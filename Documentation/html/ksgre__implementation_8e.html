<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KSFoundation: ksgre_implementation.e File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KarolinskaLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KSFoundation
   &#160;<span id="projectnumber">[Feb-2019]</span>
   </div>
   <div id="projectbrief">A platform for simpler EPIC programming on GE MR systems</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ksgre__implementation_8e.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ksgre_implementation.e File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html">KSGRE_SEQUENCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a6199326feb445e792394581122cb3b7a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:a6199326feb445e792394581122cb3b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb346530c2c4b9134aa50dc5e70656bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a>&#160;&#160;&#160;200 /* which may allow us to use the same SSI for other sequence modules too */</td></tr>
<tr class="separator:abb346530c2c4b9134aa50dc5e70656bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc3892172d12e34376e6ca8498cd054e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#adc3892172d12e34376e6ca8498cd054e">KSGRE_DEFAULT_SSI_TIME_SSFP</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:adc3892172d12e34376e6ca8498cd054e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de9d8b8f8b5932ffd38c917c9c75552"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a3de9d8b8f8b5932ffd38c917c9c75552">KSGRE_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a3de9d8b8f8b5932ffd38c917c9c75552"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afa14e87783cd60ea431d471ea4ce8625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#afa14e87783cd60ea431d471ea4ce8625">abstract</a> (&quot;GRE [KSFoundation]&quot;)</td></tr>
<tr class="separator:afa14e87783cd60ea431d471ea4ce8625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e52bacfad7e1175630f8cc09a528e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a03e52bacfad7e1175630f8cc09a528e4">psdname</a> (&quot;ksgre&quot;)</td></tr>
<tr class="separator:a03e52bacfad7e1175630f8cc09a528e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aa7448afdfc93bc9e4aa543255bd5aa"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a1aa7448afdfc93bc9e4aa543255bd5aa">ksgre_pg</a> (int start_time)</td></tr>
<tr class="separator:a1aa7448afdfc93bc9e4aa543255bd5aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab41bbe03d1ecedd754217bbe64ad4e06"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06">ksgre_scan_coreslice</a> (const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</td></tr>
<tr class="separator:ab41bbe03d1ecedd754217bbe64ad4e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb99d39d409aa58fcc42a57261b5d4d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a> (const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</td></tr>
<tr class="separator:a5fb99d39d409aa58fcc42a57261b5d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bc530012d9eb0a65c7e3f2d7361773"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773">ksgre_scan_sliceloop</a> (int slperpass, int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, int shot, int exc)</td></tr>
<tr class="separator:a85bc530012d9eb0a65c7e3f2d7361773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4690d7ea9b0a30ecfcfa4ac0dd97cbad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad">ksgre_scan_sliceloop_nargs</a> (int slperpass, int nargs, void **args)</td></tr>
<tr class="separator:a4690d7ea9b0a30ecfcfa4ac0dd97cbad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736163acb46205caa086c85b01f0a7de"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a736163acb46205caa086c85b01f0a7de">ksgre_scan_acqloop</a> (int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>)</td></tr>
<tr class="separator:a736163acb46205caa086c85b01f0a7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe8bc64d63034c5edb532aa86603aa7"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7">ksgre_scan_scanloop</a> ()</td></tr>
<tr class="separator:a2fe8bc64d63034c5edb532aa86603aa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a0c72f6b8c2aea333fc9ed05fc3cfb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a99a0c72f6b8c2aea333fc9ed05fc3cfb">ksgre_eval_ssitime</a> ()</td></tr>
<tr class="separator:a99a0c72f6b8c2aea333fc9ed05fc3cfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65b3d636670ebaaede971d7c1ec58ed"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a> (SCAN_INFO slice_info, int shot)</td></tr>
<tr class="separator:ac65b3d636670ebaaede971d7c1ec58ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a755ac06a770c8a1d3eff2300af7201d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a755ac06a770c8a1d3eff2300af7201d7">ksgre_init_imagingoptions</a> (void)</td></tr>
<tr class="separator:a755ac06a770c8a1d3eff2300af7201d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a8d2319cad4eef380e744a109d59796"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a4a8d2319cad4eef380e744a109d59796">ksgre_init_UI</a> (void)</td></tr>
<tr class="separator:a4a8d2319cad4eef380e744a109d59796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a804a62a773a1aa3e387726a241ef98ff"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a804a62a773a1aa3e387726a241ef98ff">ksgre_eval_UI</a> ()</td></tr>
<tr class="separator:a804a62a773a1aa3e387726a241ef98ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab55525094cda2e6d49d8edf1d9f84e0a"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ab55525094cda2e6d49d8edf1d9f84e0a">ksgre_eval_setupobjects</a> ()</td></tr>
<tr class="separator:ab55525094cda2e6d49d8edf1d9f84e0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f734087ad613609e1cf6167ed04612"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ae3f734087ad613609e1cf6167ed04612">ksgre_eval_TErange</a> ()</td></tr>
<tr class="separator:ae3f734087ad613609e1cf6167ed04612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad06b978814f1b9871d98d631e3aab059"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ad06b978814f1b9871d98d631e3aab059">ksgre_eval_inversion</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:ad06b978814f1b9871d98d631e3aab059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691a311addf634b0fc1ac953071e9c25"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a691a311addf634b0fc1ac953071e9c25">ksgre_eval_tr</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a691a311addf634b0fc1ac953071e9c25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefbe4ed281f274629f92c18ab8be104a"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#aefbe4ed281f274629f92c18ab8be104a">ksgre_eval_scantime</a> ()</td></tr>
<tr class="separator:aefbe4ed281f274629f92c18ab8be104a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f62546211216fb6eb8c7939d2b2d442"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a8f62546211216fb6eb8c7939d2b2d442">ksgre_check</a> ()</td></tr>
<tr class="separator:a8f62546211216fb6eb8c7939d2b2d442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07eae599d1ce9f52372aa75bdfcd93e4"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a07eae599d1ce9f52372aa75bdfcd93e4">ksgre_predownload_plot</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a07eae599d1ce9f52372aa75bdfcd93e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de37f7455b2fb392c87372b6045fc96"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a7de37f7455b2fb392c87372b6045fc96">ksgre_predownload_setrecon</a> ()</td></tr>
<tr class="separator:a7de37f7455b2fb392c87372b6045fc96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a809fe6f6679c08221f763819f4d7a360"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a809fe6f6679c08221f763819f4d7a360">ksgre_scan_phase</a> (int counter)</td></tr>
<tr class="separator:a809fe6f6679c08221f763819f4d7a360"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90518ac85d7fb144e5e61477f55646fa"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a90518ac85d7fb144e5e61477f55646fa">ksgre_scan_init</a> (void)</td></tr>
<tr class="separator:a90518ac85d7fb144e5e61477f55646fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c0934632d530a1bbc46285c66aaae80"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a7c0934632d530a1bbc46285c66aaae80">ksgre_scan_prescanloop</a> (int nloops, int dda)</td></tr>
<tr class="separator:a7c0934632d530a1bbc46285c66aaae80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5491d813b5151e654dd12ffff2eb069f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a5491d813b5151e654dd12ffff2eb069f">ksgre_excthickness</a> = 0</td></tr>
<tr class="separator:a5491d813b5151e654dd12ffff2eb069f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a118fa4240070a42571aeff56ae10505f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a118fa4240070a42571aeff56ae10505f">ksgre_gscalerfexc</a> = 0.9</td></tr>
<tr class="separator:a118fa4240070a42571aeff56ae10505f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a289433527bae0ca681523b5b2e1e80f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a> = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td></tr>
<tr class="separator:a289433527bae0ca681523b5b2e1e80f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ccbe9f480748788628fff0476129cb4"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a8ccbe9f480748788628fff0476129cb4">ksgre_spoilerarea</a> = 1500.0 with {0.0, 10000.0, 1500.0, VIS, &quot;ksgre spoiler gradient area&quot;,}</td></tr>
<tr class="separator:a8ccbe9f480748788628fff0476129cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db7939a5492a55fada202f44c2fc62a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a3db7939a5492a55fada202f44c2fc62a">ksgre_sincrf</a> = 0 with {0, 1, 0, VIS, &quot;Use Sinc RF&quot;,}</td></tr>
<tr class="separator:a3db7939a5492a55fada202f44c2fc62a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7c470400fe18ceae739dfde9657e555"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ae7c470400fe18ceae739dfde9657e555">ksgre_sincrf_bw</a> = 2500 with {0, 100000, 2500, VIS, &quot;Sinc RF BW&quot;,}</td></tr>
<tr class="separator:ae7c470400fe18ceae739dfde9657e555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac1c91a5ff2caab2fc9285493b558c54"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#aac1c91a5ff2caab2fc9285493b558c54">ksgre_sincrf_tbw</a> = 2 with {2, 100, 2, VIS, &quot;Sinc RF TBW&quot;,}</td></tr>
<tr class="separator:aac1c91a5ff2caab2fc9285493b558c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e530ba92a02d44c4e9393777aa598c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> = 0 with {0, 2, 0, VIS, &quot;RF pulse 0(fast)-1-2(high FA)&quot;,}</td></tr>
<tr class="separator:a0e530ba92a02d44c4e9393777aa598c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac5b7c0a43f63688e01c15fd2bcc414"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#aeac5b7c0a43f63688e01c15fd2bcc414">ksgre_kxnover</a> = 32 with {<a class="el" href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a>, 512, 32, VIS, &quot;Num kx overscans for minTE&quot;,}</td></tr>
<tr class="separator:aeac5b7c0a43f63688e01c15fd2bcc414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e48f5c40adcd600566db174b75d4e7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a5e48f5c40adcd600566db174b75d4e7d">ksgre_rampsampling</a> = FALSE with {FALSE, TRUE, FALSE, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a5e48f5c40adcd600566db174b75d4e7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362fcf39eb2c6b14558795b8dfc76a78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a362fcf39eb2c6b14558795b8dfc76a78">ksgre_extragap</a> = 0 with {0, 100ms, 0, VIS, &quot;extra gap between readouts [us]&quot;,}</td></tr>
<tr class="separator:a362fcf39eb2c6b14558795b8dfc76a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1e04fadad0fae1895509c3b6edea2d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a5a1e04fadad0fae1895509c3b6edea2d">ksgre_minacslines</a> = 8 with {0, 512, 8, VIS, &quot;Minimum ACS lines for ARC&quot;,}</td></tr>
<tr class="separator:a5a1e04fadad0fae1895509c3b6edea2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae20a1b61e268996485622079d9c070cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ae20a1b61e268996485622079d9c070cd">ksgre_minzacslines</a> = 8 with {0, 512, 8, VIS, &quot;Minimum z ACS lines for ARC&quot;,}</td></tr>
<tr class="separator:ae20a1b61e268996485622079d9c070cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72955e8f3240fb7683c27f130caa2cd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ad72955e8f3240fb7683c27f130caa2cd">ksgre_pos_start</a> = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, VIS, &quot;us from start until the first waveform begins&quot;,}</td></tr>
<tr class="separator:ad72955e8f3240fb7683c27f130caa2cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d7bc942dbd61e40fb1aa03c0f3ffd1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a> = <a class="el" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a> with {32, , <a class="el" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td></tr>
<tr class="separator:ab2d7bc942dbd61e40fb1aa03c0f3ffd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac17753845599aa9719d67e54eef22d16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a> = 2 with {0, 200, 2, VIS, &quot;Number of dummy scans for steady state&quot;,}</td></tr>
<tr class="separator:ac17753845599aa9719d67e54eef22d16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8821060870d44ad2634721de112f9d98"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a8821060870d44ad2634721de112f9d98">ksgre_debug</a> = 1 with {0, 100, 1, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;,}</td></tr>
<tr class="separator:a8821060870d44ad2634721de112f9d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ecef8818f4e03e085fa66a2dd28dce8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a1ecef8818f4e03e085fa66a2dd28dce8">ksgre_imsize</a> = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td></tr>
<tr class="separator:a1ecef8818f4e03e085fa66a2dd28dce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24a4d40640ee3141d6deba660607dd54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a24a4d40640ee3141d6deba660607dd54">ksgre_abort_on_kserror</a> = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a24a4d40640ee3141d6deba660607dd54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440ac0ab4615a7f49af627d1dbfa5f7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a> = TRUE with {FALSE, TRUE, TRUE, VIS, &quot;ky-kz coverage 0:Rect 1:Elliptical&quot;,}</td></tr>
<tr class="separator:a440ac0ab4615a7f49af627d1dbfa5f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26324234fd96b08dd11f91d568a5ace2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a26324234fd96b08dd11f91d568a5ace2">ksgre_fattune</a> = 0</td></tr>
<tr class="separator:a26324234fd96b08dd11f91d568a5ace2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49d5d3a953983bac06c7aa01958d5e71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html">KSGRE_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a> = <a class="el" href="ksgre__implementation_8e.html#a3de9d8b8f8b5932ffd38c917c9c75552">KSGRE_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a49d5d3a953983bac06c7aa01958d5e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2a951aaffe71e92bec8e265a3cffdb5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a> = 0</td></tr>
<tr class="separator:ab2a951aaffe71e92bec8e265a3cffdb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f39fad60409167fe45164b72a131e0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a> []</td></tr>
<tr class="separator:a8f39fad60409167fe45164b72a131e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adffbee0f8231c5226387c8dd8f2dd482"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></td></tr>
<tr class="separator:adffbee0f8231c5226387c8dd8f2dd482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae477e374b559bf16a475321797d62cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></td></tr>
<tr class="separator:aae477e374b559bf16a475321797d62cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ade314070d88026dab1b034b4332259"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a> = 1</td></tr>
<tr class="separator:a3ade314070d88026dab1b034b4332259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3ddf7eef2bb3725f4f060830cfda776"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksgre__implementation_8e.html#ae3ddf7eef2bb3725f4f060830cfda776">spgr_phase_counter</a> = 0</td></tr>
<tr class="separator:ae3ddf7eef2bb3725f4f060830cfda776"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the implementation details for the <em>ksgre</em> psd. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a6199326feb445e792394581122cb3b7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6199326feb445e792394581122cb3b7a">&#9670;&nbsp;</a></span>KSGRE_MINHNOVER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSGRE_MINHNOVER&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abb346530c2c4b9134aa50dc5e70656bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb346530c2c4b9134aa50dc5e70656bc">&#9670;&nbsp;</a></span>KSGRE_DEFAULT_SSI_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSGRE_DEFAULT_SSI_TIME&#160;&#160;&#160;200 /* which may allow us to use the same SSI for other sequence modules too */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adc3892172d12e34376e6ca8498cd054e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc3892172d12e34376e6ca8498cd054e">&#9670;&nbsp;</a></span>KSGRE_DEFAULT_SSI_TIME_SSFP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSGRE_DEFAULT_SSI_TIME_SSFP&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3de9d8b8f8b5932ffd38c917c9c75552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3de9d8b8f8b5932ffd38c917c9c75552">&#9670;&nbsp;</a></span>KSGRE_INIT_SEQUENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSGRE_INIT_SEQUENCE</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">{<a class="code" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="code" href="_k_s_foundation_8h.html#a01108d382b19492c2178b6bedbfcbc4b">KS_INIT_READTRAP</a>, <a class="code" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="code" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, \</div><div class="line">                             KS_INIT_PHASER, <a class="code" href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a>, <a class="code" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="code" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="code" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="code" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="code" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>};</div><div class="ttc" id="_k_s_foundation_8h_html_a5e620158a577fbdc94013a3f761a5a22"><div class="ttname"><a href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a></div><div class="ttdeci">#define KS_INIT_PHASER</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:138</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a01108d382b19492c2178b6bedbfcbc4b"><div class="ttname"><a href="_k_s_foundation_8h.html#a01108d382b19492c2178b6bedbfcbc4b">KS_INIT_READTRAP</a></div><div class="ttdeci">#define KS_INIT_READTRAP</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:135</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1ba17433713316fa65385237ebb0fb67"><div class="ttname"><a href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a></div><div class="ttdeci">#define KS_INIT_TRAP</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:132</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a8d8030715d634067abc0732b5507ce14"><div class="ttname"><a href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a></div><div class="ttdeci">#define KS_INIT_SELRF</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:157</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a232cf810c71aebfeadc56a82f472a1ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a></div><div class="ttdeci">#define KS_INIT_SEQ_CONTROL</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:162</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9cf630986b9344177e80b7d9644bfb81"><div class="ttname"><a href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a></div><div class="ttdeci">#define KS_INIT_PHASEENCODING_PLAN</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:140</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afa14e87783cd60ea431d471ea4ce8625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa14e87783cd60ea431d471ea4ce8625">&#9670;&nbsp;</a></span>abstract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">abstract </td>
          <td>(</td>
          <td class="paramtype">&quot;GRE &quot;&#160;</td>
          <td class="paramname">[KSFoundation]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03e52bacfad7e1175630f8cc09a528e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e52bacfad7e1175630f8cc09a528e4">&#9670;&nbsp;</a></span>psdname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psdname </td>
          <td>(</td>
          <td class="paramtype">&quot;ksgre&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1aa7448afdfc93bc9e4aa543255bd5aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aa7448afdfc93bc9e4aa543255bd5aa">&#9670;&nbsp;</a></span>ksgre_pg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_pg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The ksgre (main) pulse sequence</h4>
</p>
<p>This is the main pulse sequence in <a class="el" href="ksgre_8e.html" title="This file contains the overall structure for the ksgre psd. ">ksgre.e</a> using the sequence objects in <a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksgre sequence">KSGRE_SEQUENCE</a> with the sequence module name "ksgremain" (= ksgre.seqctrl.description)</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                                {</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <a class="code" href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a> tmploc = <a class="code" href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a>;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="keywordtype">int</span> readstart_pos, readend_pos;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="keywordtype">int</span> endposx = 0;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="keywordtype">int</span> endposy = 0;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordtype">int</span> endposz = 0;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  STATUS status;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keywordflow">if</span> (opte &lt; avminte) {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">/* we cannot proceed until TE is larger than the minimum TE (see ksgre_eval_TErange()).</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">       Return a long seq duration and pretend all is good */</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1s);</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  }</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">if</span> (start_time &lt; <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>) {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st arg (pos start) must be at least %d us&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  }</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(start_time);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">/* N.B.: ks_pg_selrf()-&gt;ks_pg_rf() detects that ksgre.selrfexc is an excitation pulse</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">     (ksgre.selrfexc.rf.role = KS_RF_ROLE_EXC) and will also set ksgre.seqctrl.momentstart</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">     to the absolute position in [us] of the isocenter of the RF excitation pulse */</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">/* forward to end of selrfexc.postgrad */</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  </div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="comment">/* Second flow comp gradient slice for slice excitation */</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* N.B.: will return quietly if ksgre.fcompslice.duration = 0 (opfcomp = 0) */</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  </div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">  *  Readout timing</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  <span class="comment">/* With ksgre.seqctrl.momentstart set by ks_pg_selrf(&amp;ksgre.selrfexc, ...), the absolute readout position</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">     can be determined (for both full Fourier and partial Fourier readouts using ksgre.read.time2center) */</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  readstart_pos = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + opte - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">   *  Pre-read: Dephasers</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="comment">/********************  Z  ********************/</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) {</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="comment">/* 3D: use .zphaseenc (with embedded slice rephaser via .areaoffset != 0) instead of .selrfexc.postgrad (not placed out since its .duration = 0) */</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* fcompslice.duration = 0 unless opfcomp */</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, 0, 0);</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  }</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="comment">/********************  Y  ********************/</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readstart_pos + RUP_GRD(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>) - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">/* set phase encode amps to first ky view (for plotting &amp; moment calcs in WTools) */</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, 0, 0); <span class="comment">/* dephaser */</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">/********************  X  ********************/</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a>)</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD; <span class="comment">/* move the readout to the Z-axis to view the slice thickness in the image */</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readstart_pos - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readstart_pos - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* N.B.: will return quietly if ksgre.fcompread.duration = 0 */</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">   *  Readout(s)</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a>)</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">/* ksgre.read at TE = opte (1st echo) */</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readstart_pos;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; opnecho; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a21198913d5b1603f03a5e5d61d00408c">ks_pg_readtrap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a362fcf39eb2c6b14558795b8dfc76a78">ksgre_extragap</a> * ((<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> + 1) &lt; opnecho); <span class="comment">/* don&#39;t add extra gap after the last readout */</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> *= -1.0;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  }</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  readend_pos = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>; <span class="comment">/* absolute time for end of last readout trapezoid */</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="comment">   *  Post-read: Rephasers &amp; spoilers</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">/********************  X  ********************/</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readend_pos;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* read rephaser */</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    endposx = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* absolute time for end of last waveform on X */</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    endposx = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* absolute time for end of last waveform on X */</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  }</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="comment">/********************  Y  ********************/</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="comment">/* phase encoding rephaser on Y (common for GRE, SPGR &amp; SSFP) */</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readend_pos - RDN_GRD(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>); <span class="comment">/* Y rephaser can start at the end of the acqwin */</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  endposy = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* absolute time for end of last waveform on Y */</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, 1, 0); <span class="comment">/* rephaser */</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="comment">/********************  Z  ********************/</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readend_pos - RDN_GRD(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>); <span class="comment">/* Z rephaser/spoiler can start at the end of the acqwin */</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) { <span class="comment">/* 3D */</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">/* z phase encoding rephaser (if 3D SSFP) */</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      endposz = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, 1, 0);</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">/* 2D SSFP */</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <span class="comment">/* endtime - postgrad.duration = starting point for z postgrad trapezoid */</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += IMax(3, \</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                         RUP_GRD(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>) + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, \</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                         <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, \</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                         <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) + <a class="code" href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="comment">/* another instance of the slice rephaser, placed at the very end. Relies on isodelay = rfwave.duration / 2 */</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      endposz = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    }</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* non-SSFP */</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    endposz = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">   *  Setup phase encoding table for scan (2D + 3D)</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a> &amp;&amp; <a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* 3D */</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#aa067bf0cb6e0bfc4a1d39f4fe760f213">ks_phaseencoding_generate_simple_ellipse</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#aa887db0578a0780ccd7ed143e858588c">ks_phaseencoding_generate_simple</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a> : NULL);</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  }</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ab37bdbd70185618b80d077f99b253616">ks_phaseencoding_print</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>);</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">   *  Set the minimal sequence duration (ksgre.seqctrl.min_duration) by calling</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="comment">   *  ks_eval_seqctrl_setminduration()</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">/* end position of all axes. Make sure we are divisible by GRAD_UPDATE_TIME (4us) */</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(IMax(3, endposx, endposy, endposz));</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <span class="comment">/* On HOST only: Sequence duration (ksgre.seqctrl.ssi_time must be &gt; 0 and is added to ksgre.seqctrl.min_duration in ks_eval_seqctrl_setminduration() */</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="ksgre__implementation_8e.html#a99a0c72f6b8c2aea333fc9ed05fc3cfb">ksgre_eval_ssitime</a>();</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>); <span class="comment">/* tmploc.pos now corresponds to the end of last gradient in the sequence */</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;} <span class="comment">/* ksgre_pg() */</span></div><div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a8cabd9318f1bc7fa94adc1027348658c"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">KSGRE_SEQUENCE::fcompread</a></div><div class="ttdeci">KS_TRAP fcompread</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">KS_SEQLOC::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:242</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a21198913d5b1603f03a5e5d61d00408c"><div class="ttname"><a href="_k_s_foundation_8h.html#a21198913d5b1603f03a5e5d61d00408c">ks_pg_readtrap</a></div><div class="ttdeci">STATUS ks_pg_readtrap(KS_READTRAP *readtrap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_READTRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1529</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa887db0578a0780ccd7ed143e858588c"><div class="ttname"><a href="_k_s_foundation_8h.html#aa887db0578a0780ccd7ed143e858588c">ks_phaseencoding_generate_simple</a></div><div class="ttdeci">STATUS ks_phaseencoding_generate_simple(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, const char *const desc, KS_PHASER *phaser, KS_PHASER *zphaser)</div><div class="ttdoc">Generation of a KS_PHASEENCODING_PLAN for any sequence having only one echo (or same phasenc step for...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:414</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSGRE_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:53</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a094595db960708064dc1b8b645c4be71"><div class="ttname"><a href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a></div><div class="ttdeci">STATUS ks_pg_phaser(KS_PHASER *phaser, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_PHASER sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1412</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6e727c3449c63278cbfc2e35cfcfa9fa"><div class="ttname"><a href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a></div><div class="ttdeci">STATUS ks_pg_selrf(KS_SELRF *selrf, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_SELRF sequence object on a gradient (and RF) board at some position in the pulse sequence...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1954</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a2e3f5254967cadb9a41167c6fbf6743e"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">KS_SEQLOC::board</a></div><div class="ttdeci">int board</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:241</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a606fbf556e8a297aa1f68b098f6ac2a2"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">KS_SEQLOC::ampscale</a></div><div class="ttdeci">float ampscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:243</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSGRE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a7ea43263446cf80f67f4b80d1e21503d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">KSGRE_SEQUENCE::readrephaser_ssfp</a></div><div class="ttdeci">KS_TRAP readrephaser_ssfp</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:47</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa067bf0cb6e0bfc4a1d39f4fe760f213"><div class="ttname"><a href="_k_s_foundation_8h.html#aa067bf0cb6e0bfc4a1d39f4fe760f213">ks_phaseencoding_generate_simple_ellipse</a></div><div class="ttdeci">STATUS ks_phaseencoding_generate_simple_ellipse(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, const char *const desc, KS_PHASER *phaser, KS_PHASER *zphaser)</div><div class="ttdoc">Generation of a KS_PHASEENCODING_PLAN for any sequence having only one echo (or same phasenc step for...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:455</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a440ac0ab4615a7f49af627d1dbfa5f7d"><div class="ttname"><a href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a></div><div class="ttdeci">int ksgre_ellipsekspace</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:104</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ab2a951aaffe71e92bec8e265a3cffdb5"><div class="ttname"><a href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a></div><div class="ttdeci">int ksgre_ssfp_endtime</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:123</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a362fcf39eb2c6b14558795b8dfc76a78"><div class="ttname"><a href="ksgre__implementation_8e.html#a362fcf39eb2c6b14558795b8dfc76a78">ksgre_extragap</a></div><div class="ttdeci">int ksgre_extragap</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:87</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a99a0c72f6b8c2aea333fc9ed05fc3cfb"><div class="ttname"><a href="ksgre__implementation_8e.html#a99a0c72f6b8c2aea333fc9ed05fc3cfb">ksgre_eval_ssitime</a></div><div class="ttdeci">int ksgre_eval_ssitime()</div><div class="ttdoc">The SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1006</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a61651c54c4dfd4388fc939d804a9964b"><div class="ttname"><a href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a></div><div class="ttdeci">STATUS ks_pg_trap(KS_TRAP *trap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_TRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1212</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSGRE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:46</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSGRE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a></div><div class="ttdoc">typedef struct used as argument to ks_pg_*** functions to control where and when to place a sequence ...</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:240</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a289433527bae0ca681523b5b2e1e80f7"><div class="ttname"><a href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a></div><div class="ttdeci">int ksgre_slicecheck</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:75</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aff91e4da3b6ccabd607ec0da04f774ce"><div class="ttname"><a href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a></div><div class="ttdeci">void ks_scan_phaser_toline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from the k-space center to a desired k-s...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:319</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a75c403072633f5a42fe364af4454b245"><div class="ttname"><a href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a></div><div class="ttdeci">STATUS ks_eval_seqctrl_setminduration(KS_SEQ_CONTROL *seqctrl, int mindur)</div><div class="ttdoc">Sets the minimum duration and duration fields of a KS_SEQ_CONTROL struct based on some minimum time (...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2925</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab37bdbd70185618b80d077f99b253616"><div class="ttname"><a href="_k_s_foundation_8h.html#ab37bdbd70185618b80d077f99b253616">ks_phaseencoding_print</a></div><div class="ttdeci">void ks_phaseencoding_print(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr)</div><div class="ttdoc">Print out KS_PHASEENCODING_PLAN to a text file</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:351</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad01dd4f06fe226a502e872d4173ba7ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a></div><div class="ttdeci">#define KS_INIT_SEQLOC</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:128</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_READTRAP::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1434</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a81a97893a74af952d90181aa858e709b"><div class="ttname"><a href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a></div><div class="ttdeci">void ks_scan_phaser_fromline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from a k-space line to the k-space cente...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:338</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab41bbe03d1ecedd754217bbe64ad4e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab41bbe03d1ecedd754217bbe64ad4e06">&#9670;&nbsp;</a></span>ksgre_scan_coreslice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_scan_coreslice </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out one slice in real time during scanning together with other active sequence modules</h4>
</p>
<p>On TGT on the MR system (PSD_HW), this function sets up (<a class="el" href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed" title="Sets the current state of all ksgre sequence objects being part of KSGRE_SEQUENCE">ksgre_scan_seqstate()</a>) and plays out the core ksgre sequence with optional sequence modules also called in this function. The low-level function call <code><a class="el" href="_k_s_foundation__tgt_8c.html#a7a93838e7d53ff7ec9fbe98843181d03">startseq()</a></code>, which actually starts the realtime sequence playout is called from within <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, which in addition also returns the time to play out that sequence module (see time += ...).</p>
<p>On HOST (in <a class="el" href="ksgre__implementation_8e.html#a691a311addf634b0fc1ac953071e9c25" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksgre_eval_tr()</a>) we call <a class="el" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad" title="Wrapper function to ksgre_scan_sliceloop() with standardized input arguments">ksgre_scan_sliceloop_nargs()</a>, which in turn calls this function that returns the total time in [us] taken to play out this core slice. These times are increasing in each parent function until ultimately ksgre_scan_scantime(), which returns the total time of the entire scan.</p>
<p>After each call to <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> is called to add slice-timing information on file for later PDF-generation of the sequence. As scanning is performed in real-time and may fail if interrupted, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> will return quietly if it detects both IPG (TGT) and PSD_HW (on the MR scanner). See <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> for the PNG/PDF generation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Position of the slice to be played out (one element in the global <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index (over ky and kz) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exc</td><td>Excitation index in range <code>[0, NEX-1]</code>, where NEX = number of excitations (opnex) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                                                                                        {</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordtype">int</span> echoindx;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="keywordtype">int</span> dabop, dabview, acqflag;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordtype">float</span> tloc = 0.0;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordtype">int</span> echo = 0; <span class="comment">/* only one phase encode for all echoes for now */</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL)</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    tloc = slice_pos-&gt;optloc;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">  * SpSat sequence module</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  time += <a class="code" href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a>(<a class="code" href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a>);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">  * Chemsat sequence module</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>); <span class="comment">/* no slice location for fat sat */</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">  * ksgre main sequence module</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL) {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">/* modify sequence for next playout */</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a>(*slice_pos, shot);</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="comment">/* false slice, shut off RF */</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  }</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, echo, shot);</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="comment">/* data acquisition control */</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  acqflag = (shot &gt;= 0 &amp;&amp; slice_pos != NULL &amp;&amp; coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> &gt;= 0 &amp;&amp; slice_pos != NULL &amp;&amp; dabslice &gt;= 0) ? DABON : DABOFF; <span class="comment">/* open or close data receiver */</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  dabop = (exc &lt;= 0) ? DABSTORE : DABADD; <span class="comment">/* replace or add to data */</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[1].optloc &gt; <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0].optloc)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      dabslice = (opslquant * opvquant - 1) - coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;      dabslice = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  }</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  dabview = (shot &gt;= 0) ? coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  if (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> &gt; 1 &amp;&amp; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">nacslines</a> == 0 &amp;&amp; dabview != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) <span class="comment">/* ASSET case triggered by R &gt; 1 and no ACS lines */</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    dabview /= <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>; <span class="comment">/* store in compressed BAM without empty non-acquired lines */</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="keywordflow">for</span> (echoindx = 0; echoindx &lt; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a>; echoindx++) {</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aa4c29e21c8d521ebb578246daeb29178">ks_scan_loaddabwithindices_nex</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[echoindx], dabslice, echoindx, dabview + 1, <span class="comment">/*acq*/</span> 0, <span class="comment">/*vol*/</span> 0, dabop, acqflag);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  }</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, &amp;tloc, <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>);</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;} <span class="comment">/* ksgre_scan_coreslice() */</span></div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a0e0bae3aa47ae5b8aae488fa0eb920ce"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">KS_READ::echo</a></div><div class="ttdeci">WF_PULSE * echo</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:587</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a4762b9a6307f0223b3d1dfde7e8ddce8"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">KS_PHASER::nacslines</a></div><div class="ttdeci">int nacslines</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1530</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa4c29e21c8d521ebb578246daeb29178"><div class="ttname"><a href="_k_s_foundation_8h.html#aa4c29e21c8d521ebb578246daeb29178">ks_scan_loaddabwithindices_nex</a></div><div class="ttdeci">STATUS ks_scan_loaddabwithindices_nex(WF_PULSE_ADDR pulse, LONG slice, LONG echo, LONG view, uint8_t acq, uint8_t vol, LONG operation, TYPDAB_PACKETS acqon_flag)</div><div class="ttdoc">loaddab() with extra arguments for current acquisition and image volume and current excitation (NEX)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1305</div></div>
<div class="ttc" id="_g_e_required_8e_html_aece7287cee904292d20da04682670ccc"><div class="ttname"><a href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a></div><div class="ttdeci">int ks_perform_slicetimeplot</div><div class="ttdef"><b>Definition:</b> GERequired.e:219</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a06ab78e08959e925d92935c582469de8"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">KS_READ::base</a></div><div class="ttdeci">KS_BASE base</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:581</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSGRE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ac65b3d636670ebaaede971d7c1ec58ed"><div class="ttname"><a href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a></div><div class="ttdeci">STATUS ksgre_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksgre sequence objects being part of KSGRE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1514</div></div>
<div class="ttc" id="_k_s_sp_sat_8e_html_abfffc166a1d95ac817d1dc894fd2a416"><div class="ttname"><a href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a></div><div class="ttdeci">int ksspsat_scan_playsequences(int perform_slicetimeplot)</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:816</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a31e708efa36d49cc75d7dc46b58d17b9"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a></div><div class="ttdeci">void kschemsat_scan_seqstate(KSCHEMSAT_SEQUENCE *kschemsat)</div><div class="ttdoc">Sets the current state of all kschemsat sequence objects being part of KSCHEMSAT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:387</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:194</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a37673579414f16215fe19214f23a1116"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a></div><div class="ttdeci">KSCHEMSAT_SEQUENCE kschemsat</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:88</div></div>
<div class="ttc" id="struct_k_s___b_a_s_e_html_a48a67aa9525b1eaff08aa809b53110dc"><div class="ttname"><a href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">KS_BASE::ngenerated</a></div><div class="ttdeci">int ngenerated</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:262</div></div>
<div class="ttc" id="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSCHEMSAT_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:70</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fb99d39d409aa58fcc42a57261b5d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb99d39d409aa58fcc42a57261b5d4d">&#9670;&nbsp;</a></span>ksgre_scan_coreslice_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_scan_coreslice_nargs </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a> with standardized input arguments</h4>
</p>
<p><a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a> has functions (<a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>, <a class="el" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a" title="Runs the inversion slice loop and validates TR and SAR/hardware limits">ksinv_eval_checkTR_SAR()</a> and <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>) that expect a standardized function pointer to the coreslice function of a main sequence. When inversion mode is enabled for the sequence, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is used instead of <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> in <a class="el" href="ksgre__implementation_8e.html#a736163acb46205caa086c85b01f0a7de" title="Plays out all phase encodes for all slices belonging to one pass">ksgre_scan_acqloop()</a>, and the generic <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> function need a handle to the coreslice function of the main sequence.</p>
<p>In order for these <code>ksinv_***</code> functions to work for any pulse sequence they need a standardized function pointer with a fixed set of input arguments. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d" title="Wrapper function to ksgre_scan_coreslice() with standardized input arguments">ksgre_scan_coreslice_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a>.</p>
<p>The function pointer must have SCAN_INFO and slice storage index (dabslice) as the first two input args, while remaining input arguments (to <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Pointer to the SCAN_INFO struct corresponding to the current slice to be played out </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a> in range [0,3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                                                                                                 {</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="keywordtype">int</span> shot = 0;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordtype">int</span> exc = 0;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 2) {</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) must contain up to 2 elements in the following order: shot, exc&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) cannot be NULL if nargs (3rd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  }</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  }</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    exc = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;  }</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06">ksgre_scan_coreslice</a>(slice_pos, dabslice, <span class="comment">/* psd specific: */</span> shot, exc); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;} <span class="comment">/* ksgre_scan_coreslice_nargs() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_ab41bbe03d1ecedd754217bbe64ad4e06"><div class="ttname"><a href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06">ksgre_scan_coreslice</a></div><div class="ttdeci">int ksgre_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1601</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85bc530012d9eb0a65c7e3f2d7361773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85bc530012d9eb0a65c7e3f2d7361773">&#9670;&nbsp;</a></span>ksgre_scan_sliceloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_scan_sliceloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out <code>slperpass</code> slices corresponding to one TR</h4>
</p>
<p>This function gets a spatial slice location index based on the pass index and temporal position within current pass. It then calls <a class="el" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksgre_scan_coreslice()</a> to play out one coreslice (i.e. the main ksgre main sequence + optional sequence modules, excluding inversion modules).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>0-based pass index in range [0, ks_slice_plan.npasses - 1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index in range <code>[0, ksgre.phaseenc_plan.num_shots - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exc</td><td>Excitation index in range [0, NEX-1], where NEX = number of excitations (opnex) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                                                                         {</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="keywordtype">int</span> slloc, sltimeinpass;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  SCAN_INFO centerposition = <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0]; <span class="comment">/* first slice chosen here, need only rotation stuff */</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="keywordtype">int</span> centerslice = opslquant/2;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="comment">/* for future 3D multislab support, let passindx update centerposition */</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    centerposition.optloc = (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice-1].optloc + <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice].optloc)/2.0;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  }</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  </div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; slperpass; sltimeinpass++) {</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    SCAN_INFO *current_slice = &amp;centerposition;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* 2D */</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass);</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    </div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;      <span class="comment">/* if slloc = KS_NOTSET, pass in NULL as first argument to indicate &#39;false slice&#39; */</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      current_slice = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc]: NULL;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    }</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    time += <a class="code" href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06">ksgre_scan_coreslice</a>(current_slice, sltimeinpass, shot, exc);</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  }</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;} <span class="comment">/* ksgre_scan_sliceloop() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_ab41bbe03d1ecedd754217bbe64ad4e06"><div class="ttname"><a href="ksgre__implementation_8e.html#ab41bbe03d1ecedd754217bbe64ad4e06">ksgre_scan_coreslice</a></div><div class="ttdeci">int ksgre_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1601</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1931</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4690d7ea9b0a30ecfcfa4ac0dd97cbad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4690d7ea9b0a30ecfcfa4ac0dd97cbad">&#9670;&nbsp;</a></span>ksgre_scan_sliceloop_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_scan_sliceloop_nargs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> with standardized input arguments</h4>
</p>
<p>For TR timing heat/SAR calculations of regular 2D multislice sequences, <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, <a class="el" href="_k_s_foundation_8h.html#af38e51235c90bff510cae4ee1955dd95" title="Returns the minimum TR based on the content of a slice loop, adding additional time due to SAR and ha...">ks_eval_mintr()</a> and <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a> use a standardized function pointer with a fixed set of input arguments to call the sliceloop of the main sequence with different number of slices to check current slice loop duration. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad" title="Wrapper function to ksgre_scan_sliceloop() with standardized input arguments">ksgre_scan_sliceloop_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>.</p>
<p>The function pointer must have an integer corresponding to the number of slices to use as its first argument while the remaining input arguments (to <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> in range [0,4] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                                                                      {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="keywordtype">int</span> shot = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;   <span class="comment">/* off */</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordtype">int</span> exc = 0;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 3) {</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) must contain up to 3 elements: passindx, shot, exc&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) cannot be NULL if nargs (2nd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  }</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  }</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  }      </div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 3 &amp;&amp; args[2] != NULL) {</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    exc = *((<span class="keywordtype">int</span> *) args[2]);</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  }</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773">ksgre_scan_sliceloop</a>(slperpass, <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot, exc); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;} <span class="comment">/* ksgre_scan_sliceloop_nargs() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1931</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a85bc530012d9eb0a65c7e3f2d7361773"><div class="ttname"><a href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773">ksgre_scan_sliceloop</a></div><div class="ttdeci">int ksgre_scan_sliceloop(int slperpass, int passindx, int shot, int exc)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1735</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a736163acb46205caa086c85b01f0a7de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a736163acb46205caa086c85b01f0a7de">&#9670;&nbsp;</a></span>ksgre_scan_acqloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_scan_acqloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all phase encodes for all slices belonging to one pass</h4>
</p>
<p>This function traverses through all phase encodes to be played out and runs the <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> for each set of kyindx, kzindx, and excitation. If ksgre_dda &gt; 0, dummy scans will be played out before the phase encoding begins.</p>
<p>In the case of inversion, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is called instead of <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>, where the former takes a function pointer to <a class="el" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d" title="Wrapper function to ksgre_scan_coreslice() with standardized input arguments">ksgre_scan_coreslice_nargs()</a> in order to be able to play out the coreslice in a timing scheme set by <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>0-based pass index in range [0, ks_slice_plan.npasses - 1] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">passlooptime</td><td>Time taken in [us] to play out all phase encodes and excitations for <code>slperpass</code> slices. Note that the value is a <code>float</code> instead of <code>int</code> to avoid int overrange at 38 mins of scanning </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;                                       {</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keywordtype">int</span> shot, exc;</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a> = TRUE; <span class="comment">/* for every new acq., prepare for half flip-angle for next RF pulse only */</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordflow">for</span> (shot = -<a class="code" href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a>; shot &lt; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">num_shots</a>; shot++) {</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="comment">/* shot &lt; 0 means dummy scans, and is handled in ksgre_scan_coreslice() and ksgre_scan_seqstate() */</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">if</span> (shot == 0 &amp;&amp; <a class="code" href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a> &gt; 0) {</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a>);</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    }</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">for</span> (exc = 0; exc &lt; (int) ceil(opnex); exc++) { <span class="comment">/* ceil rounds up opnex &lt; 1 (used for partial Fourier) to 1 */</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="keywordtype">void</span> *args[2] = {(<span class="keywordtype">void</span> *) &amp;shot, (<span class="keywordtype">void</span> *) &amp;exc}; <span class="comment">/* pass on args via ksinv_scan_sliceloop() to ksgre_scan_coreslice() */</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordtype">int</span> nargs = <span class="keyword">sizeof</span>(args) / <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        time += (float) <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>,</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                                              (shot &lt; 0) ? <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a> : <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>, <a class="code" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a>, nargs, args);</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        time += (float) <a class="code" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773">ksgre_scan_sliceloop</a>(<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot, exc);          </div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    } <span class="comment">/* for exc */</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a>(<span class="stringliteral">&quot;ksgre shots&quot;</span>);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">/* save a frame of the main sequence for later generation of an animated GIF using ./psdplot/makegif_ksgre.sh */</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="keywordflow">if</span> (shot &gt;= 0) {</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    }</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  </div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  } <span class="comment">/* for shot */</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  </div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a>);</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;} <span class="comment">/* ksgre_scan_acqloop() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_aa2f98be84137da8386df3fc88763823c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">KS_PHASEENCODING_PLAN::num_shots</a></div><div class="ttdeci">int num_shots</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1587</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1931</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa4d70e1b753a44f18ce002ecb84cd16e"><div class="ttname"><a href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a></div><div class="ttdeci">void ks_plot_tgt_addframe(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3151</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aadb6109f3b3f75f81b46e153f9eb11f0"><div class="ttname"><a href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a></div><div class="ttdeci">void ks_plot_slicetime_endofslicegroup(const char *desc)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3091</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSGRE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:198</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a85bc530012d9eb0a65c7e3f2d7361773"><div class="ttname"><a href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773">ksgre_scan_sliceloop</a></div><div class="ttdeci">int ksgre_scan_sliceloop(int slperpass, int passindx, int shot, int exc)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1735</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ac17753845599aa9719d67e54eef22d16"><div class="ttname"><a href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a></div><div class="ttdeci">int ksgre_dda</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:100</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a3ade314070d88026dab1b034b4332259"><div class="ttname"><a href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a></div><div class="ttdeci">int fiesta_firstplayout</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1932</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:200</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab8c26ea9ee8534faf737bbc61223253e"><div class="ttname"><a href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a></div><div class="ttdeci">void ks_plot_slicetime_endofpass()</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5fb99d39d409aa58fcc42a57261b5d4d"><div class="ttname"><a href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a></div><div class="ttdeci">int ksgre_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksgre_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1695</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fe8bc64d63034c5edb532aa86603aa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fe8bc64d63034c5edb532aa86603aa7">&#9670;&nbsp;</a></span>ksgre_scan_scanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_scan_scanloop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all passes of a single or multi-pass scan</h4>
</p>
<p>This function traverses through all phase encodes to be played out, and runs the <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a> for each set of kyindx, kzindx, and excitation. If ksgre_dda &gt; 0, dummy scans will be played out before the phase encoding begins.</p>
<p>In the case of inversion, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is called instead of <a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>, where the former takes a function pointer to <a class="el" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d" title="Wrapper function to ksgre_scan_coreslice() with standardized input arguments">ksgre_scan_coreslice_nargs()</a> in order to be able to play out the coreslice in a timing scheme set by <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">scantime</td><td>Total scan time in [us] (float to avoid int overrange after 38 mins) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;                            {</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> = 0; <a class="code" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; opfphases; <a class="code" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>++) { <span class="comment">/* opfphases is # volumes (BUT: opfphases for now always 1 since opmph = 0) */</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0; <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>; <a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>++) {</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">/* 2D: ks_slice_plan.npasses * ks_slice_plan.nslices_per_pass &gt;= opslquant, depending on divisibility</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">         3D: ks_slice_plan.npasses * ks_slice_plan.nslices_per_pass &gt;= opvquant,  depending on divisibility */</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      time += <a class="code" href="ksgre__implementation_8e.html#a736163acb46205caa086c85b01f0a7de">ksgre_scan_acqloop</a>(<a class="code" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#ifdef IPG</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <span class="comment">/* Send instruction to dump Pfile (if autolock = 1) and for GE&#39;s recon to start reconstructing the slices for current pass */</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <a class="code" href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a>();</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    } <span class="comment">/* end: acqs (pass) loop */</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  } <span class="comment">/* end: volume loop */</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <span class="keywordflow">return</span> time;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;} <span class="comment">/* ksgre_scan_scanloop() */</span></div><div class="ttc" id="_g_e_required_8e_html_a7d88db21119d2904e811676cff0a49a5"><div class="ttname"><a href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a></div><div class="ttdeci">void GEReq_endofpass()</div><div class="ttdoc">Sets SSP word in sequence off_GEpass() to trigger data (Pfile) writing and reconstruction</div><div class="ttdef"><b>Definition:</b> GERequired.e:2565</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1931</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1931</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a9cd9ebd93187231e5c4109d14c0dd69c"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">KS_SLICE_PLAN::npasses</a></div><div class="ttdeci">int npasses</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1201</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a736163acb46205caa086c85b01f0a7de"><div class="ttname"><a href="ksgre__implementation_8e.html#a736163acb46205caa086c85b01f0a7de">ksgre_scan_acqloop</a></div><div class="ttdeci">float ksgre_scan_acqloop(int)</div><div class="ttdoc">Plays out all phase encodes for all slices belonging to one pass</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1836</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a99a0c72f6b8c2aea333fc9ed05fc3cfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99a0c72f6b8c2aea333fc9ed05fc3cfb">&#9670;&nbsp;</a></span>ksgre_eval_ssitime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_eval_ssitime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The SSI time for the sequence</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>SSI time in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                         {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">/* SSI time CV:</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">     Empirical finding on how much SSI time we need to update.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">     But, use a longer SSI time when we write out data to file in scan() */</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; (oppseq == PSD_SSFP))</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a> = RUP_GRD(IMax(2, <a class="code" href="ksgre__implementation_8e.html#adc3892172d12e34376e6ca8498cd054e">KSGRE_DEFAULT_SSI_TIME_SSFP</a>, _ksgre_ssi_time.minval));</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a> = RUP_GRD(IMax(2, <a class="code" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a>, _ksgre_ssi_time.minval));</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <span class="comment">/* Copy SSI CV to seqctrl field used by setssitime() */</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = RUP_GRD(<a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">/* SSI time one-sequence-off workaround:</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">     We set the hardware ssitime in ks_scan_playsequence(), but it acts on the next sequence module, hence</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">     we aren&#39;t doing this correctly when using multiple sequence modules (as KSChemSat etc).</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">     One option would be to add a short dummy sequence ks_scan_playsequence(), but need to investigate</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">     if there is a better way. For now, let&#39;s assume the the necessary update time is the longest for</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">     the main sequence (this function), and let the ssi time for all other sequence modules (KSChemSat etc)</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">     have the same ssi time as the main sequence. */</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a>    = <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <a class="code" href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a>      = <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a>        = <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a> = <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a>;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;} <span class="comment">/* ksgre_eval_ssitime() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_adc3892172d12e34376e6ca8498cd054e"><div class="ttname"><a href="ksgre__implementation_8e.html#adc3892172d12e34376e6ca8498cd054e">KSGRE_DEFAULT_SSI_TIME_SSFP</a></div><div class="ttdeci">#define KSGRE_DEFAULT_SSI_TIME_SSFP</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:35</div></div>
<div class="ttc" id="_k_s_sp_sat_8e_html_ab39cbb31487a0719bb5d0af9a68f3ef2"><div class="ttname"><a href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a></div><div class="ttdeci">int ksspsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:134</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ab2d7bc942dbd61e40fb1aa03c0f3ffd1"><div class="ttname"><a href="ksgre__implementation_8e.html#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">ksgre_ssi_time</a></div><div class="ttdeci">int ksgre_ssi_time</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:99</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3ec411ca45ee9d7fd1497ad6bdec3621"><div class="ttname"><a href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a></div><div class="ttdeci">int ksinv_filltr_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:156</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_ae39a435e62e3e6d2470d70d5dbf1833e"><div class="ttname"><a href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a></div><div class="ttdeci">int kschemsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:105</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_abb346530c2c4b9134aa50dc5e70656bc"><div class="ttname"><a href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a></div><div class="ttdeci">#define KSGRE_DEFAULT_SSI_TIME</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:34</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b9ea6f30b5b38c45e32c084a7bac3c7"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a></div><div class="ttdeci">int ksinv_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:155</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac65b3d636670ebaaede971d7c1ec58ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac65b3d636670ebaaede971d7c1ec58ed">&#9670;&nbsp;</a></span>ksgre_scan_seqstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_scan_seqstate </td>
          <td>(</td>
          <td class="paramtype">SCAN_INFO&#160;</td>
          <td class="paramname"><em>slice_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the current state of all ksgre sequence objects being part of <a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksgre sequence">KSGRE_SEQUENCE</a></h4>
</p>
<p>This function sets the current state of all ksgre sequence objects being part of <a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksgre sequence">KSGRE_SEQUENCE</a>, incl. gradient amplitude changes, RF freq/phases and receive freq/phase based on current slice position and phase encoding indices.</p>
<p>The idea of having a 'seqstate' function is to be able to come back to a certain sequence state at any time and possibly play it out once more. This could for example be useful when certain lines or slices need to be rescanned due to image artifacts detected during scanning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_info</td><td>Position of the slice to be played out (one element in the <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index in range <code>[0, ksgre.phaseenc_plan.num_shots - 1]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                                           {</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordtype">float</span> rfphase = 0.0;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keywordtype">int</span> echo = 0; <span class="comment">/* only one phase encode for all echoes for now */</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a>(slice_info);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="comment">/* RF frequency &amp; phase */</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  rfphase = <a class="code" href="ksgre__implementation_8e.html#a809fe6f6679c08221f763819f4d7a360">ksgre_scan_phase</a>(<a class="code" href="ksgre__implementation_8e.html#ae3ddf7eef2bb3725f4f060830cfda776">spgr_phase_counter</a>++);</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP <span class="comment">/* = 4 */</span> &amp;&amp; <a class="code" href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a> == TRUE) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="comment">/* half FA for the 1st RF played for current acquistion (= slice, since sequential mode) */</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aefb58d645ca29e4cfa68403df396e53f">ks_scan_rf_ampscale</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL, 0.5);</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a> = FALSE;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  }</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, 0 <span class="comment">/* instance */</span>, slice_info, rfphase);</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="comment">/* ky, kz coordinate to play (for 2D: coord.kz = KS_NOTSET) */</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, echo, shot);</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">/* FOV offsets (by changing freq/phase of ksgre.read) */</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordtype">float</span> zfovratio = (opslquant * <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>) / <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a>;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordtype">float</span> zchop_phase = 0.0;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">if</span> (oparc &amp;&amp; (coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a> % 2)) {</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="comment">/* GEs ARC recon ignores RHF_ZCHOP bit in &#39;rhformat&#39;, but expects 3D data to be z-chopped for proper slice sorting.</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">      In GERequired.e:GEReq_predownload_setrecon_voldata(), RHF_ZCHOP is unset by default. In combination with</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">      that we do not do zchop for non-ARC scans (incl ASSET), this works well. But for ARC scans, we must zchop. That is,</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">      we add 180 phase to every odd kz encoded line, which is the same as a final z fftshift in the image domain */</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      zchop_phase = 180.0;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    }</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a368695617a7edf4fdba05325573efb12">ks_scan_offsetfov3D</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, INSTRALL, slice_info, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>, opphasefov, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>, zfovratio, rfphase + zchop_phase);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a11a9b9d761ba64a74b88c222b2a949e3">ks_scan_offsetfov</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, INSTRALL, slice_info, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>, opphasefov, rfphase);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="comment">/* phase enc amps */</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>,   0, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>); <span class="comment">/* dephaser. instance #0 of phaseenc */</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, 1, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>); <span class="comment">/* rephaser. instance #1 of phaseenc */</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="comment">/* z phase enc amp */</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <span class="comment">/* dephaser (incl. slice rephaser in .areaoffset). instance #0 */</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, 0, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a> == 2) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="comment">/* rephaser (incl. slice prephaser in .areaoffset for next excitation). instance #1 */</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, 1, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>);</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    }</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  }</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;} <span class="comment">/* ksgre_scan_seqstate() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6d1910f42394dc7fb363d85bd6e9c5"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a></div><div class="ttdeci">void ks_scan_rf_on(KS_RF *rf, int instanceno)</div><div class="ttdoc">Resets the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:421</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a9b9d761ba64a74b88c222b2a949e3"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a9b9d761ba64a74b88c222b2a949e3">ks_scan_offsetfov</a></div><div class="ttdeci">void ks_scan_offsetfov(KS_READTRAP *readtrap, int instanceno, SCAN_INFO sliceinfo, int view, float phasefovratio, float rcvphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a KS_READTRAP to create a FOV shift...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:905</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a06ab78e08959e925d92935c582469de8"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a06ab78e08959e925d92935c582469de8">KS_TRAP::base</a></div><div class="ttdeci">KS_BASE base</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:431</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ae3ddf7eef2bb3725f4f060830cfda776"><div class="ttname"><a href="ksgre__implementation_8e.html#ae3ddf7eef2bb3725f4f060830cfda776">spgr_phase_counter</a></div><div class="ttdeci">int spgr_phase_counter</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1933</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSGRE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae8766ce800f95dd75ca2eece6638326c"><div class="ttname"><a href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, float rfphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:532</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2fdfe2e655a76c4cd4fb1dac16d1834b"><div class="ttname"><a href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a></div><div class="ttdeci">void ks_scan_rotate(SCAN_INFO slice_info)</div><div class="ttdoc">Performs a rotation of the logical system on hardware (WARP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:988</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a3ade314070d88026dab1b034b4332259"><div class="ttname"><a href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a></div><div class="ttdeci">int fiesta_firstplayout</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1932</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aff91e4da3b6ccabd607ec0da04f774ce"><div class="ttname"><a href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a></div><div class="ttdeci">void ks_scan_phaser_toline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from the k-space center to a desired k-s...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:319</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a368695617a7edf4fdba05325573efb12"><div class="ttname"><a href="_k_s_foundation_8h.html#a368695617a7edf4fdba05325573efb12">ks_scan_offsetfov3D</a></div><div class="ttdeci">void ks_scan_offsetfov3D(KS_READTRAP *readtrap, int instanceno, SCAN_INFO sliceinfo, int kyview, float phasefovratio, int kzview, float zphasefovratio, float rcvphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a KS_READTRAP to create a FOV shift...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:912</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aefb58d645ca29e4cfa68403df396e53f"><div class="ttname"><a href="_k_s_foundation_8h.html#aefb58d645ca29e4cfa68403df396e53f">ks_scan_rf_ampscale</a></div><div class="ttdeci">void ks_scan_rf_ampscale(KS_RF *rf, int instanceno, float ampscale)</div><div class="ttdoc">Changes the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:358</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a809fe6f6679c08221f763819f4d7a360"><div class="ttname"><a href="ksgre__implementation_8e.html#a809fe6f6679c08221f763819f4d7a360">ksgre_scan_phase</a></div><div class="ttdeci">float ksgre_scan_phase(int counter)</div><div class="ttdoc">Returns a new RF phase based on an input counter and one of three GRE modes</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1474</div></div>
<div class="ttc" id="struct_k_s___b_a_s_e_html_a48a67aa9525b1eaff08aa809b53110dc"><div class="ttname"><a href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">KS_BASE::ngenerated</a></div><div class="ttdeci">int ngenerated</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:262</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a81a97893a74af952d90181aa858e709b"><div class="ttname"><a href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a></div><div class="ttdeci">void ks_scan_phaser_fromline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from a k-space line to the k-space cente...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:338</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a755ac06a770c8a1d3eff2300af7201d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a755ac06a770c8a1d3eff2300af7201d7">&#9670;&nbsp;</a></span>ksgre_init_imagingoptions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksgre_init_imagingoptions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial handling of imaging options buttons and top-level CVs at the PSD type-in page</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                     {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">int</span> numopts = <span class="keyword">sizeof</span>(<a class="code" href="ksgre__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  psd_init_iopt_activity();</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  activate_iopt_list(numopts, <a class="code" href="ksgre__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  enable_iopt_list(numopts, <a class="code" href="ksgre__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="comment">/* Imaging option control functions (using PSD_IOPT_ZIP_512 as example):</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    - Make an option unchecked and not selectable: disable_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">    - Make an option checked and not selectable:   set_required_disabled_option(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">    - Remove the imaging option:                   deactivate_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  cvmax(opimode, PSD_3DM);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">/* Sequential forced on SSFP to keep TR minimal, i.e. one slice at a time */</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    set_required_disabled_option(PSD_IOPT_SEQUENTIAL);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    set_disallowed_option(PSD_IOPT_CARD_GATE);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">/* This is likely good for PSD_3DM scans: </span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">  if (KS_3D_MULTISLAB_SELECTED) {</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">    set_required_disabled_option(PSD_IOPT_SEQUENTIAL);</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">#ifdef SIM</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  oppseq = PSD_GE;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  setexist(oppseq, PSD_ON);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  opirmode = PSD_OFF; <span class="comment">/* default interleaved slices */</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  setexist(opirmode, PSD_ON);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;} <span class="comment">/* ksgre_init_imagingoptions() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_a8f39fad60409167fe45164b72a131e0b"><div class="ttname"><a href="ksgre__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a></div><div class="ttdeci">int sequence_iopts[]</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:168</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a8d2319cad4eef380e744a109d59796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a8d2319cad4eef380e744a109d59796">&#9670;&nbsp;</a></span>ksgre_init_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_init_UI </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial setup of user interface (UI) with default values for menus and fields</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                           {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">/* Gradient Echo Type of sequence */</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  acq_type = TYPGRAD; <span class="comment">/* loadrheader.e rheaderinit: sets eeff = 1 */</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">/* rampsampling on by default for SSFP scans to reduce TE &amp; TR */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a5e48f5c40adcd600566db174b75d4e7d">ksgre_rampsampling</a> = (oppseq == PSD_SSFP) ? TRUE : FALSE;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">/* rBW */</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP <span class="comment">/* = 4 */</span>) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    cvdef(oprbw, 125.0);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    pircbval2 = 31.25;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    pircbval3 = 41.67;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    pircbval4 = 50.0;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    pircbval5 = 62.50;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    pircbval6 = 125.0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    cvdef(oprbw, 31.25);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    pircbval2 = 13.89;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    pircbval3 = 31.25;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    pircbval4 = 41.67;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    pircbval5 = 50.0;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    pircbval6 = 62.50;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  oprbw = _oprbw.defval;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  cvmax(oprbw, 250);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  pidefrbw = _oprbw.defval;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  pircbnub  = 31; <span class="comment">/* number of variable bandwidth */</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  pircb2nub = 0; <span class="comment">/* no second bandwidth option */</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">/* NEX */</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  cvdef(opnex, 1);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  opnex = _opnex.defval;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  cvmin(opnex, 0.55);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  pinexnub = 63;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  pinexval2 = 0.55;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  pinexval3 = 0.65;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  pinexval4 = 0.75;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  pinexval5 = 1;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  pinexval6 = 2;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">/* FOV */</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> = 240;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  pifovnub = 5;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  pifovval2 = 200;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  pifovval3 = 220;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  pifovval4 = 240;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  pifovval5 = 260;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  pifovval6 = 280;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">/* phase FOV fraction */</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  opphasefov = 1;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  piphasfovnub2 = 63;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  piphasfovval2 = 1.0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  piphasfovval3 = 0.9;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  piphasfovval4 = 0.8;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  piphasfovval5 = 0.7;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  piphasfovval6 = 0.6;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">/* freq (x) resolution */</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 16);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 128);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a> = 128;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  pixresnub = 63;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  pixresval2 = 64;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  pixresval3 = 128;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  pixresval4 = 192;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  pixresval5 = 256;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  pixresval6 = 320;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">/* phase (y) resolution */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 16);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 128);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> = _opyres.defval;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  piyresnub = 63;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  piyresval2 = 64;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  piyresval3 = 128;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  piyresval4 = 192;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  piyresval5 = 256;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  piyresval6 = 320;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="comment">/* Num echoes */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  piechnub = 63;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  cvdef(opnecho, 1);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  cvmax(opnecho, 16);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  opnecho = _opnecho.defval;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  piechdefval = _opnecho.defval;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  piechval2 = 1;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  piechval3 = 2;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  piechval4 = 4;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  piechval5 = 8;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  piechval6 = 16;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">/* TE */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  avmaxte = 1s;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  avminte = 0;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  pitetype = PSD_LABEL_TE_NORM; <span class="comment">/* alt. PSD_LABEL_TE_EFF */</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  cvdef(opte, 20ms);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  opte = _opte.defval;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    pite1nub = 4;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    opautote = PSD_MINTEFULL;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    pite1nub = 63;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  pite1val2 = PSD_MINIMUMTE; <span class="comment">/* opautote: PSD_MINTE = 2 */</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  pite1val3 = PSD_MINFULLTE; <span class="comment">/* opautote: PSD_MINTEFULL = 1 */</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  pite1val4 = PSD_FWINPHASETE; <span class="comment">/* opautote: PSD_FWINPHS = 3 */</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  pite1val5 = PSD_FWOUTPHASETE; <span class="comment">/* opautote: PSD_FWOUTPHS = 4 */</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000)</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    pite1val6 = 18ms; <span class="comment">/* for T2*-w */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    pite1val6 = 35ms; <span class="comment">/* for T2*-w */</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">/* TE2 */</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  pite2nub = 0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">/* TR */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP || opfast == TRUE) {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    pitrnub = 0; <span class="comment">/* &#39;0&#39;: shown but greyed out (but only if opautotr = 1, otherwise TR menu is hidden) */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    cvoverride(opautotr, PSD_ON, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    pitrnub = 6; <span class="comment">/* &#39;2&#39;: only one menu choice (Minimum = AutoTR) */</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  cvdef(optr, 100ms);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  optr = _optr.defval;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  pitrval2 = PSD_MINIMUMTR;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  pitrval3 = 25ms;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  pitrval4 = 35ms;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  pitrval5 = 45ms;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  pitrval6 = 100ms;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">/* FA */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  cvdef(opflip, 10);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  opflip = _opflip.defval;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 24</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  pifamode = PSD_FLIP_ANGLE_MODE_EXCITE;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  pifanub = 6;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; (oppseq != PSD_SSFP)) {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    pifaval2 = 10;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    pifaval3 = 12;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    pifaval4 = 15;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    pifaval5 = 18;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    pifaval6 = 20;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    pifaval2 = 10;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    pifaval3 = 20;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    pifaval4 = 30;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      pifaval5 = 40;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      pifaval6 = 50;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      pifaval5 = 60;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      pifaval6 = 90;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  } </div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">/* slice thickness */</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  pistnub = 5;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 1);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    pistval2 = 0.8;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    pistval3 = 0.9;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    pistval4 = 1;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    pistval5 = 1.5;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    pistval6 = 2;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 4);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    pistval2 = 2;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    pistval3 = 3;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    pistval4 = 4;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    pistval5 = 5;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    pistval6 = 10;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> = _opslthick.defval;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="comment">/* slice spacing */</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  cvdef(opslspace, 0);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  opslspace = _opslspace.defval;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  piisil = PSD_ON;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/* change these to do overlaps */</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    piisnub = 0;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    piisnub = 4;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    piisval3 = 0.5;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    piisval4 = 1;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    piisval5 = 4;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    piisval6 = 20;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">/* default # of slices */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  cvdef(opslquant, 30);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">/* 3D slice settings */</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D (=2) or PSD_3DM (=6) */</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    pimultislab = 0; <span class="comment">/* 0: forces only single slab, 1: allow multi-slab */</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    pilocnub = 4;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    pilocval2 = 32;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    pilocval3 = 64;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    pilocval4 = 128;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">/* opslquant = #slices in slab. opvquant = #slabs */</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    cvdef(opslquant, 32);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  opslquant = _opslquant.defval;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">/* Multi phase (i.e. multi volumes) */</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordflow">if</span> (opmph) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    pimphscrn = 1;   <span class="comment">/* display Multi-Phase Parameter screen */</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    pifphasenub = 6;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    pifphaseval2 = 1;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    pifphaseval3 = 2;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    pifphaseval4 = 5;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    pifphaseval5 = 10;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    pifphaseval6 = 15;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    pisldelnub = 0;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    piacqnub = 0;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    setexist(opacqo, 1);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    pihrepnub = 0;  <span class="comment">/* no XRR gating */</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    cvoverride(opfphases, 1, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">/* For 3D non-SSFP non-Sinc scans, let the user choose between fast scans and high FA */</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  cvmod(opuser1, _ksgre_rfexc_choice.minval, _ksgre_rfexc_choice.maxval, _ksgre_rfexc_choice.defval, _ksgre_rfexc_choice.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  opuser1 = _ksgre_rfexc_choice.defval;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> = _ksgre_rfexc_choice.defval;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; oppseq != PSD_SSFP &amp;&amp; <a class="code" href="ksgre__implementation_8e.html#a3db7939a5492a55fada202f44c2fc62a">ksgre_sincrf</a> == FALSE) <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    piuset |= use1;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    piuset &amp;= ~use1;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">/* For 3D, choose between rectangular and elliptic k-space sampling (ky-kz plane) */</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  cvmod(opuser2, _ksgre_ellipsekspace.minval, _ksgre_ellipsekspace.maxval, _ksgre_ellipsekspace.defval, _ksgre_ellipsekspace.descr, 0, <span class="stringliteral">&quot; &quot;</span>);  </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  opuser2 = _ksgre_ellipsekspace.defval;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a> = _ksgre_ellipsekspace.defval;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    piuset |= use2;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    piuset &amp;= ~use2;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">/* opuser16: Recon number*/</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  cvmod(opuser16, 0, 9999, 0, <span class="stringliteral">&quot;Recon number&quot;</span>, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  opuser16 = _opuser16.defval;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">#ifdef REV</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">/* show GIT revision using REV variable from the Imakefile */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="keywordtype">char</span> userstr[100];</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  sprintf(userstr,<span class="stringliteral">&quot;                      Recon number [PSD&#39;s version: %s]&quot;</span>, REV);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  cvdesc(opuser16, userstr);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  piuset |= use16;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  </div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">     Reserved opusers:</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">     ksgre_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">/* Acceleration menu as decimal numbers (max accel = 4) */</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a>(<a class="code" href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae">KS_ACCELMENU_FRACT</a>, 4);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="comment">/* Acceleration menu as integers (max accel = 4)</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">       Covers the non-accelerated and ASSET cases */</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a>(<a class="code" href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a>, 4);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;} <span class="comment">/* ksgre_init_UI() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1747</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae">KS_ACCELMENU_FRACT</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1747</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a440ac0ab4615a7f49af627d1dbfa5f7d"><div class="ttname"><a href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a></div><div class="ttdeci">int ksgre_ellipsekspace</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:104</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a0e530ba92a02d44c4e9393777aa598c0"><div class="ttname"><a href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a></div><div class="ttdeci">int ksgre_rfexc_choice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:80</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a3db7939a5492a55fada202f44c2fc62a"><div class="ttname"><a href="ksgre__implementation_8e.html#a3db7939a5492a55fada202f44c2fc62a">ksgre_sincrf</a></div><div class="ttdeci">int ksgre_sincrf</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:77</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="_g_e_required_8e_html_a05e7d139f5f41deb6ed1c934ed6c6e64"><div class="ttname"><a href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a></div><div class="ttdeci">STATUS GEReq_init_accelUI(int integeraccel, int maxaccel)</div><div class="ttdoc">Sets up the menu for parallel imaging (ARC or ASSET) with max/min range</div><div class="ttdef"><b>Definition:</b> GERequired.e:427</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5e48f5c40adcd600566db174b75d4e7d"><div class="ttname"><a href="ksgre__implementation_8e.html#a5e48f5c40adcd600566db174b75d4e7d">ksgre_rampsampling</a></div><div class="ttdeci">int ksgre_rampsampling</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:86</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a804a62a773a1aa3e387726a241ef98ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a804a62a773a1aa3e387726a241ef98ff">&#9670;&nbsp;</a></span>ksgre_eval_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_UI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Gets the current UI and checks for valid inputs</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                       {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a4a8d2319cad4eef380e744a109d59796">ksgre_init_UI</a>() == FAILURE)</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> = (int) opuser1;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a> = (int) opuser2;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  rhrecon = (int) opuser16;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">/* Reserved opusers:</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">     ksgre_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;} <span class="comment">/* ksgre_eval_UI() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_a440ac0ab4615a7f49af627d1dbfa5f7d"><div class="ttname"><a href="ksgre__implementation_8e.html#a440ac0ab4615a7f49af627d1dbfa5f7d">ksgre_ellipsekspace</a></div><div class="ttdeci">int ksgre_ellipsekspace</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:104</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a0e530ba92a02d44c4e9393777aa598c0"><div class="ttname"><a href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a></div><div class="ttdeci">int ksgre_rfexc_choice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:80</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a4a8d2319cad4eef380e744a109d59796"><div class="ttname"><a href="ksgre__implementation_8e.html#a4a8d2319cad4eef380e744a109d59796">ksgre_init_UI</a></div><div class="ttdeci">STATUS ksgre_init_UI(void)</div><div class="ttdoc">Initial setup of user interface (UI) with default values for menus and fields</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:238</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab55525094cda2e6d49d8edf1d9f84e0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab55525094cda2e6d49d8edf1d9f84e0a">&#9670;&nbsp;</a></span>ksgre_eval_setupobjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_setupobjects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up all sequence objects for the main sequence module (<a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksgre sequence">KSGRE_SEQUENCE</a> ksgre)</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                 {</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  STATUS status;  </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">/* RF choices */</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a3db7939a5492a55fada202f44c2fc62a">ksgre_sincrf</a>) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ad09d10d506854e0913b9f1a30f6f26cc">ks_eval_rf_sinc</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="ksgre__implementation_8e.html#ae7c470400fe18ceae739dfde9657e555">ksgre_sincrf_bw</a>, <a class="code" href="ksgre__implementation_8e.html#aac1c91a5ff2caab2fc9285493b558c54">ksgre_sincrf_tbw</a>, opflip, <a class="code" href="_k_s_foundation_8h.html#a86ae493647e9688c942bc9e0bb396313a3bc8b5d8517c5b1a3b852ee492ae293a">KS_RF_SINCWIN_HAMMING</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> = <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241">KS_RF_ROLE_EXC</a>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#ae1e0cbaa74ee239b65aff745f2947b42">ssfp_tbw3_01_001_pm_250</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="comment">/* for now, use 4k BW sinc for 2D SSFP */</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        status = <a class="code" href="_k_s_foundation_8h.html#ad09d10d506854e0913b9f1a30f6f26cc">ks_eval_rf_sinc</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <span class="stringliteral">&quot;&quot;</span>, 4000, 2, opflip, <a class="code" href="_k_s_foundation_8h.html#a86ae493647e9688c942bc9e0bb396313a3bc8b5d8517c5b1a3b852ee492ae293a">KS_RF_SINCWIN_HAMMING</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> = <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241">KS_RF_ROLE_EXC</a>;  </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="comment">/* ksgre_rfexc_choice: Low values =&gt; shorter TE but lower max FA */</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> == 0)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;          <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#abfb020340df155bc6d93e72f144b3a64">exc_tbw8_01_001_150</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> == 1)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;          <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a88692da52e2d60db4efe7205ec92c69f">exc_3d8min</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a> == 2)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#aeaa2521e51b93ac16a8fb85ae4faa8db">exc_3d16min</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a9eb856d638132c33bf2b48167b109d97">exc_3dfgre</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      }</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    cvoverride(opvthick, exist(opslquant) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>), _opslquant.fixedflag, existcv(opslquant));</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a5491d813b5151e654dd12ffff2eb069f">ksgre_excthickness</a> = (exist(opslquant) - 2 * rhslblank) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a118fa4240070a42571aeff56ae10505f">ksgre_gscalerfexc</a> = 1.0;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a5491d813b5151e654dd12ffff2eb069f">ksgre_excthickness</a> = <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksgre__implementation_8e.html#a5491d813b5151e654dd12ffff2eb069f">ksgre_excthickness</a> / <a class="code" href="ksgre__implementation_8e.html#a118fa4240070a42571aeff56ae10505f">ksgre_gscalerfexc</a>;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="comment">/* selective RF excitation */</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;rfexc&quot;</span>) == FAILURE)</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">/* readout gradient and data acquisition */</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 2); <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">rampsampling</a> = <a class="code" href="ksgre__implementation_8e.html#a5e48f5c40adcd600566db174b75d4e7d">ksgre_rampsampling</a>;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">rampsampling</a>)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> = 64; <span class="comment">/* us on the ramp until acq should begin */</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <span class="keywordflow">if</span> (opautote == PSD_MINTE) { <span class="comment">/* PSD_MINTE = 2 */</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = IMin(2,<a class="code" href="ksgre__implementation_8e.html#aeac5b7c0a43f63688e01c15fd2bcc414">ksgre_kxnover</a>,<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>/2); <span class="comment">/* Partial Fourier */</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0; <span class="comment">/* Full Fourier */</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a> = oprbw;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a0e06bd2e4433a2b508c7610d7056050f">ks_eval_readtrap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, <span class="stringliteral">&quot;read&quot;</span>) == FAILURE)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <span class="comment">/* read dephaser */</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = -<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a0c3ba07aac8b5f911ce918a97c7ebbc6">area2center</a>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, <span class="stringliteral">&quot;readdephaser&quot;</span>) == FAILURE)</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">/* read rephaser (SSFP) */</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a0c3ba07aac8b5f911ce918a97c7ebbc6">area2center</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>, <span class="stringliteral">&quot;readrephaser_ssfp&quot;</span>) == FAILURE)</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">if</span> (opfcomp == TRUE) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">/* X: Add second x dephaser */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = -<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>, <span class="stringliteral">&quot;readdephaser1&quot;</span>) == FAILURE)</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">/* X: Now, make normal readdephaser twice as large */</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> *= 2;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, <span class="stringliteral">&quot;readdephaser2&quot;</span>) == FAILURE)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">/* Z: Add second z rephaser to complete 0th and 1st moment nulling of slice selection */</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = -<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>, <span class="stringliteral">&quot;rfexc.reph2&quot;</span>) == FAILURE)</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> FAILURE;   </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">/* Z: Now, make normal z rephaser twice as large */</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> *= 2;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>, <span class="stringliteral">&quot;rfexc.reph1&quot;</span>) == FAILURE)</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">/* phase encoding gradient */</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> * opphasefov;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR((<span class="keywordtype">int</span>) (<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> * opphasefov), 2); <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> == 0 &amp;&amp; opnex &lt; 1) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">int</span> kynover;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    kynover = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> * (opnex - 0.5);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    kynover = ((kynover + 1) / 2) * 2; <span class="comment">/* round to nearest even number */</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (kynover &lt; <a class="code" href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a>)</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      kynover = <a class="code" href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a>; <span class="comment">/* protect against too few overscans */</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = IMin(2, kynover, <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>/2);</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="comment">/* set .R and .nacslines fields of ksgre.phaseenc using ks_eval_phaser_setaccel() before calling ks_eval_phaser() */</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  <span class="keywordflow">if</span> (opasset) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    cvoverride(<a class="code" href="ksgre__implementation_8e.html#a5a1e04fadad0fae1895509c3b6edea2d">ksgre_minacslines</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a5a1e04fadad0fae1895509c3b6edea2d">ksgre_minacslines</a> = _ksgre_minacslines.defval;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, <a class="code" href="ksgre__implementation_8e.html#a5a1e04fadad0fae1895509c3b6edea2d">ksgre_minacslines</a>, opaccel_ph_stride) == FAILURE)</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, <span class="stringliteral">&quot;phaseenc&quot;</span>) == FAILURE)</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="comment">/* z phase encoding gradient */</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span> (opfcomp == TRUE) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">areaoffset</a> = 0;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* disable the slice rephaser gradient (.duration = 0), and put area necessary in zphaseenc.areaoffset */</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">areaoffset</a> = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>; <span class="comment">/* copy the area info */</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = opvthick;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = IMax(2, 8, opslquant);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">/* set .R and .nacslines fields of ksgre.zphaseenc using ks_eval_phaser_setaccel() before calling ks_eval_phaser() */</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordflow">if</span> (opasset) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      cvoverride(<a class="code" href="ksgre__implementation_8e.html#ae20a1b61e268996485622079d9c070cd">ksgre_minzacslines</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#ae20a1b61e268996485622079d9c070cd">ksgre_minzacslines</a> = _ksgre_minzacslines.defval;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, <a class="code" href="ksgre__implementation_8e.html#ae20a1b61e268996485622079d9c070cd">ksgre_minzacslines</a>, opaccel_sl_stride) == FAILURE)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, <span class="stringliteral">&quot;zphaseenc&quot;</span>) == FAILURE)</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;     <a class="code" href="_k_s_foundation_8h.html#a38e859809526b8d07b17999dc6bbdbe9">ks_init_phaser</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>);</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  }</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="comment">/* post-read spoiler */</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = (opnecho % 2 == 0) ? -1*<a class="code" href="ksgre__implementation_8e.html#a8ccbe9f480748788628fff0476129cb4">ksgre_spoilerarea</a> : <a class="code" href="ksgre__implementation_8e.html#a8ccbe9f480748788628fff0476129cb4">ksgre_spoilerarea</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <span class="stringliteral">&quot;spoiler&quot;</span>) == FAILURE)</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">/* init seqctrl */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  strcpy(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, <span class="stringliteral">&quot;ksgremain&quot;</span>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a99a0c72f6b8c2aea333fc9ed05fc3cfb">ksgre_eval_ssitime</a>();</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;} <span class="comment">/* ksgre_eval_setupobjects() */</span></div><div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a8cabd9318f1bc7fa94adc1027348658c"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">KSGRE_SEQUENCE::fcompread</a></div><div class="ttdeci">KS_TRAP fcompread</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a86ae493647e9688c942bc9e0bb396313a3bc8b5d8517c5b1a3b852ee492ae293a"><div class="ttname"><a href="_k_s_foundation_8h.html#a86ae493647e9688c942bc9e0bb396313a3bc8b5d8517c5b1a3b852ee492ae293a">KS_RF_SINCWIN_HAMMING</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1751</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_acc45c24d1996acd3d95ae2866c5ffb2b"><div class="ttname"><a href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a></div><div class="ttdeci">STATUS ks_eval_phaser(KS_PHASER *phaser, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up an acquisition window with a trapezoid with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:821</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5a1e04fadad0fae1895509c3b6edea2d"><div class="ttname"><a href="ksgre__implementation_8e.html#a5a1e04fadad0fae1895509c3b6edea2d">ksgre_minacslines</a></div><div class="ttdeci">int ksgre_minacslines</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:92</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_ae1e0cbaa74ee239b65aff745f2947b42"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#ae1e0cbaa74ee239b65aff745f2947b42">ssfp_tbw3_01_001_pm_250</a></div><div class="ttdeci">const KS_RF ssfp_tbw3_01_001_pm_250</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:79</div></div>
<div class="ttc" id="struct_k_s___r_f_html_aea7921a9aa2757a88e843476848ddd55"><div class="ttname"><a href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">KS_RF::role</a></div><div class="ttdeci">int role</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:788</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a6199326feb445e792394581122cb3b7a"><div class="ttname"><a href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a></div><div class="ttdeci">#define KSGRE_MINHNOVER</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:33</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSGRE_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:53</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ae20a1b61e268996485622079d9c070cd"><div class="ttname"><a href="ksgre__implementation_8e.html#ae20a1b61e268996485622079d9c070cd">ksgre_minzacslines</a></div><div class="ttdeci">int ksgre_minzacslines</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:93</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">KS_READTRAP::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1425</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_aeaa2521e51b93ac16a8fb85ae4faa8db"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#aeaa2521e51b93ac16a8fb85ae4faa8db">exc_3d16min</a></div><div class="ttdeci">const KS_RF exc_3d16min</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:61</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aad774d0423b06e30276673c8100a8ade"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">KS_PHASER::areaoffset</a></div><div class="ttdeci">float areaoffset</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1531</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241"><div class="ttname"><a href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241">KS_RF_ROLE_EXC</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1750</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a7ea43263446cf80f67f4b80d1e21503d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">KSGRE_SEQUENCE::readrephaser_ssfp</a></div><div class="ttdeci">KS_TRAP readrephaser_ssfp</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:47</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a9eb856d638132c33bf2b48167b109d97"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a9eb856d638132c33bf2b48167b109d97">exc_3dfgre</a></div><div class="ttdeci">const KS_RF exc_3dfgre</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a13aea1e02502f8276373928c87d0da3f"><div class="ttname"><a href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a></div><div class="ttdeci">STATUS ks_eval_phaser_setaccel(KS_PHASER *phaser, int min_acslines, float R) WARN_UNUSED_RESULT</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:743</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a8efdbce2fbb4bf21a6fd8983fdd6d5c7"><div class="ttname"><a href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a></div><div class="ttdeci">void ks_init_trap(KS_TRAP *trap)</div><div class="ttdoc">Resets a KS_TRAP sequence object to its default value (KS_INIT_TRAP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:45</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a0e530ba92a02d44c4e9393777aa598c0"><div class="ttname"><a href="ksgre__implementation_8e.html#a0e530ba92a02d44c4e9393777aa598c0">ksgre_rfexc_choice</a></div><div class="ttdeci">int ksgre_rfexc_choice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:80</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a3db7939a5492a55fada202f44c2fc62a"><div class="ttname"><a href="ksgre__implementation_8e.html#a3db7939a5492a55fada202f44c2fc62a">ksgre_sincrf</a></div><div class="ttdeci">int ksgre_sincrf</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:77</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a88692da52e2d60db4efe7205ec92c69f"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a88692da52e2d60db4efe7205ec92c69f">exc_3d8min</a></div><div class="ttdeci">const KS_RF exc_3d8min</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:64</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a99a0c72f6b8c2aea333fc9ed05fc3cfb"><div class="ttname"><a href="ksgre__implementation_8e.html#a99a0c72f6b8c2aea333fc9ed05fc3cfb">ksgre_eval_ssitime</a></div><div class="ttdeci">int ksgre_eval_ssitime()</div><div class="ttdoc">The SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1006</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSGRE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:46</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSGRE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:50</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad09d10d506854e0913b9f1a30f6f26cc"><div class="ttname"><a href="_k_s_foundation_8h.html#ad09d10d506854e0913b9f1a30f6f26cc">ks_eval_rf_sinc</a></div><div class="ttdeci">STATUS ks_eval_rf_sinc(KS_RF *rf, const char *const desc, double bw, double tbw, float flip, int wintype) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_RF object with a Sinc pulse shape</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:971</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5491d813b5151e654dd12ffff2eb069f"><div class="ttname"><a href="ksgre__implementation_8e.html#a5491d813b5151e654dd12ffff2eb069f">ksgre_excthickness</a></div><div class="ttdeci">float ksgre_excthickness</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:73</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">KS_PHASER::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1528</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_aac1c91a5ff2caab2fc9285493b558c54"><div class="ttname"><a href="ksgre__implementation_8e.html#aac1c91a5ff2caab2fc9285493b558c54">ksgre_sincrf_tbw</a></div><div class="ttdeci">float ksgre_sincrf_tbw</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:79</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a8ccbe9f480748788628fff0476129cb4"><div class="ttname"><a href="ksgre__implementation_8e.html#a8ccbe9f480748788628fff0476129cb4">ksgre_spoilerarea</a></div><div class="ttdeci">float ksgre_spoilerarea</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:76</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_abfb020340df155bc6d93e72f144b3a64"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#abfb020340df155bc6d93e72f144b3a64">exc_tbw8_01_001_150</a></div><div class="ttdeci">const KS_RF exc_tbw8_01_001_150</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:67</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0e06bd2e4433a2b508c7610d7056050f"><div class="ttname"><a href="_k_s_foundation_8h.html#a0e06bd2e4433a2b508c7610d7056050f">ks_eval_readtrap</a></div><div class="ttdeci">STATUS ks_eval_readtrap(KS_READTRAP *readtrap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up an acquisition window with a trapezoid with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:599</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5e48f5c40adcd600566db174b75d4e7d"><div class="ttname"><a href="ksgre__implementation_8e.html#a5e48f5c40adcd600566db174b75d4e7d">ksgre_rampsampling</a></div><div class="ttdeci">int ksgre_rampsampling</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:86</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">KS_READTRAP::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1428</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a6a2cc013660b66a4c7793c6e55bfcaa8"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">KS_READTRAP::rampsampling</a></div><div class="ttdeci">int rampsampling</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1427</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a118fa4240070a42571aeff56ae10505f"><div class="ttname"><a href="ksgre__implementation_8e.html#a118fa4240070a42571aeff56ae10505f">ksgre_gscalerfexc</a></div><div class="ttdeci">float ksgre_gscalerfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:74</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a0c3ba07aac8b5f911ce918a97c7ebbc6"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a0c3ba07aac8b5f911ce918a97c7ebbc6">KS_READTRAP::area2center</a></div><div class="ttdeci">float area2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1433</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_aeac5b7c0a43f63688e01c15fd2bcc414"><div class="ttname"><a href="ksgre__implementation_8e.html#aeac5b7c0a43f63688e01c15fd2bcc414">ksgre_kxnover</a></div><div class="ttdeci">int ksgre_kxnover</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:85</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">KS_PHASER::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1526</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a38e859809526b8d07b17999dc6bbdbe9"><div class="ttname"><a href="_k_s_foundation_8h.html#a38e859809526b8d07b17999dc6bbdbe9">ks_init_phaser</a></div><div class="ttdeci">void ks_init_phaser(KS_PHASER *phaser)</div><div class="ttdoc">Resets a KS_PHASER sequence object to its default value (KS_INIT_PHASER)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:73</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ae7c470400fe18ceae739dfde9657e555"><div class="ttname"><a href="ksgre__implementation_8e.html#ae7c470400fe18ceae739dfde9657e555">ksgre_sincrf_bw</a></div><div class="ttdeci">float ksgre_sincrf_bw</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:78</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3f734087ad613609e1cf6167ed04612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f734087ad613609e1cf6167ed04612">&#9670;&nbsp;</a></span>ksgre_eval_TErange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_TErange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the min/max TE based on the durations of the sequence objects in <a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksgre sequence">KSGRE_SEQUENCE</a> (ksgre)</h4>
</p>
<p>N.B.: The minTE (avminte) and maxTE (avmaxte) ensures TE (opte) to be in the valid range for this pulse sequence to be set up in <a class="el" href="ksgre__implementation_8e.html#a1aa7448afdfc93bc9e4aa543255bd5aa" title="The ksgre (main) pulse sequence">ksgre_pg()</a>. If the pulse sequence design changes in <a class="el" href="ksgre__implementation_8e.html#a1aa7448afdfc93bc9e4aa543255bd5aa" title="The ksgre (main) pulse sequence">ksgre_pg()</a>, by adding/modifying/removing sequence objects in a way that affects the intended TE, this function needs to be updated too.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                            {</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordtype">float</span> fieldscale = (float) B0_15000 / (<span class="keywordtype">float</span>) <a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a>;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordtype">int</span> fatwater_halflap = (fieldscale * 4.47ms) / 2; <span class="comment">/* [us] */</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordtype">int</span> fatwater_numhalflaps;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="comment">/* Minimum TE. Note that zphaseenc.grad.duration = 0 for 2D and ksgre.selrfexc.postgrad.duration = 0 for 3D */</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  avminte = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a>) {</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    avminte += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + IMax(2, <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    avminte += IMax(3, \</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">fcompread</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>, \</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, \</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  avminte += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>; <span class="comment">/* from start of acq win to k-space center */</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <span class="keywordflow">if</span> (opautote == PSD_FWINPHS) {</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">/* fat-water in-phase */</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    avminte = CEIL_DIV(avminte, 2 * fatwater_halflap) * (2 * fatwater_halflap);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opautote == PSD_FWOUTPHS) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">/* fat-water out-of-phase */</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    fatwater_numhalflaps = CEIL_DIV(avminte, fatwater_halflap);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> ((fatwater_numhalflaps % 2) == 0)</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      fatwater_numhalflaps++; <span class="comment">/* make sure it is odd */</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    avminte = fatwater_halflap * fatwater_numhalflaps;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  avminte += GRAD_UPDATE_TIME * 2; <span class="comment">/* 8us extra margin */</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  avminte = RUP_FACTOR(avminte, 8); <span class="comment">/* round up to make time divisible by 8us */</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">/* bSSFP (FIESTA): TE = TR/2 */</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP) {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordtype">int</span> echocenter2momentstart;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    echocenter2momentstart = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>; <span class="comment">/* end of acqwin */</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    echocenter2momentstart += IMax(3, \</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, \</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, \</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> ? <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> : <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>); <span class="comment">/* end of spoiler/rephaser */</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    echocenter2momentstart += <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>; <span class="comment">/* add SSI time. This is end of TR */</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    echocenter2momentstart += <a class="code" href="ksgre__implementation_8e.html#ad72955e8f3240fb7683c27f130caa2cd">ksgre_pos_start</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>; <span class="comment">/* beginning of sequence to momentstart */</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    echocenter2momentstart = RUP_GRD(echocenter2momentstart);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> (avminte &lt;= echocenter2momentstart) {</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      avminte += echocenter2momentstart - avminte;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a> = 0;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a> = avminte - echocenter2momentstart;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">/* MaxTE. avmaxte = avminte if opautote != FALSE */</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  avmaxte = avminte;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (opautote == FALSE) {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (existcv(optr)) {</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (opautotr) {</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">/* TR = minTR, i.e. the current TE is also the maximum TE */</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">if</span> (existcv(opte))</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          avmaxte = opte;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="comment">/* maximum TE dependent on the chosen TR */</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        avmaxte = optr - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>; <span class="comment">/* maximum sequence duration for this TR (implies one slice per TR) */</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        avmaxte -= <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* subtract ksgre.spoiler time */</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        avmaxte -= (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>); <span class="comment">/* center of k-space to end of read decay ramp + extra gap */</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">if</span> (opnecho &gt; 1) {</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          avmaxte -= (opnecho - 1) * (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksgre__implementation_8e.html#a362fcf39eb2c6b14558795b8dfc76a78">ksgre_extragap</a>); <span class="comment">/* for multi-echo */</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      avmaxte = 1s;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  }</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  <span class="keywordflow">if</span> (opautote) {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    setpopup(opte, PSD_OFF);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    cvoverride(opte, avminte, PSD_FIX_ON, PSD_EXIST_ON); <span class="comment">/* AutoTE: force TE to minimum */</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    setpopup(opte, PSD_ON);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">if</span> (opte &lt; avminte)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      opte = avminte;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;} <span class="comment">/* ksgre_eval_TErange() */</span></div><div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a8cabd9318f1bc7fa94adc1027348658c"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a8cabd9318f1bc7fa94adc1027348658c">KSGRE_SEQUENCE::fcompread</a></div><div class="ttdeci">KS_TRAP fcompread</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSGRE_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a7ea43263446cf80f67f4b80d1e21503d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">KSGRE_SEQUENCE::readrephaser_ssfp</a></div><div class="ttdeci">KS_TRAP readrephaser_ssfp</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:47</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ab2a951aaffe71e92bec8e265a3cffdb5"><div class="ttname"><a href="ksgre__implementation_8e.html#ab2a951aaffe71e92bec8e265a3cffdb5">ksgre_ssfp_endtime</a></div><div class="ttdeci">int ksgre_ssfp_endtime</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:123</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a362fcf39eb2c6b14558795b8dfc76a78"><div class="ttname"><a href="ksgre__implementation_8e.html#a362fcf39eb2c6b14558795b8dfc76a78">ksgre_extragap</a></div><div class="ttdeci">int ksgre_extragap</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:87</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSGRE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:46</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSGRE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ad72955e8f3240fb7683c27f130caa2cd"><div class="ttname"><a href="ksgre__implementation_8e.html#ad72955e8f3240fb7683c27f130caa2cd">ksgre_pos_start</a></div><div class="ttdeci">int ksgre_pos_start</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:98</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a289433527bae0ca681523b5b2e1e80f7"><div class="ttname"><a href="ksgre__implementation_8e.html#a289433527bae0ca681523b5b2e1e80f7">ksgre_slicecheck</a></div><div class="ttdeci">int ksgre_slicecheck</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:75</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_READTRAP::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1434</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad06b978814f1b9871d98d631e3aab059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad06b978814f1b9871d98d631e3aab059">&#9670;&nbsp;</a></span>ksgre_eval_inversion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_inversion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to KSInversion functions to add single and dual IR support to this sequence</h4>
</p>
<p>N.B.: For now, <a class="el" href="ksgre_8e.html" title="This file contains the overall structure for the ksgre psd. ">ksgre.e</a> has the same inversion logic as <a class="el" href="ksfse_8e.html" title="This file contains the overall structure for the ksfse psd. ">ksfse.e</a> and this function is similar to <a class="el" href="ksfse__implementation_8e.html#add948dfc3d7160d4b41892e809520a34" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksfse_eval_inversion()</a>. This is not used in clinical practice for 3D GRE and should be viewed as a placeholder. Once 3D mode is supported with <a class="el" href="ksgre_8e.html" title="This file contains the overall structure for the ksgre psd. ">ksgre.e</a>, this section should change to perform an MP-RAGE type or BRAVO type of preparation instead.</p>
<p>It is important that <a class="el" href="ksgre__implementation_8e.html#ad06b978814f1b9871d98d631e3aab059" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksgre_eval_inversion()</a> is called after other sequence modules have been set up and added to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct in <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>. Otherwise the TI and TR timing will be wrong.</p>
<p>Whether IR is on or off is determined by ksinv1_mode, which is set up in <a class="el" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818" title="C-macro assigning four UserCV slots and then calling ksinv_eval()">KSINV_EVAL()</a>-&gt;<a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a>. If it is off, this function will return quietly.</p>
<p>This function calls <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> (<a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a>), which takes over the responsibility of TR timing that otherwise is determined in <a class="el" href="ksgre__implementation_8e.html#a691a311addf634b0fc1ac953071e9c25" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksgre_eval_tr()</a>. <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> sets seqcollection.evaltrdone = TRUE, which indicates that TR timing has been done. <a class="el" href="ksgre__implementation_8e.html#a691a311addf634b0fc1ac953071e9c25" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksgre_eval_tr()</a> checks whether seqcollection.evaltrdone = TRUE to avoid that non-inversion TR timing overrides the TR timing set up in <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>.</p>
<p>At the end of this function, TR validation and heat/SAR checks are done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                                              {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  STATUS status;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordtype">int</span> slperpass, npasses;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="keywordtype">int</span> approved_TR = FALSE;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="comment">/* Set up up to four opusers for inversion control */</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, 26, 27, 28, 29); <span class="comment">/* args 2-6: integer X corresponds to opuserX CV */</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="comment">/* If no IR1 flag on, return */</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: This function is only for 2D scans&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  }</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    npasses = 2;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    npasses = 1;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">while</span> (approved_TR == FALSE) {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">/* Inversion (specific to 2D FSE/EPI type of PSDs). Must be done after all other sequence modules have been set up */</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    slperpass = CEIL_DIV((<span class="keywordtype">int</span>) exist(opslquant), npasses);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a>, 0, NULL, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; opflair == OPFLAIR_INTERLEAVED &amp;&amp; optr &gt; <a class="code" href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a>) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="comment">/* T1-FLAIR */</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">if</span> (npasses &gt; exist(opslquant)) {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: T1-FLAIR: TR not met for single slice per TR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      }</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      npasses++; <span class="comment">/* increase #passes and call ksinv_eval_multislice() again with a new ks_slice_plan */</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="comment">/* non-T1-FLAIR, or T1-FLAIR with approved TR value */</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      approved_TR = TRUE;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  } <span class="comment">/* while (approved_TR == FALSE)  */</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">/* Check TR timing and SAR limits */</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a>, 0, NULL);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;} <span class="comment">/* ksgre_eval_inversion() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_aa08a7ecfbf13a621a577fa984bda2b5a"><div class="ttname"><a href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS ksinv_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Runs the inversion slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1846</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab3fa4125b24bcc3e5d7f0ffacc32d86b"><div class="ttname"><a href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a></div><div class="ttdeci">int ksinv_maxtr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:159</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a2a4ae2b692531f3c649a5035992425c1"><div class="ttname"><a href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a></div><div class="ttdeci">STATUS ksinv_eval_multislice(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args, KS_SEQ_CONTROL *mainseqctrl)</div><div class="ttdoc">Calculates the duration of inversion module(s) for various inversion modes</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1509</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a5fb99d39d409aa58fcc42a57261b5d4d"><div class="ttname"><a href="ksgre__implementation_8e.html#a5fb99d39d409aa58fcc42a57261b5d4d">ksgre_scan_coreslice_nargs</a></div><div class="ttdeci">int ksgre_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksgre_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1695</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b2d943c3862a3980c7291b8e3ac1818"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a></div><div class="ttdeci">#define KSINV_EVAL(sptr, o1, o2, o3, o4)</div><div class="ttdoc">C-macro assigning four UserCV slots and then calling ksinv_eval()</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1132</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a691a311addf634b0fc1ac953071e9c25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a691a311addf634b0fc1ac953071e9c25">&#9670;&nbsp;</a></span>ksgre_eval_tr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_tr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks</h4>
</p>
<p>With the current sequence collection (see <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>), and a function pointer to an argument-standardized wrapper function (<a class="el" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad" title="Wrapper function to ksgre_scan_sliceloop() with standardized input arguments">ksgre_scan_sliceloop_nargs()</a>) to the slice loop function (<a class="el" href="ksgre__implementation_8e.html#a85bc530012d9eb0a65c7e3f2d7361773" title="Plays out slperpass slices corresponding to one TR">ksgre_scan_sliceloop()</a>, this function calls <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, where number of slices that can fit within one TR is determined by adding more slices as input argument to the slice loop function. For more details see <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>.</p>
<p>With the number of slices/TR now known, a standard 2D slice plan is set up using <a class="el" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb" title="Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...">ks_calc_sliceplan()</a> and the duration of the main sequence is increased based on timetoadd_perTR, which was returned by <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>. timetoadd_perTR &gt; 0 when optr &gt; avmintr and when heat or SAR restrictions requires <code>avmintr</code> to be larger than the net sum of sequence modules in the slice loop.</p>
<p>This function first checks whether seqcollection.evaltrdone == TRUE. This is e.g. the case for inversion where the TR timing instead is controlled using <a class="el" href="ksgre__implementation_8e.html#ad06b978814f1b9871d98d631e3aab059" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksgre_eval_inversion()</a> (calling <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>).</p>
<p>At the end of this function, TR validation and heat/SAR checks are done using <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                                                       {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="keywordtype">int</span> timetoadd_perTR;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  STATUS status;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="keywordtype">int</span> slperpass, min_npasses;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">evaltrdone</a> == TRUE) {</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">/* We cannot call GEReq_eval_TR() or GEReq_eval_checkTR_SAR(..., ksgre_scan_sliceloop_nargs, ...) if e.g. the inversion sequence module is used. This is because</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">     ksinv_scan_sliceloop() is used instead of ksgre_scan_sliceloop(). When ksinv1.params.mode != 0 (i.e. inversion sequence module on), the TR timing is done in</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">     ksinv_eval_multislice(), which is called from ksgre_eval_inversion().</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">     In the future, other sequence modules may want to take over the responsibility of TR calculations and SAR checks, in which case they need to end their corresponding function</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">     by setting evaltrdone = TRUE to avoid double processing here */</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    min_npasses = 2;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    min_npasses = 1;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;   <span class="comment">/* Calculate # slices per TR, # acquisitions and how much spare time we have within the current TR by running the slice loop, honoring heating and SAR limits */</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR</a>(&amp;slperpass, &amp;timetoadd_perTR, min_npasses, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad">ksgre_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="comment">/* Calculate the slice plan (ordering) and passes (acqs). ks_slice_plan is passed to GEReq_predownload_store_sliceplan() in predownload() */</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opvquant), 1 <span class="comment">/* seq 3DMS */</span>);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  } </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="comment">/* We spread the available timetoadd_perTR evenly, by increasing the .duration of each slice by timetoadd_perTR/slperpass */</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + CEIL_DIV(timetoadd_perTR, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>));</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="comment">/* Update SAR values in the UI (error will occur if the sum of sequence durations differs from optr) */</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad">ksgre_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="comment">/* Fill in the &#39;tmin&#39; and &#39;tmin_total&#39;. tmin_total is only like GEs use of the variable when TR = minTR */</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  tmin = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  tmin_total = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;} <span class="comment">/* ksgre_eval_tr() */</span></div><div class="ttc" id="_g_e_required_8e_html_a027161dabe834c55750bd1e7f2fa8473"><div class="ttname"><a href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS GEReq_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, int nslices, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdoc">Runs the slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> GERequired.e:974</div></div>
<div class="ttc" id="_g_e_required_8e_html_a3bf65ebca3543f771e2d17799bbb0d3c"><div class="ttname"><a href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR</a></div><div class="ttdeci">STATUS GEReq_eval_TR(int *slperpass, int *timetoadd_perTR, int requested_minacqs, KS_SEQ_COLLECTION *seqcollection, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdef"><b>Definition:</b> GERequired.e:714</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n_html_aaa31b32f56e7b425f15f4191ef1f92be"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">KS_SEQ_COLLECTION::evaltrdone</a></div><div class="ttdeci">int evaltrdone</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1152</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a4690d7ea9b0a30ecfcfa4ac0dd97cbad"><div class="ttname"><a href="ksgre__implementation_8e.html#a4690d7ea9b0a30ecfcfa4ac0dd97cbad">ksgre_scan_sliceloop_nargs</a></div><div class="ttdeci">int ksgre_scan_sliceloop_nargs(int slperpass, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksgre_scan_sliceloop() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1790</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aefbe4ed281f274629f92c18ab8be104a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefbe4ed281f274629f92c18ab8be104a">&#9670;&nbsp;</a></span>ksgre_eval_scantime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_eval_scantime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Set the number of dummy scans for the sequence and calls <a class="el" href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7" title="Plays out all passes of a single or multi-pass scan">ksgre_scan_scanloop()</a> to determine</h4>
the length of the scan </p>
<p>After setting the number of dummy scans based on the current TR, the <a class="el" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650" title="Plays out all volumes and passes of a single or multi-pass scan">ksfse_scan_scanloop()</a> is called to get the scan time. <code>pitscan</code> is the UI variable for the scan clock shown in the top right corner on the MR scanner.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                             {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="comment">/* number of dummy TRs to use to reach steady state */</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SSFP)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a> = 20; <span class="comment">/* since single-slice, it&#39;s quick anyway */</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <a class="code" href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a> = 4;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">/* call the scan loop function to get the total scan time. pitscan is the countdown timer shown in</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">     the top-right corner on the MR scanner */</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  pitscan = <a class="code" href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7">ksgre_scan_scanloop</a>();</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;}</div><div class="ttc" id="ksgre__implementation_8e_html_a2fe8bc64d63034c5edb532aa86603aa7"><div class="ttname"><a href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7">ksgre_scan_scanloop</a></div><div class="ttdeci">float ksgre_scan_scanloop()</div><div class="ttdoc">Plays out all passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1893</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ac17753845599aa9719d67e54eef22d16"><div class="ttname"><a href="ksgre__implementation_8e.html#ac17753845599aa9719d67e54eef22d16">ksgre_dda</a></div><div class="ttdeci">int ksgre_dda</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:100</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f62546211216fb6eb8c7939d2b2d442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f62546211216fb6eb8c7939d2b2d442">&#9670;&nbsp;</a></span>ksgre_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Returns error of various parameter combinations that are not allowed for ksgre</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                     {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="comment">/* Show resolution &amp; BW per pixel in the UI */</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  piinplaneres = 1;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  pirbwperpix = 1;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  ihinplanexres = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">fov</a>/<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  ihinplaneyres = <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a>/<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  ihrbwperpix = (1000.0 * <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a> * 2.0)/<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="comment">/* Force the user to select the Gradient Echo button. This error needs to be in cvcheck(), not in</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">     cvinit()/cveval() to avoid it to trigger also when Gradient Echo hass been selected */</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SE || opepi == PSD_ON) {</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Please first select the &#39;Gradient Echo&#39; button&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">/* SSFP symmetric RF watchdog */</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keywordflow">if</span> ((oppseq == PSD_SSFP) &amp;&amp; (abs(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a2a9b610a78cdae3ac8ef682bd34f7e0d">rfwave</a>.<a class="code" href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>/2 - <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>) &gt; GRAD_UPDATE_TIME)) {</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ksgre_check: Symmetric RF pulses are required for SSFP scans&quot;</span>);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">/* SSFP duration watchdog (to assure TE = TR/2) */</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keywordflow">if</span> (existcv(opte) &amp;&amp; existcv(optr) &amp;&amp; existcv(opflip) &amp;&amp; (oppseq == PSD_SSFP) &amp;&amp; (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>)) {</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ksgre_check: SAR/heating penalty - reduce FA&quot;</span>);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  }</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <span class="keywordflow">if</span> (oparc &amp;&amp; <a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> &gt; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>)) {</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="comment">/* Unclear why, but zR &gt; R leads to corrupted images for ARC and 3D.</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">    Probably a bug that can be fixed later. Limited experience (July 2018) */</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Need Slice acceleration &lt;= Phase accleration&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;} <span class="comment">/* ksgre_check() */</span></div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">KS_READTRAP::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1425</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a2a9b610a78cdae3ac8ef682bd34f7e0d"><div class="ttname"><a href="struct_k_s___r_f.html#a2a9b610a78cdae3ac8ef682bd34f7e0d">KS_RF::rfwave</a></div><div class="ttdeci">KS_WAVE rfwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:798</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">KS_PHASER::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1526</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="struct_k_s___w_a_v_e_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_WAVE::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:518</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a07eae599d1ce9f52372aa75bdfcd93e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07eae599d1ce9f52372aa75bdfcd93e4">&#9670;&nbsp;</a></span>ksgre_predownload_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_predownload_plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plotting of sequence modules and slice timing to PNG/SVG/PDF files</h4>
</p>
<p>The ks_plot_*** functions used in here will save plots to disk depending on the value of the CV <code>ks_plot_filefmt</code> (see KS_PLOT_FILEFORMATS). E.g. if ks_plot_filefmt = KS_PLOT_OFF, nothing will be written to disk. On the MR scanner, the output will be located in /usr/g/mrraw/plot/&lt;ks_psdname&gt;. In simulation, it will be placed in the current directory (./plot/).</p>
<p>Please see the documentation on how to install the required python version and links. Specifically, there must be a link /usr/local/bin/apython pointing to the Anaconda 2 python binary (v. 2.7).</p>
<p>In addition, the following text files are printed out</p><ul>
<li>&lt;ks_psdname&gt;_objects.txt</li>
<li>&lt;ks_psdname&gt;_seqcollection.txt </li>
</ul>
<div class="fragment"><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                                                {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordtype">char</span> tmpstr[1000];</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="preprocessor">#ifdef PSD_HW</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;/usr/g/mrraw/%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;./%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  FILE *fp  = fopen(tmpstr, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">/* Note: &#39;fp&#39; can be replaced with &#39;stdout&#39; or &#39;stderr&#39; to get these</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">     values printed out in the WTools window in simulation. However,</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">     heavy printing may result in that the WTools window closes,</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="comment">     why we here write to a file ksgre_objects.txt instead */</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a13a8f8b8bd8fccfc5bae9cef555053ad">ks_print_readtrap</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, fp);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, fp);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">readrephaser_ssfp</a>, fp);</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a4f5dffeec30279ac23c5f12ecb868575">ks_print_phaser</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, fp);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a4f5dffeec30279ac23c5f12ecb868575">ks_print_phaser</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, fp);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, fp);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, fp);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  fclose(fp);</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="comment">/* ks_plot_host():</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">  Plot each sequence module as a separate file (PNG/SVG/PDF depending on ks_plot_filefmt (GERequired.e))</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">  See KS_PLOT_FILEFORMATS in KSFoundation.h for options.</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">  Note that the phase encoding amplitudes corresponds to the first shot, as set by the call to ksgre_scan_seqstate below */</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], 0);</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a9cc16cc637cbb032a1df9434ab3ae900">ks_plot_host</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">/* Sequence timing plot */</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a>();</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7">ksgre_scan_scanloop</a>();</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a>();</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">/* ks_plot_tgt_reset():</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">  Creates sub directories and clear old files for later use of ksfse_scan_acqloop()-&gt;ks_plot_tgt_addframe().</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="comment">  ks_plot_tgt_addframe() will only write in MgdSim (WTools) to avoid timing issues on the MR scanner. Hence,</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">  unlike ks_plot_host() and the sequence timing plot, one has to open MgdSim and press RunEntry (and also</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="comment">  press PlotPulse several times after pressing RunEntry).</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="comment">  ks_plot_tgt_reset() will create a &#39;makegif_***.sh&#39; file that should be run in a terminal afterwards </span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="comment">  to create the animiated GIF from the dat files */</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;}  <span class="comment">/* ksgre_predownload_plot() */</span></div><div class="ttc" id="ksgre__implementation_8e_html_a2fe8bc64d63034c5edb532aa86603aa7"><div class="ttname"><a href="ksgre__implementation_8e.html#a2fe8bc64d63034c5edb532aa86603aa7">ksgre_scan_scanloop</a></div><div class="ttdeci">float ksgre_scan_scanloop()</div><div class="ttdoc">Plays out all passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1893</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSGRE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9cc16cc637cbb032a1df9434ab3ae900"><div class="ttname"><a href="_k_s_foundation_8h.html#a9cc16cc637cbb032a1df9434ab3ae900">ks_plot_host</a></div><div class="ttdeci">void ks_plot_host(KS_SEQ_COLLECTION *seqcollection, KS_PHASEENCODING_PLAN *plan)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:4079</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSGRE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a7ea43263446cf80f67f4b80d1e21503d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a7ea43263446cf80f67f4b80d1e21503d">KSGRE_SEQUENCE::readrephaser_ssfp</a></div><div class="ttdeci">KS_TRAP readrephaser_ssfp</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:47</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae136d8a2e504e06e8592185e85fecfde"><div class="ttname"><a href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a></div><div class="ttdeci">void ks_plot_slicetime_begin()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3068</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ac65b3d636670ebaaede971d7c1ec58ed"><div class="ttname"><a href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a></div><div class="ttdeci">STATUS ksgre_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksgre sequence objects being part of KSGRE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1514</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6eab83ca87166f306eb449a94a354ec6"><div class="ttname"><a href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a></div><div class="ttdeci">void ks_plot_slicetime_end()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3100</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSGRE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:46</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a4f5dffeec30279ac23c5f12ecb868575"><div class="ttname"><a href="_k_s_foundation_8h.html#a4f5dffeec30279ac23c5f12ecb868575">ks_print_phaser</a></div><div class="ttdeci">void ks_print_phaser(KS_PHASER phaser, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_PHASER sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3721</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSGRE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1abdbad21b51b6554580840ef8376e0d"><div class="ttname"><a href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a></div><div class="ttdeci">void ks_print_trap(KS_TRAP trap, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_TRAP sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3691</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSGRE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:48</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_abb36a5018815d55e357775e8515f220d"><div class="ttname"><a href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a></div><div class="ttdeci">void ks_plot_tgt_reset(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3108</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSGRE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:49</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a29a4c870ed4dcbee78d35bbbce9722b4"><div class="ttname"><a href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a></div><div class="ttdeci">void ks_print_selrf(KS_SELRF selrf, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_SELRF sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3839</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a13a8f8b8bd8fccfc5bae9cef555053ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a13a8f8b8bd8fccfc5bae9cef555053ad">ks_print_readtrap</a></div><div class="ttdeci">void ks_print_readtrap(KS_READTRAP readtrap, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_READTRAP sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3702</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7de37f7455b2fb392c87372b6045fc96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7de37f7455b2fb392c87372b6045fc96">&#9670;&nbsp;</a></span>ksgre_predownload_setrecon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_predownload_setrecon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Last-resort function to override certain recon variables not set up correctly already</h4>
</p>
<p>For most cases, the GEReq_predownload_*** functions in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> in <a class="el" href="ksgre_8e.html" title="This file contains the overall structure for the ksgre psd. ">ksgre.e</a> set up the necessary rh*** variables for the reconstruction to work properly. However, if this sequence is customized, certain rh*** variables may need to be changed. Doing this here instead of in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> directly separates these changes from the standard behavior.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                    {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;} <span class="comment">/* ksgre_predownload_setrecon() */</span></div></div><!-- fragment -->
</div>
</div>
<a id="a809fe6f6679c08221f763819f4d7a360"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a809fe6f6679c08221f763819f4d7a360">&#9670;&nbsp;</a></span>ksgre_scan_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_scan_phase </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>counter</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Returns a new RF phase based on an input counter and one of three GRE modes</h4>
</p>
<p>This function is largely what makes the difference between the the types of gradient echo sequences by different phase increment policies. For SPGR, RF spoiling is wanted and one tries to not repeat the same RF phase in a series of consecutive excitation. For bSSFP, the flip angle should be 'negative' every other time, which is accomplished by setting the RF phase to 0 or 180 [deg]. In all other cases (values of oppseq), the RF phase is set to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">counter</td><td>Counter from the calling function that should increment by 1 outside this function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">phase</td><td>RF phase in [deg] to be passed to <a class="el" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c" title="Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...">ks_scan_selrf_setfreqphase()</a> and <a class="el" href="_k_s_foundation_8h.html#a11a9b9d761ba64a74b88c222b2a949e3" title="Updates the frequency and phase of one or all instances of a KS_READTRAP to create a FOV shift...">ks_scan_offsetfov()</a> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                    {</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordtype">float</span> phase = 0;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_SPGR <span class="comment">/* = 5 */</span> ) {</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="comment">/* RF spoiling */</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    phase = <a class="code" href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a>(counter);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oppseq == PSD_SSFP <span class="comment">/* = 4 */</span>) {</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">/* balanced SSFP */</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> (counter % 2)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      phase = 180;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      phase = 0;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <span class="comment">/* Gradient spoiling */</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    phase = 0;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="keywordflow">return</span> phase;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;} <span class="comment">/* ksgre_scan_phase() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a48609b98dac5c8f7619bc0521f58d6e3"><div class="ttname"><a href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a></div><div class="ttdeci">float ks_scan_rf_phase_spoiling(int counter)</div><div class="ttdoc">Returns spoiling phase for a given RF counter</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3547</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90518ac85d7fb144e5e61477f55646fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90518ac85d7fb144e5e61477f55646fa">&#9670;&nbsp;</a></span>ksgre_scan_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_scan_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Common initialization for prescan entry points MPS2 and APS2 as well as the SCAN entry point</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                             {</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <a class="code" href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a>();</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="comment">/* Here goes code common for APS2, MPS2 and SCAN */</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);  <span class="comment">/* switch to main sequence */</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  scopeon(&amp;seqcore); <span class="comment">/* Activate scope for core */</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  syncon(&amp;seqcore);  <span class="comment">/* Activate sync for core */</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  <a class="code" href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a>(<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>/HW_GRAD_UPDATE_TIME);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="comment">/* can we make these independent on global rsptrigger and rsprot in orderslice? */</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  settriggerarray( (<span class="keywordtype">short</span>) <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, rsptrigger);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#ae3ddf7eef2bb3725f4f060830cfda776">spgr_phase_counter</a> = 0;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <a class="code" href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a> = TRUE;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;} <span class="comment">/* ksgre_scan_init() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a595f599c90a3cb1f300c3c83b5fa116d"><div class="ttname"><a href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a></div><div class="ttdeci">void ks_scan_switch_to_sequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1269</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ae3ddf7eef2bb3725f4f060830cfda776"><div class="ttname"><a href="ksgre__implementation_8e.html#ae3ddf7eef2bb3725f4f060830cfda776">spgr_phase_counter</a></div><div class="ttdeci">int spgr_phase_counter</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1933</div></div>
<div class="ttc" id="_k_s_foundation__tgt_8c_html_a70f8570a5d1cca01d8d49d9cd34bed79"><div class="ttname"><a href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a></div><div class="ttdeci">STATUS setssitime(long)</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_g_e_required_8e_html_ad56ed68dab054734d4e258fc33a45b71"><div class="ttname"><a href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a></div><div class="ttdeci">void GEReq_initRSP(void)</div><div class="ttdoc">RSP Init. To be inserted in the psdinit() function (or scan()) in the main sequence</div><div class="ttdef"><b>Definition:</b> GERequired.e:2671</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a3ade314070d88026dab1b034b4332259"><div class="ttname"><a href="ksgre__implementation_8e.html#a3ade314070d88026dab1b034b4332259">fiesta_firstplayout</a></div><div class="ttdeci">int fiesta_firstplayout</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1932</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c0934632d530a1bbc46285c66aaae80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c0934632d530a1bbc46285c66aaae80">&#9670;&nbsp;</a></span>ksgre_scan_prescanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksgre_scan_prescanloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nloops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Prescan loop called from both APS2 and MPS2 entry points</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                                                   {</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, echoindx, sltimeinpass, slloc;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  <span class="comment">/* turn off receivers for all echoes */</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">for</span> (echoindx = 0; echoindx &lt; <a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a>; echoindx++) {</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    loaddab(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[echoindx], 0, 0, DABSTORE, 0, DABOFF, PSD_LOAD_DAB_ALL);</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  }</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <span class="comment">/* play dummy scans to get into steady state */</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = -dda; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; nloops; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="comment">/* loop over slices */</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>; sltimeinpass++) {</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;      <span class="comment">/* slice location from slice plan (unless bSSFP, where we only play out center slice) */</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      <span class="keywordflow">if</span> (oppseq == PSD_SSFP)</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        slloc = CEIL_DIV(opslquant, 2);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, 0, sltimeinpass);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;      <span class="comment">/* modify sequence for next playout */</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <a class="code" href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc], <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>); <span class="comment">/* KS_NOTSET =&gt; no phase encodes */</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">/* data routing control */</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &gt;= 0) {</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="comment">/* turn on receiver for 1st echo */</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a> &gt; 0)</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;          loaddab(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[0], 0, 0, DABSTORE, 0, DABON, PSD_LOAD_DAB_ALL);</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      }</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a>.<a class="code" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    } <span class="comment">/* for slices */</span></div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  } <span class="comment">/* for nloops */</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;} <span class="comment">/* ksgre_scan_prescanloop() */</span></div><div class="ttc" id="struct_k_s___r_e_a_d_html_a0e0bae3aa47ae5b8aae488fa0eb920ce"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">KS_READ::echo</a></div><div class="ttdeci">WF_PULSE * echo</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:587</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a06ab78e08959e925d92935c582469de8"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">KS_READ::base</a></div><div class="ttdeci">KS_BASE base</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:581</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_ac65b3d636670ebaaede971d7c1ec58ed"><div class="ttname"><a href="ksgre__implementation_8e.html#ac65b3d636670ebaaede971d7c1ec58ed">ksgre_scan_seqstate</a></div><div class="ttdeci">STATUS ksgre_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksgre sequence objects being part of KSGRE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:1514</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSGRE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:45</div></div>
<div class="ttc" id="struct_k_s_g_r_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSGRE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:44</div></div>
<div class="ttc" id="ksgre__implementation_8e_html_a49d5d3a953983bac06c7aa01958d5e71"><div class="ttname"><a href="ksgre__implementation_8e.html#a49d5d3a953983bac06c7aa01958d5e71">ksgre</a></div><div class="ttdeci">KSGRE_SEQUENCE ksgre</div><div class="ttdef"><b>Definition:</b> ksgre_implementation.e:120</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
<div class="ttc" id="struct_k_s___b_a_s_e_html_a48a67aa9525b1eaff08aa809b53110dc"><div class="ttname"><a href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">KS_BASE::ngenerated</a></div><div class="ttdeci">int ngenerated</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:262</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5491d813b5151e654dd12ffff2eb069f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5491d813b5151e654dd12ffff2eb069f">&#9670;&nbsp;</a></span>ksgre_excthickness</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_excthickness = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a118fa4240070a42571aeff56ae10505f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a118fa4240070a42571aeff56ae10505f">&#9670;&nbsp;</a></span>ksgre_gscalerfexc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_gscalerfexc = 0.9</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a289433527bae0ca681523b5b2e1e80f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a289433527bae0ca681523b5b2e1e80f7">&#9670;&nbsp;</a></span>ksgre_slicecheck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_slicecheck = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8ccbe9f480748788628fff0476129cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ccbe9f480748788628fff0476129cb4">&#9670;&nbsp;</a></span>ksgre_spoilerarea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_spoilerarea = 1500.0 with {0.0, 10000.0, 1500.0, VIS, &quot;ksgre spoiler gradient area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3db7939a5492a55fada202f44c2fc62a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3db7939a5492a55fada202f44c2fc62a">&#9670;&nbsp;</a></span>ksgre_sincrf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_sincrf = 0 with {0, 1, 0, VIS, &quot;Use Sinc RF&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7c470400fe18ceae739dfde9657e555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7c470400fe18ceae739dfde9657e555">&#9670;&nbsp;</a></span>ksgre_sincrf_bw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_sincrf_bw = 2500 with {0, 100000, 2500, VIS, &quot;Sinc RF BW&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aac1c91a5ff2caab2fc9285493b558c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac1c91a5ff2caab2fc9285493b558c54">&#9670;&nbsp;</a></span>ksgre_sincrf_tbw</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_sincrf_tbw = 2 with {2, 100, 2, VIS, &quot;Sinc RF TBW&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e530ba92a02d44c4e9393777aa598c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e530ba92a02d44c4e9393777aa598c0">&#9670;&nbsp;</a></span>ksgre_rfexc_choice</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_rfexc_choice = 0 with {0, 2, 0, VIS, &quot;RF pulse 0(fast)-1-2(high FA)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aeac5b7c0a43f63688e01c15fd2bcc414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeac5b7c0a43f63688e01c15fd2bcc414">&#9670;&nbsp;</a></span>ksgre_kxnover</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_kxnover = 32 with {<a class="el" href="ksgre__implementation_8e.html#a6199326feb445e792394581122cb3b7a">KSGRE_MINHNOVER</a>, 512, 32, VIS, &quot;Num kx overscans for minTE&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5e48f5c40adcd600566db174b75d4e7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e48f5c40adcd600566db174b75d4e7d">&#9670;&nbsp;</a></span>ksgre_rampsampling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_rampsampling = FALSE with {FALSE, TRUE, FALSE, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a362fcf39eb2c6b14558795b8dfc76a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a362fcf39eb2c6b14558795b8dfc76a78">&#9670;&nbsp;</a></span>ksgre_extragap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_extragap = 0 with {0, 100ms, 0, VIS, &quot;extra gap between readouts [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5a1e04fadad0fae1895509c3b6edea2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1e04fadad0fae1895509c3b6edea2d">&#9670;&nbsp;</a></span>ksgre_minacslines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_minacslines = 8 with {0, 512, 8, VIS, &quot;Minimum ACS lines for ARC&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae20a1b61e268996485622079d9c070cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae20a1b61e268996485622079d9c070cd">&#9670;&nbsp;</a></span>ksgre_minzacslines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_minzacslines = 8 with {0, 512, 8, VIS, &quot;Minimum z ACS lines for ARC&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad72955e8f3240fb7683c27f130caa2cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72955e8f3240fb7683c27f130caa2cd">&#9670;&nbsp;</a></span>ksgre_pos_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_pos_start = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, VIS, &quot;us from start until the first waveform begins&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2d7bc942dbd61e40fb1aa03c0f3ffd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2d7bc942dbd61e40fb1aa03c0f3ffd1">&#9670;&nbsp;</a></span>ksgre_ssi_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_ssi_time = <a class="el" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a> with {32, , <a class="el" href="ksgre__implementation_8e.html#abb346530c2c4b9134aa50dc5e70656bc">KSGRE_DEFAULT_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac17753845599aa9719d67e54eef22d16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac17753845599aa9719d67e54eef22d16">&#9670;&nbsp;</a></span>ksgre_dda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_dda = 2 with {0, 200, 2, VIS, &quot;Number of dummy scans for steady state&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8821060870d44ad2634721de112f9d98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8821060870d44ad2634721de112f9d98">&#9670;&nbsp;</a></span>ksgre_debug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_debug = 1 with {0, 100, 1, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1ecef8818f4e03e085fa66a2dd28dce8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ecef8818f4e03e085fa66a2dd28dce8">&#9670;&nbsp;</a></span>ksgre_imsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_imsize = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a24a4d40640ee3141d6deba660607dd54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24a4d40640ee3141d6deba660607dd54">&#9670;&nbsp;</a></span>ksgre_abort_on_kserror</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_abort_on_kserror = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a440ac0ab4615a7f49af627d1dbfa5f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a440ac0ab4615a7f49af627d1dbfa5f7d">&#9670;&nbsp;</a></span>ksgre_ellipsekspace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_ellipsekspace = TRUE with {FALSE, TRUE, TRUE, VIS, &quot;ky-kz coverage 0:Rect 1:Elliptical&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a26324234fd96b08dd11f91d568a5ace2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26324234fd96b08dd11f91d568a5ace2">&#9670;&nbsp;</a></span>ksgre_fattune</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksgre_fattune = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a49d5d3a953983bac06c7aa01958d5e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d5d3a953983bac06c7aa01958d5e71">&#9670;&nbsp;</a></span>ksgre</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_g_r_e___s_e_q_u_e_n_c_e.html">KSGRE_SEQUENCE</a> ksgre = <a class="el" href="ksgre__implementation_8e.html#a3de9d8b8f8b5932ffd38c917c9c75552">KSGRE_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2a951aaffe71e92bec8e265a3cffdb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2a951aaffe71e92bec8e265a3cffdb5">&#9670;&nbsp;</a></span>ksgre_ssfp_endtime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksgre_ssfp_endtime = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f39fad60409167fe45164b72a131e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f39fad60409167fe45164b72a131e0b">&#9670;&nbsp;</a></span>sequence_iopts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sequence_iopts[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">  PSD_IOPT_ARC, </div><div class="line">  PSD_IOPT_ASSET, </div><div class="line">  PSD_IOPT_EDR, </div><div class="line">  PSD_IOPT_DYNPL, </div><div class="line">  PSD_IOPT_SEQUENTIAL, </div><div class="line">  PSD_IOPT_ZIP_512, </div><div class="line">  PSD_IOPT_IR_PREP, </div><div class="line">  PSD_IOPT_MILDNOTE, </div><div class="line">  PSD_IOPT_FLOW_COMP, </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="adffbee0f8231c5226387c8dd8f2dd482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffbee0f8231c5226387c8dd8f2dd482">&#9670;&nbsp;</a></span>volindx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int volindx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae477e374b559bf16a475321797d62cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae477e374b559bf16a475321797d62cb">&#9670;&nbsp;</a></span>passindx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int passindx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ade314070d88026dab1b034b4332259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ade314070d88026dab1b034b4332259">&#9670;&nbsp;</a></span>fiesta_firstplayout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fiesta_firstplayout = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae3ddf7eef2bb3725f4f060830cfda776"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3ddf7eef2bb3725f4f060830cfda776">&#9670;&nbsp;</a></span>spgr_phase_counter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spgr_phase_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_edd0b46848e1966a9ba471eaad9abcfd.html">tmpfiles</a></li><li class="navelem"><a class="el" href="ksgre__implementation_8e.html">ksgre_implementation.e</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
