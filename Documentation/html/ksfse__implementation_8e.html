<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KSFoundation: ksfse_implementation.e File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KarolinskaLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KSFoundation
   &#160;<span id="projectnumber">[Feb-2019]</span>
   </div>
   <div id="projectbrief">A platform for simpler EPIC programming on GE MR systems</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ksfse__implementation_8e.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ksfse_implementation.e File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a49b40808cadc9aa2638ff5cf65effbc7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a49b40808cadc9aa2638ff5cf65effbc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef9d9c4f9c117165300e06cf9899fda8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a>&#160;&#160;&#160;200</td></tr>
<tr class="separator:aef9d9c4f9c117165300e06cf9899fda8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a713f9b6c2f156e3b05a27a0936da3439"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a713f9b6c2f156e3b05a27a0936da3439">KSFSE_MAXTHICKFACT</a>&#160;&#160;&#160;3.0</td></tr>
<tr class="separator:a713f9b6c2f156e3b05a27a0936da3439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69ef18818d8b0e4117ded34e134e181d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a69ef18818d8b0e4117ded34e134e181d">KSFSE_INIT_SEQUENCE</a>&#160;&#160;&#160;{<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a01108d382b19492c2178b6bedbfcbc4b">KS_INIT_READTRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a>, <a class="el" href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>};</td></tr>
<tr class="separator:a69ef18818d8b0e4117ded34e134e181d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:abc6126af1d45847bc59afa0aa3216b04"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, 
<a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4">KSFSE_RECOVERY_T1WOPT</a>, 
<a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>
 }</td></tr>
<tr class="separator:abc6126af1d45847bc59afa0aa3216b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a663f0efa1ef983828a4a6280175f1088"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a663f0efa1ef983828a4a6280175f1088">abstract</a> (&quot;FSE [KSFoundation]&quot;)</td></tr>
<tr class="separator:a663f0efa1ef983828a4a6280175f1088"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78e45987586c99d31eafcf28b143a971"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a78e45987586c99d31eafcf28b143a971">psdname</a> (&quot;ksfse&quot;)</td></tr>
<tr class="separator:a78e45987586c99d31eafcf28b143a971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a257cccbbaeda541ca5250d16adc5c8c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5">ksfse_eval_TEmenu</a> (int esp, int maxte, int etl, double optechono)</td></tr>
<tr class="separator:a257cccbbaeda541ca5250d16adc5c8c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af287d52efc92c8e069e341c3eb00de99"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#af287d52efc92c8e069e341c3eb00de99">ksfse_calc_echo</a> (double *bestecho, double *optecho, <a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *pe, int TE, int etl, int esp)</td></tr>
<tr class="separator:af287d52efc92c8e069e341c3eb00de99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd">ksfse_pg</a> (int start_time)</td></tr>
<tr class="separator:a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02fe3feec8e332e82f555eb3c05e5f36"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36">ksfse_scan_coreslice</a> (const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</td></tr>
<tr class="separator:a02fe3feec8e332e82f555eb3c05e5f36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d7d7a81235745c6e98201f2e15fbe08"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08">ksfse_scan_coreslice_nargs</a> (const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</td></tr>
<tr class="separator:a0d7d7a81235745c6e98201f2e15fbe08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6484a51a27836574d96417d2f0a3655d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d">ksfse_scan_sliceloop</a> (int slperpass, int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, int shot, int exc)</td></tr>
<tr class="separator:a6484a51a27836574d96417d2f0a3655d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a656087391c0eb24a54958214896ab23d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d">ksfse_scan_sliceloop_nargs</a> (int slperpass, int nargs, void **args)</td></tr>
<tr class="separator:a656087391c0eb24a54958214896ab23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b80282dd477cfb811a5ca903a6616b1"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a1b80282dd477cfb811a5ca903a6616b1">ksfse_scan_acqloop</a> (int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>)</td></tr>
<tr class="separator:a1b80282dd477cfb811a5ca903a6616b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c1aabd1ad5e03c56dba64cccd5f650"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650">ksfse_scan_scanloop</a> ()</td></tr>
<tr class="separator:a84c1aabd1ad5e03c56dba64cccd5f650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01c14f0885b7400680196de955b96be9"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a> (SCAN_INFO slice_info, int shot)</td></tr>
<tr class="separator:a01c14f0885b7400680196de955b96be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f2c867dda89628c257585dd4357e682"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a7f2c867dda89628c257585dd4357e682">ksfse_init_imagingoptions</a> (void)</td></tr>
<tr class="separator:a7f2c867dda89628c257585dd4357e682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7072470234e07e0805d82b222e8fdab"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ac7072470234e07e0805d82b222e8fdab">ksfse_init_UI</a> (void)</td></tr>
<tr class="separator:ac7072470234e07e0805d82b222e8fdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0941dfd16b0a412b0665b985e05f8267"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a0941dfd16b0a412b0665b985e05f8267">ksfse_eval_UI</a> ()</td></tr>
<tr class="separator:a0941dfd16b0a412b0665b985e05f8267"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ffee4e96e25132c8bafafa3aeb3d5ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a> (int *min90_180, int *min180_echo, int slicecheck, <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *seq)</td></tr>
<tr class="separator:a7ffee4e96e25132c8bafafa3aeb3d5ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe70d8840f6d66615bf7dfa411a5177"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#acbe70d8840f6d66615bf7dfa411a5177">ksfse_eval_optimalkxnover</a> (<a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *seq)</td></tr>
<tr class="separator:acbe70d8840f6d66615bf7dfa411a5177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e372ec3f75f3e94bd2dd1012a47755c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a6e372ec3f75f3e94bd2dd1012a47755c">ksfse_eval_rfstretchfactor</a> (float patientweight, float flipangle, int tailoredrf_flag)</td></tr>
<tr class="separator:a6e372ec3f75f3e94bd2dd1012a47755c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af38ecec57c34124374ec13fcf4c403d5"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#af38ecec57c34124374ec13fcf4c403d5">ksfse_eval_setuprfpulses_2D</a> (<a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *seq)</td></tr>
<tr class="separator:af38ecec57c34124374ec13fcf4c403d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44f048a04968d71cab625493f5354ed"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ae44f048a04968d71cab625493f5354ed">ksfse_eval_setuprfpulses_3D</a> (<a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *seq)</td></tr>
<tr class="separator:ae44f048a04968d71cab625493f5354ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7b5b5f3e357196bd56e374d74e4a216"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ad7b5b5f3e357196bd56e374d74e4a216">ksfse_eval_setuprfpulses_recovery</a> (<a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *seq)</td></tr>
<tr class="separator:ad7b5b5f3e357196bd56e374d74e4a216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45c9672a3b30f0d0b6b9c02fd1d7b8a4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">ksfse_eval_ssitime</a> ()</td></tr>
<tr class="separator:a45c9672a3b30f0d0b6b9c02fd1d7b8a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb2b82b4fb1bc27cf72befce0547ba3"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a2fb2b82b4fb1bc27cf72befce0547ba3">ksfse_eval_setupobjects</a> ()</td></tr>
<tr class="separator:a2fb2b82b4fb1bc27cf72befce0547ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bfb29ce686a198f1de0ae12e20d6d65"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a5bfb29ce686a198f1de0ae12e20d6d65">ksfse_eval_TErange</a> ()</td></tr>
<tr class="separator:a5bfb29ce686a198f1de0ae12e20d6d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add948dfc3d7160d4b41892e809520a34"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#add948dfc3d7160d4b41892e809520a34">ksfse_eval_inversion</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:add948dfc3d7160d4b41892e809520a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e837471ce64138aa92879973c539cb8"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a5e837471ce64138aa92879973c539cb8">ksfse_eval_tr</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a5e837471ce64138aa92879973c539cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6757ca75cb3af4cafdee9000b5d128ca"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a6757ca75cb3af4cafdee9000b5d128ca">ksfse_eval_scantime</a> ()</td></tr>
<tr class="separator:a6757ca75cb3af4cafdee9000b5d128ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2db6cfa9ec7fd4025ab57ee69e2cdbc"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#aa2db6cfa9ec7fd4025ab57ee69e2cdbc">ksfse_check</a> ()</td></tr>
<tr class="separator:aa2db6cfa9ec7fd4025ab57ee69e2cdbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a680b7ebd358c5355979dd9bf28c76768"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a680b7ebd358c5355979dd9bf28c76768">ksfse_predownload_plot</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a680b7ebd358c5355979dd9bf28c76768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb2180cb9c08db068e0d794039b45c91"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#adb2180cb9c08db068e0d794039b45c91">ksfse_predownload_setrecon</a> ()</td></tr>
<tr class="separator:adb2180cb9c08db068e0d794039b45c91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ee8f888f2b3eece931b22925a69930"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a10ee8f888f2b3eece931b22925a69930">ksfse_etlphaseamps</a> (<a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *phaseenc_plan_ptr, <a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *phaser, <a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *zphaser, int shot)</td></tr>
<tr class="separator:a10ee8f888f2b3eece931b22925a69930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a83b6497cfecf4d5fe14f598a3751af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a0a83b6497cfecf4d5fe14f598a3751af">ksfse_spoilamp</a> (<a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *phaseenc_plan_ptr, <a class="el" href="struct_k_s___t_r_a_p.html">KS_TRAP</a> *spoiler, int res, int shot)</td></tr>
<tr class="separator:a0a83b6497cfecf4d5fe14f598a3751af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ff08e5aa2e8031060c4f291bb0594f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a25ff08e5aa2e8031060c4f291bb0594f">ksfse_scan_rf_off</a> ()</td></tr>
<tr class="separator:a25ff08e5aa2e8031060c4f291bb0594f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16799dfe755e64443936787e6705e80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ab16799dfe755e64443936787e6705e80">ksfse_scan_rf_on</a> ()</td></tr>
<tr class="separator:ab16799dfe755e64443936787e6705e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d334021df9f3f01d33dd756f4828ef6"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a6d334021df9f3f01d33dd756f4828ef6">ksfse_scan_init</a> (void)</td></tr>
<tr class="separator:a6d334021df9f3f01d33dd756f4828ef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedc112d27e9a6f4311eeed74eb0e00f8"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#aedc112d27e9a6f4311eeed74eb0e00f8">ksfse_scan_prescanloop</a> (int nloops, int dda)</td></tr>
<tr class="separator:aedc112d27e9a6f4311eeed74eb0e00f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a68650973336da93ca00062d7345818eb"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> = 0</td></tr>
<tr class="separator:a68650973336da93ca00062d7345818eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada5166232c93c38dbff47a3284abaeb7"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a> = 0.9</td></tr>
<tr class="separator:ada5166232c93c38dbff47a3284abaeb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4f25a4252632f0f86c71ce5d24127c"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a4f4f25a4252632f0f86c71ce5d24127c">ksfse_flipexc</a> = 90.0 with {0.0, 180.0, 90.0, VIS, &quot;Excitation flip angle [deg]&quot;,}</td></tr>
<tr class="separator:a4f4f25a4252632f0f86c71ce5d24127c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b9f392e04c921b7b63266b33be7c647"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a2b9f392e04c921b7b63266b33be7c647">ksfse_spoilerarea</a> = 2000.0 with {0.0, 20000.0, 5000.0, VIS, &quot;ksfse spoiler gradient area&quot;,}</td></tr>
<tr class="separator:a2b9f392e04c921b7b63266b33be7c647"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accedc302ef662e1b4d7a90b97e789dad"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a> = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> pulse if &gt; 1.0&quot;,}</td></tr>
<tr class="separator:accedc302ef662e1b4d7a90b97e789dad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ce223033aad0afd68255485629bdf7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a> = 0 with {0, 1, 0, VIS, &quot;In-flow Suppression [0:OFF, 1:ON]&quot;,}</td></tr>
<tr class="separator:a10ce223033aad0afd68255485629bdf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02cc10bf52afa88ba2d4de122965bb81"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a02cc10bf52afa88ba2d4de122965bb81">ksfse_inflowsuppression_mm</a> = 0.0 with {0.0, 100.0, 0.0, VIS, &quot;In-flow suppression [mm]&quot;,}</td></tr>
<tr class="separator:a02cc10bf52afa88ba2d4de122965bb81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66d550b779b0ac9177ed7640086bc4b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a> = 1.0 with {0.0, 1.0, 1.0, VIS, &quot;Variable flip angles [0:OFF, 1:ON]&quot;,}</td></tr>
<tr class="separator:ac66d550b779b0ac9177ed7640086bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e3149443c4d14f743cc18569e3f31e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a> = 0.5 with {0.0, 20.0, 0.5, VIS, &quot;scaling of crusher gradient area&quot;,}</td></tr>
<tr class="separator:a37e3149443c4d14f743cc18569e3f31e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab64845b4ed4919114a702f65ab1d3d4d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a> = 0.9</td></tr>
<tr class="separator:ab64845b4ed4919114a702f65ab1d3d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec461106cf1a6720d4641b9988bfa2cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a> = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td></tr>
<tr class="separator:aec461106cf1a6720d4641b9988bfa2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ae230002e11e72e2b78ef1ac3fd737d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a> = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF refocusing pulses if &gt; 1.0&quot;,}</td></tr>
<tr class="separator:a5ae230002e11e72e2b78ef1ac3fd737d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa069f8db856d8cb0f1f3510e71904a5"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch all RF pulses if &gt; 1.0&quot;,}</td></tr>
<tr class="separator:afa069f8db856d8cb0f1f3510e71904a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b6b5ece7f3021e6f7d9003799a01163"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a> = <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a> with {<a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>, <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, VIS, &quot;Recovery. 0:off 1:T1wopt 2:T2fast&quot;, }</td></tr>
<tr class="separator:a7b6b5ece7f3021e6f7d9003799a01163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ef0ac44bd2e5e837f8bbbe9ea78b003"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a1ef0ac44bd2e5e837f8bbbe9ea78b003">rf_stretch_rfrecovery</a> = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF recovery pulses if &gt; 1.0&quot;,}</td></tr>
<tr class="separator:a1ef0ac44bd2e5e837f8bbbe9ea78b003"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aaa25c865ecd2ee214ba45dfa00a96d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a5aaa25c865ecd2ee214ba45dfa00a96d">ksfse_kxnover_min</a> = <a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a> with {<a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, 512, <a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, VIS, &quot;Min mum kx overscans for minTE&quot;,}</td></tr>
<tr class="separator:a5aaa25c865ecd2ee214ba45dfa00a96d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76ebb43b78039e7250fac06e50fba578"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a76ebb43b78039e7250fac06e50fba578">ksfse_kxnover</a> = 32 with {<a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, 512, 32, VIS, &quot;Num kx overscans for minTE&quot;,}</td></tr>
<tr class="separator:a76ebb43b78039e7250fac06e50fba578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33cc9c27102dbf43a3446c2558ca9168"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a33cc9c27102dbf43a3446c2558ca9168">ksfse_rampsampling</a> = 0 with {0, 1, 0, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a33cc9c27102dbf43a3446c2558ca9168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2fd510dada2197d9628e541f89b9426"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#af2fd510dada2197d9628e541f89b9426">ksfse_extragap</a> = 0 with {0, 100ms, 0, VIS, &quot;extra gap between readout [us]&quot;,}</td></tr>
<tr class="separator:af2fd510dada2197d9628e541f89b9426"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0677ae1147b74362792c5014c638e65"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a> = 1 with {0, 1, 1, VIS, &quot;ETL controls TE&quot;,}</td></tr>
<tr class="separator:ac0677ae1147b74362792c5014c638e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bb767118594019cf8553926001a7259"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a1bb767118594019cf8553926001a7259">ksfse_xcrusherarea</a> = 100.0 with {0.0, 100.0, 0.0, VIS, &quot;x crusher area for readout&quot;,}</td></tr>
<tr class="separator:a1bb767118594019cf8553926001a7259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d79b39e9c23bb5a017c214eb182a20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> = 0 with {0, 1000000, 0, VIS, &quot;View-only: Echo spacing in [us]&quot;,}</td></tr>
<tr class="separator:a90d79b39e9c23bb5a017c214eb182a20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9cddaa2b0daf95f740080d00669a86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a5f9cddaa2b0daf95f740080d00669a86">ksfse_noph</a> = 0 with {0, 1, 0, VIS, &quot;Turn OFF phase encoding [0:Disabled 1:Enabled]&quot;,}</td></tr>
<tr class="separator:a5f9cddaa2b0daf95f740080d00669a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae666a499a4647e92db6977328a60a8c3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ae666a499a4647e92db6977328a60a8c3">ksfse_minacslines</a> = 12 with {0, 512, 12, VIS, &quot;Minimum ACS lines for ARC&quot;,}</td></tr>
<tr class="separator:ae666a499a4647e92db6977328a60a8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a955ccaf130774fd90f7831650bf6a94b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a955ccaf130774fd90f7831650bf6a94b">ksfse_minzacslines</a> = 12 with {0, 512, 12, VIS, &quot;Minimum z ACS lines for ARC&quot;,}</td></tr>
<tr class="separator:a955ccaf130774fd90f7831650bf6a94b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a425ae21dd8ac8304478402f10bbde98f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a425ae21dd8ac8304478402f10bbde98f">ksfse_pos_start</a> = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, VIS, &quot;us from start until the first waveform begins&quot;,}</td></tr>
<tr class="separator:a425ae21dd8ac8304478402f10bbde98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e1154fac838dc278087955669299cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a> = <a class="el" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a> with {50, , <a class="el" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td></tr>
<tr class="separator:a83e1154fac838dc278087955669299cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7af5654e8b4db142fb80465d6f256f7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a> = 2 with {0, 200, 2, VIS, &quot;Number of dummy scans for steady state&quot;,}</td></tr>
<tr class="separator:ab7af5654e8b4db142fb80465d6f256f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da9fbe7f1a563677f5e88060905eeeb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a4da9fbe7f1a563677f5e88060905eeeb">ksfse_debug</a> = 1 with {0, 100, 1, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;,}</td></tr>
<tr class="separator:a4da9fbe7f1a563677f5e88060905eeeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e1230681574d002f10a28671a56d705"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a8e1230681574d002f10a28671a56d705">ksfse_imsize</a> = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td></tr>
<tr class="separator:a8e1230681574d002f10a28671a56d705"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afead5e22beaaab664df25dd0cfb8fda9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#afead5e22beaaab664df25dd0cfb8fda9">ksfse_abort_on_kserror</a> = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:afead5e22beaaab664df25dd0cfb8fda9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c49bc9f0980dd02a99cd26b933b7131"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> = 0 with {0, 20s, 0, VIS, &quot;Min TR (ms) [0: Disabled]&quot;,}</td></tr>
<tr class="separator:a3c49bc9f0980dd02a99cd26b933b7131"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad232fff30fc715e9baa395aab5d40bd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a> = 0 with {0, 40s, 0, VIS, &quot;Max TR (ms) [0: Disabled]&quot;,}</td></tr>
<tr class="separator:ad232fff30fc715e9baa395aab5d40bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c3ae9d44addcef6a9e09b7db6679baf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a> = <a class="el" href="ksfse__implementation_8e.html#a69ef18818d8b0e4117ded34e134e181d">KSFSE_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a9c3ae9d44addcef6a9e09b7db6679baf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f39fad60409167fe45164b72a131e0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a> []</td></tr>
<tr class="separator:a8f39fad60409167fe45164b72a131e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adffbee0f8231c5226387c8dd8f2dd482"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></td></tr>
<tr class="separator:adffbee0f8231c5226387c8dd8f2dd482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae477e374b559bf16a475321797d62cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></td></tr>
<tr class="separator:aae477e374b559bf16a475321797d62cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the implementation details for the <em>ksfse</em> psd. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a49b40808cadc9aa2638ff5cf65effbc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49b40808cadc9aa2638ff5cf65effbc7">&#9670;&nbsp;</a></span>KSFSE_MINHNOVER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSFSE_MINHNOVER&#160;&#160;&#160;6</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aef9d9c4f9c117165300e06cf9899fda8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef9d9c4f9c117165300e06cf9899fda8">&#9670;&nbsp;</a></span>KSFSE_MIN_SSI_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSFSE_MIN_SSI_TIME&#160;&#160;&#160;200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a713f9b6c2f156e3b05a27a0936da3439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a713f9b6c2f156e3b05a27a0936da3439">&#9670;&nbsp;</a></span>KSFSE_MAXTHICKFACT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSFSE_MAXTHICKFACT&#160;&#160;&#160;3.0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a69ef18818d8b0e4117ded34e134e181d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69ef18818d8b0e4117ded34e134e181d">&#9670;&nbsp;</a></span>KSFSE_INIT_SEQUENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSFSE_INIT_SEQUENCE&#160;&#160;&#160;{<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a01108d382b19492c2178b6bedbfcbc4b">KS_INIT_READTRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a>, <a class="el" href="_k_s_foundation_8h.html#a5e620158a577fbdc94013a3f761a5a22">KS_INIT_PHASER</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>};</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="abc6126af1d45847bc59afa0aa3216b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6126af1d45847bc59afa0aa3216b04">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b"></a>KSFSE_RECOVERY_OFF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4"></a>KSFSE_RECOVERY_T1WOPT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647"></a>KSFSE_RECOVERY_FAST&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{<a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, <a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4">KSFSE_RECOVERY_T1WOPT</a>, <a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>};</div><div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4">KSFSE_RECOVERY_T1WOPT</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a663f0efa1ef983828a4a6280175f1088"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a663f0efa1ef983828a4a6280175f1088">&#9670;&nbsp;</a></span>abstract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">abstract </td>
          <td>(</td>
          <td class="paramtype">&quot;FSE &quot;&#160;</td>
          <td class="paramname">[KSFoundation]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a78e45987586c99d31eafcf28b143a971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78e45987586c99d31eafcf28b143a971">&#9670;&nbsp;</a></span>psdname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psdname </td>
          <td>(</td>
          <td class="paramtype">&quot;ksfse&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a257cccbbaeda541ca5250d16adc5c8c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a257cccbbaeda541ca5250d16adc5c8c5">&#9670;&nbsp;</a></span>ksfse_eval_TEmenu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksfse_eval_TEmenu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>esp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxte</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>etl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>optechono</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up the TE menu based on echo spacing, max TE, ETL and the optimal echo index</h4>
</p>
<p><code>optechono</code> is the echo index in range [0, ETL-1] that is in the center of the FSE train. If the TE corresponding to this index is chosen, optimal image quality is achieved with minimal FSE ghosting.</p>
<p>For ETLs &gt; 6, this value is given first in the TE menu, meaning that if the user chooses the first field in the TE menu this will have the same effect as setting "ETL controls TE", and the remaining TE fields in the menu are the ones straddling the optimal TE.</p>
<p>For ETLs in range [2,6], MinFull is the first, followed by the optimal TE.</p>
<p>For ETL = 1, which corresponds to a conventional Spin-Echo, the user can choose only between MinTE (partial kx Fourier) and MinFullTE. Manual type-in is not allowed for ETL = 1.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                                                      {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="keywordtype">int</span> allow_typein = 1;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordflow">if</span> (etl &gt; 6) {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    pite1val2 = optechono * esp; <span class="comment">/* best TE for image quality (minimal T2-blurring, ghosting) */</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    pite1val3 = (optechono - 2) * esp;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    pite1val4 = (optechono - 1) * esp;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    pite1val5 = (optechono + 1) * esp;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    pite1val6 = (optechono + 2) * esp;</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (etl &gt; 1) {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    pite1val2 = PSD_MINFULLTE;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    pite1val3 = (optechono - 2) * esp;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    pite1val4 = (optechono - 1) * esp;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    pite1val5 = optechono * esp;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    pite1val6 = (optechono + 1) * esp;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* etl = 1 */</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    allow_typein = 0;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    pite1val2 = PSD_MINIMUMTE;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    pite1val3 = PSD_MINFULLTE;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    pite1val4 = 0;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    pite1val5 = 0;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    pite1val6 = 0;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">if</span> (etl &gt; 1) {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    pite1nub = allow_typein + 2 +</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;               4  * (pite1val3 &gt;= esp &amp;&amp; pite1val3 &lt;= maxte) +</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;               8  * (pite1val4 &gt;= esp &amp;&amp; pite1val4 &lt;= maxte) +</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;               16 * (pite1val5 &gt;= esp &amp;&amp; pite1val5 &lt;= maxte) +</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;               32 * (pite1val6 &gt;= esp &amp;&amp; pite1val6 &lt;= maxte);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    pite1nub = 6; <span class="comment">/* only MinTE &amp; MinFull */</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;} <span class="comment">/* ksfse_eval_TEmenu() */</span></div></div><!-- fragment -->
</div>
</div>
<a id="af287d52efc92c8e069e341c3eb00de99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af287d52efc92c8e069e341c3eb00de99">&#9670;&nbsp;</a></span>ksfse_calc_echo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_calc_echo </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>bestecho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>optecho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *&#160;</td>
          <td class="paramname"><em>pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>etl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>esp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd">&#9670;&nbsp;</a></span>ksfse_pg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_pg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The ksfse (main) pulse sequence</h4>
</p>
<p>This is the main pulse sequence in <a class="el" href="ksfse_8e.html" title="This file contains the overall structure for the ksfse psd. ">ksfse.e</a> using the sequence objects in <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> with the sequence module name "ksfsemain" (= ksfse.seqctrl.description)</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                                {</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <a class="code" href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a> tmploc = <a class="code" href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a>;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;  <span class="keywordtype">int</span> readpos_start = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  <span class="keywordtype">int</span> spoiler_pos = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;  <span class="keywordflow">if</span> (start_time &lt; <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>) {</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st arg (pos start) must be at least %d us&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;  }</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(start_time + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="comment">/* N.B.: ks_pg_selrf()-&gt;ks_pg_rf() detects that ksfse.selrfexc is an excitation pulse</span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="comment">     (ksfse.selrfexc.rf.role = KS_RF_ROLE_EXC) and will also set ksfse.seqctrl.momentstart</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">     to the absolute position in [us] of the isocenter of the RF excitation pulse */</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">   *  X dephaser (between 90 and 1st 180)</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>) {</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>;</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;  }</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">  *  Generate the refocusing flip angles</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">  -------------------------------------------------------------------------------------------------------*/</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <span class="keywordtype">double</span> flip_angles[512]; <span class="comment">/* rad */</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a>) {</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    STATUS status = <a class="code" href="_k_s_foundation_8h.html#adee331638310d0a0ed1c726c02051e1b">ks_pg_fse_flip_angle_taperoff</a>(flip_angles,</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                                                  opetl,</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                                                  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>,</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                                                  80.0, <span class="comment">/* degrees */</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                                                  opflair != OPFLAIR_INTERLEAVED);</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ks_pg_fse_flip_angle_taperoff failed&quot;</span>);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="comment">/* modify rfpulse-struct for SAR calcs. */</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a43efb5f9eb84e0ace408cd1a74825f3f">ks_pg_mod_fse_rfpulse_structs</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>,</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                                  flip_angles,</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                                  opetl);</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  }</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="comment">  *  FSE train: Begin</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="comment">  -------------------------------------------------------------------------------------------------------*/</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; opetl; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">/* Selective RF Refocus with left (pregrad.) and right (postgrad.) crushers */</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> == 0) {</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;      <span class="comment">/* special case for 1st pulse with at least a smaller left crusher */</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> + 0.5) * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a>)</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = flip_angles[<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>] / <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> == 1) {</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> + 0.5) * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a>)</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;        tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = flip_angles[<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>] / <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> + 0.5) * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a>)</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = flip_angles[<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>] / <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>;</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    }</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;    <span class="comment">/* ksfse_esp dependent time at beginning of readout ramp */</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    readpos_start = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> + 1) * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">    *  Readouts</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readpos_start;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    if (<a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>)</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a21198913d5b1603f03a5e5d61d00408c">ks_pg_readtrap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">    *  Phase encoding dephasers &amp; rephasers</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readpos_start + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance 2*i */</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readpos_start + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance 2*i + 1 */</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="comment">    *  Z phase encoding dephasers &amp; rephasers (3D)</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) {</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readpos_start + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance 2*i */</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = readpos_start + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>;</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance 2*i + 1 */</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  } <span class="comment">/* opetl */</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">/*------------------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">   *  FSE train: End</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">   * Phase encoding table</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="comment">   * written to /usr/g/mrraw/ks_phaseencodingtable.txt (HW) or ./ks_phaseencodingtable.txt (SIM)</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="comment">   * Need to call this in ksfse_pg() so it is run both on HOST and TGT. This, since the phase table</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">   * is dynamically allocated in ks_phaseencoding_generate_2Dfse()-&gt;ks_phaseencoding_resize()</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">   * For 3D, ks_phaseencoding_generate_2Dfse() just repeats the same ETL ky path for every kz. This is just</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">   * for testing, and a better ks_phaseencoding_generate_*** function would be needed to do optimal ky-kz</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="comment">   * trajectory for 3D</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6101f1a037684c71a6c5d654671824f9">ks_phaseencoding_generate_2Dfse</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, <span class="stringliteral">&quot;&quot;</span>,</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                                      &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a> : NULL,</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                                      opte, opetl, <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>) == FAILURE)</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;     <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ab37bdbd70185618b80d077f99b253616">ks_phaseencoding_print</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>);</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  <span class="comment">/* set phase encoding amp as for the first shot in the scan loop so it is displayed in WTools MGDSim */</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a10ee8f888f2b3eece931b22925a69930">ksfse_etlphaseamps</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a> : NULL, 0);</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="comment">   * Post-ETL forced recovery: T1-w Optimization / T2 fast Recovery</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a>) {</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <span class="keywordtype">int</span> lastReadoutCenter = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + opetl * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="comment">/* Place extra refocusing pulse */</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = lastReadoutCenter + <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>/2 - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = (<a class="code" href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a>) ? flip_angles[opetl-1] / <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> : 1;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    if (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    <span class="comment">/* Place rewinder of previous readout in order to get back to the center of k-space */</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = lastReadoutCenter + <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>) {</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> -= <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    }</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="comment">/* Place excitation pulse */</span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = lastReadoutCenter + <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a> == <a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>) {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = -1;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">/* = KSFSE_RECOVERY_T1WOPT */</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    }</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="comment">/* spoiler pos */</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    spoiler_pos = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    <span class="comment">/* spoiler pos */</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    spoiler_pos = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + opetl * <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  } <span class="comment">/* ksfse_recovery */</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment">   *  Gradient spoiler on Y</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = spoiler_pos;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a0a83b6497cfecf4d5fe14f598a3751af">ksfse_spoilamp</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>, 0);</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment">   *  Set the minimal sequence duration (ksfse.seqctrl.min_duration) by calling</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="comment">   *  ks_eval_seqctrl_setminduration()</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="comment">/* make sure we are divisible by GRAD_UPDATE_TIME (4us) */</span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="comment">/* On HOST only: Sequence duration (ksfse.seqctrl.ssi_time must be &gt; 0 and is added to ksfse.seqctrl.min_duration in ks_eval_seqctrl_setminduration() */</span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="ksfse__implementation_8e.html#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">ksfse_eval_ssitime</a>();</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>); <span class="comment">/* tmploc.pos now corresponds to the end of last gradient in the sequence */</span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;} <span class="comment">/* ksfse_pg() */</span></div><div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSFSE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">KS_SEQLOC::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:242</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a21198913d5b1603f03a5e5d61d00408c"><div class="ttname"><a href="_k_s_foundation_8h.html#a21198913d5b1603f03a5e5d61d00408c">ks_pg_readtrap</a></div><div class="ttdeci">STATUS ks_pg_readtrap(KS_READTRAP *readtrap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_READTRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1529</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a094595db960708064dc1b8b645c4be71"><div class="ttname"><a href="_k_s_foundation_8h.html#a094595db960708064dc1b8b645c4be71">ks_pg_phaser</a></div><div class="ttdeci">STATUS ks_pg_phaser(KS_PHASER *phaser, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_PHASER sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1412</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6e727c3449c63278cbfc2e35cfcfa9fa"><div class="ttname"><a href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a></div><div class="ttdeci">STATUS ks_pg_selrf(KS_SELRF *selrf, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_SELRF sequence object on a gradient (and RF) board at some position in the pulse sequence...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1954</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a2e3f5254967cadb9a41167c6fbf6743e"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">KS_SEQLOC::board</a></div><div class="ttdeci">int board</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:241</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a43efb5f9eb84e0ace408cd1a74825f3f"><div class="ttname"><a href="_k_s_foundation_8h.html#a43efb5f9eb84e0ace408cd1a74825f3f">ks_pg_mod_fse_rfpulse_structs</a></div><div class="ttdeci">void ks_pg_mod_fse_rfpulse_structs(KS_SELRF *rf1, KS_SELRF *rf2, KS_SELRF *rf3, const double *flip_angles, const int etl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2481</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a606fbf556e8a297aa1f68b098f6ac2a2"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">KS_SEQLOC::ampscale</a></div><div class="ttdeci">float ampscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:243</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a90d79b39e9c23bb5a017c214eb182a20"><div class="ttname"><a href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a></div><div class="ttdeci">int ksfse_esp</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:112</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSFSE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:51</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a10ee8f888f2b3eece931b22925a69930"><div class="ttname"><a href="ksfse__implementation_8e.html#a10ee8f888f2b3eece931b22925a69930">ksfse_etlphaseamps</a></div><div class="ttdeci">STATUS ksfse_etlphaseamps(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, KS_PHASER *phaser, KS_PHASER *zphaser, int shot)</div><div class="ttdoc">Sets the phase encoding amplitudes in the FSE train on hardware using the phase enc. table and shot index</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2008</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a0a83b6497cfecf4d5fe14f598a3751af"><div class="ttname"><a href="ksfse__implementation_8e.html#a0a83b6497cfecf4d5fe14f598a3751af">ksfse_spoilamp</a></div><div class="ttdeci">void ksfse_spoilamp(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, KS_TRAP *spoiler, int res, int shot)</div><div class="ttdoc">2DFSE: Updates the spoiler amplitude on hardware during scanning depending on current etl and shot...</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2052</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6101f1a037684c71a6c5d654671824f9"><div class="ttname"><a href="_k_s_foundation_8h.html#a6101f1a037684c71a6c5d654671824f9">ks_phaseencoding_generate_2Dfse</a></div><div class="ttdeci">STATUS ks_phaseencoding_generate_2Dfse(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, const char *const desc, KS_PHASER *phaser, KS_PHASER *zphaser, int TE, int etl, int esp)</div><div class="ttdoc">2DFSE: Makes a KS_PHASEENCODING_PLAN depending on etl, desired TE, and echo spacing (esp)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:602</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a61651c54c4dfd4388fc939d804a9964b"><div class="ttname"><a href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a></div><div class="ttdeci">STATUS ks_pg_trap(KS_TRAP *trap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_TRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1212</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ac66d550b779b0ac9177ed7640086bc4b"><div class="ttname"><a href="ksfse__implementation_8e.html#ac66d550b779b0ac9177ed7640086bc4b">ksfse_vfa</a></div><div class="ttdeci">int ksfse_vfa</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:86</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a></div><div class="ttdoc">typedef struct used as argument to ks_pg_*** functions to control where and when to place a sequence ...</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:240</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a45c9672a3b30f0d0b6b9c02fd1d7b8a4"><div class="ttname"><a href="ksfse__implementation_8e.html#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">ksfse_eval_ssitime</a></div><div class="ttdeci">int ksfse_eval_ssitime()</div><div class="ttdoc">Set the SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:1317</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a75c403072633f5a42fe364af4454b245"><div class="ttname"><a href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a></div><div class="ttdeci">STATUS ks_eval_seqctrl_setminduration(KS_SEQ_CONTROL *seqctrl, int mindur)</div><div class="ttdoc">Sets the minimum duration and duration fields of a KS_SEQ_CONTROL struct based on some minimum time (...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2925</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab37bdbd70185618b80d077f99b253616"><div class="ttname"><a href="_k_s_foundation_8h.html#ab37bdbd70185618b80d077f99b253616">ks_phaseencoding_print</a></div><div class="ttdeci">void ks_phaseencoding_print(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr)</div><div class="ttdoc">Print out KS_PHASEENCODING_PLAN to a text file</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:351</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7b6b5ece7f3021e6f7d9003799a01163"><div class="ttname"><a href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a></div><div class="ttdeci">int ksfse_recovery</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:100</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad01dd4f06fe226a502e872d4173ba7ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a></div><div class="ttdeci">#define KS_INIT_SEQLOC</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:128</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_READTRAP::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1434</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSFSE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:61</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_adee331638310d0a0ed1c726c02051e1b"><div class="ttname"><a href="_k_s_foundation_8h.html#adee331638310d0a0ed1c726c02051e1b">ks_pg_fse_flip_angle_taperoff</a></div><div class="ttdeci">STATUS ks_pg_fse_flip_angle_taperoff(double *flip_angles, int etl, double flip1, double flip2, double flip3, double target_flip, int start_middle)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2514</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aec461106cf1a6720d4641b9988bfa2cc"><div class="ttname"><a href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a></div><div class="ttdeci">int ksfse_slicecheck</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:93</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a02fe3feec8e332e82f555eb3c05e5f36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02fe3feec8e332e82f555eb3c05e5f36">&#9670;&nbsp;</a></span>ksfse_scan_coreslice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_scan_coreslice </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out one slice in real time during scanning together with other active sequence modules</h4>
</p>
<p>On TGT on the MR system (PSD_HW), this function sets up (<a class="el" href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9" title="Sets the current state of all ksfse sequence objects being part of KSFSE_SEQUENCE">ksfse_scan_seqstate()</a>) and plays out the core ksfse sequence with optional sequence modules also called in this function. The low-level function call <code><a class="el" href="_k_s_foundation__tgt_8c.html#a7a93838e7d53ff7ec9fbe98843181d03">startseq()</a></code>, which actually starts the realtime sequence playout is called from within <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, which in addition also returns the time to play out that sequence module (see time += ...).</p>
<p>On HOST (in <a class="el" href="ksfse__implementation_8e.html#a5e837471ce64138aa92879973c539cb8" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksfse_eval_tr()</a>) we call <a class="el" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d" title="Wrapper function to ksfse_scan_sliceloop() with standardized input arguments">ksfse_scan_sliceloop_nargs()</a>, which in turn calls this function that returns the total time in [us] taken to play out this core slice. These times are increasing in each parent function until ultimately ksfse_scan_scantime(), which returns the total time of the entire scan.</p>
<p>After each call to <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> is called to add slice-timing information on file for later PNG/PDF-generation of the sequence. As scanning is performed in real-time and may fail if interrupted, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> will return quietly if it detects both IPG (TGT) and PSD_HW (on the MR scanner). See <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> for the PNG/PDF generation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Position of the slice to be played out (one element in the global <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index (over ky and kz) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exc</td><td>Excitation index in range <code>[0, NEX-1]</code>, where NEX = number of excitations (opnex) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                                                                        {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="keywordtype">int</span> dabop, dabview, acqflag;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keywordtype">float</span> tloc = 0.0;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL)</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    tloc = slice_pos-&gt;optloc;</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="comment">  * SpSat sequence module</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  time += <a class="code" href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a>(<a class="code" href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a>);</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="comment">  * Chemsat sequence module</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>);</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>); <span class="comment">/* no slice location for fat sat */</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="comment">  * ksfse main sequence module</span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL) {</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ab16799dfe755e64443936787e6705e80">ksfse_scan_rf_on</a>();</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a>(*slice_pos, (<a class="code" href="ksfse__implementation_8e.html#a5f9cddaa2b0daf95f740080d00669a86">ksfse_noph</a> != PSD_ON) ? shot : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>); <span class="comment">/* shot. if = KS_NOTSET, no phase encodes */</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a25ff08e5aa2e8031060c4f291bb0594f">ksfse_scan_rf_off</a>(); <span class="comment">/* false slice, shut off RF pulses */</span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  }</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a>; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="comment">/* N.B.: Looping over ksfse.read.acq.base.ngenerated corresponds to:</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="comment">       HOST: No looping since ksfse.read.acq.base.ngenerated is 0 on HOST</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">       TGT: ETL.</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="comment">       This protects calls to loaddab() on HOST</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, shot);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="comment">/* data routing control */</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    acqflag = (shot &gt;= 0 &amp;&amp; slice_pos != NULL &amp;&amp; coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> &gt;= 0 &amp;&amp; dabslice &gt;= 0) ? DABON : DABOFF; <span class="comment">/* open or close data receiver */</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    dabop = (exc &lt;= 0) ? DABSTORE : DABADD; <span class="comment">/* replace or add to data */</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[1].optloc &gt; <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0].optloc)</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        dabslice = (opslquant * opvquant - 1) - coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        dabslice = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    }</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    dabview = (shot &gt;= 0) ? coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    if (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> &gt; 1 &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">nacslines</a> == 0 &amp;&amp; dabview != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="comment">/* ASSET case triggered by R &gt; 1 and no ACS lines */</span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      dabview /= <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>; <span class="comment">/* store in compressed BAM without empty non-acquired lines */</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    }</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    loaddab(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>], dabslice, 0, dabop, dabview + 1, acqflag, PSD_LOAD_DAB_ALL); <span class="comment">/* see epicfuns.h for alternatives to loaddab() */</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  } <span class="comment">/* etl */</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, &amp;tloc, <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>);</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;} <span class="comment">/* ksfse_scan_coreslice() */</span></div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a0e0bae3aa47ae5b8aae488fa0eb920ce"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">KS_READ::echo</a></div><div class="ttdeci">WF_PULSE * echo</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:587</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a4762b9a6307f0223b3d1dfde7e8ddce8"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">KS_PHASER::nacslines</a></div><div class="ttdeci">int nacslines</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1530</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a01c14f0885b7400680196de955b96be9"><div class="ttname"><a href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a></div><div class="ttdeci">STATUS ksfse_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksfse sequence objects being part of KSFSE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2376</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a5f9cddaa2b0daf95f740080d00669a86"><div class="ttname"><a href="ksfse__implementation_8e.html#a5f9cddaa2b0daf95f740080d00669a86">ksfse_noph</a></div><div class="ttdeci">int ksfse_noph</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:117</div></div>
<div class="ttc" id="_g_e_required_8e_html_aece7287cee904292d20da04682670ccc"><div class="ttname"><a href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a></div><div class="ttdeci">int ks_perform_slicetimeplot</div><div class="ttdef"><b>Definition:</b> GERequired.e:219</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a25ff08e5aa2e8031060c4f291bb0594f"><div class="ttname"><a href="ksfse__implementation_8e.html#a25ff08e5aa2e8031060c4f291bb0594f">ksfse_scan_rf_off</a></div><div class="ttdeci">void ksfse_scan_rf_off()</div><div class="ttdoc">Sets all RF pulse amplitudes to zero</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2441</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a06ab78e08959e925d92935c582469de8"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">KS_READ::base</a></div><div class="ttdeci">KS_BASE base</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:581</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ab16799dfe755e64443936787e6705e80"><div class="ttname"><a href="ksfse__implementation_8e.html#ab16799dfe755e64443936787e6705e80">ksfse_scan_rf_on</a></div><div class="ttdeci">void ksfse_scan_rf_on()</div><div class="ttdoc">Sets all RF pulse amplitudes on</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2458</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="_k_s_sp_sat_8e_html_abfffc166a1d95ac817d1dc894fd2a416"><div class="ttname"><a href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a></div><div class="ttdeci">int ksspsat_scan_playsequences(int perform_slicetimeplot)</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:816</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a31e708efa36d49cc75d7dc46b58d17b9"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a></div><div class="ttdeci">void kschemsat_scan_seqstate(KSCHEMSAT_SEQUENCE *kschemsat)</div><div class="ttdoc">Sets the current state of all kschemsat sequence objects being part of KSCHEMSAT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:387</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:194</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a37673579414f16215fe19214f23a1116"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a></div><div class="ttdeci">KSCHEMSAT_SEQUENCE kschemsat</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:88</div></div>
<div class="ttc" id="struct_k_s___b_a_s_e_html_a48a67aa9525b1eaff08aa809b53110dc"><div class="ttname"><a href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">KS_BASE::ngenerated</a></div><div class="ttdeci">int ngenerated</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:262</div></div>
<div class="ttc" id="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSCHEMSAT_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:70</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSFSE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:61</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d7d7a81235745c6e98201f2e15fbe08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d7d7a81235745c6e98201f2e15fbe08">&#9670;&nbsp;</a></span>ksfse_scan_coreslice_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_scan_coreslice_nargs </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a> with standardized input arguments</h4>
</p>
<p><a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a> has functions (<a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>, <a class="el" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a" title="Runs the inversion slice loop and validates TR and SAR/hardware limits">ksinv_eval_checkTR_SAR()</a> and <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>) that expect a standardized function pointer to the coreslice function of a main sequence. When inversion mode is enabled for the sequence, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is used instead of <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a> in <a class="el" href="ksfse__implementation_8e.html#a1b80282dd477cfb811a5ca903a6616b1" title="Plays out all phase encodes for all slices belonging to one pass">ksfse_scan_acqloop()</a>, and the generic <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> function need a handle to the coreslice function of the main sequence.</p>
<p>In order for these <code>ksinv_***</code> functions to work for any pulse sequence they need a standardized function pointer with a fixed set of input arguments. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08" title="Wrapper function to ksfse_scan_coreslice() with standardized input arguments">ksfse_scan_coreslice_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a>.</p>
<p>The function pointer must have SCAN_INFO and slice storage index (dabslice) as the first two input args, while remaining input arguments (to <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Pointer to the SCAN_INFO struct corresponding to the current slice to be played out </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a> in range [0,2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                                                                                                 {</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="keywordtype">int</span> shot = 0;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  <span class="keywordtype">int</span> exc = 0;</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 2) {</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) must contain up to 2 elements in the following order: shot, exc&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) cannot be NULL if nargs (3rd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  }</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  }</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    exc = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36">ksfse_scan_coreslice</a>(slice_pos, dabslice, <span class="comment">/* psd specific: */</span> shot, exc); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;} <span class="comment">/* ksfse_scan_coreslice_nargs() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a02fe3feec8e332e82f555eb3c05e5f36"><div class="ttname"><a href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36">ksfse_scan_coreslice</a></div><div class="ttdeci">int ksfse_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2496</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6484a51a27836574d96417d2f0a3655d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6484a51a27836574d96417d2f0a3655d">&#9670;&nbsp;</a></span>ksfse_scan_sliceloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_scan_sliceloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out <code>slperpass</code> slices corresponding to one TR</h4>
</p>
<p>This function gets a spatial slice location index based on the pass index and temporal position within current pass. It then calls <a class="el" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksfse_scan_coreslice()</a> to play out one coreslice (i.e. the main ksfse main sequence + optional sequence modules, excluding inversion modules).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>Pass index in range [0, ks_slice_plan.npasses - 1] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index in range <code>[0, ksfse.phaseenc_plan.num_shots - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exc</td><td>Excitation index in range <code>[0, NEX-1]</code>, where NEX = number of excitations (opnex) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                                                                         {</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keywordtype">int</span> slloc, sltimeinpass;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  SCAN_INFO centerposition = <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0]; <span class="comment">/* first slice chosen here, need only rotation stuff */</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;</div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="keywordtype">int</span> centerslice = opslquant/2;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="comment">/* for future 3D multislab support, let passindx update centerposition */</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    centerposition.optloc = (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice-1].optloc + <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice].optloc)/2.0;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  }</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; slperpass; sltimeinpass++) {</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    SCAN_INFO *current_slice = &amp;centerposition;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* 2D */</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="comment">/* if slloc = KS_NOTSET, pass in NULL as first argument to indicate &#39;false slice&#39; */</span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;      current_slice = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc]: NULL;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    }</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    time += <a class="code" href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36">ksfse_scan_coreslice</a>(current_slice, sltimeinpass, shot, exc);</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;  }</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;} <span class="comment">/* ksfse_scan_sliceloop() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a02fe3feec8e332e82f555eb3c05e5f36"><div class="ttname"><a href="ksfse__implementation_8e.html#a02fe3feec8e332e82f555eb3c05e5f36">ksfse_scan_coreslice</a></div><div class="ttdeci">int ksfse_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot, int exc)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2496</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a656087391c0eb24a54958214896ab23d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a656087391c0eb24a54958214896ab23d">&#9670;&nbsp;</a></span>ksfse_scan_sliceloop_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_scan_sliceloop_nargs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a> with standardized input arguments</h4>
</p>
<p>For TR timing heat/SAR calculations of regular 2D multislice sequences, <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, <a class="el" href="_k_s_foundation_8h.html#af38e51235c90bff510cae4ee1955dd95" title="Returns the minimum TR based on the content of a slice loop, adding additional time due to SAR and ha...">ks_eval_mintr()</a> and <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a> use a standardized function pointer with a fixed set of input arguments to call the sliceloop of the main sequence with different number of slices to check current slice loop duration. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d" title="Wrapper function to ksfse_scan_sliceloop() with standardized input arguments">ksfse_scan_sliceloop_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a>.</p>
<p>The function pointer must have an integer corresponding to the number of slices to use as its first argument while the remaining input arguments (to <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a> in range [0,4] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                                                                      {</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0;</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="keywordtype">int</span> shot = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;   <span class="comment">/* off */</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="keywordtype">int</span> exc = 0;</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 3) {</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) must contain up to 3 elements: passindx, shot, exc&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) cannot be NULL if nargs (2nd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;  }</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;  }</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  }</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 3 &amp;&amp; args[2] != NULL) {</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    exc = *((<span class="keywordtype">int</span> *) args[2]);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d">ksfse_scan_sliceloop</a>(slperpass, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot, exc); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;} <span class="comment">/* ksfse_scan_sliceloop_nargs() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a6484a51a27836574d96417d2f0a3655d"><div class="ttname"><a href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d">ksfse_scan_sliceloop</a></div><div class="ttdeci">int ksfse_scan_sliceloop(int slperpass, int passindx, int shot, int exc)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2638</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b80282dd477cfb811a5ca903a6616b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b80282dd477cfb811a5ca903a6616b1">&#9670;&nbsp;</a></span>ksfse_scan_acqloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_scan_acqloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all phase encodes for all slices belonging to one pass</h4>
</p>
<p>This function traverses through all shots (<code>ksfse.phaseenc_plan.num_shots</code>) to be played out and runs the <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a> for each set of shots and excitation. If ksfse_dda &gt; 0, dummy scans will be played out before the phase encoding begins.</p>
<p>In the case of inversion, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is called instead of <a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a>, where the former takes a function pointer to <a class="el" href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08" title="Wrapper function to ksfse_scan_coreslice() with standardized input arguments">ksfse_scan_coreslice_nargs()</a> in order to be able to play out the coreslice in a timing scheme set by <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>0-based pass index in range <code>[0, ks_slice_plan.npasses - 1]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">passlooptime</td><td>Time taken in [us] to play out all phase encodes and excitations for <code>slperpass</code> slices. Note that the value is a <code>float</code> instead of <code>int</code> to avoid int overrange at 38 mins of scanning </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                                       {</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="keywordtype">int</span> shot, exc;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;  <span class="keywordflow">for</span> (shot = -<a class="code" href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a>; shot &lt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">num_shots</a>; shot++) {</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="comment">/* shot &lt; 0 means dummy scans, and is handled in ksfse_scan_coreslice(), ksfse_scan_seqstate() and ksfse_etlphaseamps() */</span></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keywordflow">if</span> (shot == 0 &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a> &gt; 0) {</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a>);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    }</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    <span class="keywordflow">for</span> (exc = 0; exc &lt; (int) ceil(opnex); exc++) { <span class="comment">/* ceil rounds up opnex &lt; 1 (used for partial Fourier) to 1 */</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;        <span class="keywordtype">void</span> *args[2] = {(<span class="keywordtype">void</span> *) &amp;shot, (<span class="keywordtype">void</span> *) &amp;exc}; <span class="comment">/* pass on args via ksinv_scan_sliceloop() to ksfse_scan_coreslice() */</span></div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="keywordtype">int</span> nargs = <span class="keyword">sizeof</span>(args) / <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *);</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        time += (float) <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>,</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                                              (shot &lt; 0) ? <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a> : <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>, <a class="code" href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08">ksfse_scan_coreslice_nargs</a>, nargs, args);</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        time += (float) <a class="code" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d">ksfse_scan_sliceloop</a>(<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot, exc);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      }</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a>(<span class="stringliteral">&quot;ksfse shots&quot;</span>);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    } <span class="comment">/* for exc */</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="comment">/* save a frame of the main sequence for later generation of an animated GIF (only in MgdSim, WTools) */</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    <span class="keywordflow">if</span> (shot &gt;= 0) {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;    }</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  } <span class="comment">/* for shot */</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a>);</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;} <span class="comment">/* ksfse_scan_acqloop() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_aa2f98be84137da8386df3fc88763823c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">KS_PHASEENCODING_PLAN::num_shots</a></div><div class="ttdeci">int num_shots</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1587</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ab7af5654e8b4db142fb80465d6f256f7"><div class="ttname"><a href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a></div><div class="ttdeci">int ksfse_dda</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:126</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa4d70e1b753a44f18ce002ecb84cd16e"><div class="ttname"><a href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a></div><div class="ttdeci">void ks_plot_tgt_addframe(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3151</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aadb6109f3b3f75f81b46e153f9eb11f0"><div class="ttname"><a href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a></div><div class="ttdeci">void ks_plot_slicetime_endofslicegroup(const char *desc)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3091</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:198</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a0d7d7a81235745c6e98201f2e15fbe08"><div class="ttname"><a href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08">ksfse_scan_coreslice_nargs</a></div><div class="ttdeci">int ksfse_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksfse_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2598</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:200</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a6484a51a27836574d96417d2f0a3655d"><div class="ttname"><a href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d">ksfse_scan_sliceloop</a></div><div class="ttdeci">int ksfse_scan_sliceloop(int slperpass, int passindx, int shot, int exc)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2638</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab8c26ea9ee8534faf737bbc61223253e"><div class="ttname"><a href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a></div><div class="ttdeci">void ks_plot_slicetime_endofpass()</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSFSE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:61</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84c1aabd1ad5e03c56dba64cccd5f650"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c1aabd1ad5e03c56dba64cccd5f650">&#9670;&nbsp;</a></span>ksfse_scan_scanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_scan_scanloop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all volumes and passes of a single or multi-pass scan</h4>
</p>
<p>This function performs the entire scan and traverses through passes and volumes. For now, since <code>opmph = 0</code> as multiphase is controlled outside the psd via PSD_IOPT_DYNPL, opfphases will always be 1. For each <code>passindx</code> (in range <code>[0, ks_slice_plan.npasses-1]</code>), <a class="el" href="ksfse__implementation_8e.html#a1b80282dd477cfb811a5ca903a6616b1" title="Plays out all phase encodes for all slices belonging to one pass">ksfse_scan_acqloop()</a> will be called to acquire all data for the current set of slices belong to the current pass (acquisition). At the end of each pass, <a class="el" href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5" title="Sets SSP word in sequence off_GEpass() to trigger data (Pfile) writing and reconstruction">GEReq_endofpass()</a> is called to trigger GE's recon and to dump Pfiles (if <code>autolock = 1</code>).</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">scantime</td><td>Total scan time in [us] (<code>float</code> to avoid int overrange after 38 mins) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                            {</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> = 0; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; opfphases; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>++) { <span class="comment">/* opfphases is # volumes (BUT: opfphases always 1 since opmph = 0) */</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0; <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>; <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>++) { <span class="comment">/* acqs = passes */</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      time += <a class="code" href="ksfse__implementation_8e.html#a1b80282dd477cfb811a5ca903a6616b1">ksfse_scan_acqloop</a>(<a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>);</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="preprocessor">#ifdef IPG</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <a class="code" href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a>();</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    } <span class="comment">/* end: acqs (pass) loop */</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  } <span class="comment">/* end: volume loop */</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;} <span class="comment">/* ksfse_scan_acqloop() */</span></div><div class="ttc" id="_g_e_required_8e_html_a7d88db21119d2904e811676cff0a49a5"><div class="ttname"><a href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a></div><div class="ttdeci">void GEReq_endofpass()</div><div class="ttdoc">Sets SSP word in sequence off_GEpass() to trigger data (Pfile) writing and reconstruction</div><div class="ttdef"><b>Definition:</b> GERequired.e:2565</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a9cd9ebd93187231e5c4109d14c0dd69c"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">KS_SLICE_PLAN::npasses</a></div><div class="ttdeci">int npasses</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1201</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a1b80282dd477cfb811a5ca903a6616b1"><div class="ttname"><a href="ksfse__implementation_8e.html#a1b80282dd477cfb811a5ca903a6616b1">ksfse_scan_acqloop</a></div><div class="ttdeci">float ksfse_scan_acqloop(int)</div><div class="ttdoc">Plays out all phase encodes for all slices belonging to one pass</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2740</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01c14f0885b7400680196de955b96be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01c14f0885b7400680196de955b96be9">&#9670;&nbsp;</a></span>ksfse_scan_seqstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_scan_seqstate </td>
          <td>(</td>
          <td class="paramtype">SCAN_INFO&#160;</td>
          <td class="paramname"><em>slice_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the current state of all ksfse sequence objects being part of <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a></h4>
</p>
<p>This function sets the current state of all ksfse sequence objects being part of <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a>, incl. gradient amplitude changes, RF freq/phases and receive freq/phase based on current slice position and phase encoding indices.</p>
<p>The idea of having a 'seqstate' function is to be able to come back to a certain sequence state at any time and possibly play it out once more. This could for example be useful when certain lines or slices need to be rescanned due to image artifacts detected during scanning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_info</td><td>Position of the slice to be played out (one element in the <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index in range <code>[0, ksfse.phaseenc_plan.num_shots - 1]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                                                           {</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <span class="keywordtype">float</span> rfphase = 0.0;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a>(slice_info);</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>,    0,        slice_info, rfphase <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, INSTRALL, slice_info, rfphase + 90 <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, INSTRALL, slice_info, rfphase + 90 <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>,    INSTRALL, slice_info, rfphase + 90 <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a>) {</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>, INSTRALL, slice_info, rfphase + 90 <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>, 0, slice_info, rfphase <span class="comment">/* [deg] */</span>);</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;  }</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <span class="comment">/* FOV offsets (by changing freq/phase of ksfse.read) */</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">if</span> (shot &gt;= 0) {</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a>; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;      coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, shot);</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        <span class="keywordtype">float</span> zfovratio = (opslquant * <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>) / <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a>;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordtype">float</span> zchop_phase = 0.0;</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        <span class="keywordflow">if</span> (oparc &amp;&amp; (coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a> % 2)) {</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;          <span class="comment">/* GEs ARC recon ignores RHF_ZCHOP bit in &#39;rhformat&#39;, but expects 3D data to be z-chopped for proper slice sorting.</span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="comment">          In GERequired.e:GEReq_predownload_setrecon_voldata(), RHF_ZCHOP is unset by default. In combination with</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">          that we do not do zchop for non-ARC scans (incl ASSET), this works well. But for ARC scans, we must zchop. That is,</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">          we add 180 phase to every odd kz encoded line, which is the same as a final z fftshift in the image domain */</span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;          zchop_phase = 180.0;</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;        }</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a368695617a7edf4fdba05325573efb12">ks_scan_offsetfov3D</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, slice_info, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>, opphasefov, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>, zfovratio, rfphase + zchop_phase);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a11a9b9d761ba64a74b88c222b2a949e3">ks_scan_offsetfov</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, slice_info, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>, opphasefov, rfphase);</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;      }</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    } <span class="comment">/* etl */</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  } <span class="comment">/* shot &gt; 0 */</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">/* change phase encoding amplitudes */</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a10ee8f888f2b3eece931b22925a69930">ksfse_etlphaseamps</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a> : NULL, shot);</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="comment">/* change spoiler amplitude */</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a0a83b6497cfecf4d5fe14f598a3751af">ksfse_spoilamp</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>, shot);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  <span class="comment">/* Turn off T1-w opt. in DDAs */</span></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a>) &amp;&amp; (shot &lt; 0)) {</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, 0);</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, 0);</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  }</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;} <span class="comment">/* ksfse_scan_seqstate() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a11a9b9d761ba64a74b88c222b2a949e3"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a9b9d761ba64a74b88c222b2a949e3">ks_scan_offsetfov</a></div><div class="ttdeci">void ks_scan_offsetfov(KS_READTRAP *readtrap, int instanceno, SCAN_INFO sliceinfo, int view, float phasefovratio, float rcvphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a KS_READTRAP to create a FOV shift...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:905</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSFSE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae8766ce800f95dd75ca2eece6638326c"><div class="ttname"><a href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, float rfphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:532</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_PHASEENCODING_PLAN::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1588</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a10ee8f888f2b3eece931b22925a69930"><div class="ttname"><a href="ksfse__implementation_8e.html#a10ee8f888f2b3eece931b22925a69930">ksfse_etlphaseamps</a></div><div class="ttdeci">STATUS ksfse_etlphaseamps(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, KS_PHASER *phaser, KS_PHASER *zphaser, int shot)</div><div class="ttdoc">Sets the phase encoding amplitudes in the FSE train on hardware using the phase enc. table and shot index</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2008</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a0a83b6497cfecf4d5fe14f598a3751af"><div class="ttname"><a href="ksfse__implementation_8e.html#a0a83b6497cfecf4d5fe14f598a3751af">ksfse_spoilamp</a></div><div class="ttdeci">void ksfse_spoilamp(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, KS_TRAP *spoiler, int res, int shot)</div><div class="ttdoc">2DFSE: Updates the spoiler amplitude on hardware during scanning depending on current etl and shot...</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2052</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2fdfe2e655a76c4cd4fb1dac16d1834b"><div class="ttname"><a href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a></div><div class="ttdeci">void ks_scan_rotate(SCAN_INFO slice_info)</div><div class="ttdoc">Performs a rotation of the logical system on hardware (WARP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:988</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a368695617a7edf4fdba05325573efb12"><div class="ttname"><a href="_k_s_foundation_8h.html#a368695617a7edf4fdba05325573efb12">ks_scan_offsetfov3D</a></div><div class="ttdeci">void ks_scan_offsetfov3D(KS_READTRAP *readtrap, int instanceno, SCAN_INFO sliceinfo, int kyview, float phasefovratio, int kzview, float zphasefovratio, float rcvphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a KS_READTRAP to create a FOV shift...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:912</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7b6b5ece7f3021e6f7d9003799a01163"><div class="ttname"><a href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a></div><div class="ttdeci">int ksfse_recovery</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:100</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSFSE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:61</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f2c867dda89628c257585dd4357e682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f2c867dda89628c257585dd4357e682">&#9670;&nbsp;</a></span>ksfse_init_imagingoptions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksfse_init_imagingoptions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial handling of imaging options buttons and top-level CVs at the PSD type-in pages</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                     {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">int</span> numopts = <span class="keyword">sizeof</span>(<a class="code" href="ksfse__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  psd_init_iopt_activity();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  activate_iopt_list(numopts, <a class="code" href="ksfse__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  enable_iopt_list(numopts, <a class="code" href="ksfse__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="comment">/* Imaging option control functions (using PSD_IOPT_ZIP_512 as example):</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    - Make an option unchecked and not selectable: disable_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    - Make an option checked and not selectable:   set_required_disabled_option(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    - Remove the imaging option:                   deactivate_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  cvmax(opimode, PSD_3DM);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="comment">/* Button accept control */</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  cvmax(opepi, PSD_OFF); <span class="comment">/* don&#39;t allow EPI selection */</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  cvmax(opfast, PSD_ON);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  cvmax(opssfse, PSD_ON);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  cvmax(opflair, OPFLAIR_INTERLEAVED);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  cvmax(optlrdrf, PSD_ON);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  cvmax(opfr, PSD_ON);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    pidefexcitemode = NON_SELECTIVE;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    piexcitemodenub = 1 + 2 <span class="comment">/* + 4 FOCUS */</span>;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    cvmax(opexcitemode, NON_SELECTIVE);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">/* For now, 3D is not compatible with: */</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    deactivate_ioption(PSD_IOPT_T1FLAIR);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    deactivate_ioption(PSD_IOPT_T2FLAIR);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    deactivate_ioption(PSD_IOPT_IR_PREP);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    deactivate_ioption(PSD_IOPT_TLRD_RF);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">#ifdef SIM</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  oppseq = PSD_SE;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  setexist(oppseq, PSD_ON);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  opfast = PSD_ON;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  setexist(opfast, PSD_ON);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  opirmode = PSD_OFF; <span class="comment">/* default interleaved slices */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  setexist(opirmode, PSD_ON);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;} <span class="comment">/* ksfse_init_imagingoptions() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a8f39fad60409167fe45164b72a131e0b"><div class="ttname"><a href="ksfse__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a></div><div class="ttdeci">int sequence_iopts[]</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:195</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7072470234e07e0805d82b222e8fdab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7072470234e07e0805d82b222e8fdab">&#9670;&nbsp;</a></span>ksfse_init_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_init_UI </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial setup of user interface (UI) with default values for menus and fields</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                           {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">/* IR always in interleaved mode */</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (oppseq == PSD_IR) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    cvoverride(opirmode, PSD_OFF, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  acq_type = TYPSPIN; <span class="comment">/* loadrheader.e rheaderinit: sets eeff = 1 */</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">/* rBW */</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  cvmin(oprbw, 2);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  cvmax(oprbw, 250.0);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  pircbnub  = 31; <span class="comment">/* number of variable bandwidth */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">if</span> (opssfse == PSD_ON) {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    pidefrbw = 62.50 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    pidefrbw = 41.67 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  pircbval2 = 31.25 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  pircbval3 = 41.67 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  pircbval4 = 50.00 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  pircbval5 = 62.50 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  pircbval6 = 83.33 * (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> / 30000.0);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  cvdef(oprbw, pidefrbw);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  oprbw = _oprbw.defval;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  pircb2nub = 0; <span class="comment">/* no second bandwidth option */</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="comment">/* NEX */</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  pinexnub = 63;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (opssfse == PSD_ON) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    cvdef(opnex, 0.6);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    cvmin(opnex, 0.55);</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    cvmax(opnex, 100);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    pinexval2 = 0.55;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    pinexval3 = 0.575;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    pinexval4 = 0.60;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    pinexval5 = 0.625;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    pinexval6 = 0.65;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    cvdef(opnex, 1);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    cvmin(opnex, 0.55);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    cvmax(opnex, 100);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    pinexval2 = 0.65;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    pinexval3 = 0.75;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    pinexval4 = 0.85;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    pinexval5 = 1;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    pinexval6 = 2;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  }</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  opnex = _opnex.defval;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">/* FOV */</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> = 240;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  pifovnub = 4; <span class="comment">/* show the first three + type-in */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  pifovval2 = 180;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  pifovval3 = 220;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  pifovval4 = 240;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  pifovval5 = 260;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  pifovval6 = 280;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">/* phase FOV fraction */</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  opphasefov = 1;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  piphasfovnub2 = 63;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  piphasfovval2 = 1.0;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  piphasfovval3 = 0.9;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  piphasfovval4 = 0.8;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  piphasfovval5 = 0.7;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  piphasfovval6 = 0.6;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="comment">/* freq (x) resolution */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 16);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 64);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a> = _opxres.defval;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  pixresnub = 63;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  pixresval2 = 192;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  pixresval3 = 224;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  pixresval4 = 256;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  pixresval5 = 320;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  pixresval6 = 384;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">/* phase (y) resolution */</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 16);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  piyresnub = 63;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (opssfse == PSD_ON) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    piyresval2 = 64;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    piyresval3 = 128;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    piyresval4 = 160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    piyresval5 = 192;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    piyresval6 = 256;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 16); <span class="comment">/* init low for SSFSE to avoid too long sequence length before proper values have been chosen */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    piyresval2 = 192;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    piyresval3 = 224;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    piyresval4 = 256;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    piyresval5 = 320;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    piyresval6 = 384;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 128);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> = _opyres.defval;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="comment">/* Num echoes */</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  piechnub = 0;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  cvdef(opnecho, 1);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  cvmax(opnecho, 1);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">/* ETL */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  avminetl = 1;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  avmaxetl = 256;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">if</span> (opssfse == PSD_ON) {</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a> &gt; 0)</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      cvdef(opetl, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      cvdef(opetl, _opyres.defval);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    opetl = _opetl.defval;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    pietlnub = 0;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">/* 2D */</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;       <span class="keywordflow">if</span> (opflair == FALSE) {</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">if</span> (optr &lt; 1s) {</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="comment">/* T1-w */</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          cvdef(opetl, 1);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          opetl = _opetl.defval;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          pietlnub = 63;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          pietlval2 = 1;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          pietlval3 = 2;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          pietlval4 = 3;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          pietlval5 = 4;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          pietlval6 = 8;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="comment">/* T2-w */</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          cvdef(opetl, 16);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          opetl = _opetl.defval;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          pietlnub = 63;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          pietlval2 = 8;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          pietlval3 = 12;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;          pietlval4 = 16;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;          pietlval5 = 20;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;          pietlval6 = 24;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP) { <span class="comment">/* T2-FLAIR */</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        cvdef(opetl, 24);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        opetl = _opetl.defval;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        pietlnub = 63;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        pietlval2 = 20;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        pietlval3 = 24;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        pietlval4 = 28;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        pietlval5 = 32;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        pietlval6 = 36;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opflair == OPFLAIR_INTERLEAVED) { <span class="comment">/* T1-FLAIR */</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        cvdef(opetl, 8);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        opetl = _opetl.defval;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        pietlnub = 63;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        pietlval2 = 4;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        pietlval3 = 5;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        pietlval4 = 6;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        pietlval5 = 7;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        pietlval6 = 8;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <span class="comment">/* 3D */</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      cvdef(opetl, 32);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      opetl = _opetl.defval;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      pietlnub = 63;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      pietlval2 = 32;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      pietlval3 = 48;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      pietlval4 = 64;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      pietlval5 = 96;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      pietlval6 = 128;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  } <span class="comment">/* non-ssfse ETL menu */</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">/* TE */</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  pitetype = PSD_LABEL_TE_EFF; <span class="comment">/* alt. PSD_LABEL_TE_EFF */</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (! existcv(opte)) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    avmaxte = 2s;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    avminte = 0;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    cvmin(opte, avminte);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    cvmax(opte, avmaxte);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    cvdef(opte, 100ms);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    opte = _opte.defval;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5">ksfse_eval_TEmenu</a>(10ms <span class="comment">/* fake esp */</span>, 200ms <span class="comment">/* fake maxte */</span>, opetl, opetl / 2.0);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">/* TE2 */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  pite2nub = 0;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">/* TR */</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  cvdef(optr, 5s);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  optr = _optr.defval;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">   If you want values (pitrval) in the dropdown menu, change to pitrnub = 6;. </span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">   Remember that you can control the minimum and maximum TR-range </span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">   from the advanced tab using opuser18 &amp; 19. </span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  pitrnub = 2;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  pitrval2 = PSD_MINIMUMTR;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  pitrval3 = 500ms;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  pitrval4 = 3000ms;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  pitrval5 = 4000ms;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  pitrval6 = 5000ms;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">/* FA of refocusing pulse */</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  cvmax(opflip, 360);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  cvdef(opflip, 125); <span class="comment">/* set it low to avoid init errors on sequence selection */</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  opflip = _opflip.defval;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 24</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  pifamode = PSD_FLIP_ANGLE_MODE_REFOCUS;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  pifanub = 5;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  pifaval2 = 110;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  pifaval3 = 125;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  pifaval4 = 140;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  pifaval5 = 160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  pifanub = 0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">/* slice thickness */</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  pistnub = 5;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 1);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    pistval2 = 0.8;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    pistval3 = 0.9;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    pistval4 = 1;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    pistval5 = 1.5;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    pistval5 = 2;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 4);</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    pistval2 = 2;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    pistval3 = 3;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    pistval4 = 4;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    pistval5 = 5;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    pistval6 = 10;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> = _opslthick.defval;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">/* slice spacing */</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  cvdef(opslspace, 0);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  opslspace = _opslspace.defval;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  piisil = PSD_ON;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">/* change these to do overlaps */</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    piisnub = 0;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    piisnub = 5;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    piisval3 = 0.5;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    piisval4 = 1;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    piisval5 = 2;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    piisval6 = 3;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">/* default # of slices */</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  cvdef(opslquant, 30);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">/* 3D slice settings */</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    pimultislab = 0; <span class="comment">/* 0: forces only single slab, 1: allow multi-slab (won&#39;t work with non-selective refocusing pulses) */</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    pilocnub = 4;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    pilocval2 = 28;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    pilocval3 = 60;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    pilocval4 = 124;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    pilocval5 = 252;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">/* opslquant = #slices in slab. opvquant = #slabs */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    cvdef(opslquant, 32);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  opslquant = _opslquant.defval;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">/* Multi phase (i.e. multi volumes) (only active if PSD_IOPT_MPH, not PSD_IOPT_DYNPL) */</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keywordflow">if</span> (opmph) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    pimphscrn = 1;   <span class="comment">/* display Multi-Phase Parameter screen */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    pifphasenub = 6;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    pifphaseval2 = 1;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    pifphaseval3 = 2;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    pifphaseval4 = 5;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    pifphaseval5 = 10;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    pifphaseval6 = 15;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    pisldelnub = 0;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    piacqnub = 0;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    setexist(opacqo, 1);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    pihrepnub = 0;  <span class="comment">/* no XRR gating */</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    cvoverride(opfphases, 1, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  <span class="comment">/* opuser0: show GIT revision (GITSHA) using REV variable from the Imakefile */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordtype">char</span> userstr[100];</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">#ifdef REV</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  sprintf(userstr, <span class="stringliteral">&quot;    %s PSD version: %s&quot;</span>, _ksfse_flipexc.descr, REV);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  sprintf(userstr, <span class="stringliteral">&quot;%s&quot;</span>, _ksfse_flipexc.descr);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  cvmod(opuser0, _ksfse_flipexc.minval, _ksfse_flipexc.maxval, _ksfse_flipexc.defval, userstr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  opuser0 = _opuser0.defval;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  piuset |= use0;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">/* opuser1: TE based on ETL. */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  cvmod(opuser1, _ksfse_etlte.minval, _ksfse_etlte.maxval, _ksfse_etlte.defval, _ksfse_etlte.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  opuser1 = _ksfse_etlte.defval;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a> = _ksfse_etlte.defval;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">if</span> (opssfse) {</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    piuset &amp;= ~use1; <span class="comment">/* don&#39;t show for SSFSE */</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    piuset |= use1; <span class="comment">/* show since not SSFSE */</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  cvmod(opuser2, _ksfse_inflowsuppression.minval, _ksfse_inflowsuppression.maxval, _ksfse_inflowsuppression.defval, _ksfse_inflowsuppression.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  piuset |= use2;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  opuser2 = _ksfse_inflowsuppression.defval;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (opfr == FALSE &amp;&amp; (oppseq != PSD_IR <span class="comment">/* 3 */</span> &amp;&amp; opirprep == FALSE &amp;&amp; opflair == FALSE) &amp;&amp; opssfse == FALSE &amp;&amp; exist(opetl) &gt; 1) {</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="comment">/* if FSE-XL has been selected, allow T1-w optimization */</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    cvmod(opuser3, 0, 1, 0, <span class="stringliteral">&quot;T1-w Optimization [0:OFF 1:ON]&quot;</span>, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    opuser3 = _opuser3.defval;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    piuset |= use3;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    opuser3 = 0;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    piuset &amp;= ~use3;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="comment">/* In-range TR support (but without using GE&#39;s opinrangetr, since we don&#39;t know</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">     how to read the AutoTR field values on the Advanced tab. Instead, for now, add two opusers</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">     for the range. If any of these are = 0, it is disabled */</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  cvmod(opuser4, _ksfse_mintr.minval/1000, _ksfse_mintr.maxval/1000, _ksfse_mintr.defval/1000, _ksfse_mintr.descr, 0, <span class="stringliteral">&quot; &quot;</span>); <span class="comment">/* minTR in [ms] */</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  opuser4 = _opuser4.defval;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  piuset |= use4;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  cvmod(opuser5, _ksfse_maxtr.minval/1000, _ksfse_maxtr.maxval/1000, _ksfse_maxtr.defval/1000, _ksfse_maxtr.descr, 0, <span class="stringliteral">&quot; &quot;</span>); <span class="comment">/* maxTR in [ms] */</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  opuser5 = _opuser5.defval;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    piuset &amp;= ~use5; <span class="comment">/* Don&#39;t show maxTR limit for T2FLAIR */</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    piuset |= use5;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <span class="keywordflow">if</span> (opflair != OPFLAIR_GROUP) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    _rf_stretch_all.defval = 1.5; <span class="comment">/* Wider default (except for T2FLAIR which is less SAR heavy) to shorten the scan time (less SAR penalty) */</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    _rf_stretch_all.defval = 1.0;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  cvmod(opuser6, 1.0, _rf_stretch_all.maxval,  _rf_stretch_all.defval, _rf_stretch_all.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  opuser6 = _rf_stretch_all.defval;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  piuset |= use6;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">     Reserved opusers:</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">     ksfse_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">/* Acceleration menu as decimal numbers (max accel = 4) */</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <a class="code" href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a>(<a class="code" href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae">KS_ACCELMENU_FRACT</a>, 4);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="comment">/* Acceleration menu as integers (max accel = 4)</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">       Covers the non-accelerated and ASSET cases */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <a class="code" href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a>(<a class="code" href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a>, 4);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;} <span class="comment">/* ksfse_init_UI() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1747</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a09b1a7dc77a7cf8c4e8421a23608a42a"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">KS_PHASER::numlinestoacq</a></div><div class="ttdeci">int numlinestoacq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1532</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efaf1ab60443a3f1764b91d306bec1112ae">KS_ACCELMENU_FRACT</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1747</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a257cccbbaeda541ca5250d16adc5c8c5"><div class="ttname"><a href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5">ksfse_eval_TEmenu</a></div><div class="ttdeci">void ksfse_eval_TEmenu(int esp, int maxte, int etl, double optechono)</div><div class="ttdoc">Sets up the TE menu based on echo spacing, max TE, ETL and the optimal echo index</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:801</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_g_e_required_8e_html_a05e7d139f5f41deb6ed1c934ed6c6e64"><div class="ttname"><a href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a></div><div class="ttdeci">STATUS GEReq_init_accelUI(int integeraccel, int maxaccel)</div><div class="ttdoc">Sets up the menu for parallel imaging (ARC or ASSET) with max/min range</div><div class="ttdef"><b>Definition:</b> GERequired.e:427</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ac0677ae1147b74362792c5014c638e65"><div class="ttname"><a href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a></div><div class="ttdeci">int ksfse_etlte</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:110</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0941dfd16b0a412b0665b985e05f8267"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0941dfd16b0a412b0665b985e05f8267">&#9670;&nbsp;</a></span>ksfse_eval_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_UI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Gets the current UI and checks for valid inputs</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                       {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac7072470234e07e0805d82b222e8fdab">ksfse_init_UI</a>() == FAILURE)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">/*** Copy UserCVs to human readable CVs ***/</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a4f4f25a4252632f0f86c71ce5d24127c">ksfse_flipexc</a> = opuser0;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a> = (int) opuser1;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a> != PSD_OFF &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a> != PSD_ON) {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;&#39;ETL controls TE&#39; flag must be either [0:OFF, 1:ON]&quot;</span>); <span class="comment">/* User error */</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (existcv(opetl)) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">/* if ETL has been selected, adjust TR menu to either T1-w or T2-w mode */</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span> (exist(opetl) &lt; 6) {</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      pitrval3 = 450ms;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      pitrval4 = 500ms;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      pitrval5 = 550ms;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      pitrval6 = 600ms;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      pitrval3 = 2500ms;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      pitrval4 = 3000ms;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      pitrval5 = 4000ms;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      pitrval6 = 5000ms;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">/* Inflow suppression (only if spacing or multiple acqs) */</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keywordflow">if</span> (existcv(opslquant) &amp;&amp; (opslspace &gt; 0.0 || avmaxacqs &gt; 1)) {</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a> = opuser2;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    cvoverride(<a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a> &gt; 0) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    cvdesc(opuser2, <span class="stringliteral">&quot;In-flow suppression 0:OFF [1:ON]&quot;</span>); <span class="comment">/* Highlight ON */</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    cvdesc(opuser2, <span class="stringliteral">&quot;In-flow suppression [0:OFF] 1:ON&quot;</span>); <span class="comment">/* Highlight OFF */</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  }</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="comment">/* Fast recovery / T1w optimization */</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">if</span> (opuser3 &gt; 0) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a> = <a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4">KSFSE_RECOVERY_T1WOPT</a>;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opfr) {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a> = <a class="code" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a> = 0;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="comment">/* Min/Max TR */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">char</span> tmpstr[100];</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  (<a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a>) = RUP_GRD((<span class="keywordtype">int</span>) opuser4 * 1000); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  (<a class="code" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a>) = RUP_GRD((<span class="keywordtype">int</span>) opuser5 * 1000); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">/* T2FLAIR */</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    (<a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>) = (<a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> &gt; 0) ? <a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> : _ksinv_mintr_t2flair.defval;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> &gt; 0)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Min TR (ms) [0: Auto]&quot;</span>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Min TR (ms) [0: Auto (%d)]&quot;</span>, _ksinv_mintr_t2flair.defval/1000);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    cvdesc(opuser4, tmpstr);</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opflair == OPFLAIR_INTERLEAVED) {</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">/* T1FLAIR */</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    (<a class="code" href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a>) = (<a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> &gt; 0) ? <a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> : _ksinv_mintr_t1flair.defval;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    (<a class="code" href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a>) = (<a class="code" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a> &gt; 0) ? <a class="code" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a> : _ksinv_maxtr_t1flair.defval;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a> &gt; 0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Min TR (ms) [0: Auto]&quot;</span>);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Min TR (ms) [0: Auto (%d)]&quot;</span>, _ksinv_mintr_t1flair.defval/1000);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    cvdesc(opuser4, tmpstr);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a> &gt; 0)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Max TR (ms) [0: Auto]&quot;</span>);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;Max TR (ms) [0: Auto (%d)]&quot;</span>, _ksinv_maxtr_t1flair.defval/1000);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    cvdesc(opuser5, tmpstr);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    cvdesc(opuser4, _ksfse_mintr.descr);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    cvdesc(opuser5, _ksfse_maxtr.descr);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="comment">/* overall RF pulse stretching */</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> = opuser6;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">/* Reserved opusers:</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">     ksfse_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;} <span class="comment">/* ksfse_eval_UI() */</span></div><div class="ttc" id="ksfse__implementation_8e_html_a10ce223033aad0afd68255485629bdf7"><div class="ttname"><a href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a></div><div class="ttdeci">int ksfse_inflowsuppression</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:84</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aedcaff264fe0d9a3f5f21f798294df71"><div class="ttname"><a href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a></div><div class="ttdeci">int ksinv_mintr_t2flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:157</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_afa069f8db856d8cb0f1f3510e71904a5"><div class="ttname"><a href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a></div><div class="ttdeci">float rf_stretch_all</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:95</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ac7072470234e07e0805d82b222e8fdab"><div class="ttname"><a href="ksfse__implementation_8e.html#ac7072470234e07e0805d82b222e8fdab">ksfse_init_UI</a></div><div class="ttdeci">STATUS ksfse_init_UI(void)</div><div class="ttdoc">Initial setup of user interface (UI) with default values for menus and fields</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:283</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a4f4f25a4252632f0f86c71ce5d24127c"><div class="ttname"><a href="ksfse__implementation_8e.html#a4f4f25a4252632f0f86c71ce5d24127c">ksfse_flipexc</a></div><div class="ttdeci">float ksfse_flipexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:81</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab3fa4125b24bcc3e5d7f0ffacc32d86b"><div class="ttname"><a href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a></div><div class="ttdeci">int ksinv_maxtr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:159</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4"><div class="ttname"><a href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a68bc8d732fb82149412c2611f9b691d4">KSFSE_RECOVERY_T1WOPT</a></div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:40</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ad232fff30fc715e9baa395aab5d40bd5"><div class="ttname"><a href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a></div><div class="ttdeci">int ksfse_maxtr</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:131</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7b6b5ece7f3021e6f7d9003799a01163"><div class="ttname"><a href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a></div><div class="ttdeci">int ksfse_recovery</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:100</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acc139f545253464349e788315546ee0a"><div class="ttname"><a href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a></div><div class="ttdeci">int ksinv_mintr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:158</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ac0677ae1147b74362792c5014c638e65"><div class="ttname"><a href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a></div><div class="ttdeci">int ksfse_etlte</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:110</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a3c49bc9f0980dd02a99cd26b933b7131"><div class="ttname"><a href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a></div><div class="ttdeci">int ksfse_mintr</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:130</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7ffee4e96e25132c8bafafa3aeb3d5ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ffee4e96e25132c8bafafa3aeb3d5ba">&#9670;&nbsp;</a></span>ksfse_eval_esp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_eval_esp </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>min90_180</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>min180_echo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slicecheck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>seq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates echo spacing for the sequence</h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">min90_180</td><td>Pointer to the time between moment start of the excitation pulse to the center of the refocusing pulse in [us] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">min180_echo</td><td>Pointer to the time between center of the refocusing pulse to the center of the first echo in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slicecheck</td><td>0: Normal mode 1: Slice check mode, where the readout is moved to the slice axis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Pointer to <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">echospacing</td><td>Echo Spacing in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                                                                          {</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordtype">int</span> echospacing;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">/*** minimum time needed between RF exc center to RF ref center ***/</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">/* latter portion of RF pulse incl ramptime of slice sel grad */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  *min90_180 = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keywordflow">if</span> (slicecheck) {</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">/* need separate time for read dephaser */</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    *min90_180 += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> +</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">/* max of seq-&gt;readdephaser and time from end of rfexc grad plateau to beginning of plateau for rfrefocus */</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    *min90_180 += IMax(2,</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                       seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> <span class="comment">/* X */</span>,</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                       seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> <span class="comment">/* Z */</span>);</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  *min90_180 += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>; <span class="comment">/* slice selection time until RF center */</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="comment">/*** minimum time needed between RF ref center and echo center ***/</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  *min180_echo = IMax(3, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (slicecheck) {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    *min180_echo += IMax(4,</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                        seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> <span class="comment">/* Y */</span>,</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                        seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>                + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> <span class="comment">/* Z 1st echo */</span>,</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                        (opetl &gt; 1) * (seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>) <span class="comment">/* Z 2nd echo */</span>,</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                        (opetl &gt; 2) * (seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>    + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>    + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>) <span class="comment">/* Z 3-Nth echo */</span>);</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    *min180_echo += IMax(5,</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                        seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> <span class="comment">/* X */</span>,</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> <span class="comment">/* Y */</span>,</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                        seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>                + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> <span class="comment">/* Z 1st echo */</span>,</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                        (opetl &gt; 1) * (seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) <span class="comment">/* Z 2nd echo */</span>,</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;                        (opetl &gt; 2) * (seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>    + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>    + seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) <span class="comment">/* Z 3-Nth echo */</span>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    *min180_echo += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>; <span class="comment">/* time from start of acquisition to k-space center */</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  echospacing = IMax(2, *min90_180, *min180_echo) * 2;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  echospacing = RUP_FACTOR(echospacing, 16);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">return</span> echospacing;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;}</div><div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSFSE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:51</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_READTRAP::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1434</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbe70d8840f6d66615bf7dfa411a5177"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe70d8840f6d66615bf7dfa411a5177">&#9670;&nbsp;</a></span>ksfse_eval_optimalkxnover()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_eval_optimalkxnover </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>seq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates the optimal number of k-space points for partial kx Fourier that does not increase TE</h4>
</p>
<p>This function plays by the following rules:</p><ol type="1">
<li>CV ksfse_kxnover_min is the lowest number of samples allowed</li>
<li>ksfse.read.res/2 is the highest number of samples allowed</li>
<li>Increase <code>kxnover</code> until an increase in TE results, while staying within above limits</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Pointer to the <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> struct holding all sequence objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">kxnover</td><td>Optimal number of k-space points beyond half k-space for partial kx Fourier scans. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                                                   {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordtype">int</span> min90_180 = 0; <span class="comment">/* [us] */</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="keywordtype">int</span> min180_echo = 0; <span class="comment">/* [us] */</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordtype">int</span> kxnover = 0; <span class="comment">/* samples */</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a>(&amp;min90_180, &amp;min180_echo, <a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>, seq);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">if</span> (seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a>) {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="comment">/* we are currently using partial Fourier, adjust kxnover to balance the time before and after</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="comment">    the refocusing pulse */</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    kxnover = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> + ((min90_180 - min180_echo) / <a class="code" href="_k_s_foundation_8h.html#a955f51280beb0915d42853ad14eee700">ks_calc_bw2tsp</a>(seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a>));</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="comment">/* we are currently using full Fourier (read.nover = 0) */</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">if</span> (min90_180 &gt; min180_echo) {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="comment">/* more time needed before the 180 anyway, no need to do partial Fourier */</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      kxnover = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> / 2;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      kxnover = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> / 2 - ((min180_echo - min90_180) / <a class="code" href="_k_s_foundation_8h.html#a955f51280beb0915d42853ad14eee700">ks_calc_bw2tsp</a>(seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a>));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  }</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">/* keep in range */</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="keywordflow">if</span> (kxnover &lt; <a class="code" href="ksfse__implementation_8e.html#a5aaa25c865ecd2ee214ba45dfa00a96d">ksfse_kxnover_min</a>) {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    kxnover = <a class="code" href="ksfse__implementation_8e.html#a5aaa25c865ecd2ee214ba45dfa00a96d">ksfse_kxnover_min</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (kxnover &gt; seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> / 2) {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    kxnover = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> / 2;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  kxnover = RUP_GRD(kxnover);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="keywordflow">return</span> kxnover;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;} <span class="comment">/* ksfse_eval_optimalkxnover() */</span></div><div class="ttc" id="ksfse__implementation_8e_html_a7ffee4e96e25132c8bafafa3aeb3d5ba"><div class="ttname"><a href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a></div><div class="ttdeci">int ksfse_eval_esp(int *min90_180, int *min180_echo, int slicecheck, KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Calculates echo spacing for the sequence</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:852</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a955f51280beb0915d42853ad14eee700"><div class="ttname"><a href="_k_s_foundation_8h.html#a955f51280beb0915d42853ad14eee700">ks_calc_bw2tsp</a></div><div class="ttdeci">int ks_calc_bw2tsp(float bw)</div><div class="ttdoc">Convert receiver bandwidth to dwell time</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3367</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a5aaa25c865ecd2ee214ba45dfa00a96d"><div class="ttname"><a href="ksfse__implementation_8e.html#a5aaa25c865ecd2ee214ba45dfa00a96d">ksfse_kxnover_min</a></div><div class="ttdeci">int ksfse_kxnover_min</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:106</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">KS_READTRAP::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1428</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aec461106cf1a6720d4641b9988bfa2cc"><div class="ttname"><a href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a></div><div class="ttdeci">int ksfse_slicecheck</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:93</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e372ec3f75f3e94bd2dd1012a47755c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e372ec3f75f3e94bd2dd1012a47755c">&#9670;&nbsp;</a></span>ksfse_eval_rfstretchfactor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_eval_rfstretchfactor </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>patientweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>flipangle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tailoredrf_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                                                                                            {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="keywordtype">float</span> rfstretchfactor = 1.0;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordtype">float</span> flipangle_factor = 1.0;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordtype">float</span> patientweight_factor = FMax(2, 1.0, patientweight * 0.0055 + 0.6); <span class="comment">/* 1.0 at around 75 kg, never less than 0 */</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="keywordflow">if</span> (tailoredrf_flag) {</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">/* Empirical 2D plane as a function of patient weight and flip angle (for RF pulse set ref_fse1601/2/n)</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">       Important to not let it below ~0.6 when flipangle or patient weight is too small */</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    flipangle_factor = FMax(2, 0.6, 0.0035 * flipangle + 0.15);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    rfstretchfactor = flipangle_factor * patientweight_factor;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">/* Empirical 2D plane as a function of patient weight and flip angle (for RF pulse set ref_se1b4)</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">    Important to not let it below ~0.6 when flipangle or patient weight is too small */</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    flipangle_factor = FMax(2, 0.6, 0.0080 * flipangle - 0.10);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    rfstretchfactor = flipangle_factor * patientweight_factor;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">if</span> (rfstretchfactor &lt; 0.6)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    rfstretchfactor = 0.6; <span class="comment">/* extra level of safety */</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="keywordflow">return</span> rfstretchfactor;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="af38ecec57c34124374ec13fcf4c403d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af38ecec57c34124374ec13fcf4c403d5">&#9670;&nbsp;</a></span>ksfse_eval_setuprfpulses_2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_setuprfpulses_2D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>seq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up the RF objects for the ksfse sequence (2D)</h4>
</p>
<p>This function attempts to mimick the RF scaling and flip angle varation performed in the product fsemaster.e psd, with and without the tailored RF (optlrdrf) option. It is called from <a class="el" href="ksfse__implementation_8e.html#a2fb2b82b4fb1bc27cf72befce0547ba3" title="Sets up all sequence objects for the main sequence module (KSFSE_SEQUENCE ksfse)">ksfse_eval_setupobjects()</a> to set up the RF pulses to keep <a class="el" href="ksfse__implementation_8e.html#a2fb2b82b4fb1bc27cf72befce0547ba3" title="Sets up all sequence objects for the main sequence module (KSFSE_SEQUENCE ksfse)">ksfse_eval_setupobjects()</a> from growing too much in size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Pointer to the <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> struct holding all sequence objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                                                        {</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  STATUS status;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">/* Clear potential gradient waveforms in the KS_SELRF objects before we choose our RF pulses */</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">   *  RF Selections. Flip angle and slice thickness tweaks</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> = <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">if</span> (optlrdrf == TRUE || opetl &gt; 2) {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a2c2f3ffff089ec8ea84810bdc2cba295">exc_fse90</a>;      <span class="comment">/* Excitation */</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a115ae0fe48734b16dc052718ea0844b6">ref_fse1601</a>; <span class="comment">/* 1st Refocusing */</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a37cf0a86072a6ffa18283083029fd360">ref_fse1602</a>; <span class="comment">/* 2nd Refocusing */</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#acaf4c89554c591a5729a462dad9401f2">ref_fse160n</a>;    <span class="comment">/* 3-&gt;ETL Refocusing */</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a> = 0.8;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a> = (<a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a>) ? 0.9 : 0.8;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a5c62a1c075135ed711a8b3f639e441c9">exc_fl901mc</a>;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a> = 0.9;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a> = (<a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a>) ? 1.0 : 0.9;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">/* Stretch factors for RF refocusing pulses */</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a> = <a class="code" href="ksfse__implementation_8e.html#a6e372ec3f75f3e94bd2dd1012a47755c">ksfse_eval_rfstretchfactor</a>(opweight, opflip, optlrdrf);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a> = <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (opsarmode == 0) { <span class="comment">/* normal mode */</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> *= 1.6;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opsarmode == 3) { <span class="comment">/* low SAR mode */</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> *= 3;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  }</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="comment">/* Set flip angles */</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordflow">if</span> (optlrdrf == TRUE &amp;&amp; opetl &gt; 2) {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip + 0.6032 * (180.0 - opflip);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip + 0.1032 * (180.0 - opflip);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> / <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  <span class="comment">/* Optional widening of the excitation pulse when we have slice gap or</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">     interleaved (opileave) slice mode where odd slices are completed and reconstructed</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">     before playing out the even slices */</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a>) {</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a02cc10bf52afa88ba2d4de122965bb81">ksfse_inflowsuppression_mm</a> &lt;= 0) {</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <span class="comment">/* ksfse_inflowsuppression_mm = 0 =&gt; auto thickness */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <span class="keywordtype">int</span> intleavefact = IMax(2, 1, avmaxacqs);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <span class="keywordtype">float</span> newthick = intleavefact * (<a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> + opslspace);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      newthick = FMax(2, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>, newthick); <span class="comment">/* to handle case where newthick is smaller */</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="comment">/* up to the case where newthick is three times the slice thickness */</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = (newthick &lt;= <a class="code" href="ksfse__implementation_8e.html#a713f9b6c2f156e3b05a27a0936da3439">KSFSE_MAXTHICKFACT</a> * <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a>) ? newthick : <a class="code" href="ksfse__implementation_8e.html#a713f9b6c2f156e3b05a27a0936da3439">KSFSE_MAXTHICKFACT</a> * <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a>;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="comment">/* ksfse_inflowsuppression_mm &gt; 0: the user wants to specify how many mm extra the excitation</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">      thickness should be */</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> += <a class="code" href="ksfse__implementation_8e.html#a02cc10bf52afa88ba2d4de122965bb81">ksfse_inflowsuppression_mm</a> / <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  }</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = <a class="code" href="ksfse__implementation_8e.html#a4f4f25a4252632f0f86c71ce5d24127c">ksfse_flipexc</a>; <span class="comment">/* value from opuser0 */</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a>);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;rfexc&quot;</span>);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">   *  RF Refocusing (1st echo)</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> / <a class="code" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">/* when quietness factor is used, find the crusherscale that minimizes the echo spacing (esp) */</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a> &gt; 1) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordtype">int</span> dummy1, dummy2;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a>;</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">float</span> optc = 2.0;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">int</span> optesp = 1s;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">int</span> my_esp = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a> = 0.0; <a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a> &lt; 2.0; <a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a> += 0.01) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a>;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, <span class="stringliteral">&quot;rfref1st&quot;</span>);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* disable the rephaser of the excitation */</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>; <span class="comment">/* note: postgrad.area is negative ! */</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      status = <a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      my_esp = <a class="code" href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a>(&amp;dummy1, &amp;dummy2, FALSE, seq);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <span class="keywordflow">if</span> (my_esp &lt; optesp) {</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        optesp = my_esp;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        optc = <a class="code" href="union_indices.html#acb607650af9713167c308f9121560425">c</a>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a> = optc;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, <span class="stringliteral">&quot;rfref1st&quot;</span>);</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* disable the rephaser of the excitation */</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>; <span class="comment">/* note: postgrad.area is negative ! */</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">   *  RF Refocusing (2nd echo)</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> / <a class="code" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a>;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a>);</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, <span class="stringliteral">&quot;rfref2nd&quot;</span>);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">   *  RF Refocusing (3rd-Nth echo)</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> / <a class="code" href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a>);</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, <span class="stringliteral">&quot;rfref&quot;</span>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;} <span class="comment">/* ksfse_eval_setuprfpulses_2D() */</span></div><div class="ttc" id="ksfse__implementation_8e_html_a10ce223033aad0afd68255485629bdf7"><div class="ttname"><a href="ksfse__implementation_8e.html#a10ce223033aad0afd68255485629bdf7">ksfse_inflowsuppression</a></div><div class="ttdeci">int ksfse_inflowsuppression</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:84</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_acaf4c89554c591a5729a462dad9401f2"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#acaf4c89554c591a5729a462dad9401f2">ref_fse160n</a></div><div class="ttdeci">const KS_RF ref_fse160n</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:97</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a6e372ec3f75f3e94bd2dd1012a47755c"><div class="ttname"><a href="ksfse__implementation_8e.html#a6e372ec3f75f3e94bd2dd1012a47755c">ksfse_eval_rfstretchfactor</a></div><div class="ttdeci">float ksfse_eval_rfstretchfactor(float patientweight, float flipangle, int tailoredrf_flag)</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:946</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7ffee4e96e25132c8bafafa3aeb3d5ba"><div class="ttname"><a href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a></div><div class="ttdeci">int ksfse_eval_esp(int *min90_180, int *min180_echo, int slicecheck, KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Calculates echo spacing for the sequence</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:852</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a713f9b6c2f156e3b05a27a0936da3439"><div class="ttname"><a href="ksfse__implementation_8e.html#a713f9b6c2f156e3b05a27a0936da3439">KSFSE_MAXTHICKFACT</a></div><div class="ttdeci">#define KSFSE_MAXTHICKFACT</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:38</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_afa069f8db856d8cb0f1f3510e71904a5"><div class="ttname"><a href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a></div><div class="ttdeci">float rf_stretch_all</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:95</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a37e3149443c4d14f743cc18569e3f31e"><div class="ttname"><a href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a></div><div class="ttdeci">float ksfse_crusherscale</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:91</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a5ae230002e11e72e2b78ef1ac3fd737d"><div class="ttname"><a href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a></div><div class="ttdeci">float rf_stretch_rfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:94</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a7f69114669ee63f8e3d2f37956cabd49"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a></div><div class="ttdeci">const KS_RF ref_se1b4</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:88</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a4f4f25a4252632f0f86c71ce5d24127c"><div class="ttname"><a href="ksfse__implementation_8e.html#a4f4f25a4252632f0f86c71ce5d24127c">ksfse_flipexc</a></div><div class="ttdeci">float ksfse_flipexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:81</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a115ae0fe48734b16dc052718ea0844b6"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a115ae0fe48734b16dc052718ea0844b6">ref_fse1601</a></div><div class="ttdeci">const KS_RF ref_fse1601</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:91</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ab64845b4ed4919114a702f65ab1d3d4d"><div class="ttname"><a href="ksfse__implementation_8e.html#ab64845b4ed4919114a702f65ab1d3d4d">ksfse_gscalerfref</a></div><div class="ttdeci">float ksfse_gscalerfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:92</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="_g_e_required_8e_html_a7506e6224f5036fb1941843536b6f4a6"><div class="ttname"><a href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a></div><div class="ttdeci">float ks_qfact</div><div class="ttdef"><b>Definition:</b> GERequired.e:240</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a68650973336da93ca00062d7345818eb"><div class="ttname"><a href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a></div><div class="ttdeci">float ksfse_excthickness</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:79</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_accedc302ef662e1b4d7a90b97e789dad"><div class="ttname"><a href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a></div><div class="ttdeci">float rf_stretch_rfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:83</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a2c2f3ffff089ec8ea84810bdc2cba295"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a2c2f3ffff089ec8ea84810bdc2cba295">exc_fse90</a></div><div class="ttdeci">const KS_RF exc_fse90</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:46</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">KS_TRAP::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:432</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a02cc10bf52afa88ba2d4de122965bb81"><div class="ttname"><a href="ksfse__implementation_8e.html#a02cc10bf52afa88ba2d4de122965bb81">ksfse_inflowsuppression_mm</a></div><div class="ttdeci">float ksfse_inflowsuppression_mm</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:85</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5e361f25d617a7522e7a14d0cba41c77"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">KS_SELRF::crusherscale</a></div><div class="ttdeci">float crusherscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1337</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a5c62a1c075135ed711a8b3f639e441c9"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a5c62a1c075135ed711a8b3f639e441c9">exc_fl901mc</a></div><div class="ttdeci">const KS_RF exc_fl901mc</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:43</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ada5166232c93c38dbff47a3284abaeb7"><div class="ttname"><a href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a></div><div class="ttdeci">float ksfse_gscalerfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:80</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a38e6cbd20c6ca7972e583360a1fb67c3"><div class="ttname"><a href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a></div><div class="ttdeci">STATUS ks_eval_stretch_rf(KS_RF *rf, float stretch_factor)</div><div class="ttdoc">In-place stretching of a KS_RF object</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2171</div></div>
<div class="ttc" id="union_indices_html_acb607650af9713167c308f9121560425"><div class="ttname"><a href="union_indices.html#acb607650af9713167c308f9121560425">Indices::c</a></div><div class="ttdeci">uint8_t c[4]</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1301</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a37cf0a86072a6ffa18283083029fd360"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a37cf0a86072a6ffa18283083029fd360">ref_fse1602</a></div><div class="ttdeci">const KS_RF ref_fse1602</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:94</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa2b37fa5aa0bffff1de8ca29e7c19cc1"><div class="ttname"><a href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a></div><div class="ttdeci">void ks_init_wave(KS_WAVE *wave)</div><div class="ttdoc">Resets a KS_WAVE sequence object to its default value (KS_INIT_WAVE)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:53</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae44f048a04968d71cab625493f5354ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae44f048a04968d71cab625493f5354ed">&#9670;&nbsp;</a></span>ksfse_eval_setuprfpulses_3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_setuprfpulses_3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>seq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up the RF objects for the ksfse sequence (3D)</h4>
</p>
<p>This function attempts to mimick the RF scaling and flip angle varation performed in the product fsemaster.e psd, with and without the tailored RF (optlrdrf) option. It is called from <a class="el" href="ksfse__implementation_8e.html#a2fb2b82b4fb1bc27cf72befce0547ba3" title="Sets up all sequence objects for the main sequence module (KSFSE_SEQUENCE ksfse)">ksfse_eval_setupobjects()</a> to set up the RF pulses to keep <a class="el" href="ksfse__implementation_8e.html#a2fb2b82b4fb1bc27cf72befce0547ba3" title="Sets up all sequence objects for the main sequence module (KSFSE_SEQUENCE ksfse)">ksfse_eval_setupobjects()</a> from growing too much in size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seq</td><td>Pointer to the <a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> struct holding all sequence objects </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                                                        {</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  STATUS status;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="comment">/* GE defines (epic.h) for opexcitemode:</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="comment">    SELECTIVE 0, NON_SELECTIVE 1, FOCUS 2 */</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">float</span> hardpulse_duration = 1ms;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <span class="keywordtype">float</span> adaptive_crusherscale = 1.0;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="comment">/* Clear potential gradient waveforms in the KS_SELRF objects before we choose our RF pulses */</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  cvoverride(opvthick, exist(opslquant) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>), _opslquant.fixedflag, existcv(opslquant));</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> = (exist(opslquant) - 2 * rhslblank) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a> = 1.0;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">areaoffset</a> &gt; 0 || <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> == 0) {</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Call ks_eval_phaser(zphasenc) with .areaoffset = 0, before calling this function&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="comment">/* we want the same big enough crusher for any kz encoding variation accross the ETL, where even the</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">    most negative kz encoding gradient will not be able to cancel out the positive crushers */</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    adaptive_crusherscale = <a class="code" href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a> + (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> / <a class="code" href="_k_s_foundation_8h.html#a76daa37aac330cbb2ccf7261d25a771a">KS_RF_STANDARD_CRUSHERAREA</a>);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  }</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (opexcitemode == NON_SELECTIVE) {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="comment">/* Non-selective 90 hard excitaion */</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ae907ed47938039d14cf25b9a9a1b3eb8">ks_eval_rf_hard</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <span class="stringliteral">&quot;rfexc&quot;</span>, hardpulse_duration, 90);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> = <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241">KS_RF_ROLE_EXC</a>;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">/* Selective 90 using a sharp high-BW minimum phase excitation pulse */</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a9eb856d638132c33bf2b48167b109d97">exc_3dfgre</a>;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = 90.0;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a> / <a class="code" href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a> * (opexcitemode != NON_SELECTIVE);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a>);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;rfexc&quot;</span>);</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">   *  RF Refocusing (1st echo)</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ae907ed47938039d14cf25b9a9a1b3eb8">ks_eval_rf_hard</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <span class="stringliteral">&quot;rfref1st&quot;</span>, hardpulse_duration, opflip);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> = <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd">KS_RF_ROLE_REF</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = 0; <span class="comment">/* N.B.: sel gradient = 0 if .selrfref1st.slthick = 0 (ks_eval_selrf()) */</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, <a class="code" href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a> * <a class="code" href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a>);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = adaptive_crusherscale;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, <span class="stringliteral">&quot;rfref1st&quot;</span>);</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">/* Left crusher: Merge excitation rephaser into left crusher */</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="comment">/* N.B.: Right crusher will be embedded in zphasenc in ksfse_eval_setupobjects() */</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* disable the rephaser of the excitation */</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> += seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>; <span class="comment">/* note: postgrad.area is negative ! */</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">   *  RF Refocusing (2nd echo)</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, <span class="stringliteral">&quot;rfref2nd&quot;</span>);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="comment">   *  RF Refocusing (3rd-Nth echo)</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a>;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, <span class="stringliteral">&quot;rfref&quot;</span>);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">   *  Move crushers area from selrf.pregrad/postgrad to zphasenc.areaoffset</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">   *  Disable pre/postgrads by setting their duration to 0</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* right crusher only */</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">areaoffset</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, <span class="stringliteral">&quot;zphaseenc&quot;</span>); <span class="comment">/* update zphaseenc, now with .areaoffset &gt; 0 */</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;} <span class="comment">/* ksfse_eval_setuprfpulses_3D() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a76daa37aac330cbb2ccf7261d25a771a"><div class="ttname"><a href="_k_s_foundation_8h.html#a76daa37aac330cbb2ccf7261d25a771a">KS_RF_STANDARD_CRUSHERAREA</a></div><div class="ttdeci">#define KS_RF_STANDARD_CRUSHERAREA</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:86</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_acc45c24d1996acd3d95ae2866c5ffb2b"><div class="ttname"><a href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a></div><div class="ttdeci">STATUS ks_eval_phaser(KS_PHASER *phaser, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up an acquisition window with a trapezoid with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:821</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_afa069f8db856d8cb0f1f3510e71904a5"><div class="ttname"><a href="ksfse__implementation_8e.html#afa069f8db856d8cb0f1f3510e71904a5">rf_stretch_all</a></div><div class="ttdeci">float rf_stretch_all</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:95</div></div>
<div class="ttc" id="struct_k_s___r_f_html_aea7921a9aa2757a88e843476848ddd55"><div class="ttname"><a href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">KS_RF::role</a></div><div class="ttdeci">int role</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:788</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd"><div class="ttname"><a href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd">KS_RF_ROLE_REF</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1750</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a37e3149443c4d14f743cc18569e3f31e"><div class="ttname"><a href="ksfse__implementation_8e.html#a37e3149443c4d14f743cc18569e3f31e">ksfse_crusherscale</a></div><div class="ttdeci">float ksfse_crusherscale</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:91</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a5ae230002e11e72e2b78ef1ac3fd737d"><div class="ttname"><a href="ksfse__implementation_8e.html#a5ae230002e11e72e2b78ef1ac3fd737d">rf_stretch_rfref</a></div><div class="ttdeci">float rf_stretch_rfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:94</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aad774d0423b06e30276673c8100a8ade"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">KS_PHASER::areaoffset</a></div><div class="ttdeci">float areaoffset</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1531</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241"><div class="ttname"><a href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedacc16dd3ca09dedaf6334a39ee4e46241">KS_RF_ROLE_EXC</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1750</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a9eb856d638132c33bf2b48167b109d97"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a9eb856d638132c33bf2b48167b109d97">exc_3dfgre</a></div><div class="ttdeci">const KS_RF exc_3dfgre</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:58</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a68650973336da93ca00062d7345818eb"><div class="ttname"><a href="ksfse__implementation_8e.html#a68650973336da93ca00062d7345818eb">ksfse_excthickness</a></div><div class="ttdeci">float ksfse_excthickness</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:79</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_accedc302ef662e1b4d7a90b97e789dad"><div class="ttname"><a href="ksfse__implementation_8e.html#accedc302ef662e1b4d7a90b97e789dad">rf_stretch_rfexc</a></div><div class="ttdeci">float rf_stretch_rfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:83</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae907ed47938039d14cf25b9a9a1b3eb8"><div class="ttname"><a href="_k_s_foundation_8h.html#ae907ed47938039d14cf25b9a9a1b3eb8">ks_eval_rf_hard</a></div><div class="ttdeci">STATUS ks_eval_rf_hard(KS_RF *rf, const char *const desc, int duration, float flip) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_RF object with a rectangular (hard) pulse of a given duration. </div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1153</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">KS_TRAP::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:432</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5e361f25d617a7522e7a14d0cba41c77"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">KS_SELRF::crusherscale</a></div><div class="ttdeci">float crusherscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1337</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ada5166232c93c38dbff47a3284abaeb7"><div class="ttname"><a href="ksfse__implementation_8e.html#ada5166232c93c38dbff47a3284abaeb7">ksfse_gscalerfexc</a></div><div class="ttdeci">float ksfse_gscalerfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:80</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a38e6cbd20c6ca7972e583360a1fb67c3"><div class="ttname"><a href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a></div><div class="ttdeci">STATUS ks_eval_stretch_rf(KS_RF *rf, float stretch_factor)</div><div class="ttdoc">In-place stretching of a KS_RF object</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2171</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa2b37fa5aa0bffff1de8ca29e7c19cc1"><div class="ttname"><a href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a></div><div class="ttdeci">void ks_init_wave(KS_WAVE *wave)</div><div class="ttdoc">Resets a KS_WAVE sequence object to its default value (KS_INIT_WAVE)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:53</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7b5b5f3e357196bd56e374d74e4a216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7b5b5f3e357196bd56e374d74e4a216">&#9670;&nbsp;</a></span>ksfse_eval_setuprfpulses_recovery()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_setuprfpulses_recovery </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>seq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                                              {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  STATUS status;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>);</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">   * Post-ETL forced recovery: T1-w Optimization / T2 fast Recovery</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">/* Recovery &quot;negative&quot; excitation (selrfrecover) */</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>; <span class="comment">/* already potentially RF-stretched */</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>, <span class="stringliteral">&quot;rfrecover&quot;</span>);</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  <span class="comment">/* no postgrad by setting duration = 0 (or pregrad either since KS_RF_ROLE_EXC) */</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">/* Mirror RF wave using &quot;-1&quot; (negative stretch factor), will mirror the excitation RF pulse waveform */</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, -1);</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <span class="comment">/* Recovery refocusing (selrfrecoverref). Use flip angle and design from &#39;selrfref.rf&#39; but left crusher</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">     area from selrfref1st.pregrad.area */</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a>;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>, <span class="stringliteral">&quot;rfrecoverref&quot;</span>);</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* zphaseenc.areaoffset takes over */</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>, seq-&gt;<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;}</div><div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">KS_TRAP::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:432</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5e361f25d617a7522e7a14d0cba41c77"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">KS_SELRF::crusherscale</a></div><div class="ttdeci">float crusherscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1337</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a38e6cbd20c6ca7972e583360a1fb67c3"><div class="ttname"><a href="_k_s_foundation_8h.html#a38e6cbd20c6ca7972e583360a1fb67c3">ks_eval_stretch_rf</a></div><div class="ttdeci">STATUS ks_eval_stretch_rf(KS_RF *rf, float stretch_factor)</div><div class="ttdoc">In-place stretching of a KS_RF object</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2171</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa2b37fa5aa0bffff1de8ca29e7c19cc1"><div class="ttname"><a href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a></div><div class="ttdeci">void ks_init_wave(KS_WAVE *wave)</div><div class="ttdoc">Resets a KS_WAVE sequence object to its default value (KS_INIT_WAVE)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45c9672a3b30f0d0b6b9c02fd1d7b8a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">&#9670;&nbsp;</a></span>ksfse_eval_ssitime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_eval_ssitime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Set the SSI time for the sequence</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>SSI time in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                         {</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="comment">/* SSI time CV:</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">     Empirical finding as a function of etl on how much SSI time we need to update.</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">     But, use a longer SSI time when we write out data to file in scan() */</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a> = RUP_GRD(IMax(2, <a class="code" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a> + 13 * opetl, _ksfse_ssi_time.minval));</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">/* Copy SSI CV to seqctrl field used by setssitime() */</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;  <span class="comment">/* SSI time one-sequence-off workaround:</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">     We set the hardware ssitime in ks_scan_playsequence(), but it acts on the next sequence module, hence</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">     we aren&#39;t doing this correctly when using multiple sequence modules (as KSChemSat etc).</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">     One option would be to add a short dummy sequence ks_scan_playsequence(), but need to investigate</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="comment">     if there is a better way. For now, let&#39;s assume the the necessary update time is the longest for</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="comment">     the main sequence (this function), and let the ssi time for all other sequence modules (KSChemSat etc)</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">     have the same ssi time as the main sequence. */</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a>    = <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <a class="code" href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a>      = <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a>        = <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a> = <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a>;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;} <span class="comment">/* ksfse_eval_ssitime() */</span></div><div class="ttc" id="_k_s_sp_sat_8e_html_ab39cbb31487a0719bb5d0af9a68f3ef2"><div class="ttname"><a href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a></div><div class="ttdeci">int ksspsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:134</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3ec411ca45ee9d7fd1497ad6bdec3621"><div class="ttname"><a href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a></div><div class="ttdeci">int ksinv_filltr_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:156</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_ae39a435e62e3e6d2470d70d5dbf1833e"><div class="ttname"><a href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a></div><div class="ttdeci">int kschemsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:105</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aef9d9c4f9c117165300e06cf9899fda8"><div class="ttname"><a href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a></div><div class="ttdeci">#define KSFSE_MIN_SSI_TIME</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:37</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a83e1154fac838dc278087955669299cb"><div class="ttname"><a href="ksfse__implementation_8e.html#a83e1154fac838dc278087955669299cb">ksfse_ssi_time</a></div><div class="ttdeci">int ksfse_ssi_time</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:125</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b9ea6f30b5b38c45e32c084a7bac3c7"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a></div><div class="ttdeci">int ksinv_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:155</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2fb2b82b4fb1bc27cf72befce0547ba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb2b82b4fb1bc27cf72befce0547ba3">&#9670;&nbsp;</a></span>ksfse_eval_setupobjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_setupobjects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up all sequence objects for the main sequence module (<a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksfse sequence">KSFSE_SEQUENCE</a> ksfse)</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                  {</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;   STATUS status;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="comment">/* Readout gradient and data acquisition */</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a>;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 2); <span class="comment">/* Round UP to nearest multiple of 2 */</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">rampsampling</a> = <a class="code" href="ksfse__implementation_8e.html#a33cc9c27102dbf43a3446c2558ca9168">ksfse_rampsampling</a>;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">rampsampling</a>)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a> = 16; <span class="comment">/* us on the ramp until acq should begin */</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">if</span> (opautote == PSD_MINTE) { <span class="comment">/* PSD_MINTE = 2 */</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a76ebb43b78039e7250fac06e50fba578">ksfse_kxnover</a> = <a class="code" href="ksfse__implementation_8e.html#acbe70d8840f6d66615bf7dfa411a5177">ksfse_eval_optimalkxnover</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>); <span class="comment">/* Partial Fourier */</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = <a class="code" href="ksfse__implementation_8e.html#a76ebb43b78039e7250fac06e50fba578">ksfse_kxnover</a>;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0; <span class="comment">/* Full Fourier */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a> = oprbw;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a304cb284861ddcc08f2e4d24b3d30ff2">paddingarea</a> = <a class="code" href="ksfse__implementation_8e.html#a1bb767118594019cf8553926001a7259">ksfse_xcrusherarea</a>;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a0e06bd2e4433a2b508c7610d7056050f">ks_eval_readtrap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, <span class="stringliteral">&quot;read&quot;</span>) == FAILURE)</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;  <span class="comment">/* read dephaser */</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a0c3ba07aac8b5f911ce918a97c7ebbc6">area2center</a>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, <span class="stringliteral">&quot;readdephaser&quot;</span>) == FAILURE)</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <span class="comment">/* phase encoding gradient */</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> * opphasefov;</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR((<span class="keywordtype">int</span>) (<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> * opphasefov), 2); <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> == 0 &amp;&amp; opnex &lt; 1) {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordtype">int</span> kynover;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    kynover = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> * (opnex - 0.5);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    kynover = ((kynover + 1) / 2) * 2; <span class="comment">/* round to nearest even number */</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (kynover &lt; <a class="code" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>)</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      kynover = <a class="code" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>; <span class="comment">/* protect against too few overscans */</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = IMin(2, kynover, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> / 2);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="comment">/* set .R and .nacslines fields of ksfse.phaseenc using ks_eval_phaser_setaccel() before calling ks_eval_phaser() */</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;  <span class="keywordflow">if</span> (opasset) {</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    cvoverride(<a class="code" href="ksfse__implementation_8e.html#ae666a499a4647e92db6977328a60a8c3">ksfse_minacslines</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ae666a499a4647e92db6977328a60a8c3">ksfse_minacslines</a> = _ksfse_minacslines.defval;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, <a class="code" href="ksfse__implementation_8e.html#ae666a499a4647e92db6977328a60a8c3">ksfse_minacslines</a>, opaccel_ph_stride) == FAILURE)</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, <span class="stringliteral">&quot;phaseenc&quot;</span>) == FAILURE)</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">/* z phase encoding gradient (N.B. 3D is not yet implemented in this sequence) */</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 0; <span class="comment">/* disable the right crusher gradient (.duration = 0), and put area necessary in zphaseenc.areaoffset */</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">areaoffset</a> = 0; <span class="comment">/* explicitly 0 here, since modified later in ksfse_eval_setuprfpulses_3D() */</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = opvthick;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = IMax(2, 1, opslquant);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="comment">/* set .R and .nacslines fields of ksfse.zphaseenc using ks_eval_phaser_setaccel() before calling ks_eval_phaser() */</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">if</span> (opasset) {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      cvoverride(<a class="code" href="ksfse__implementation_8e.html#a955ccaf130774fd90f7831650bf6a94b">ksfse_minzacslines</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oparc) {</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a955ccaf130774fd90f7831650bf6a94b">ksfse_minzacslines</a> = _ksfse_minzacslines.defval;</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    }</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, <a class="code" href="ksfse__implementation_8e.html#a955ccaf130774fd90f7831650bf6a94b">ksfse_minzacslines</a>, opaccel_sl_stride) == FAILURE)</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="comment">/* another call done in ksfse_eval_setuprfpulses_3D() with .areaoffset &gt; 0 */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>, <span class="stringliteral">&quot;zphaseenc&quot;</span>) == FAILURE)</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a38e859809526b8d07b17999dc6bbdbe9">ks_init_phaser</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">/* setup RF pulses in FSE train */</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ae44f048a04968d71cab625493f5354ed">ksfse_eval_setuprfpulses_3D</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>) == FAILURE)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#af38ecec57c34124374ec13fcf4c403d5">ksfse_eval_setuprfpulses_2D</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>) == FAILURE)</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="comment">/* Add recovery pulses after the main Echo Train, common for 2D and 3D */</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a>) {</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    status = <a class="code" href="ksfse__implementation_8e.html#ad7b5b5f3e357196bd56e374d74e4a216">ksfse_eval_setuprfpulses_recovery</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>);</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  }</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="comment">/* post-read spoiler */</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = <a class="code" href="ksfse__implementation_8e.html#a2b9f392e04c921b7b63266b33be7c647">ksfse_spoilerarea</a>;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <span class="stringliteral">&quot;spoiler&quot;</span>) == FAILURE)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="comment">/* init seqctrl */</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  strcpy(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, <span class="stringliteral">&quot;ksfsemain&quot;</span>);</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">ksfse_eval_ssitime</a>();</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;} <span class="comment">/* ksfse_eval_setupobjects() */</span></div><div class="ttc" id="ksfse__implementation_8e_html_a2b9f392e04c921b7b63266b33be7c647"><div class="ttname"><a href="ksfse__implementation_8e.html#a2b9f392e04c921b7b63266b33be7c647">ksfse_spoilerarea</a></div><div class="ttdeci">float ksfse_spoilerarea</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:82</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_af38ecec57c34124374ec13fcf4c403d5"><div class="ttname"><a href="ksfse__implementation_8e.html#af38ecec57c34124374ec13fcf4c403d5">ksfse_eval_setuprfpulses_2D</a></div><div class="ttdeci">STATUS ksfse_eval_setuprfpulses_2D(KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Sets up the RF objects for the ksfse sequence (2D)</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:983</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSFSE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:54</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_acc45c24d1996acd3d95ae2866c5ffb2b"><div class="ttname"><a href="_k_s_foundation_8h.html#acc45c24d1996acd3d95ae2866c5ffb2b">ks_eval_phaser</a></div><div class="ttdeci">STATUS ks_eval_phaser(KS_PHASER *phaser, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up an acquisition window with a trapezoid with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:821</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">KS_READTRAP::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1425</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aad774d0423b06e30276673c8100a8ade"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aad774d0423b06e30276673c8100a8ade">KS_PHASER::areaoffset</a></div><div class="ttdeci">float areaoffset</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1531</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a76ebb43b78039e7250fac06e50fba578"><div class="ttname"><a href="ksfse__implementation_8e.html#a76ebb43b78039e7250fac06e50fba578">ksfse_kxnover</a></div><div class="ttdeci">int ksfse_kxnover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:107</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a304cb284861ddcc08f2e4d24b3d30ff2"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a304cb284861ddcc08f2e4d24b3d30ff2">KS_READTRAP::paddingarea</a></div><div class="ttdeci">float paddingarea</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1430</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a955ccaf130774fd90f7831650bf6a94b"><div class="ttname"><a href="ksfse__implementation_8e.html#a955ccaf130774fd90f7831650bf6a94b">ksfse_minzacslines</a></div><div class="ttdeci">int ksfse_minzacslines</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:119</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a33cc9c27102dbf43a3446c2558ca9168"><div class="ttname"><a href="ksfse__implementation_8e.html#a33cc9c27102dbf43a3446c2558ca9168">ksfse_rampsampling</a></div><div class="ttdeci">int ksfse_rampsampling</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:108</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a13aea1e02502f8276373928c87d0da3f"><div class="ttname"><a href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a></div><div class="ttdeci">STATUS ks_eval_phaser_setaccel(KS_PHASER *phaser, int min_acslines, float R) WARN_UNUSED_RESULT</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:743</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ae44f048a04968d71cab625493f5354ed"><div class="ttname"><a href="ksfse__implementation_8e.html#ae44f048a04968d71cab625493f5354ed">ksfse_eval_setuprfpulses_3D</a></div><div class="ttdeci">STATUS ksfse_eval_setuprfpulses_3D(KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Sets up the RF objects for the ksfse sequence (3D)</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:1152</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSFSE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3cb1d6e472e9061b0f4768d8985a442e"><div class="ttname"><a href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a></div><div class="ttdeci">void ks_init_selrf(KS_SELRF *selrf)</div><div class="ttdoc">Resets a KS_SELRF sequence object to its default value (KS_INIT_SELRF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:65</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a1bb767118594019cf8553926001a7259"><div class="ttname"><a href="ksfse__implementation_8e.html#a1bb767118594019cf8553926001a7259">ksfse_xcrusherarea</a></div><div class="ttdeci">int ksfse_xcrusherarea</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:111</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ae666a499a4647e92db6977328a60a8c3"><div class="ttname"><a href="ksfse__implementation_8e.html#ae666a499a4647e92db6977328a60a8c3">ksfse_minacslines</a></div><div class="ttdeci">int ksfse_minacslines</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:118</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ad7b5b5f3e357196bd56e374d74e4a216"><div class="ttname"><a href="ksfse__implementation_8e.html#ad7b5b5f3e357196bd56e374d74e4a216">ksfse_eval_setuprfpulses_recovery</a></div><div class="ttdeci">STATUS ksfse_eval_setuprfpulses_recovery(KSFSE_SEQUENCE *seq)</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:1265</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">KS_PHASER::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1528</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a45c9672a3b30f0d0b6b9c02fd1d7b8a4"><div class="ttname"><a href="ksfse__implementation_8e.html#a45c9672a3b30f0d0b6b9c02fd1d7b8a4">ksfse_eval_ssitime</a></div><div class="ttdeci">int ksfse_eval_ssitime()</div><div class="ttdoc">Set the SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:1317</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7b6b5ece7f3021e6f7d9003799a01163"><div class="ttname"><a href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a></div><div class="ttdeci">int ksfse_recovery</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:100</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0e06bd2e4433a2b508c7610d7056050f"><div class="ttname"><a href="_k_s_foundation_8h.html#a0e06bd2e4433a2b508c7610d7056050f">ks_eval_readtrap</a></div><div class="ttdeci">STATUS ks_eval_readtrap(KS_READTRAP *readtrap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up an acquisition window with a trapezoid with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:599</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a49b40808cadc9aa2638ff5cf65effbc7"><div class="ttname"><a href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a></div><div class="ttdeci">#define KSFSE_MINHNOVER</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:36</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_acbe70d8840f6d66615bf7dfa411a5177"><div class="ttname"><a href="ksfse__implementation_8e.html#acbe70d8840f6d66615bf7dfa411a5177">ksfse_eval_optimalkxnover</a></div><div class="ttdeci">int ksfse_eval_optimalkxnover(KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Calculates the optimal number of k-space points for partial kx Fourier that does not increase TE...</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:909</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">KS_READTRAP::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1428</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a6a2cc013660b66a4c7793c6e55bfcaa8"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">KS_READTRAP::rampsampling</a></div><div class="ttdeci">int rampsampling</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1427</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a0c3ba07aac8b5f911ce918a97c7ebbc6"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a0c3ba07aac8b5f911ce918a97c7ebbc6">KS_READTRAP::area2center</a></div><div class="ttdeci">float area2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1433</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">KS_PHASER::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1526</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a38e859809526b8d07b17999dc6bbdbe9"><div class="ttname"><a href="_k_s_foundation_8h.html#a38e859809526b8d07b17999dc6bbdbe9">ks_init_phaser</a></div><div class="ttdeci">void ks_init_phaser(KS_PHASER *phaser)</div><div class="ttdoc">Resets a KS_PHASER sequence object to its default value (KS_INIT_PHASER)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:73</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bfb29ce686a198f1de0ae12e20d6d65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bfb29ce686a198f1de0ae12e20d6d65">&#9670;&nbsp;</a></span>ksfse_eval_TErange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_TErange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the min/max TE and echo spacing for the FSE train based on rBW, res and ETL</h4>
</p>
<p>Based on the duration of the sequence objects involved, this function first calculates the minimum echo spacing in the FSE train (<code>ksfse_esp</code>). Then, if the SSFSE flag is set (opssfse), the ETL (opetl) is forced to be equal to the number of phase encoding lines acquired (see <a class="el" href="_k_s_foundation_8h.html#a92f07eb83de68841171693b2041cee66" title="Sets up which lines to acquire for a KS_PHASER object">ks_eval_phaseviewtable()</a>), otherwise the chosen ETL is used to calculate how many TRs (or shots) is necessary to fill k-space (<code>ksfse.phaseenc_plan.num_shots</code>). This value is used later in scan.</p>
<p>Next, if the user has selected that the "ETL should set TE" (ksfse_etlte = TRUE), the echo time is forced to be equal to the most optimal one in the center of the echo train (optecho). The benefits of setting ksfse_etlte are a) reduced T2-blurring due to faster k-space traversal, and b) no FSE ghosting. The drawback is that TE needs to be controlled via changing ETL in the UI, but image quality wise, it may still be worth it. If ksfse_etlte = FALSE, <a class="el" href="ksfse__implementation_8e.html#af287d52efc92c8e069e341c3eb00de99">ksfse_calc_echo()</a> will find the <code>bestecho</code>, which is the echo index in the FSE train closest to the desired TE. When <code>bestecho</code> ends up being equal to <code>optecho</code> (as enforced by ksfse_etlte), the image quality improves, however this it not possible, especially for long ETLs with a normal TE of 80-100 ms.</p>
<p>Last, this function calls <a class="el" href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5" title="Sets up the TE menu based on echo spacing, max TE, ETL and the optimal echo index">ksfse_eval_TEmenu()</a> to change the TE menu so the optimal TE is always at the top, followed by other TEs one or more echo spacings from the optimal TE.</p>
<p>N.B.: <code>ksfse_esp</code> is the shortest time allowed between the RF excitation and the first echo, which is also the same time needed between two consecutive echoes in the FSE train. <code>ksfse_esp</code> is used in <a class="el" href="ksfse__implementation_8e.html#a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd" title="The ksfse (main) pulse sequence">ksfse_pg()</a>. If the pulse sequence design changes in <a class="el" href="ksfse__implementation_8e.html#a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd" title="The ksfse (main) pulse sequence">ksfse_pg()</a> such that more/less time is needed to the first echo, or between consecutive echoes, ksfse_esp must here be updated to avoid gradient overlaps.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                            {</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordtype">int</span> min90_180 = 0;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordtype">int</span> min180_echo = 0;</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordtype">double</span> optecho, bestecho;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keywordtype">int</span> fixed_teflag = _opte.fixedflag;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordtype">int</span> exist_teflag = _opte.existflag;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  STATUS status;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">/* echo spacing (esp) */</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> = <a class="code" href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a>(&amp;min90_180, &amp;min180_echo, <a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>);</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="comment">/* ETL */</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordflow">if</span> (opssfse == PSD_ON) {</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="comment">/* SSFSE case */</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    cvoverride(opetl, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (opetl &lt; 1) {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      cvoverride(opetl, 1, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opetl &gt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>) {</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ksfse_eval_TErange: Please reduce ETL to %d&quot;</span>, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    }</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  }</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="comment">/* if single shot (2D), ks_phaseencoding_generate_2Dfse() will not allow non-optimal TE, i.e. linear k-space sweep</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">     is required. Therefore, ETL must control TE via setting ksfse_etlte = TRUE */</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keywordflow">if</span> (CEIL_DIV(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>, opetl) == 1) {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    cvoverride(<a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a>, TRUE, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    _ksfse_etlte.fixedflag = FALSE;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  }</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="comment">/* calc spacing between RF pulses used for T1-w opt. */</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a>) {</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordtype">int</span> recovery_min_read2ref = (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">acqdelay</a>) +</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> +</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> +</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordtype">int</span> recovery_min_ref2exc = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> +</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    IMax(2, <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>,</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) +</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> +</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a>) {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      recovery_min_read2ref += <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      recovery_min_ref2exc = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> +</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> +</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> +</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> +</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> +</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    }</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordtype">int</span> ksfse_recovery_spacing = IMax(2, recovery_min_read2ref, recovery_min_ref2exc) * 2;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> = IMax(2, <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>, ksfse_recovery_spacing);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  }</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> += GRAD_UPDATE_TIME * 2; <span class="comment">/* 8us extra margin */</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> = RUP_FACTOR(<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>, 8); <span class="comment">/* make sure ksfse_esp is divisible by 8us (as we will need to use ksfse_esp/2 on 4us grid) */</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <span class="comment">/* protect against too long sequence before we are having trouble in pg */</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * opetl &gt; 2s) {</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Too long sequence duration (%.1f ms)&quot;</span>, __FUNCTION__, (<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * opetl) / 1000.0);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="comment">/* bestecho: opte rounded off. optecho: ignores &#39;opte&#39; input */</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad6d4710baf0864b0e04ba55908a52666">ks_fse_calcecho</a>(&amp;bestecho, &amp;optecho, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, opte, opetl, <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  setpopup(opte, PSD_OFF);</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a>) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">/* ETL is controlling the use of an optimal TE to ensure a linear k-space sweep */</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    cvoverride(opte, (<span class="keywordtype">int</span>) (<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * optecho), PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    pite1nub = 0;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    _opte.defval = opte;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    pite1val2 = opte;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    avminte = opte;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    avmaxte = opte;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">/* must set opautote here so that the TE menu is shaded rather than removed */</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    cvoverride(opautote, PSD_MINTEFULL, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="comment">/* minimum TE */</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    avminte = <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">if</span> (opautote || (opte &lt; avminte)) {</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      cvoverride(opte, avminte, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="comment">/* round opte to nearest valid value */</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      cvoverride(opte, (<span class="keywordtype">int</span>) (<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * bestecho), fixed_teflag, exist_teflag);</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    }</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">/* maximum TE */</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    avmaxte = <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * opetl;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">/* Setup TE menu */</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5">ksfse_eval_TEmenu</a>(<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>, avmaxte, opetl, optecho);</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  }</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  { <span class="comment">/* Update opuser1 to show optimal TE and echo spacing) */</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">char</span> tmpstr[100];</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    sprintf(tmpstr, <span class="stringliteral">&quot;%s [opt=%.1f, esp=%d]&quot;</span>, _ksfse_etlte.descr, (<a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> * optecho) / 1000.0, <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a> / 1000);</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    cvdesc(opuser1, tmpstr);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  }</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;} <span class="comment">/* ksfse_eval_TErange() */</span></div><div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7ffee4e96e25132c8bafafa3aeb3d5ba"><div class="ttname"><a href="ksfse__implementation_8e.html#a7ffee4e96e25132c8bafafa3aeb3d5ba">ksfse_eval_esp</a></div><div class="ttdeci">int ksfse_eval_esp(int *min90_180, int *min180_echo, int slicecheck, KSFSE_SEQUENCE *seq)</div><div class="ttdoc">Calculates echo spacing for the sequence</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:852</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a09b1a7dc77a7cf8c4e8421a23608a42a"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">KS_PHASER::numlinestoacq</a></div><div class="ttdeci">int numlinestoacq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1532</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a90d79b39e9c23bb5a017c214eb182a20"><div class="ttname"><a href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a></div><div class="ttdeci">int ksfse_esp</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:112</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSFSE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:51</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a257cccbbaeda541ca5250d16adc5c8c5"><div class="ttname"><a href="ksfse__implementation_8e.html#a257cccbbaeda541ca5250d16adc5c8c5">ksfse_eval_TEmenu</a></div><div class="ttdeci">void ksfse_eval_TEmenu(int esp, int maxte, int etl, double optechono)</div><div class="ttdoc">Sets up the TE menu based on echo spacing, max TE, ETL and the optimal echo index</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:801</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a7b6b5ece7f3021e6f7d9003799a01163"><div class="ttname"><a href="ksfse__implementation_8e.html#a7b6b5ece7f3021e6f7d9003799a01163">ksfse_recovery</a></div><div class="ttdeci">int ksfse_recovery</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:100</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad6d4710baf0864b0e04ba55908a52666"><div class="ttname"><a href="_k_s_foundation_8h.html#ad6d4710baf0864b0e04ba55908a52666">ks_fse_calcecho</a></div><div class="ttdeci">STATUS ks_fse_calcecho(double *bestecho, double *optecho, KS_PHASER *pe, int TE, int etl, int esp)</div><div class="ttdoc">Calculates the ETL index corresponding the desired TE given a KS_PHASER object and echo spacing...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:513</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_READTRAP::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1434</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ac0677ae1147b74362792c5014c638e65"><div class="ttname"><a href="ksfse__implementation_8e.html#ac0677ae1147b74362792c5014c638e65">ksfse_etlte</a></div><div class="ttdeci">int ksfse_etlte</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:110</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a13d3424b69abfaa66668757e06fed900"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a13d3424b69abfaa66668757e06fed900">KS_READTRAP::acqdelay</a></div><div class="ttdeci">int acqdelay</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1429</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aec461106cf1a6720d4641b9988bfa2cc"><div class="ttname"><a href="ksfse__implementation_8e.html#aec461106cf1a6720d4641b9988bfa2cc">ksfse_slicecheck</a></div><div class="ttdeci">int ksfse_slicecheck</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:93</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add948dfc3d7160d4b41892e809520a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add948dfc3d7160d4b41892e809520a34">&#9670;&nbsp;</a></span>ksfse_eval_inversion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_inversion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to KSInversion functions to add single and dual IR support to this sequence</h4>
</p>
<p>It is important that <a class="el" href="ksfse__implementation_8e.html#add948dfc3d7160d4b41892e809520a34" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksfse_eval_inversion()</a> is called after other sequence modules have been set up and added to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct in <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>. Otherwise the TI and TR timing will be wrong.</p>
<p>Whether IR is on or off is determined by ksinv1_mode, which is set up in <a class="el" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818" title="C-macro assigning four UserCV slots and then calling ksinv_eval()">KSINV_EVAL()</a>-&gt;<a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a>. If it is off, this function will return quietly.</p>
<p>This function calls <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> (<a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a>), which takes over the responsibility of TR timing that otherwise is determined in <a class="el" href="ksfse__implementation_8e.html#a5e837471ce64138aa92879973c539cb8" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksfse_eval_tr()</a>. <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> sets seqcollection.evaltrdone = TRUE, which indicates that TR timing has been done. <a class="el" href="ksfse__implementation_8e.html#a5e837471ce64138aa92879973c539cb8" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksfse_eval_tr()</a> checks whether seqcollection.evaltrdone = TRUE to avoid that non-inversion TR timing overrides the TR timing set up in <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>.</p>
<p>At the end of this function, TR validation and heat/SAR checks are done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                                                              {</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  STATUS status;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordtype">int</span> slperpass, npasses;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordtype">int</span> approved_TR = FALSE;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, 26, 27, 28, 29); <span class="comment">/* args 2-6: integer X corresponds to opuserX CV */</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="comment">/* If no IR1 flag on, return */</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: This function is only for 2D scans&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    npasses = 2;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    npasses = 1;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="keywordflow">while</span> (approved_TR == FALSE) {</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="comment">/* Inversion (specific to 2D FSE/EPI type of PSDs). Must be done after all other sequence modules have been set up */</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    slperpass = CEIL_DIV((<span class="keywordtype">int</span>) exist(opslquant), npasses);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">/* ksinv_eval_multislice() sets seqcollection.evaltrdone = TRUE. This indicates that TR timing has been done.</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="comment">       ksfse_eval_tr() check whether seqcollection.evaltrdone = TRUE to avoid that non-inversion TR timing overrides the</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">       intricate TR timing with inversion module(s). At the end of ksinv_eval_multislice(), TR validation and heat/SAR checks are done */</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08">ksfse_scan_coreslice_nargs</a>, 0, NULL, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; existcv(opslquant) &amp;&amp; opflair == OPFLAIR_INTERLEAVED &amp;&amp; optr &gt; <a class="code" href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a>) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="comment">/* T1-FLAIR, too long TR */</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      <span class="keywordflow">if</span> (npasses &gt; exist(opslquant)) {</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: T1-FLAIR: TR not met for single slice per TR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      npasses++; <span class="comment">/* increase #passes and call ksinv_eval_multislice() again with a new ks_slice_plan */</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; existcv(opslquant) &amp;&amp; opflair == OPFLAIR_INTERLEAVED &amp;&amp; optr &lt; <a class="code" href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a>) {</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="comment">/* T1-FLAIR, too short TR */</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: T1-FLAIR: Min TR is %.0f ms. Increase slices or ETL&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a>/1000.0);</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      <span class="comment">/* non-T1-FLAIR, or T1-FLAIR with approved TR value */</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      approved_TR = TRUE;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  } <span class="comment">/* while (approved_TR == FALSE)  */</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;} <span class="comment">/* ksfse_eval_inversion() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a0d7d7a81235745c6e98201f2e15fbe08"><div class="ttname"><a href="ksfse__implementation_8e.html#a0d7d7a81235745c6e98201f2e15fbe08">ksfse_scan_coreslice_nargs</a></div><div class="ttdeci">int ksfse_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksfse_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2598</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab3fa4125b24bcc3e5d7f0ffacc32d86b"><div class="ttname"><a href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a></div><div class="ttdeci">int ksinv_maxtr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:159</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a2a4ae2b692531f3c649a5035992425c1"><div class="ttname"><a href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a></div><div class="ttdeci">STATUS ksinv_eval_multislice(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args, KS_SEQ_CONTROL *mainseqctrl)</div><div class="ttdoc">Calculates the duration of inversion module(s) for various inversion modes</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1509</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acc139f545253464349e788315546ee0a"><div class="ttname"><a href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a></div><div class="ttdeci">int ksinv_mintr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:158</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b2d943c3862a3980c7291b8e3ac1818"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a></div><div class="ttdeci">#define KSINV_EVAL(sptr, o1, o2, o3, o4)</div><div class="ttdoc">C-macro assigning four UserCV slots and then calling ksinv_eval()</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1132</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e837471ce64138aa92879973c539cb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e837471ce64138aa92879973c539cb8">&#9670;&nbsp;</a></span>ksfse_eval_tr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_tr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks</h4>
</p>
<p>With the current sequence collection (see <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>), and a function pointer to an argument-standardized wrapper function (<a class="el" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d" title="Wrapper function to ksfse_scan_sliceloop() with standardized input arguments">ksfse_scan_sliceloop_nargs()</a>) to the slice loop function (<a class="el" href="ksfse__implementation_8e.html#a6484a51a27836574d96417d2f0a3655d" title="Plays out slperpass slices corresponding to one TR">ksfse_scan_sliceloop()</a>, this function calls <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, where number of slices that can fit within one TR is determined by adding more slices as input argument to the slice loop function. For more details see <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>.</p>
<p>With the number of slices/TR now known, a standard 2D slice plan is set up using <a class="el" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb" title="Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...">ks_calc_sliceplan()</a> and the duration of the main sequence is increased based on timetoadd_perTR, which was returned by <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>. timetoadd_perTR &gt; 0 when optr &gt; avmintr and when heat or SAR restrictions requires <code>avmintr</code> to be larger than the net sum of sequence modules in the slice loop.</p>
<p>This function first checks whether seqcollection.evaltrdone == TRUE. This is e.g. the case for inversion where the TR timing instead is controlled using <a class="el" href="ksfse__implementation_8e.html#add948dfc3d7160d4b41892e809520a34" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksfse_eval_inversion()</a> (calling <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>).</p>
<p>At the end of this function, TR validation and heat/SAR checks are done using <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;                                                       {</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  <span class="keywordtype">int</span> timetoadd_perTR;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  STATUS status;</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordtype">int</span> slperpass, min_npasses;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">evaltrdone</a> == TRUE) {</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">     We cannot call GEReq_eval_TR() or GEReq_eval_checkTR_SAR(..., ksfse_scan_sliceloop_nargs, ...) if e.g. the inversion sequence module is used. This is because</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="comment">     ksinv_scan_sliceloop() is used instead of ksfse_scan_sliceloop(). When ksinv1.params.mode != 0 (i.e. inversion sequence module on), the TR timing and</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">     heat/SAR limits checks are done in ksinv_eval_multislice(), which is called from ksfse_eval_inversion().</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">     In the future, other sequence modules may want to take over the responsibility of TR calculations and SAR checks, in which case they need to end their corresponding function</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">     by setting evaltrdone = TRUE to avoid double processing here */</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  }</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    min_npasses = 2;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    min_npasses = 1;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="comment">/* Calculate # slices per TR and how much spare time we have within the current TR by running the slice loop. */</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#ad97ca73c80e23352aa79230ba0e068b6">GEReq_eval_TRrange</a>(&amp;slperpass, &amp;timetoadd_perTR, min_npasses, <a class="code" href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a>, <a class="code" href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a>, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d">ksfse_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="comment">/* Calculate the slice plan (ordering) and passes (acqs). ks_slice_plan is passed to GEReq_predownload_store_sliceplan() in predownload() */</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opvquant), 1 <span class="comment">/* seq 3DMS */</span>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="comment">/* We spread the available timetoadd_perTR evenly, by increasing the .duration of each slice by timetoadd_perTR/ks_slice_plan.nslices_per_pass */</span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + CEIL_DIV(timetoadd_perTR, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>));</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">/* Update SAR values in the UI (error will occur if the sum of sequence durations differs from optr)  */</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d">ksfse_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">/* Fill in the &#39;tmin&#39; and &#39;tmin_total&#39;. tmin_total is only like GEs use of the variable when TR = minTR */</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  tmin = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  tmin_total = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;} <span class="comment">/* ksfse_eval_tr() */</span></div><div class="ttc" id="_g_e_required_8e_html_a027161dabe834c55750bd1e7f2fa8473"><div class="ttname"><a href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS GEReq_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, int nslices, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdoc">Runs the slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> GERequired.e:974</div></div>
<div class="ttc" id="_g_e_required_8e_html_ad97ca73c80e23352aa79230ba0e068b6"><div class="ttname"><a href="_g_e_required_8e.html#ad97ca73c80e23352aa79230ba0e068b6">GEReq_eval_TRrange</a></div><div class="ttdeci">STATUS GEReq_eval_TRrange(int *slperpass, int *timetoadd_perTR, int requested_minacqs, int mintr, int maxtr, KS_SEQ_COLLECTION *seqcollection, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdoc">Calculate the number of slices per TR and TR padding time (2D imaging)</div><div class="ttdef"><b>Definition:</b> GERequired.e:539</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a656087391c0eb24a54958214896ab23d"><div class="ttname"><a href="ksfse__implementation_8e.html#a656087391c0eb24a54958214896ab23d">ksfse_scan_sliceloop_nargs</a></div><div class="ttdeci">int ksfse_scan_sliceloop_nargs(int slperpass, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksfse_scan_sliceloop() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2693</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ad232fff30fc715e9baa395aab5d40bd5"><div class="ttname"><a href="ksfse__implementation_8e.html#ad232fff30fc715e9baa395aab5d40bd5">ksfse_maxtr</a></div><div class="ttdeci">int ksfse_maxtr</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:131</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n_html_aaa31b32f56e7b425f15f4191ef1f92be"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">KS_SEQ_COLLECTION::evaltrdone</a></div><div class="ttdeci">int evaltrdone</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1152</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a3c49bc9f0980dd02a99cd26b933b7131"><div class="ttname"><a href="ksfse__implementation_8e.html#a3c49bc9f0980dd02a99cd26b933b7131">ksfse_mintr</a></div><div class="ttdeci">int ksfse_mintr</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:130</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6757ca75cb3af4cafdee9000b5d128ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6757ca75cb3af4cafdee9000b5d128ca">&#9670;&nbsp;</a></span>ksfse_eval_scantime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_eval_scantime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Set the number of dummy scans for the sequence and calls <a class="el" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650" title="Plays out all volumes and passes of a single or multi-pass scan">ksfse_scan_scanloop()</a> to determine</h4>
the length of the scan </p>
<p>After setting the number of dummy scans based on the current TR, the <a class="el" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650" title="Plays out all volumes and passes of a single or multi-pass scan">ksfse_scan_scanloop()</a> is called to get the scan time. <code>pitscan</code> is the UI variable for the scan clock shown in the top right corner on the MR scanner.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;                             {</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">/* ksfse_dda default = 2 */</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="keywordflow">if</span> (optr &gt; 6s || opetl == <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">/* For long TRs or single-shot FSE, don&#39;t use dummies */</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a> = 0;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((optr &gt; 1s) &amp;&amp; (opflair != OPFLAIR_INTERLEAVED)) {</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">/* For medium long TRs and not T1-FLAIR */</span></div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a> = 1;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  }</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  pitscan = <a class="code" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650">ksfse_scan_scanloop</a>();</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;} <span class="comment">/* ksfse_eval_scantime() */</span></div><div class="ttc" id="ksfse__implementation_8e_html_ab7af5654e8b4db142fb80465d6f256f7"><div class="ttname"><a href="ksfse__implementation_8e.html#ab7af5654e8b4db142fb80465d6f256f7">ksfse_dda</a></div><div class="ttdeci">int ksfse_dda</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:126</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a09b1a7dc77a7cf8c4e8421a23608a42a"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">KS_PHASER::numlinestoacq</a></div><div class="ttdeci">int numlinestoacq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1532</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a84c1aabd1ad5e03c56dba64cccd5f650"><div class="ttname"><a href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650">ksfse_scan_scanloop</a></div><div class="ttdeci">float ksfse_scan_scanloop()</div><div class="ttdoc">Plays out all volumes and passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2794</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2db6cfa9ec7fd4025ab57ee69e2cdbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2db6cfa9ec7fd4025ab57ee69e2cdbc">&#9670;&nbsp;</a></span>ksfse_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Returns error of various parameter combinations that are not allowed for ksfse</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;                     {</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="comment">/* Show resolution, BW per pixel &amp; echo spacing in the UI */</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  piinplaneres = 1;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  pirbwperpix = 1;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  piesp = 1;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  ihinplanexres = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">fov</a>/<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  ihinplaneyres = <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a>/<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  ihrbwperpix = (1000.0 * <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a> * 2.0)/<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  ihesp = <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>/1000.0;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="comment">/* Force the user to select the Fast Spin echo button. This error needs to be in cvcheck(), not in</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">     cvinit()/cveval() to avoid it to trigger also when Fast Spin Echo has been selected */</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <span class="keywordflow">if</span> (!((oppseq == PSD_SE || oppseq == PSD_IR) &amp;&amp; opfast == PSD_ON &amp;&amp; existcv(opfast))) {</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Please first select the &#39;Fast Spin Echo&#39; button&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  }</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; opcube) {</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Please select either FRFSE-XL or FSE&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  }</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="keywordflow">if</span> (oparc &amp;&amp; <a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; (<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> &gt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>)) {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="comment">/* Unclear why, but zR &gt; R leads to corrupted images for ARC and 3D.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment">    Probably a bug that can be fixed later. Limited experience (July 2018) */</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Need Slice acceleration &lt;= Phase accleration&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  }</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;} <span class="comment">/* ksfse_check() */</span></div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">KS_READTRAP::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1425</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a90d79b39e9c23bb5a017c214eb182a20"><div class="ttname"><a href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a></div><div class="ttdeci">int ksfse_esp</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:112</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">KS_PHASER::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1526</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a680b7ebd358c5355979dd9bf28c76768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a680b7ebd358c5355979dd9bf28c76768">&#9670;&nbsp;</a></span>ksfse_predownload_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_predownload_plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plotting of sequence modules and slice timing to PNG/SVG/PDF files</h4>
</p>
<p>The ks_plot_*** functions used in here will save plots to disk depending on the value of the CV <code>ks_plot_filefmt</code> (see KS_PLOT_FILEFORMATS). E.g. if ks_plot_filefmt = KS_PLOT_OFF, nothing will be written to disk. On the MR scanner, the output will be located in /usr/g/mrraw/plot/&lt;ks_psdname&gt;. In simulation, it will be placed in the current directory (./plot/).</p>
<p>Please see the documentation on how to install the required python version and links. Specifically, there must be a link /usr/local/bin/apython pointing to the Anaconda 2 python binary (v. 2.7).</p>
<p>In addition, the following text files are printed out</p><ul>
<li>&lt;ks_psdname&gt;_objects.txt</li>
<li>&lt;ks_psdname&gt;_seqcollection.txt</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>STATUS <code>SUCCESS</code> or <code>FAILURE</code> </dd></dl>
<div class="fragment"><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                                                                {</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <span class="keywordtype">char</span> tmpstr[1000];</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="preprocessor">#ifdef PSD_HW</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;/usr/g/mrraw/%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;./%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  FILE *fp  = fopen(tmpstr, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  <span class="comment">/* Note: &#39;fp&#39; can be replaced with &#39;stdout&#39; or &#39;stderr&#39; to get these</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="comment">     values printed out in the WTools window in simulation. However,</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="comment">     heavy printing may result in that the WTools window closes,</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="comment">     why we here write to a file ksfse_objects.txt instead */</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a13a8f8b8bd8fccfc5bae9cef555053ad">ks_print_readtrap</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>, fp);</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">readdephaser</a>, fp);</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a4f5dffeec30279ac23c5f12ecb868575">ks_print_phaser</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">phaseenc</a>, fp);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">zphaseenc</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>, fp);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, fp);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, fp);</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>, fp);</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>, fp);</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, fp);</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, fp);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  }</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  fclose(fp);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;  <span class="comment">/* ks_plot_host():</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="comment">  Plot each sequence module as a separate file (PNG/SVG/PDF depending on ks_plot_filefmt (GERequired.e))</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">  See KS_PLOT_FILEFORMATS in KSFoundation.h for options.</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="comment">  Note that the phase encoding amplitudes corresponds to the first shot, as set by the call to ksfse_scan_seqstate below */</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], 0);</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a9cc16cc637cbb032a1df9434ab3ae900">ks_plot_host</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">phaseenc_plan</a>);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;  <span class="comment">/* Sequence timing plot: */</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a>();</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;  <a class="code" href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650">ksfse_scan_scanloop</a>();</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a>();</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="comment">/* ks_plot_tgt_reset():</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment">  Creates sub directories and clear old files for later use of ksfse_scan_acqloop()-&gt;ks_plot_tgt_addframe().</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment">  ks_plot_tgt_addframe() will only write in MgdSim (WTools) to avoid timing issues on the MR scanner. Hence,</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment">  unlike ks_plot_host() and the sequence timing plot, one has to open MgdSim and press RunEntry (and also</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">  press PlotPulse several times after pressing RunEntry).</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="comment">  ks_plot_tgt_reset() will create a &#39;makegif_***.sh&#39; file that should be run in a terminal afterwards</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">  to create the animiated GIF from the dat files */</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;} <span class="comment">/* ksfse_predownload_plot() */</span></div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSFSE_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae94187154de0227e276ecd435755c77d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae94187154de0227e276ecd435755c77d">KSFSE_SEQUENCE::phaseenc</a></div><div class="ttdeci">KS_PHASER phaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:52</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a01c14f0885b7400680196de955b96be9"><div class="ttname"><a href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a></div><div class="ttdeci">STATUS ksfse_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksfse sequence objects being part of KSFSE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2376</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a38de45041acbb666417da7e19b81b12d"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a38de45041acbb666417da7e19b81b12d">KSFSE_SEQUENCE::zphaseenc</a></div><div class="ttdeci">KS_PHASER zphaseenc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:53</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9cc16cc637cbb032a1df9434ab3ae900"><div class="ttname"><a href="_k_s_foundation_8h.html#a9cc16cc637cbb032a1df9434ab3ae900">ks_plot_host</a></div><div class="ttdeci">void ks_plot_host(KS_SEQ_COLLECTION *seqcollection, KS_PHASEENCODING_PLAN *plan)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:4079</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a84c1aabd1ad5e03c56dba64cccd5f650"><div class="ttname"><a href="ksfse__implementation_8e.html#a84c1aabd1ad5e03c56dba64cccd5f650">ksfse_scan_scanloop</a></div><div class="ttdeci">float ksfse_scan_scanloop()</div><div class="ttdoc">Plays out all volumes and passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2794</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_add1f554400cbae8fcca90bdbb11286e4"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#add1f554400cbae8fcca90bdbb11286e4">KSFSE_SEQUENCE::readdephaser</a></div><div class="ttdeci">KS_TRAP readdephaser</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:51</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae136d8a2e504e06e8592185e85fecfde"><div class="ttname"><a href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a></div><div class="ttdeci">void ks_plot_slicetime_begin()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3068</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6eab83ca87166f306eb449a94a354ec6"><div class="ttname"><a href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a></div><div class="ttdeci">void ks_plot_slicetime_end()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3100</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a4f5dffeec30279ac23c5f12ecb868575"><div class="ttname"><a href="_k_s_foundation_8h.html#a4f5dffeec30279ac23c5f12ecb868575">ks_print_phaser</a></div><div class="ttdeci">void ks_print_phaser(KS_PHASER phaser, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_PHASER sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3721</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1abdbad21b51b6554580840ef8376e0d"><div class="ttname"><a href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a></div><div class="ttdeci">void ks_print_trap(KS_TRAP trap, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_TRAP sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3691</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_abb36a5018815d55e357775e8515f220d"><div class="ttname"><a href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a></div><div class="ttdeci">void ks_plot_tgt_reset(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3108</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a427c63c14d81f2b67ae029576793d4fe"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a427c63c14d81f2b67ae029576793d4fe">KSFSE_SEQUENCE::phaseenc_plan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN phaseenc_plan</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:61</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a29a4c870ed4dcbee78d35bbbce9722b4"><div class="ttname"><a href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a></div><div class="ttdeci">void ks_print_selrf(KS_SELRF selrf, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_SELRF sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3839</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a13a8f8b8bd8fccfc5bae9cef555053ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a13a8f8b8bd8fccfc5bae9cef555053ad">ks_print_readtrap</a></div><div class="ttdeci">void ks_print_readtrap(KS_READTRAP readtrap, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_READTRAP sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3702</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb2180cb9c08db068e0d794039b45c91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb2180cb9c08db068e0d794039b45c91">&#9670;&nbsp;</a></span>ksfse_predownload_setrecon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_predownload_setrecon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Last-resort function to override certain recon variables not set up correctly already</h4>
</p>
<p>For most cases, the GEReq_predownload_*** functions in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> in <a class="el" href="ksfse_8e.html" title="This file contains the overall structure for the ksfse psd. ">ksfse.e</a> set up the necessary rh*** variables for the reconstruction to work properly. However, if this sequence is customized, certain rh*** variables may need to be changed. Doing this here instead of in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> directly separates these changes from the standard behavior.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                                    {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;} <span class="comment">/* ksfse_predownload_setrecon() */</span></div></div><!-- fragment -->
</div>
</div>
<a id="a10ee8f888f2b3eece931b22925a69930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ee8f888f2b3eece931b22925a69930">&#9670;&nbsp;</a></span>ksfse_etlphaseamps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_etlphaseamps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *&#160;</td>
          <td class="paramname"><em>phaseenc_plan_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *&#160;</td>
          <td class="paramname"><em>phaser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___p_h_a_s_e_r.html">KS_PHASER</a> *&#160;</td>
          <td class="paramname"><em>zphaser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the phase encoding amplitudes in the FSE train on hardware using the phase enc. table and shot index</h4>
</p>
<p>This function will quietly return early when called on HOST. On IPG, it will set the instruction amplitudes of the phase encoding gradients in the FSE train given the phase encoding table, the pointer to the single phase encoding object for all phase encodes in the echo train, and the shot index.</p>
<p>The <code>shot</code> index must be in range [0, ceil(pe.numlinestoacq/etl)] and is used to select the current row of <code>etl</code> different amplitudes in <code>phaseenc_plan[][shot]</code>.</p>
<p>The <a class="el" href="struct_k_s___p_h_a_s_e_r.html" title="Composite sequence object for phase encoding using a trapezoid gradient">KS_PHASER</a> object must have been placed out <code>2*etl</code> times in <code><a class="el" href="ksfse__implementation_8e.html#a2ab0a2b60d7dd15cb9a2c3c62ee2bbfd" title="The ksfse (main) pulse sequence">ksfse_pg()</a></code> before calling this function. The <code>etl</code> dephasing gradients before each readout in the echo train correspond to even indices, i.e. 0,2,4,...,(2*etl-1), whereas the rephasing gradients after each readout correspond to odd indices. This is an effect of that all <code>ks_pg_***()</code> functions sort the instances of an object in time.</p>
<p>If <code>shot &lt; 0</code> (e.g. <code>shot = KS_NOTSET = -1</code>), all phase encoding amplitudes will be set to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">phaseenc_plan_ptr</td><td>Pointer to the phase encoding table (<a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html" title="Phase encoding plan for the sequence (2D and 3D)">KS_PHASEENCODING_PLAN</a>) (2D &amp; 3D) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">phaser</td><td>Pointer to a <a class="el" href="struct_k_s___p_h_a_s_e_r.html" title="Composite sequence object for phase encoding using a trapezoid gradient">KS_PHASER</a> ("ky") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zphaser</td><td>Pointer to a <a class="el" href="struct_k_s___p_h_a_s_e_r.html" title="Composite sequence object for phase encoding using a trapezoid gradient">KS_PHASER</a> ("kz"). Pass in NULL for 2D </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td>Which <code>shot</code> index to play out for this echo train. <code>shot = KS_NOTSET</code> will set all phase encoding gradients to zero. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                                                                                                     {</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <span class="keywordtype">int</span> echo;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord = <a class="code" href="_k_s_foundation_8h.html#ae5e9ce52cebc9a6543bc6e69e9a03148">KS_INIT_PHASEENCODING_COORD</a>;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="keywordflow">if</span> (phaseenc_plan_ptr-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">return</span> SUCCESS; <span class="comment">/* we haven&#39;t set it up yet */</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  }</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="comment">/* TODO: Check that #instance for phaser and zphaser is equal to phaseenc_plan_ptr-&gt;etl * 2 - 1.</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">    If 1 less that 2*etl, this indicates no fastrecovery. Don&#39;t need the last arg then */</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">for</span> (echo = 0; echo &lt; phaseenc_plan_ptr-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a>; echo++) {</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(phaseenc_plan_ptr, echo, shot);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(phaser,   0 + 2 * echo, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>); <span class="comment">/* dephaser */</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(phaser, 1 + 2 * echo, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>); <span class="comment">/* rephaser */</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">if</span> (zphaser != NULL) {</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a>(zphaser,  0 + 2 * echo, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>); <span class="comment">/* dephaser */</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a>(zphaser, 1 + 2 * echo, coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>); <span class="comment">/* rephaser */</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    }</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  } <span class="comment">/* for echo in etl */</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;} <span class="comment">/* ksfse_etlphaseamps() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ae5e9ce52cebc9a6543bc6e69e9a03148"><div class="ttname"><a href="_k_s_foundation_8h.html#ae5e9ce52cebc9a6543bc6e69e9a03148">KS_INIT_PHASEENCODING_COORD</a></div><div class="ttdeci">#define KS_INIT_PHASEENCODING_COORD</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:139</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_PHASEENCODING_PLAN::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1588</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aff91e4da3b6ccabd607ec0da04f774ce"><div class="ttname"><a href="_k_s_foundation_8h.html#aff91e4da3b6ccabd607ec0da04f774ce">ks_scan_phaser_toline</a></div><div class="ttdeci">void ks_scan_phaser_toline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from the k-space center to a desired k-s...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:319</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a81a97893a74af952d90181aa858e709b"><div class="ttname"><a href="_k_s_foundation_8h.html#a81a97893a74af952d90181aa858e709b">ks_scan_phaser_fromline</a></div><div class="ttdeci">void ks_scan_phaser_fromline(KS_PHASER *phaser, int instanceno, int view)</div><div class="ttdoc">Updates the amplitude of a KS_PHASER sequence object to move from a k-space line to the k-space cente...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:338</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a83b6497cfecf4d5fe14f598a3751af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a83b6497cfecf4d5fe14f598a3751af">&#9670;&nbsp;</a></span>ksfse_spoilamp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksfse_spoilamp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *&#160;</td>
          <td class="paramname"><em>phaseenc_plan_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___t_r_a_p.html">KS_TRAP</a> *&#160;</td>
          <td class="paramname"><em>spoiler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>res</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>2DFSE: Updates the spoiler amplitude on hardware during scanning depending on current <code>etl</code> and <code>shot</code></h4>
</p>
<p>This function updates the spoiler amplitude during scanning, and will return quietly if called on HOST.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">phaseenc_plan_ptr</td><td>Pointer to the phase encoding table (<a class="el" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html" title="Phase encoding plan for the sequence (2D and 3D)">KS_PHASEENCODING_PLAN</a>) (2D &amp; 3D) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spoiler</td><td>Pointer to the <a class="el" href="struct_k_s___t_r_a_p.html" title="Core sequence object for making trapezoids on X,Y,Z, and OMEGA boards">KS_TRAP</a> spoiler object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">res</td><td>Phase encoding resolution </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td><code>shot</code> index in range <code>[0, ceil(pe.numlinestoacq/etl)]</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;                                                                                                   {</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord = <a class="code" href="_k_s_foundation_8h.html#ae5e9ce52cebc9a6543bc6e69e9a03148">KS_INIT_PHASEENCODING_COORD</a>;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">/* change spoil direction with respect to last phase encoding blip */</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">if</span> (shot &gt;= 0) {</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 1;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="keywordtype">double</span> kspace_dist = 0.0;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; phaseenc_plan_ptr-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a>; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(phaseenc_plan_ptr, <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, shot);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="keywordflow">if</span> (coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        kspace_dist = ((res - 1.0) / 2.0) - coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a>;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      }</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    }</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">if</span> (kspace_dist &gt;= 0.0) {</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;      coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(phaseenc_plan_ptr, phaseenc_plan_ptr-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> - 1, shot);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keywordflow">if</span> (coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a2c01e4ef0737a46f9c973b77ca284424">ks_scan_trap_ampscale</a>(spoiler, 0, -1.0);</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a2c01e4ef0737a46f9c973b77ca284424">ks_scan_trap_ampscale</a>(spoiler, 0, 1.0);</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      }</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(phaseenc_plan_ptr, phaseenc_plan_ptr-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> - 1, shot);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      <span class="keywordflow">if</span> (coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a2c01e4ef0737a46f9c973b77ca284424">ks_scan_trap_ampscale</a>(spoiler, 0, 1.0);</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a2c01e4ef0737a46f9c973b77ca284424">ks_scan_trap_ampscale</a>(spoiler, 0, -1.0);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      }</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    }</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  }</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;} <span class="comment">/* ksfse_spoilamp() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ae5e9ce52cebc9a6543bc6e69e9a03148"><div class="ttname"><a href="_k_s_foundation_8h.html#ae5e9ce52cebc9a6543bc6e69e9a03148">KS_INIT_PHASEENCODING_COORD</a></div><div class="ttdeci">#define KS_INIT_PHASEENCODING_COORD</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:139</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2c01e4ef0737a46f9c973b77ca284424"><div class="ttname"><a href="_k_s_foundation_8h.html#a2c01e4ef0737a46f9c973b77ca284424">ks_scan_trap_ampscale</a></div><div class="ttdeci">void ks_scan_trap_ampscale(KS_TRAP *trap, int instanceno, float ampscale)</div><div class="ttdoc">Updates the amplitude of one or all instances of a KS_TRAP sequence object</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:182</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_PHASEENCODING_PLAN::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1588</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25ff08e5aa2e8031060c4f291bb0594f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25ff08e5aa2e8031060c4f291bb0594f">&#9670;&nbsp;</a></span>ksfse_scan_rf_off()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksfse_scan_rf_off </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets all RF pulse amplitudes to zero</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                         {</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>,    INSTRALL);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>,    INSTRALL);</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;} <span class="comment">/* ksfse_scan_rf_off() */</span></div><div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab16799dfe755e64443936787e6705e80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16799dfe755e64443936787e6705e80">&#9670;&nbsp;</a></span>ksfse_scan_rf_on()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksfse_scan_rf_on </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets all RF pulse amplitudes on</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                        {</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>,    INSTRALL);</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">selrfref1st</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">selrfref2nd</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>,    INSTRALL);</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">selrfrecover</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">selrfrecoverref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;}</div><div class="ttc" id="_k_s_foundation_8h_html_ada6d1910f42394dc7fb363d85bd6e9c5"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a></div><div class="ttdeci">void ks_scan_rf_on(KS_RF *rf, int instanceno)</div><div class="ttdoc">Resets the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:421</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aec96c9381d729ee7838490ea72fb1270"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aec96c9381d729ee7838490ea72fb1270">KSFSE_SEQUENCE::selrfrecoverref</a></div><div class="ttdeci">KS_SELRF selrfrecoverref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:60</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSFSE_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a6b26c4c3138b3db499d45beb31ec2dd1"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a6b26c4c3138b3db499d45beb31ec2dd1">KSFSE_SEQUENCE::selrfref2nd</a></div><div class="ttdeci">KS_SELRF selrfref2nd</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:57</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSFSE_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:58</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_aab2029794ab0d137fbab506b88985a4a"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#aab2029794ab0d137fbab506b88985a4a">KSFSE_SEQUENCE::selrfref1st</a></div><div class="ttdeci">KS_SELRF selrfref1st</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_ae13fefe0a260798332ea88c5b8cf49af"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#ae13fefe0a260798332ea88c5b8cf49af">KSFSE_SEQUENCE::selrfrecover</a></div><div class="ttdeci">KS_SELRF selrfrecover</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:59</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d334021df9f3f01d33dd756f4828ef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d334021df9f3f01d33dd756f4828ef6">&#9670;&nbsp;</a></span>ksfse_scan_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_scan_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Common initialization for prescan entry points MPS2 and APS2 as well as the SCAN entry point</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                             {</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;  <a class="code" href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a>();</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <span class="comment">/* Here goes code common for APS2, MPS2 and SCAN */</span></div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);  <span class="comment">/* switch to main sequence */</span></div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  scopeon(&amp;seqcore); <span class="comment">/* Activate scope for core */</span></div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  syncon(&amp;seqcore);  <span class="comment">/* Activate sync for core */</span></div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  <a class="code" href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a>(<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> / HW_GRAD_UPDATE_TIME);</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  <span class="comment">/* can we make these independent on global rsptrigger and rsprot in orderslice? */</span></div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;  settriggerarray( (<span class="keywordtype">short</span>) <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, rsptrigger);</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;</div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;} <span class="comment">/* ksfse_scan_init() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a595f599c90a3cb1f300c3c83b5fa116d"><div class="ttname"><a href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a></div><div class="ttdeci">void ks_scan_switch_to_sequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1269</div></div>
<div class="ttc" id="_k_s_foundation__tgt_8c_html_a70f8570a5d1cca01d8d49d9cd34bed79"><div class="ttname"><a href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a></div><div class="ttdeci">STATUS setssitime(long)</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_g_e_required_8e_html_ad56ed68dab054734d4e258fc33a45b71"><div class="ttname"><a href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a></div><div class="ttdeci">void GEReq_initRSP(void)</div><div class="ttdoc">RSP Init. To be inserted in the psdinit() function (or scan()) in the main sequence</div><div class="ttdef"><b>Definition:</b> GERequired.e:2671</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aedc112d27e9a6f4311eeed74eb0e00f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedc112d27e9a6f4311eeed74eb0e00f8">&#9670;&nbsp;</a></span>ksfse_scan_prescanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksfse_scan_prescanloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nloops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Prescan loop called from both APS2 and MPS2 entry points</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                                                   {</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, echoindx, sltimeinpass, slloc;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  <span class="keywordtype">int</span> centerecho = IMin(2, opetl-1, opte / <a class="code" href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a>);</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  <span class="comment">/* turn off receivers for all echoes */</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  <span class="keywordflow">for</span> (echoindx = 0; echoindx &lt; <a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">base</a>.<a class="code" href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">ngenerated</a>; echoindx++) {</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    loaddab(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[echoindx], 0, 0, DABSTORE, 0, DABOFF, PSD_LOAD_DAB_ALL);</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  }</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  <span class="comment">/* play dummy scans to get into steady state */</span></div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = -dda; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; nloops; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="comment">/* loop over slices */</span></div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>; sltimeinpass++) {</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, 0, sltimeinpass);</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;      <span class="keywordflow">if</span> (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;        <span class="comment">/* modify sequence for next playout */</span></div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;        <a class="code" href="ksfse__implementation_8e.html#ab16799dfe755e64443936787e6705e80">ksfse_scan_rf_on</a>();</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;        <a class="code" href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc], <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>); <span class="comment">/* KS_NOTSET =&gt; no phase encodes */</span></div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        <a class="code" href="ksfse__implementation_8e.html#a25ff08e5aa2e8031060c4f291bb0594f">ksfse_scan_rf_off</a>();</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      }</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      <span class="comment">/* data routing control */</span></div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &gt;= 0) {</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        <span class="comment">/* turn on receiver for center echo */</span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        loaddab(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">echo</a>[centerecho], 0, 0, DABSTORE, 0, DABON, PSD_LOAD_DAB_ALL);</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      }</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a>.<a class="code" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    } <span class="comment">/* for slices */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;  } <span class="comment">/* for nloops */</span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;} <span class="comment">/* ksfse_scan_prescanloop() */</span></div><div class="ttc" id="struct_k_s___r_e_a_d_html_a0e0bae3aa47ae5b8aae488fa0eb920ce"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a0e0bae3aa47ae5b8aae488fa0eb920ce">KS_READ::echo</a></div><div class="ttdeci">WF_PULSE * echo</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:587</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a01c14f0885b7400680196de955b96be9"><div class="ttname"><a href="ksfse__implementation_8e.html#a01c14f0885b7400680196de955b96be9">ksfse_scan_seqstate</a></div><div class="ttdeci">STATUS ksfse_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksfse sequence objects being part of KSFSE_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2376</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#a03d42c44e323f3203fe5beabcefa47a5">KSFSE_SEQUENCE::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:50</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a25ff08e5aa2e8031060c4f291bb0594f"><div class="ttname"><a href="ksfse__implementation_8e.html#a25ff08e5aa2e8031060c4f291bb0594f">ksfse_scan_rf_off</a></div><div class="ttdeci">void ksfse_scan_rf_off()</div><div class="ttdoc">Sets all RF pulse amplitudes to zero</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2441</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a06ab78e08959e925d92935c582469de8"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a06ab78e08959e925d92935c582469de8">KS_READ::base</a></div><div class="ttdeci">KS_BASE base</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:581</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a90d79b39e9c23bb5a017c214eb182a20"><div class="ttname"><a href="ksfse__implementation_8e.html#a90d79b39e9c23bb5a017c214eb182a20">ksfse_esp</a></div><div class="ttdeci">int ksfse_esp</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:112</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_ab16799dfe755e64443936787e6705e80"><div class="ttname"><a href="ksfse__implementation_8e.html#ab16799dfe755e64443936787e6705e80">ksfse_scan_rf_on</a></div><div class="ttdeci">void ksfse_scan_rf_on()</div><div class="ttdoc">Sets all RF pulse amplitudes on</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2458</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="struct_k_s_f_s_e___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSFSE_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:49</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_a9c3ae9d44addcef6a9e09b7db6679baf"><div class="ttname"><a href="ksfse__implementation_8e.html#a9c3ae9d44addcef6a9e09b7db6679baf">ksfse</a></div><div class="ttdeci">KSFSE_SEQUENCE ksfse</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:147</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
<div class="ttc" id="struct_k_s___b_a_s_e_html_a48a67aa9525b1eaff08aa809b53110dc"><div class="ttname"><a href="struct_k_s___b_a_s_e.html#a48a67aa9525b1eaff08aa809b53110dc">KS_BASE::ngenerated</a></div><div class="ttdeci">int ngenerated</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:262</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a68650973336da93ca00062d7345818eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68650973336da93ca00062d7345818eb">&#9670;&nbsp;</a></span>ksfse_excthickness</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_excthickness = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ada5166232c93c38dbff47a3284abaeb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada5166232c93c38dbff47a3284abaeb7">&#9670;&nbsp;</a></span>ksfse_gscalerfexc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_gscalerfexc = 0.9</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4f4f25a4252632f0f86c71ce5d24127c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4f25a4252632f0f86c71ce5d24127c">&#9670;&nbsp;</a></span>ksfse_flipexc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_flipexc = 90.0 with {0.0, 180.0, 90.0, VIS, &quot;Excitation flip angle [deg]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2b9f392e04c921b7b63266b33be7c647"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b9f392e04c921b7b63266b33be7c647">&#9670;&nbsp;</a></span>ksfse_spoilerarea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_spoilerarea = 2000.0 with {0.0, 20000.0, 5000.0, VIS, &quot;ksfse spoiler gradient area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="accedc302ef662e1b4d7a90b97e789dad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accedc302ef662e1b4d7a90b97e789dad">&#9670;&nbsp;</a></span>rf_stretch_rfexc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rf_stretch_rfexc = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> pulse if &gt; 1.0&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a10ce223033aad0afd68255485629bdf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ce223033aad0afd68255485629bdf7">&#9670;&nbsp;</a></span>ksfse_inflowsuppression</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_inflowsuppression = 0 with {0, 1, 0, VIS, &quot;In-flow Suppression [0:OFF, 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a02cc10bf52afa88ba2d4de122965bb81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02cc10bf52afa88ba2d4de122965bb81">&#9670;&nbsp;</a></span>ksfse_inflowsuppression_mm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_inflowsuppression_mm = 0.0 with {0.0, 100.0, 0.0, VIS, &quot;In-flow suppression [mm]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac66d550b779b0ac9177ed7640086bc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac66d550b779b0ac9177ed7640086bc4b">&#9670;&nbsp;</a></span>ksfse_vfa</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_vfa = 1.0 with {0.0, 1.0, 1.0, VIS, &quot;Variable flip angles [0:OFF, 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a37e3149443c4d14f743cc18569e3f31e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e3149443c4d14f743cc18569e3f31e">&#9670;&nbsp;</a></span>ksfse_crusherscale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_crusherscale = 0.5 with {0.0, 20.0, 0.5, VIS, &quot;scaling of crusher gradient area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab64845b4ed4919114a702f65ab1d3d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab64845b4ed4919114a702f65ab1d3d4d">&#9670;&nbsp;</a></span>ksfse_gscalerfref</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksfse_gscalerfref = 0.9</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aec461106cf1a6720d4641b9988bfa2cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec461106cf1a6720d4641b9988bfa2cc">&#9670;&nbsp;</a></span>ksfse_slicecheck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_slicecheck = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5ae230002e11e72e2b78ef1ac3fd737d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ae230002e11e72e2b78ef1ac3fd737d">&#9670;&nbsp;</a></span>rf_stretch_rfref</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rf_stretch_rfref = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF refocusing pulses if &gt; 1.0&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa069f8db856d8cb0f1f3510e71904a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa069f8db856d8cb0f1f3510e71904a5">&#9670;&nbsp;</a></span>rf_stretch_all</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rf_stretch_all = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch all RF pulses if &gt; 1.0&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b6b5ece7f3021e6f7d9003799a01163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b6b5ece7f3021e6f7d9003799a01163">&#9670;&nbsp;</a></span>ksfse_recovery</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_recovery = <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a> with {<a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a242e58204f1faca889dbb52cbe0cd647">KSFSE_RECOVERY_FAST</a>, <a class="el" href="ksfse__implementation_8e.html#abc6126af1d45847bc59afa0aa3216b04a5406c75325c7e4a8a29a8b5bde90287b">KSFSE_RECOVERY_OFF</a>, VIS, &quot;Recovery. 0:off 1:T1wopt 2:T2fast&quot;, }</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1ef0ac44bd2e5e837f8bbbe9ea78b003"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ef0ac44bd2e5e837f8bbbe9ea78b003">&#9670;&nbsp;</a></span>rf_stretch_rfrecovery</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float rf_stretch_rfrecovery = 1.0 with {0.01, 100.0, 1.0, VIS, &quot;Stretch RF recovery pulses if &gt; 1.0&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5aaa25c865ecd2ee214ba45dfa00a96d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aaa25c865ecd2ee214ba45dfa00a96d">&#9670;&nbsp;</a></span>ksfse_kxnover_min</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_kxnover_min = <a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a> with {<a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, 512, <a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, VIS, &quot;Min mum kx overscans for minTE&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a76ebb43b78039e7250fac06e50fba578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76ebb43b78039e7250fac06e50fba578">&#9670;&nbsp;</a></span>ksfse_kxnover</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_kxnover = 32 with {<a class="el" href="ksfse__implementation_8e.html#a49b40808cadc9aa2638ff5cf65effbc7">KSFSE_MINHNOVER</a>, 512, 32, VIS, &quot;Num kx overscans for minTE&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a33cc9c27102dbf43a3446c2558ca9168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33cc9c27102dbf43a3446c2558ca9168">&#9670;&nbsp;</a></span>ksfse_rampsampling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_rampsampling = 0 with {0, 1, 0, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2fd510dada2197d9628e541f89b9426"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2fd510dada2197d9628e541f89b9426">&#9670;&nbsp;</a></span>ksfse_extragap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_extragap = 0 with {0, 100ms, 0, VIS, &quot;extra gap between readout [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac0677ae1147b74362792c5014c638e65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0677ae1147b74362792c5014c638e65">&#9670;&nbsp;</a></span>ksfse_etlte</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_etlte = 1 with {0, 1, 1, VIS, &quot;ETL controls TE&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1bb767118594019cf8553926001a7259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bb767118594019cf8553926001a7259">&#9670;&nbsp;</a></span>ksfse_xcrusherarea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_xcrusherarea = 100.0 with {0.0, 100.0, 0.0, VIS, &quot;x crusher area for readout&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a90d79b39e9c23bb5a017c214eb182a20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90d79b39e9c23bb5a017c214eb182a20">&#9670;&nbsp;</a></span>ksfse_esp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_esp = 0 with {0, 1000000, 0, VIS, &quot;View-only: Echo spacing in [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5f9cddaa2b0daf95f740080d00669a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f9cddaa2b0daf95f740080d00669a86">&#9670;&nbsp;</a></span>ksfse_noph</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_noph = 0 with {0, 1, 0, VIS, &quot;Turn OFF phase encoding [0:Disabled 1:Enabled]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae666a499a4647e92db6977328a60a8c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae666a499a4647e92db6977328a60a8c3">&#9670;&nbsp;</a></span>ksfse_minacslines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_minacslines = 12 with {0, 512, 12, VIS, &quot;Minimum ACS lines for ARC&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a955ccaf130774fd90f7831650bf6a94b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a955ccaf130774fd90f7831650bf6a94b">&#9670;&nbsp;</a></span>ksfse_minzacslines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_minzacslines = 12 with {0, 512, 12, VIS, &quot;Minimum z ACS lines for ARC&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a425ae21dd8ac8304478402f10bbde98f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a425ae21dd8ac8304478402f10bbde98f">&#9670;&nbsp;</a></span>ksfse_pos_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_pos_start = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, VIS, &quot;us from start until the first waveform begins&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a83e1154fac838dc278087955669299cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e1154fac838dc278087955669299cb">&#9670;&nbsp;</a></span>ksfse_ssi_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_ssi_time = <a class="el" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a> with {50, , <a class="el" href="ksfse__implementation_8e.html#aef9d9c4f9c117165300e06cf9899fda8">KSFSE_MIN_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab7af5654e8b4db142fb80465d6f256f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7af5654e8b4db142fb80465d6f256f7">&#9670;&nbsp;</a></span>ksfse_dda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_dda = 2 with {0, 200, 2, VIS, &quot;Number of dummy scans for steady state&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4da9fbe7f1a563677f5e88060905eeeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4da9fbe7f1a563677f5e88060905eeeb">&#9670;&nbsp;</a></span>ksfse_debug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_debug = 1 with {0, 100, 1, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e1230681574d002f10a28671a56d705"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e1230681574d002f10a28671a56d705">&#9670;&nbsp;</a></span>ksfse_imsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_imsize = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afead5e22beaaab664df25dd0cfb8fda9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afead5e22beaaab664df25dd0cfb8fda9">&#9670;&nbsp;</a></span>ksfse_abort_on_kserror</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_abort_on_kserror = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3c49bc9f0980dd02a99cd26b933b7131"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c49bc9f0980dd02a99cd26b933b7131">&#9670;&nbsp;</a></span>ksfse_mintr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_mintr = 0 with {0, 20s, 0, VIS, &quot;Min TR (ms) [0: Disabled]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad232fff30fc715e9baa395aab5d40bd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad232fff30fc715e9baa395aab5d40bd5">&#9670;&nbsp;</a></span>ksfse_maxtr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksfse_maxtr = 0 with {0, 40s, 0, VIS, &quot;Max TR (ms) [0: Disabled]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9c3ae9d44addcef6a9e09b7db6679baf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c3ae9d44addcef6a9e09b7db6679baf">&#9670;&nbsp;</a></span>ksfse</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_f_s_e___s_e_q_u_e_n_c_e.html">KSFSE_SEQUENCE</a> ksfse = <a class="el" href="ksfse__implementation_8e.html#a69ef18818d8b0e4117ded34e134e181d">KSFSE_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f39fad60409167fe45164b72a131e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f39fad60409167fe45164b72a131e0b">&#9670;&nbsp;</a></span>sequence_iopts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sequence_iopts[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">  PSD_IOPT_ARC, </div><div class="line">  PSD_IOPT_ASSET, </div><div class="line">  PSD_IOPT_EDR, </div><div class="line">  PSD_IOPT_DYNPL, </div><div class="line">  PSD_IOPT_TLRD_RF, </div><div class="line">  PSD_IOPT_MILDNOTE, </div><div class="line">  PSD_IOPT_ZIP_512, </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="adffbee0f8231c5226387c8dd8f2dd482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adffbee0f8231c5226387c8dd8f2dd482">&#9670;&nbsp;</a></span>volindx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int volindx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae477e374b559bf16a475321797d62cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae477e374b559bf16a475321797d62cb">&#9670;&nbsp;</a></span>passindx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int passindx</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_edd0b46848e1966a9ba471eaad9abcfd.html">tmpfiles</a></li><li class="navelem"><a class="el" href="ksfse__implementation_8e.html">ksfse_implementation.e</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
