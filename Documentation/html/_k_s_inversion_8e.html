<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KSFoundation: KSInversion.e File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KarolinskaLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KSFoundation
   &#160;<span id="projectnumber">[Feb-2019]</span>
   </div>
   <div id="projectbrief">A platform for simpler EPIC programming on GE MR systems</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_k_s_inversion_8e.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">KSInversion.e File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acccb7cf90701a42deac2cc8555a7625f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#acccb7cf90701a42deac2cc8555a7625f">KSINV_MODULE_LOADED</a>&#160;&#160;&#160;/* can be used to check whether the KSInversion module has been included in a main psd */</td></tr>
<tr class="separator:acccb7cf90701a42deac2cc8555a7625f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11b34b780eeeb61d87bf58432fe16c8d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a>&#160;&#160;&#160;180</td></tr>
<tr class="separator:a11b34b780eeeb61d87bf58432fe16c8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2772d646804abafb1606b361f08b717"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a>&#160;&#160;&#160;5000</td></tr>
<tr class="separator:ad2772d646804abafb1606b361f08b717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868e7ea1239820edb6d7279f65e384a6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a>&#160;&#160;&#160;1000 /* try to reduce this value */</td></tr>
<tr class="separator:a868e7ea1239820edb6d7279f65e384a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fdc2a27e8d7a5b81219a20f51e8a29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a53fdc2a27e8d7a5b81219a20f51e8a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d747180202840f5e601225a98ef8e06"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6d747180202840f5e601225a98ef8e06">KSINV_FILLTR_SSITIME</a>&#160;&#160;&#160;1000 /* try to reduce this value */</td></tr>
<tr class="separator:a6d747180202840f5e601225a98ef8e06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c4be32a3787391c3c1239ae744a496"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#af0c4be32a3787391c3c1239ae744a496">KSINV_MINTR_T2FLAIR</a>&#160;&#160;&#160;8000000 /* default minTR [us] for T2FLAIR, 8 [s] */</td></tr>
<tr class="separator:af0c4be32a3787391c3c1239ae744a496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674357090f00fc5dcfb92e6b734b3ba4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a>&#160;&#160;&#160;1300000 /* default minTR [us] for T1FLAIR, 1.3 [s] */</td></tr>
<tr class="separator:a674357090f00fc5dcfb92e6b734b3ba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2968a3f8855256ed2cebfa2236f048af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a2968a3f8855256ed2cebfa2236f048af">KSINV_MAXTR_T1FLAIR</a>&#160;&#160;&#160;2500000 /* default maxTR [us] for T1FLAIR, 2.5 [s] */</td></tr>
<tr class="separator:a2968a3f8855256ed2cebfa2236f048af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc869a70acec39e5abf83e4ff3f2282c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>&#160;&#160;&#160;3.0 /* how much the inversion slice thickness may increase over <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> */</td></tr>
<tr class="separator:afc869a70acec39e5abf83e4ff3f2282c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14920c5e204db4c6806708793acd04d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a14920c5e204db4c6806708793acd04d6">T1_CSF_3T</a>&#160;&#160;&#160;4500</td></tr>
<tr class="separator:a14920c5e204db4c6806708793acd04d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84b291225425cacf5586f8e96eceb45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ae84b291225425cacf5586f8e96eceb45">T1_CSF_1_5T</a>&#160;&#160;&#160;3600</td></tr>
<tr class="separator:ae84b291225425cacf5586f8e96eceb45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea1ff6fab1e514587e7476608e5a6411"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aea1ff6fab1e514587e7476608e5a6411">T1_GM_3T</a>&#160;&#160;&#160;1400</td></tr>
<tr class="separator:aea1ff6fab1e514587e7476608e5a6411"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320b11f98da39a21a7434c56a6114d34"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a320b11f98da39a21a7434c56a6114d34">T1_GM_1_5T</a>&#160;&#160;&#160;1100</td></tr>
<tr class="separator:a320b11f98da39a21a7434c56a6114d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f426784f63708cad67ecccef32052be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a2f426784f63708cad67ecccef32052be">T1_WM_3T</a>&#160;&#160;&#160;750</td></tr>
<tr class="separator:a2f426784f63708cad67ecccef32052be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42466f02f13cffb483cc1e8d9f922969"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a42466f02f13cffb483cc1e8d9f922969">T1_WM_1_5T</a>&#160;&#160;&#160;600</td></tr>
<tr class="separator:a42466f02f13cffb483cc1e8d9f922969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f5d44c9946155170eee07f10711b90"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a06f5d44c9946155170eee07f10711b90">T1_FAT_3T</a>&#160;&#160;&#160;340</td></tr>
<tr class="separator:a06f5d44c9946155170eee07f10711b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a274b254ad1864dae61ca471400767801"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a274b254ad1864dae61ca471400767801">T1_FAT_1_5T</a>&#160;&#160;&#160;260</td></tr>
<tr class="separator:a274b254ad1864dae61ca471400767801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96573441c0546978cb8dfa6e5448c5d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#af96573441c0546978cb8dfa6e5448c5d">KSINV_INIT_PARAMS</a>&#160;&#160;&#160;{<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>, <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a>, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, 0, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a>, FALSE, <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a>, 0, 0, <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a>, 90, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, 1, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>}</td></tr>
<tr class="separator:af96573441c0546978cb8dfa6e5448c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be1d3680000349036dcb110c7ff1a6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a>&#160;&#160;&#160;{{0,0,NULL,sizeof(<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a>)}, <a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_inversion_8e.html#af96573441c0546978cb8dfa6e5448c5d">KSINV_INIT_PARAMS</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>}</td></tr>
<tr class="separator:a4be1d3680000349036dcb110c7ff1a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd4c1a6bad73dbecc8d215d63803bb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a0dd4c1a6bad73dbecc8d215d63803bb4">KSINV_PIUSE</a>(o1,  o2,  o3,  o4)</td></tr>
<tr class="separator:a0dd4c1a6bad73dbecc8d215d63803bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61997e3aafb10556ab483043f36729da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a61997e3aafb10556ab483043f36729da">KSINV_OPUSER_VALS</a>(o1,  o2,  o3,  o4)</td></tr>
<tr class="separator:a61997e3aafb10556ab483043f36729da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96ddb157c7e6c1b173e8dae07d2f2ff9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a96ddb157c7e6c1b173e8dae07d2f2ff9">KSINV_OPUSER_STRUCTS</a>(o1,  o2,  o3,  o4)</td></tr>
<tr class="separator:a96ddb157c7e6c1b173e8dae07d2f2ff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2d943c3862a3980c7291b8e3ac1818"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a>(sptr,  o1,  o2,  o3,  o4)</td></tr>
<tr class="separator:a3b2d943c3862a3980c7291b8e3ac1818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f6e930c7703ec1f845c424971de195"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a48f6e930c7703ec1f845c424971de195">KSINV_EVAL_CUSTOMRF</a>(sptr,  rfptr,  o1,  o2,  o3,  o4)</td></tr>
<tr class="separator:a48f6e930c7703ec1f845c424971de195"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:adc29c2ff13d900c2f185ee95427fb06c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <br />
&#160;&#160;<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>, 
<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>, 
<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>, 
<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a>, 
<br />
&#160;&#160;<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>
<br />
 }</td></tr>
<tr class="separator:adc29c2ff13d900c2f185ee95427fb06c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61dadd085c1777f559549e05962b2c9e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, 
<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, 
<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634">KSINV_RF_CUSTOM</a>
 }</td></tr>
<tr class="separator:a61dadd085c1777f559549e05962b2c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda2604f80fde12fdea9080776fff112"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a> { <a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>, 
<a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a>, 
<a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a>, 
<a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf">KSINV_LOOP_SLICEAHEAD_LAST</a>
 }</td></tr>
<tr class="separator:acda2604f80fde12fdea9080776fff112"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa08a7ecfbf13a621a577fa984bda2b5a"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</td></tr>
<tr class="separator:aa08a7ecfbf13a621a577fa984bda2b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d73f67e51b69dac2f331c220e8c7106"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv)</td></tr>
<tr class="separator:a5d73f67e51b69dac2f331c220e8c7106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0adb26c729e5b3bd252f5e1918869c4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a> (const <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *slice_plan, const SCAN_INFO *slice_positions, int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *<a class="el" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, <a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a> ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</td></tr>
<tr class="separator:af0adb26c729e5b3bd252f5e1918869c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30b492de37e2ee91adf49a2a2ac6778e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a30b492de37e2ee91adf49a2a2ac6778e">ksinv_init_params</a> (<a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a> *params)</td></tr>
<tr class="separator:a30b492de37e2ee91adf49a2a2ac6778e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82cf97823a7c838642029fdf29e9d76e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv)</td></tr>
<tr class="separator:a82cf97823a7c838642029fdf29e9d76e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6d57cd163e2af9351a9535c2f32fdbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aa6d57cd163e2af9351a9535c2f32fdbc">ksinv_eval_copycvs</a> (<a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a> *params, int mode)</td></tr>
<tr class="separator:aa6d57cd163e2af9351a9535c2f32fdbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a46f11f109e568396afa27660f9425"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a34a46f11f109e568396afa27660f9425">ksinv_eval_setuprf</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, const char *suffix, <a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *custom_selrf)</td></tr>
<tr class="separator:a34a46f11f109e568396afa27660f9425"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f02f9a7da4f096c07c202d43e3d8b3"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a67f02f9a7da4f096c07c202d43e3d8b3">ksinv_eval_setupt2prep</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv)</td></tr>
<tr class="separator:a67f02f9a7da4f096c07c202d43e3d8b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb942440dc967f835bdad59f07519e03"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#abb942440dc967f835bdad59f07519e03">ksinv_eval_setupobjects</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, const char *suffix, <a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *custom_selrf)</td></tr>
<tr class="separator:abb942440dc967f835bdad59f07519e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d9eb96605539fd74a90b3788f21998"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a> (int TR, int T1value, int seqdur)</td></tr>
<tr class="separator:a06d9eb96605539fd74a90b3788f21998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4d7e8d641045f0f72b824493bdcb88"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6a4d7e8d641045f0f72b824493bdcb88">ksinv_eval_duration</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, int TI, int coreslice_momentstart)</td></tr>
<tr class="separator:a6a4d7e8d641045f0f72b824493bdcb88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a2bc8ea23c238a06473dc7e8a32def3"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a9a2bc8ea23c238a06473dc7e8a32def3">ksinv_eval_duration_t1value</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, int *TR, int *TI, int approxti_flag, int coreslice_momentstart, int coreslice_duration, int mainseq_mindur, int T1value_toNull, int slperpass)</td></tr>
<tr class="separator:a9a2bc8ea23c238a06473dc7e8a32def3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2ff181a992b40e2a58afec637d14bf"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a3f2ff181a992b40e2a58afec637d14bf">ksinv_eval_duration_flairblock</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, int TI, int coreslice_momentstart, int coreslice_duration, int slperpass)</td></tr>
<tr class="separator:a3f2ff181a992b40e2a58afec637d14bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356bbeecc0c30e76a26bec0290a16945"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a356bbeecc0c30e76a26bec0290a16945">ksinv_eval_setfilltr</a> (<a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *filltr, const char *const desc, int duration)</td></tr>
<tr class="separator:a356bbeecc0c30e76a26bec0290a16945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5737de577667231c42545c5b12afca2c"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a5737de577667231c42545c5b12afca2c">ksinv_init_UI</a> ()</td></tr>
<tr class="separator:a5737de577667231c42545c5b12afca2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1faad3c6c3b83af20fc17d34db56c1ed"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a1faad3c6c3b83af20fc17d34db56c1ed">ksinv_eval_UI</a> ()</td></tr>
<tr class="separator:a1faad3c6c3b83af20fc17d34db56c1ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a70fccdbea3feb9556b6d52ea9aaaed"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *custom_selrf)</td></tr>
<tr class="separator:a5a70fccdbea3feb9556b6d52ea9aaaed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addad288b52ddf945f6740ac6241b4a39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a> (const <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *slice_plan, <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, float gheatfact, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *<a class="el" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</td></tr>
<tr class="separator:addad288b52ddf945f6740ac6241b4a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0d4a045ba5f33c135f38227fe6326b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#af0d4a045ba5f33c135f38227fe6326b1">ksinv_eval_maxslicespertr</a> (int TR, <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> temp_slice_plan, <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, float gheatfact, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="el" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *<a class="el" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</td></tr>
<tr class="separator:af0d4a045ba5f33c135f38227fe6326b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56977a078ab040bd50c4b8b7fba9337"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, int *filltr_time, int *repetition_time, int *inversion_time, int autotr_flag, int T1tonull, int coreslice_momentstart, int coreslice_duration, int slperpass)</td></tr>
<tr class="separator:af56977a078ab040bd50c4b8b7fba9337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b1b8efc850e9c75308857736fd847ec"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a5b1b8efc850e9c75308857736fd847ec">ksinv_eval_flairblock_withmainupdate</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *<a class="el" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *mainseqctrl, int *repetition_time, int *inversion_time, int autotr_flag, int T1tonull, int coreslice_momentstart, int coreslice_duration, int slperpass)</td></tr>
<tr class="separator:a5b1b8efc850e9c75308857736fd847ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a4ae2b692531f3c649a5035992425c1"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args, <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *mainseqctrl)</td></tr>
<tr class="separator:a2a4ae2b692531f3c649a5035992425c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a7199cbc45d139870616b7ec288cb7"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a44a7199cbc45d139870616b7ec288cb7">ksinv_check</a> ()</td></tr>
<tr class="separator:a44a7199cbc45d139870616b7ec288cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad58f67c4aa2bc4815d7ea1298753e069"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ad58f67c4aa2bc4815d7ea1298753e069">ksinv_predownload_setrecon</a> ()</td></tr>
<tr class="separator:ad58f67c4aa2bc4815d7ea1298753e069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adecabb815648ab0473dade37919a7e0b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#adecabb815648ab0473dade37919a7e0b">ksinv_pulsegen</a> ()</td></tr>
<tr class="separator:adecabb815648ab0473dade37919a7e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7243c21c92994e98b1baf972465bde4"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ac7243c21c92994e98b1baf972465bde4">ksinv_scan_seqstate</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, const SCAN_INFO *slice_info)</td></tr>
<tr class="separator:ac7243c21c92994e98b1baf972465bde4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc6e42d3cc89e0469897a74a66ffcc19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a> (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *ksinv, const SCAN_INFO *slice_pos)</td></tr>
<tr class="separator:adc6e42d3cc89e0469897a74a66ffcc19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b638972c4a790586ed8031327e85d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ae4b638972c4a790586ed8031327e85d9">ksinv_scan_sliceloop_nargs</a> (int slperpass, int nargs, void **args)</td></tr>
<tr class="separator:ae4b638972c4a790586ed8031327e85d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab1a16f7634c6afebc34abe7a8942709f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a> = <a class="el" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a></td></tr>
<tr class="separator:ab1a16f7634c6afebc34abe7a8942709f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b459c9789d0941c6a2e6262e59579aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a> = <a class="el" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a5b459c9789d0941c6a2e6262e59579aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43cba2a0a2557026231e05da863c15c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a> = <a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a></td></tr>
<tr class="separator:a43cba2a0a2557026231e05da863c15c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249adb4dd19303322658fb21bd50f0f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = 0</td></tr>
<tr class="separator:a249adb4dd19303322658fb21bd50f0f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad16abf0f4ed621197332669743d97511"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> = 0</td></tr>
<tr class="separator:ad16abf0f4ed621197332669743d97511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326f5619a82910c975cbe0dfdb80792a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a326f5619a82910c975cbe0dfdb80792a">use_ir1_mode</a> = 0</td></tr>
<tr class="separator:a326f5619a82910c975cbe0dfdb80792a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595dd888c8c07d45eedcc25c826309f9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a> = 0</td></tr>
<tr class="separator:a595dd888c8c07d45eedcc25c826309f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95165792103811810e882d2be1381f54"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a> = 0</td></tr>
<tr class="separator:a95165792103811810e882d2be1381f54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81b4237583e689d003167994a8719a0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a> = 0</td></tr>
<tr class="separator:a81b4237583e689d003167994a8719a0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b12154153490ce7139f74b5ac1d9199"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a> = NULL</td></tr>
<tr class="separator:a6b12154153490ce7139f74b5ac1d9199"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a71ab613a50aa4cb90eb4146fb06ca7"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a> = NULL</td></tr>
<tr class="separator:a8a71ab613a50aa4cb90eb4146fb06ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a4b2616ed775246a12caf9b951eef55"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> = NULL</td></tr>
<tr class="separator:a6a4b2616ed775246a12caf9b951eef55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6579b086714c710ddbc06234b65778ef"><td class="memItemLeft" align="right" valign="top">float *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a> = NULL</td></tr>
<tr class="separator:a6579b086714c710ddbc06234b65778ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd63530f860d975a0f760ad700a0ffd"><td class="memItemLeft" align="right" valign="top">_cvfloat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a> = NULL</td></tr>
<tr class="separator:a8dd63530f860d975a0f760ad700a0ffd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefdb8236f7b0142a72e065761f38d77a"><td class="memItemLeft" align="right" valign="top">_cvfloat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a> = NULL</td></tr>
<tr class="separator:aefdb8236f7b0142a72e065761f38d77a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc292edee1b0d4a4bb8dc26a5aaafb0"><td class="memItemLeft" align="right" valign="top">_cvfloat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a> = NULL</td></tr>
<tr class="separator:abfc292edee1b0d4a4bb8dc26a5aaafb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefff0d8b1fa3576fd70d11c3c6531153"><td class="memItemLeft" align="right" valign="top">_cvfloat *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a> = NULL</td></tr>
<tr class="separator:aefff0d8b1fa3576fd70d11c3c6531153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b9ea6f30b5b38c45e32c084a7bac3c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a> = <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a> with {10, 20000, <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a>, VIS, &quot;Time from eos to ssi in intern trig&quot;,}</td></tr>
<tr class="separator:a3b9ea6f30b5b38c45e32c084a7bac3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec411ca45ee9d7fd1497ad6bdec3621"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a> = <a class="el" href="_k_s_inversion_8e.html#a6d747180202840f5e601225a98ef8e06">KSINV_FILLTR_SSITIME</a> with {10, 20000, <a class="el" href="_k_s_inversion_8e.html#a6d747180202840f5e601225a98ef8e06">KSINV_FILLTR_SSITIME</a>, VIS, &quot;Time from eos to ssi in intern trig&quot;,}</td></tr>
<tr class="separator:a3ec411ca45ee9d7fd1497ad6bdec3621"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedcaff264fe0d9a3f5f21f798294df71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a> = <a class="el" href="_k_s_inversion_8e.html#af0c4be32a3787391c3c1239ae744a496">KSINV_MINTR_T2FLAIR</a> with {0, 30s, KSINV_MINTR_T2FLAIR, VIS, &quot;Min TR for T2-FLAIR&quot;,}</td></tr>
<tr class="separator:aedcaff264fe0d9a3f5f21f798294df71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc139f545253464349e788315546ee0a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#acc139f545253464349e788315546ee0a">ksinv_mintr_t1flair</a> = <a class="el" href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a> with {0, 30s, KSINV_MINTR_T1FLAIR, VIS, &quot;Min TR for T1-FLAIR&quot;,}</td></tr>
<tr class="separator:acc139f545253464349e788315546ee0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3fa4125b24bcc3e5d7f0ffacc32d86b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a> = <a class="el" href="_k_s_inversion_8e.html#a2968a3f8855256ed2cebfa2236f048af">KSINV_MAXTR_T1FLAIR</a> with {0, 30s, KSINV_MAXTR_T1FLAIR, VIS, &quot;Max TR for T1-FLAIR&quot;,}</td></tr>
<tr class="separator:ab3fa4125b24bcc3e5d7f0ffacc32d86b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d86b129051574ab247567e218f4b62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#aa7d86b129051574ab247567e218f4b62">ksinv_slicecheck</a> = 0 with {0.0, 1.0, 0.0, VIS, &quot;move slice sel to x axis for slice thickness test&quot;,}</td></tr>
<tr class="separator:aa7d86b129051574ab247567e218f4b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a093e98e842e1dbeff8b101ba74e70162"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a093e98e842e1dbeff8b101ba74e70162">ksinv_approxti</a> = 1 with {0, 1, 1, VIS, &quot;allow approx. TI for sliceahead IR mode&quot;,}</td></tr>
<tr class="separator:a093e98e842e1dbeff8b101ba74e70162"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a782452f0d134270a074410f806be776f"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a782452f0d134270a074410f806be776f">ksinv_flip</a> = <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a> with {0, 360, <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a>, VIS, &quot;RF flip angle [deg]&quot;,}</td></tr>
<tr class="separator:a782452f0d134270a074410f806be776f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407623c8b83da7fb46f7c2fb693f58e1"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a> = 1.0 with {0, <a class="el" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>, 1.0, VIS, &quot;Inversion sl.thick / <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> factor&quot;,}</td></tr>
<tr class="separator:a407623c8b83da7fb46f7c2fb693f58e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09100e3070e07bd6ee68aeecffe09997"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a09100e3070e07bd6ee68aeecffe09997">ksinv_rfoffset</a> = 0 with { -10000, 10000, 0, VIS, &quot;RF <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> freq offset [Hz]&quot;,}</td></tr>
<tr class="separator:a09100e3070e07bd6ee68aeecffe09997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4386f491cf706c7d23222d2fc840e20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#ad4386f491cf706c7d23222d2fc840e20">ksinv_rftype</a> = <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a> with {<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, VIS, &quot;RF type (0:Std 1:Adiabatic)&quot;,}</td></tr>
<tr class="separator:ad4386f491cf706c7d23222d2fc840e20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bf554ec251f326d2cf7e544803cac5e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a8bf554ec251f326d2cf7e544803cac5e">ksinv_spoilerarea</a> = <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a> with {0, 100000, <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a>, VIS, &quot;Spoiler area&quot;,}</td></tr>
<tr class="separator:a8bf554ec251f326d2cf7e544803cac5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d3d685e189f82e1e1b536694d64933"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a97d3d685e189f82e1e1b536694d64933">ksinv_startpos</a> = <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a> with {16, 10000, <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a>, VIS, &quot;Start time of the first grad/RF inversion pulse in sequence module&quot;,}</td></tr>
<tr class="separator:a97d3d685e189f82e1e1b536694d64933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b20d97b03afcad597c99a023359575"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a54b20d97b03afcad597c99a023359575">ksinv_t2prep</a> = 0 with {0, 1, 0, VIS, &quot;Use T2 preperation instead of conventional Inversion&quot;,}</td></tr>
<tr class="separator:a54b20d97b03afcad597c99a023359575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795a20d46908cabfe8bafd734cf6d749"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a795a20d46908cabfe8bafd734cf6d749">ksinv_t2prep_exc_flip</a> = 90 with {0, 180, 90, VIS, &quot;Flip angle of the <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> pulse and the flip down/up pulse for T2 prep&quot;,}</td></tr>
<tr class="separator:a795a20d46908cabfe8bafd734cf6d749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e43e12d3223d1ba27eaccc3657cb824"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6e43e12d3223d1ba27eaccc3657cb824">ksinv_t2prep_N_Refoc</a> = 1 with {1, 16, 1, VIS, &quot;Number of refocusing pulses in the T2 inversion preperation&quot;,}</td></tr>
<tr class="separator:a6e43e12d3223d1ba27eaccc3657cb824"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0892225b7196bf0d726691746f6af87f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a0892225b7196bf0d726691746f6af87f">ksinv_t2prep_TE</a> = 100ms with {30ms, 300ms, 100ms, VIS, &quot;TE for T2 inv preperation&quot;,}</td></tr>
<tr class="separator:a0892225b7196bf0d726691746f6af87f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a73ff5d0928aab9fa04bd8a8bac689c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a6a73ff5d0928aab9fa04bd8a8bac689c">ksinv_t2prep_rftype_refoc</a> = <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a> with {<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, VIS, &quot;RF type (0:Std 1:Adiabatic)&quot;,}</td></tr>
<tr class="separator:a6a73ff5d0928aab9fa04bd8a8bac689c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a859527bdf4dc460bdf84895ad48fad8e"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a859527bdf4dc460bdf84895ad48fad8e">ksinv_slthickfact_exc</a> = 1.0 with {0, <a class="el" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>, 1.0, VIS, &quot;Inversion sl.thick / <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> factor&quot;,}</td></tr>
<tr class="separator:a859527bdf4dc460bdf84895ad48fad8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f26aad1c923f8730b833487f07f6cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_k_s_foundation_8h.html#a7b8e8b52358de55dd1fb64ef924b2f48">KS_MAT4x4</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_k_s_inversion_8e.html#a22f26aad1c923f8730b833487f07f6cb">Mphysical_inversion</a> = <a class="el" href="_k_s_foundation_8h.html#afdbaf673741ec0d6d5ebb7ab5974338e">KS_MAT4x4_IDENTITY</a></td></tr>
<tr class="separator:a22f26aad1c923f8730b833487f07f6cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains an inversion preparation module that should be <code>@inline</code>'d at the beginning of a KSFoundation PSD. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acccb7cf90701a42deac2cc8555a7625f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acccb7cf90701a42deac2cc8555a7625f">&#9670;&nbsp;</a></span>KSINV_MODULE_LOADED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_MODULE_LOADED&#160;&#160;&#160;/* can be used to check whether the KSInversion module has been included in a main psd */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a11b34b780eeeb61d87bf58432fe16c8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11b34b780eeeb61d87bf58432fe16c8d">&#9670;&nbsp;</a></span>KSINV_DEFAULT_FLIP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_DEFAULT_FLIP&#160;&#160;&#160;180</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad2772d646804abafb1606b361f08b717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2772d646804abafb1606b361f08b717">&#9670;&nbsp;</a></span>KSINV_DEFAULT_SPOILERAREA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_DEFAULT_SPOILERAREA&#160;&#160;&#160;5000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a868e7ea1239820edb6d7279f65e384a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a868e7ea1239820edb6d7279f65e384a6">&#9670;&nbsp;</a></span>KSINV_DEFAULT_SSITIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_DEFAULT_SSITIME&#160;&#160;&#160;1000 /* try to reduce this value */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53fdc2a27e8d7a5b81219a20f51e8a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53fdc2a27e8d7a5b81219a20f51e8a29">&#9670;&nbsp;</a></span>KSINV_DEFAULT_STARTPOS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_DEFAULT_STARTPOS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d747180202840f5e601225a98ef8e06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d747180202840f5e601225a98ef8e06">&#9670;&nbsp;</a></span>KSINV_FILLTR_SSITIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_FILLTR_SSITIME&#160;&#160;&#160;1000 /* try to reduce this value */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af0c4be32a3787391c3c1239ae744a496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0c4be32a3787391c3c1239ae744a496">&#9670;&nbsp;</a></span>KSINV_MINTR_T2FLAIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_MINTR_T2FLAIR&#160;&#160;&#160;8000000 /* default minTR [us] for T2FLAIR, 8 [s] */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a674357090f00fc5dcfb92e6b734b3ba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a674357090f00fc5dcfb92e6b734b3ba4">&#9670;&nbsp;</a></span>KSINV_MINTR_T1FLAIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_MINTR_T1FLAIR&#160;&#160;&#160;1300000 /* default minTR [us] for T1FLAIR, 1.3 [s] */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2968a3f8855256ed2cebfa2236f048af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2968a3f8855256ed2cebfa2236f048af">&#9670;&nbsp;</a></span>KSINV_MAXTR_T1FLAIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_MAXTR_T1FLAIR&#160;&#160;&#160;2500000 /* default maxTR [us] for T1FLAIR, 2.5 [s] */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afc869a70acec39e5abf83e4ff3f2282c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc869a70acec39e5abf83e4ff3f2282c">&#9670;&nbsp;</a></span>KSINV_MAXTHICKFACT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_MAXTHICKFACT&#160;&#160;&#160;3.0 /* how much the inversion slice thickness may increase over <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a14920c5e204db4c6806708793acd04d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14920c5e204db4c6806708793acd04d6">&#9670;&nbsp;</a></span>T1_CSF_3T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_CSF_3T&#160;&#160;&#160;4500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae84b291225425cacf5586f8e96eceb45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84b291225425cacf5586f8e96eceb45">&#9670;&nbsp;</a></span>T1_CSF_1_5T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_CSF_1_5T&#160;&#160;&#160;3600</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aea1ff6fab1e514587e7476608e5a6411"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea1ff6fab1e514587e7476608e5a6411">&#9670;&nbsp;</a></span>T1_GM_3T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_GM_3T&#160;&#160;&#160;1400</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a320b11f98da39a21a7434c56a6114d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a320b11f98da39a21a7434c56a6114d34">&#9670;&nbsp;</a></span>T1_GM_1_5T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_GM_1_5T&#160;&#160;&#160;1100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f426784f63708cad67ecccef32052be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f426784f63708cad67ecccef32052be">&#9670;&nbsp;</a></span>T1_WM_3T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_WM_3T&#160;&#160;&#160;750</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a42466f02f13cffb483cc1e8d9f922969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42466f02f13cffb483cc1e8d9f922969">&#9670;&nbsp;</a></span>T1_WM_1_5T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_WM_1_5T&#160;&#160;&#160;600</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06f5d44c9946155170eee07f10711b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06f5d44c9946155170eee07f10711b90">&#9670;&nbsp;</a></span>T1_FAT_3T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_FAT_3T&#160;&#160;&#160;340</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a274b254ad1864dae61ca471400767801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a274b254ad1864dae61ca471400767801">&#9670;&nbsp;</a></span>T1_FAT_1_5T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T1_FAT_1_5T&#160;&#160;&#160;260</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af96573441c0546978cb8dfa6e5448c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96573441c0546978cb8dfa6e5448c5d">&#9670;&nbsp;</a></span>KSINV_INIT_PARAMS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_INIT_PARAMS&#160;&#160;&#160;{<a class="el" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>, <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a>, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, 0, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a>, FALSE, <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a>, 0, 0, <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a>, 90, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, 1, <a class="el" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4be1d3680000349036dcb110c7ff1a6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be1d3680000349036dcb110c7ff1a6f">&#9670;&nbsp;</a></span>KSINV_INIT_SEQUENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_INIT_SEQUENCE&#160;&#160;&#160;{{0,0,NULL,sizeof(<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a>)}, <a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_inversion_8e.html#af96573441c0546978cb8dfa6e5448c5d">KSINV_INIT_PARAMS</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0dd4c1a6bad73dbecc8d215d63803bb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dd4c1a6bad73dbecc8d215d63803bb4">&#9670;&nbsp;</a></span>KSINV_PIUSE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_PIUSE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o4&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line"> use_ir1_mode = use ## o1;\</div><div class="line"> use_ir1_t1 = use ## o2;\</div><div class="line"> use_ir2_mode = use ## o3;\</div><div class="line"> use_ir2_t1 = use ## o4;\</div><div class="line">})</div></div><!-- fragment -->
</div>
</div>
<a id="a61997e3aafb10556ab483043f36729da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61997e3aafb10556ab483043f36729da">&#9670;&nbsp;</a></span>KSINV_OPUSER_VALS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_OPUSER_VALS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o4&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line"> ksinv1_mode = &amp;opuser ## o1;\</div><div class="line"> ksinv1_t1value = &amp;opuser ## o2;\</div><div class="line"> ksinv2_mode = &amp;opuser ## o3;\</div><div class="line"> ksinv2_t1value = &amp;opuser ## o4;\</div><div class="line">})</div></div><!-- fragment -->
</div>
</div>
<a id="a96ddb157c7e6c1b173e8dae07d2f2ff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96ddb157c7e6c1b173e8dae07d2f2ff9">&#9670;&nbsp;</a></span>KSINV_OPUSER_STRUCTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_OPUSER_STRUCTS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o4&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line"> _ksinv1_mode = &amp;_opuser ## o1;\</div><div class="line"> _ksinv1_t1value = &amp;_opuser ## o2;\</div><div class="line"> _ksinv2_mode = &amp;_opuser ## o3;\</div><div class="line"> _ksinv2_t1value = &amp;_opuser ## o4;\</div><div class="line">})</div></div><!-- fragment -->
</div>
</div>
<a id="a3b2d943c3862a3980c7291b8e3ac1818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2d943c3862a3980c7291b8e3ac1818">&#9670;&nbsp;</a></span>KSINV_EVAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_EVAL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o4&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line">  KSINV_PIUSE(o1, o2, o3, o4);\</div><div class="line">  KSINV_OPUSER_VALS(o1, o2, o3, o4);\</div><div class="line">  KSINV_OPUSER_STRUCTS(o1, o2, o3, o4);\</div><div class="line">  ksinv_eval(sptr, NULL);\</div><div class="line">})</div></div><!-- fragment -->
<p><h4>C-macro assigning four UserCV slots and then calling <a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a></h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sptr</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o1</td><td>A number (not a variable) between 0 and 35 corresponding to the first UserCV used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o2</td><td>A number (not a variable) between 0 and 35 corresponding to the second UserCV used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o3</td><td>A number (not a variable) between 0 and 35 corresponding to the third UserCV used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o4</td><td>A number (not a variable) between 0 and 35 corresponding to the fourth UserCV used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a48f6e930c7703ec1f845c424971de195"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f6e930c7703ec1f845c424971de195">&#9670;&nbsp;</a></span>KSINV_EVAL_CUSTOMRF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSINV_EVAL_CUSTOMRF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rfptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o1, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o2, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o3, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">o4&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({\</div><div class="line">  KSINV_PIUSE(o1, o2, o3, o4);\</div><div class="line">  KSINV_OPUSER_VALS(o1, o2, o3, o4);\</div><div class="line">  KSINV_OPUSER_STRUCTS(o1, o2, o3, o4);\</div><div class="line">  ksinv_eval(sptr, rfptr);\</div><div class="line">})</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="adc29c2ff13d900c2f185ee95427fb06c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc29c2ff13d900c2f185ee95427fb06c">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"></a>KSINV_OFF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"></a>KSINV_IR_SIMPLE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"></a>KSINV_IR_SLICEAHEAD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"></a>KSINV_FLAIR_BLOCK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"></a>KSINV_FLAIR_T2PREP_BLOCK&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{<a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>, <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>, <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>, <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a>, <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>};</div><div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61dadd085c1777f559549e05962b2c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61dadd085c1777f559549e05962b2c9e">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06"></a>KSINV_RF_STD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed"></a>KSINV_RF_ADIABATIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634"></a>KSINV_RF_CUSTOM&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{<a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634">KSINV_RF_CUSTOM</a>};</div><div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634">KSINV_RF_CUSTOM</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acda2604f80fde12fdea9080776fff112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda2604f80fde12fdea9080776fff112">&#9670;&nbsp;</a></span>KSINV_LOOP_MODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"></a>KSINV_LOOP_NORMAL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"></a>KSINV_LOOP_DUMMY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f"></a>KSINV_LOOP_SLICEAHEAD_FIRST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf"></a>KSINV_LOOP_SLICEAHEAD_LAST&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{<a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>, <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a>, <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a>, <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf">KSINV_LOOP_SLICEAHEAD_LAST</a>} <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a>;</div><div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf">KSINV_LOOP_SLICEAHEAD_LAST</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a></div><div class="ttdeci">KSINV_LOOP_MODE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa08a7ecfbf13a621a577fa984bda2b5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08a7ecfbf13a621a577fa984bda2b5a">&#9670;&nbsp;</a></span>ksinv_eval_checkTR_SAR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_checkTR_SAR </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *&#160;</td>
          <td class="paramname"><em>slice_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const SCAN_INFO *, int, int, void **)&#160;</td>
          <td class="paramname"><em>play_coreslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core_nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>core_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Runs the inversion slice loop and validates TR and SAR/hardware limits</h4>
</p>
<p>This function first makes sure that the <code>.nseqinstances</code> field for each sequence module in the sequence collection corresponds to the number of times played out in <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a></p>
<p>In simulation (WTools), <a class="el" href="_k_s_foundation_8h.html#ac39743a45d5ad00147e24218523f88c8" title="Print out the duration of each sequence module in the sequence collection to a file pointerBesides pr...">ks_print_seqcollection()</a> will print out a table of the sequence modules in the sequence collection in the WToolsMgd window.</p>
<p>Finally, <a class="el" href="_g_e_required_8e.html#a789f2b2ac7ec21daa6a693820873e64a" title="Checks that sequence modules sum up to TR, honoring SAR/heating limits">GEReq_eval_checkTR_SAR_calcs()</a> is called to check that the TR is correct and within SAR/hardware limits.</p>
<p>N.B.: For non-inversion sequences, ks_eval_checkTR_SAR() is used to do the same thing, with the difference that the psd's sliceloop function is used instead of <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_plan</td><td>Pointer to the <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html" title="Struct holding all information about slice locations and aquisition order">KS_SLICE_PLAN</a> struct holding the slice order information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">play_coreslice</td><td>Function pointer to (the wrapper function to) the coreslice function of the sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_nargs</td><td>Number of extra input arguments to the coreslice wrapper function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_args</td><td>Void pointer array pointing to the variables containing the actual values needed for the sequence's coreslice function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                                                                                                                                                                                          {</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  STATUS status;</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="comment">/* set all `seqctrl.nseqinstances` to 0 */</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#acb34cd9d6c99193829696596b4d0271f">ks_eval_seqcollection_resetninst</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>);</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="comment">/* set all `seqctrl.nseqinstances` to the number of occurrences */</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(slice_plan, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, 0, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, FALSE, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <span class="comment">/* validate TR and check that we are within SAR/hardware limits */</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a789f2b2ac7ec21daa6a693820873e64a">GEReq_eval_checkTR_SAR_calcs</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, optr);</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;} <span class="comment">/* ksinv_eval_checkTR_SAR() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_g_e_required_8e_html_a789f2b2ac7ec21daa6a693820873e64a"><div class="ttname"><a href="_g_e_required_8e.html#a789f2b2ac7ec21daa6a693820873e64a">GEReq_eval_checkTR_SAR_calcs</a></div><div class="ttdeci">STATUS GEReq_eval_checkTR_SAR_calcs(KS_SEQ_COLLECTION *seqcollection, int intended_time)</div><div class="ttdoc">Checks that sequence modules sum up to TR, honoring SAR/heating limits</div><div class="ttdef"><b>Definition:</b> GERequired.e:857</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_acb34cd9d6c99193829696596b4d0271f"><div class="ttname"><a href="_k_s_foundation_8h.html#acb34cd9d6c99193829696596b4d0271f">ks_eval_seqcollection_resetninst</a></div><div class="ttdeci">void ks_eval_seqcollection_resetninst(KS_SEQ_COLLECTION *seqcollection)</div><div class="ttdoc">Set the .nseqinstances field of each sequence module (KS_SEQ_CONTROL) equal to 0</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3235</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d73f67e51b69dac2f331c220e8c7106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d73f67e51b69dac2f331c220e8c7106">&#9670;&nbsp;</a></span>ksinv_pg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_pg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Generation of the waveforms for the sequence objects in a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a></h4>
</p>
<p>Two <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> structs are currently declared in <a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a>, <code>ksinv1</code> and <code>ksinv2</code>. By passing each one of them to this function, will generate the actual sequence on TGT. On HOST, the <code>seqctrl.min_duration</code> field is set and used by TI/TR calculations.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                                       {</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  STATUS status;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;  <a class="code" href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a> loc = <a class="code" href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a>;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>)</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="preprocessor">#ifdef IPG</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="comment">/* TGT (IPG) only: return early if sequence module duration is zero */</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> == 0)</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">startpos</a>;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">if</span> (loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> % GRAD_UPDATE_TIME) {</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Start position of RF pulse must be divisible by GRAD_UPDATE_TIME (ksinv-&gt;params.rfstartpos = %d)&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">startpos</a>);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  }</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keywordflow">if</span> (loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> &lt; <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>) {</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Start position of RF pulse must be at least %d [us] (ksinv-&gt;params.rfstartpos = %d)&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">startpos</a>);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  }</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="comment">/* RF */</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#aa7d86b129051574ab247567e218f4b62">ksinv_slicecheck</a>){</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = XGRAD;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  }</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordtype">int</span> mag_center_exc = loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">/* now refocussing pulses*/</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="comment">/* we make sure that that delta_t_refoc/2 is a multiple of GRAD_UPDATE_TIME using the RUP_GRD function (division results are integer truncated) */</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordtype">int</span> delta_t_refoc_half = RUP_GRD(ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ab67bd20ab7f6496ad5de9c95fe952d49">t2prep_TE</a>  / ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">N_Refoc</a> / 2);</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="comment">/* first refocusing pulse*/</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = mag_center_exc + delta_t_refoc_half - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="comment">/* all other refocusing pulses*/</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordtype">int</span> n;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordflow">for</span> (n = 1; n &lt; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">N_Refoc</a>; n++) {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;      loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += 2*delta_t_refoc_half;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    }</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="comment">/***************************************************************************************************</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">     *  two different versions</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment">     *  non adiabatic (+90)-(n*180)-(+90)</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">     *  adiabatic (+90)-(n*180)-(-90)-(180)</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">     *  the polarity of the flip angle of the flip pulse is set with loc.ampscale</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">     ***************************************************************************************************/</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = mag_center_exc + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">N_Refoc</a>*delta_t_refoc_half*2 - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    </div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>) {</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;      loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = -1;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    }</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    </div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="comment">/* Save absolute time in sequence for moment start, it is important to do that after </span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">    ks_pg_selrf(&amp;ksinv-&gt;selrfflip, loc, &amp;ksinv-&gt;seqctrl) because otherwise ksinv-&gt;seqctrl.momentstart would be overwritten as</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment">    the &quot;ROLE&quot; of selrfflip is an excitation pulse, there is no ROLE for a flipup pulse yet */</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> = mag_center_exc;   </div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1; <span class="comment">/* set it back to default */</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    <span class="comment">/* waveform overlap problems between selrfflip and selrfinv on DV25 --&gt; 5*GRAD_UPDATE_TIME safety margin */</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + 5*GRAD_UPDATE_TIME;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    </div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>) {</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) ? ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> : ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>.<a class="code" href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    }</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="comment">/* Save absolute time in sequence for moment start */</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> = loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) ? ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> : ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>.<a class="code" href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  }</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <span class="comment">/* Z spoiler */</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, loc, &amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">   *  Set the minimal sequence duration (ksinv-&gt;seqctrl.min_duration) by calling</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">   *  ks_eval_seqctrl_setminduration()</span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">/* make sure we are divisible by GRAD_UPDATE_TIME (4us) */</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="comment">/* On HOST only: Sequence module duration (ksinv-&gt;seqctrl.ssi_time must be &gt; 0 and is added to ksinv-&gt;seqctrl.min_duration in ks_eval_seqctrl_setminduration()) */</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, loc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>); <span class="comment">/* loc.pos now corresponds to the end of last gradient in the sequence */</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;} <span class="comment">/* ksinv_pg() */</span></div><div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">KS_SEQLOC::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:242</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6e727c3449c63278cbfc2e35cfcfa9fa"><div class="ttname"><a href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a></div><div class="ttdeci">STATUS ks_pg_selrf(KS_SELRF *selrf, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_SELRF sequence object on a gradient (and RF) board at some position in the pulse sequence...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1954</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a2e3f5254967cadb9a41167c6fbf6743e"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">KS_SEQLOC::board</a></div><div class="ttdeci">int board</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:241</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ab67bd20ab7f6496ad5de9c95fe952d49"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ab67bd20ab7f6496ad5de9c95fe952d49">KSINV_PARAMS::t2prep_TE</a></div><div class="ttdeci">int t2prep_TE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:89</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a606fbf556e8a297aa1f68b098f6ac2a2"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">KS_SEQLOC::ampscale</a></div><div class="ttdeci">float ampscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:243</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a9b938b45a69cb4a8e451d8c365dff979"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">KSINV_SEQUENCE::selrfflip</a></div><div class="ttdeci">KS_SELRF selrfflip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:103</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSINV_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:102</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aa7d86b129051574ab247567e218f4b62"><div class="ttname"><a href="_k_s_inversion_8e.html#aa7d86b129051574ab247567e218f4b62">ksinv_slicecheck</a></div><div class="ttdeci">int ksinv_slicecheck</div><div class="ttdef"><b>Definition:</b> KSInversion.e:160</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a61651c54c4dfd4388fc939d804a9964b"><div class="ttname"><a href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a></div><div class="ttdeci">STATUS ks_pg_trap(KS_TRAP *trap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_TRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1212</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a></div><div class="ttdoc">typedef struct used as argument to ks_pg_*** functions to control where and when to place a sequence ...</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:240</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a75c403072633f5a42fe364af4454b245"><div class="ttname"><a href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a></div><div class="ttdeci">STATUS ks_eval_seqctrl_setminduration(KS_SEQ_CONTROL *seqctrl, int mindur)</div><div class="ttdoc">Sets the minimum duration and duration fields of a KS_SEQ_CONTROL struct based on some minimum time (...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2925</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a620f873c08811cb1b6eae1a50bc97029"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">KSINV_SEQUENCE::selrfrefoc</a></div><div class="ttdeci">KS_SELRF selrfrefoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:104</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad01dd4f06fe226a502e872d4173ba7ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a></div><div class="ttdeci">#define KS_INIT_SEQLOC</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:128</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSINV_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> KSInversion.e:101</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa6771fa061704040bf95cd4daf9f5e7f"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">KSINV_PARAMS::rftype</a></div><div class="ttdeci">int rftype</div><div class="ttdef"><b>Definition:</b> KSInversion.e:78</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="struct_k_s___w_a_v_e_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_WAVE::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:518</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a4eab9e6ed3f1bfffb575cbd617a6c4cf"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">KSINV_PARAMS::N_Refoc</a></div><div class="ttdeci">int N_Refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:88</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a8dbc43e7c10453ead9fa606185d99200"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">KSINV_PARAMS::startpos</a></div><div class="ttdeci">int startpos</div><div class="ttdef"><b>Definition:</b> KSInversion.e:81</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac6037d68ff7b6f66735a92611628df57">KSINV_PARAMS::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:84</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0adb26c729e5b3bd252f5e1918869c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0adb26c729e5b3bd252f5e1918869c4">&#9670;&nbsp;</a></span>ksinv_scan_sliceloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_scan_sliceloop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *&#160;</td>
          <td class="paramname"><em>slice_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>ksinv_filltr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a>&#160;</td>
          <td class="paramname"><em>ksinv_loop_mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const SCAN_INFO *, int, int, void **)&#160;</td>
          <td class="paramname"><em>play_coreslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core_nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>core_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out <code>slice_plan.nslices_per_pass</code> slices corresponding to one TR for inversion psds</h4>
</p>
<p>This function should replace the sliceloop function of a 2D psd when inversion is enabled. It will take over the sequence timing for one TR by playing out the inversion sequence module(s) and other sequence modules in an order that is subject to the inversion mode (<code>ksinvX.params.irmode</code>). The non-inversion sequence modules should be played out together in a 'core slice' function of the psd. This core slice function should have a wrapper function with standardized input arguments that conmplies with the function pointer (and core_nargs, core_args) passed to this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_plan</td><td>Pointer to the slice plan (<a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html" title="Struct holding all information about slice locations and aquisition order">KS_SLICE_PLAN</a>) set up earlier using <a class="el" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb" title="Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...">ks_calc_sliceplan()</a> or similar </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_positions</td><td>Pointer to the SCAN_INFO array corresponding to the slice locations (typically <code>ks_scan_info</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>Pass index in range <code>[0, ks_slice_plan.npasses - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv1</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to the 1st (or only) inversion. Cannot be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv2</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to an optional 2nd inversion. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv_filltr</td><td>Pointer to <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html" title="A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching">KS_SEQ_CONTROL</a> for fillTR sequence for FLAIR block modes. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv_loop_mode</td><td>If KSINV_LOOP_DUMMY, this function will pass in KS_NOTSET (-1) as the 2nd argument to 'play_coreslice'. For this to work, the play_coreslice() function (usually the main sequence's coreslice), must check if it's 2nd arg is KS_NOTSET, and if so shut off data collection in loaddab() KSINV_LOOP_NORMAL: Slice excitation ON, Data acq. ON KSINV_LOOP_DUMMY: Slice excitation ON, Data acq. OFF KSINV_LOOP_SLICEAHEAD_FIRST: Slice excitation ON for IR, OFF for coreslice, Data acq. OFF KSINV_LOOP_SLICEAHEAD_LAST: Slice excitation OFF for IR, ON for coreslice, Data acq. ON</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">play_coreslice</td><td>Function pointer to (the wrapper function to) the coreslice function of the sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_nargs</td><td>Number of extra input arguments to the coreslice wrapper function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_args</td><td>Void pointer array pointing to the variables containing the actual values needed for the sequence's coreslice function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slice_plan.nslices_per_pass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                                                                                                                        {</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, sltimeinpass;</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  <span class="keywordtype">int</span> slloc, sltime_adjusted;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keyword">const</span> SCAN_INFO *slpos;</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a> == NULL) {</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg cannot be NULL&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  }</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">return</span> 0;  <span class="comment">/* if the IR mode for the 1st IR is off, return quietly */</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  }</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="keywordflow">if</span> (slice_plan == NULL) {</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st arg cannot be NULL&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  }</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  <span class="keywordflow">if</span> (slice_positions == NULL) {</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 2nd arg cannot be NULL&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  }</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <span class="keywordflow">if</span> (play_coreslice == NULL) {</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 7th arg must be a function pointer to the coreslice function&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  }</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a> || <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="comment">/* For classic T2-FLAIR, we often end up with 2 sets of FLAIR+core per TR</span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="comment">       Here is a generalization, where number of sets is equal to:</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="comment">       CEIL_DIV(slice_plan-&gt;nslices_per_pass, ksinv1-&gt;params.nflairslices), where slice_plan-&gt;nslices_per_pass = CEIL_DIV(slice_plan-&gt;nslices, slice_plan-&gt;npasses)</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;   </div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <span class="comment">/* make sure nflairslices &gt; 0, or else we will be stuck here as sltimeinpass will remain at 0 forever */</span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> &lt;= 0) {</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ksinv1.params.nflairslices must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    }</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    sltimeinpass = 0;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    <span class="keywordflow">while</span> (sltimeinpass &lt; slice_plan-&gt;nslices_per_pass) {</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <span class="comment">/*--------- 1st inversion sequence module as FLAIR block -----------*/</span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(slice_plan, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass + <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>);</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        slpos = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;slice_positions[slloc] : NULL;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        time += <a class="code" href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a>(<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, slpos <span class="comment">/* if NULL, shut off RF */</span>);</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;      }</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>) &amp;&amp; (sltimeinpass + i &lt; slice_plan-&gt;nslices_per_pass); <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(slice_plan, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass + <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>);</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        slpos = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;slice_positions[slloc] : NULL;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a> != NULL) {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;          <span class="comment">/*--------- optional 2nd inversion sequence module (DIR mode) attached to each coreslice playout -----------*/</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;          time += <a class="code" href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a>(<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, slpos <span class="comment">/* if NULL, shut off RF */</span>);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        }</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        <span class="comment">/*--------- &quot;coreslice&quot;: main sequence module (may include e.g. GRx Sat, FatSat etc.) -----------*/</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        time += play_coreslice(</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                  slpos, <span class="comment">/* if NULL, shut off RF. The coreslice function must also shut data acquisition off regardless of next arg */</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;                  (ksinv_loop_mode == <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a>) ? <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a> : (sltimeinpass + <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>), <span class="comment">/* if KS_NOTSET (-1), shut off data acquisition */</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;                  core_nargs, core_args);</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;      }</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      sltimeinpass += <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a> != NULL) {</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="comment">/*--------- fillTR sequence module (to fill up to manual TR in CEIL_DIV(nslices_per_pass, ksinv1-&gt;params.nflairslices) chunks) -----------*/</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>);</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, 1, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a>); <span class="comment">/* Add a filler to slicetime plot */</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      }</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    } <span class="comment">/* while */</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keywordtype">int</span> sltime_start = (ksinv_loop_mode == <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a>) ? (slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> - <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a>) : 0;</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">for</span> (sltimeinpass = sltime_start; sltimeinpass &lt; slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>; sltimeinpass++) {</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <span class="comment">/*--------- 1st inversion sequence module -----------*/</span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a> || <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>)  {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;        sltime_adjusted = (sltimeinpass + <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a>) % slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(slice_plan, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltime_adjusted);</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        slpos = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;slice_positions[slloc] : NULL;        </div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        slpos = ((ksinv_loop_mode == <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf">KSINV_LOOP_SLICEAHEAD_LAST</a>) &amp;&amp; (sltime_adjusted &lt; ksinv1-&gt;params.nslicesahead)) ? NULL : slpos;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        time += <a class="code" href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a>(<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, slpos <span class="comment">/* if NULL, shut off RF */</span>);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="comment">/*--------- 2nd inversion sequence module -----------*/</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a> != NULL &amp;&amp; (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a> || <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>)) {</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        sltime_adjusted = (sltimeinpass + <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a>) % slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(slice_plan, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltime_adjusted);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;        slpos = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;slice_positions[slloc] : NULL;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        time += <a class="code" href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a>(<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, slpos <span class="comment">/* if NULL, shut off RF */</span>);</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      }</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="comment">/*--------- &quot;coreslice&quot;: main sequence module (may include e.g. GRx Sat, FatSat etc.) -----------*/</span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(slice_plan, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      slpos = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;slice_positions[slloc] : NULL;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;      slpos = (ksinv_loop_mode == <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a>) ? NULL : slpos;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      time += play_coreslice(</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                slpos, <span class="comment">/* if NULL, shut off RF. The coreslice function must also shut data acquisition off regardless of next arg */</span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                (ksinv_loop_mode == <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a>) ? <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a> : sltimeinpass, <span class="comment">/* if KS_NOTSET (-1), shut off data acquisition */</span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                core_nargs,</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                core_args);</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    } <span class="comment">/* slice in pass */</span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  } <span class="comment">/* else (not FLAIR-block) */</span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="keywordflow">return</span> time;</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;} <span class="comment">/* ksinv_scan_sliceloop() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e18bd0ca80b433845a881497625515f">KSINV_LOOP_SLICEAHEAD_FIRST</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a302628743e4e40804bca195aa83f41bf">KSINV_LOOP_SLICEAHEAD_LAST</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc6e42d3cc89e0469897a74a66ffcc19"><div class="ttname"><a href="_k_s_inversion_8e.html#adc6e42d3cc89e0469897a74a66ffcc19">ksinv_scan_irslice</a></div><div class="ttdeci">int ksinv_scan_irslice(KSINV_SEQUENCE *ksinv, const SCAN_INFO *slice_pos)</div><div class="ttdoc">Plays out one inversion slice in real time during scanning</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2167</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30b492de37e2ee91adf49a2a2ac6778e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30b492de37e2ee91adf49a2a2ac6778e">&#9670;&nbsp;</a></span>ksinv_init_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksinv_init_params </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a> *&#160;</td>
          <td class="paramname"><em>params</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Resets the <a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html" title="typedef struct holding steering parameters for KSInversion">KSINV_PARAMS</a> struct (arg 1) to KSINV_INIT_PARAMS</h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">params</td><td>Pointer to the ksinv params struct used to steer the behavior of this inversion sequence module </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                             {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a> defparams = <a class="code" href="_k_s_inversion_8e.html#af96573441c0546978cb8dfa6e5448c5d">KSINV_INIT_PARAMS</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  *params = defparams;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;} <span class="comment">/* ksinv_init_params() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_af96573441c0546978cb8dfa6e5448c5d"><div class="ttname"><a href="_k_s_inversion_8e.html#af96573441c0546978cb8dfa6e5448c5d">KSINV_INIT_PARAMS</a></div><div class="ttdeci">#define KSINV_INIT_PARAMS</div><div class="ttdef"><b>Definition:</b> KSInversion.e:92</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a></div><div class="ttdoc">typedef struct holding steering parameters for KSInversion</div><div class="ttdef"><b>Definition:</b> KSInversion.e:73</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82cf97823a7c838642029fdf29e9d76e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82cf97823a7c838642029fdf29e9d76e">&#9670;&nbsp;</a></span>ksinv_init_sequence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksinv_init_sequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Resets the <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> struct (arg 1) to KSINV_INIT_SEQUENCE</h4>
</p>
<p>As KSINV_INIT_SEQUENCE contains <a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html" title="typedef struct holding steering parameters for KSInversion">KSINV_PARAMS</a>, which sets the field <code>.irmode = KSINV_OFF</code>, calling <a class="el" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e" title="Resets the KSINV_SEQUENCE struct (arg 1) to KSINV_INIT_SEQUENCE">ksinv_init_sequence()</a> will disable the <code>ksinversion</code> sequence module (i.e. turn off inversion)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                                {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> defseq = <a class="code" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  *ksinv = defseq;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a30b492de37e2ee91adf49a2a2ac6778e">ksinv_init_params</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;} <span class="comment">/* ksinv_init_sequence() */</span></div><div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a></div><div class="ttdoc">typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms</div><div class="ttdef"><b>Definition:</b> KSInversion.e:96</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a4be1d3680000349036dcb110c7ff1a6f"><div class="ttname"><a href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a></div><div class="ttdeci">#define KSINV_INIT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:106</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a30b492de37e2ee91adf49a2a2ac6778e"><div class="ttname"><a href="_k_s_inversion_8e.html#a30b492de37e2ee91adf49a2a2ac6778e">ksinv_init_params</a></div><div class="ttdeci">void ksinv_init_params(KSINV_PARAMS *params)</div><div class="ttdoc">Resets the KSINV_PARAMS struct (arg 1) to KSINV_INIT_PARAMS</div><div class="ttdef"><b>Definition:</b> KSInversion.e:195</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6d57cd163e2af9351a9535c2f32fdbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6d57cd163e2af9351a9535c2f32fdbc">&#9670;&nbsp;</a></span>ksinv_eval_copycvs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksinv_eval_copycvs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html">KSINV_PARAMS</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Copy CVs into a common params struct (<a class="el" href="struct_k_s_i_n_v___p_a_r_a_m_s.html" title="typedef struct holding steering parameters for KSInversion">KSINV_PARAMS</a>) used to steer this sequence module</h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">params</td><td>Pointer to the ksinv params struct used to steer the behavior of this inversion sequence module </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mode</td><td>Inversion mode, one of: KSINV_OFF, KSINV_IR_SIMPLE, KSINV_IR_SLICEAHEAD, KSINV_FLAIR_BLOCK </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                        {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a30b492de37e2ee91adf49a2a2ac6778e">ksinv_init_params</a>(params);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> = mode;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordflow">if</span> (params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = <a class="code" href="_k_s_inversion_8e.html#a782452f0d134270a074410f806be776f">ksinv_flip</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = opvthick * <a class="code" href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> * <a class="code" href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7f7a597fd1e33ff3f4288bb3c84ecef7">rfoffset</a> = <a class="code" href="_k_s_inversion_8e.html#a09100e3070e07bd6ee68aeecffe09997">ksinv_rfoffset</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> = <a class="code" href="_k_s_inversion_8e.html#ad4386f491cf706c7d23222d2fc840e20">ksinv_rftype</a>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a26b4ce5286681394fce04d2803769a05">spoilerarea</a> = <a class="code" href="_k_s_inversion_8e.html#a8bf554ec251f326d2cf7e544803cac5e">ksinv_spoilerarea</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a> = <a class="code" href="_k_s_inversion_8e.html#a093e98e842e1dbeff8b101ba74e70162">ksinv_approxti</a>; <span class="comment">/* Only applicable for sliceahead mode */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a> = FALSE;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">startpos</a> = RUP_GRD(<a class="code" href="_k_s_inversion_8e.html#a97d3d685e189f82e1e1b536694d64933">ksinv_startpos</a>);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = 0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> = 0;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ae1d9bc5717ff9d6435e0854bc9b9929a">slthick_exc</a> = <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> * <a class="code" href="_k_s_inversion_8e.html#a859527bdf4dc460bdf84895ad48fad8e">ksinv_slthickfact_exc</a>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ad54d5d49ec0d8e701496b7a6e98d7df1">flip_exc</a> = <a class="code" href="_k_s_inversion_8e.html#a795a20d46908cabfe8bafd734cf6d749">ksinv_t2prep_exc_flip</a>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">N_Refoc</a> = <a class="code" href="_k_s_inversion_8e.html#a6e43e12d3223d1ba27eaccc3657cb824">ksinv_t2prep_N_Refoc</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ab67bd20ab7f6496ad5de9c95fe952d49">t2prep_TE</a> = <a class="code" href="_k_s_inversion_8e.html#a0892225b7196bf0d726691746f6af87f">ksinv_t2prep_TE</a>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#afcd1eb9dce88d3e9dabb9074281c1169">rftype_refoc</a> = <a class="code" href="_k_s_inversion_8e.html#a6a73ff5d0928aab9fa04bd8a8bac689c">ksinv_t2prep_rftype_refoc</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }   </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">/* SSI time */</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  params-&gt;<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;} <span class="comment">/* ksinv_eval_copycvs() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a7f7a597fd1e33ff3f4288bb3c84ecef7"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7f7a597fd1e33ff3f4288bb3c84ecef7">KSINV_PARAMS::rfoffset</a></div><div class="ttdeci">int rfoffset</div><div class="ttdef"><b>Definition:</b> KSInversion.e:77</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ae1d9bc5717ff9d6435e0854bc9b9929a"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ae1d9bc5717ff9d6435e0854bc9b9929a">KSINV_PARAMS::slthick_exc</a></div><div class="ttdeci">float slthick_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:87</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ab67bd20ab7f6496ad5de9c95fe952d49"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ab67bd20ab7f6496ad5de9c95fe952d49">KSINV_PARAMS::t2prep_TE</a></div><div class="ttdeci">int t2prep_TE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:89</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6a73ff5d0928aab9fa04bd8a8bac689c"><div class="ttname"><a href="_k_s_inversion_8e.html#a6a73ff5d0928aab9fa04bd8a8bac689c">ksinv_t2prep_rftype_refoc</a></div><div class="ttdeci">int ksinv_t2prep_rftype_refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:176</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a407623c8b83da7fb46f7c2fb693f58e1"><div class="ttname"><a href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a></div><div class="ttdeci">float ksinv_slthickfact</div><div class="ttdef"><b>Definition:</b> KSInversion.e:165</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a782452f0d134270a074410f806be776f"><div class="ttname"><a href="_k_s_inversion_8e.html#a782452f0d134270a074410f806be776f">ksinv_flip</a></div><div class="ttdeci">float ksinv_flip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:164</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a093e98e842e1dbeff8b101ba74e70162"><div class="ttname"><a href="_k_s_inversion_8e.html#a093e98e842e1dbeff8b101ba74e70162">ksinv_approxti</a></div><div class="ttdeci">int ksinv_approxti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:161</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a0892225b7196bf0d726691746f6af87f"><div class="ttname"><a href="_k_s_inversion_8e.html#a0892225b7196bf0d726691746f6af87f">ksinv_t2prep_TE</a></div><div class="ttdeci">int ksinv_t2prep_TE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:175</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_afcd1eb9dce88d3e9dabb9074281c1169"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#afcd1eb9dce88d3e9dabb9074281c1169">KSINV_PARAMS::rftype_refoc</a></div><div class="ttdeci">int rftype_refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:90</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a26b4ce5286681394fce04d2803769a05"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a26b4ce5286681394fce04d2803769a05">KSINV_PARAMS::spoilerarea</a></div><div class="ttdeci">float spoilerarea</div><div class="ttdef"><b>Definition:</b> KSInversion.e:79</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ad54d5d49ec0d8e701496b7a6e98d7df1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ad54d5d49ec0d8e701496b7a6e98d7df1">KSINV_PARAMS::flip_exc</a></div><div class="ttdeci">float flip_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:86</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">KSINV_PARAMS::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSInversion.e:76</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ad4386f491cf706c7d23222d2fc840e20"><div class="ttname"><a href="_k_s_inversion_8e.html#ad4386f491cf706c7d23222d2fc840e20">ksinv_rftype</a></div><div class="ttdeci">int ksinv_rftype</div><div class="ttdef"><b>Definition:</b> KSInversion.e:167</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a8bf554ec251f326d2cf7e544803cac5e"><div class="ttname"><a href="_k_s_inversion_8e.html#a8bf554ec251f326d2cf7e544803cac5e">ksinv_spoilerarea</a></div><div class="ttdeci">float ksinv_spoilerarea</div><div class="ttdef"><b>Definition:</b> KSInversion.e:168</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a795a20d46908cabfe8bafd734cf6d749"><div class="ttname"><a href="_k_s_inversion_8e.html#a795a20d46908cabfe8bafd734cf6d749">ksinv_t2prep_exc_flip</a></div><div class="ttdeci">int ksinv_t2prep_exc_flip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:173</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a97d3d685e189f82e1e1b536694d64933"><div class="ttname"><a href="_k_s_inversion_8e.html#a97d3d685e189f82e1e1b536694d64933">ksinv_startpos</a></div><div class="ttdeci">int ksinv_startpos</div><div class="ttdef"><b>Definition:</b> KSInversion.e:169</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a09100e3070e07bd6ee68aeecffe09997"><div class="ttname"><a href="_k_s_inversion_8e.html#a09100e3070e07bd6ee68aeecffe09997">ksinv_rfoffset</a></div><div class="ttdeci">int ksinv_rfoffset</div><div class="ttdef"><b>Definition:</b> KSInversion.e:166</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b9ea6f30b5b38c45e32c084a7bac3c7"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a></div><div class="ttdeci">int ksinv_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:155</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a859527bdf4dc460bdf84895ad48fad8e"><div class="ttname"><a href="_k_s_inversion_8e.html#a859527bdf4dc460bdf84895ad48fad8e">ksinv_slthickfact_exc</a></div><div class="ttdeci">float ksinv_slthickfact_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:177</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6e43e12d3223d1ba27eaccc3657cb824"><div class="ttname"><a href="_k_s_inversion_8e.html#a6e43e12d3223d1ba27eaccc3657cb824">ksinv_t2prep_N_Refoc</a></div><div class="ttdeci">int ksinv_t2prep_N_Refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:174</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">KSINV_PARAMS::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:75</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa6771fa061704040bf95cd4daf9f5e7f"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">KSINV_PARAMS::rftype</a></div><div class="ttdeci">int rftype</div><div class="ttdef"><b>Definition:</b> KSInversion.e:78</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a30b492de37e2ee91adf49a2a2ac6778e"><div class="ttname"><a href="_k_s_inversion_8e.html#a30b492de37e2ee91adf49a2a2ac6778e">ksinv_init_params</a></div><div class="ttdeci">void ksinv_init_params(KSINV_PARAMS *params)</div><div class="ttdoc">Resets the KSINV_PARAMS struct (arg 1) to KSINV_INIT_PARAMS</div><div class="ttdef"><b>Definition:</b> KSInversion.e:195</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a70de662739aecac63e1b0a999ea4d23d"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">KSINV_PARAMS::approxti</a></div><div class="ttdeci">int approxti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:80</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a4eab9e6ed3f1bfffb575cbd617a6c4cf"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a4eab9e6ed3f1bfffb575cbd617a6c4cf">KSINV_PARAMS::N_Refoc</a></div><div class="ttdeci">int N_Refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:88</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a8dbc43e7c10453ead9fa606185d99200"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a8dbc43e7c10453ead9fa606185d99200">KSINV_PARAMS::startpos</a></div><div class="ttdeci">int startpos</div><div class="ttdef"><b>Definition:</b> KSInversion.e:81</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac6037d68ff7b6f66735a92611628df57">KSINV_PARAMS::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34a46f11f109e568396afa27660f9425"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a46f11f109e568396afa27660f9425">&#9670;&nbsp;</a></span>ksinv_eval_setuprf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_setuprf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>suffix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *&#160;</td>
          <td class="paramname"><em>custom_selrf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up the RF sequence object for the inversion sequence module (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> ksinv)</h4>
</p>
<p>This function is called from <a class="el" href="_k_s_inversion_8e.html#abb942440dc967f835bdad59f07519e03" title="Sets up the sequence objects for the inversion sequence module (KSINV_SEQUENCE ksinv)">ksinv_eval_setupobjects()</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> sequence module to be set up </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">suffix</td><td>Suffix string to att to "ksinv" for the description of the sequence module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">custom_selrf</td><td>Optional pointer to <a class="el" href="struct_k_s___s_e_l_r_f.html" title="Composite sequence object for slice-selective RF">KS_SELRF</a> for custom inversion RF pulse. Pass NULL to use default RF pulses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                                                             {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  STATUS status;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordtype">char</span> tmpstr[1000];</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">/* if irmode == KSINV_OFF, reset and return */</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a>(ksinv);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span> (custom_selrf != NULL) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a> = *custom_selrf;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> = <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634">KSINV_RF_CUSTOM</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#aab92ee6c85dc28e0e1dd202fe27066c8">adinv_shNvrg5b</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>) {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#ae487a133d050e2528be02adecad37993">inv_invI0</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: invalid RF type (ksinv.params.rftype = %d)&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">/* N.B. The designed (i.e. nominal) flip angle varies a lot between GE&#39;s inversion RF pulses:</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">     - adinv_sh3t2: 250 deg.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">     - shNvrg5b: 43.82 deg.</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">     - invI0: (non-adiabatic) 178 deg</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">     So it is important to set the desired FA now after the &#39;ksinv-&gt;selrfinv.rf =&#39; assignment above.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">     The relation between .selrfinv.rf.flip and .selrfinv.rf.rfpulse.nom_fa can be used internally for RF scaling</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>; <span class="comment">/* desired FA */</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#add1e81760153252b7f921b8f9118edb2">cf_offset</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7f7a597fd1e33ff3f4288bb3c84ecef7">rfoffset</a>; <span class="comment">/* Exciter offset in Hz */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;ksinv_selinv%s&quot;</span>, suffix);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, tmpstr);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;} <span class="comment">/* ksinv_eval_setuprf() */</span></div><div class="ttc" id="struct_k_s___r_f_html_add1e81760153252b7f921b8f9118edb2"><div class="ttname"><a href="struct_k_s___r_f.html#add1e81760153252b7f921b8f9118edb2">KS_RF::cf_offset</a></div><div class="ttdeci">float cf_offset</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:791</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a7f7a597fd1e33ff3f4288bb3c84ecef7"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7f7a597fd1e33ff3f4288bb3c84ecef7">KSINV_PARAMS::rfoffset</a></div><div class="ttdeci">int rfoffset</div><div class="ttdef"><b>Definition:</b> KSInversion.e:77</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_ae487a133d050e2528be02adecad37993"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#ae487a133d050e2528be02adecad37993">inv_invI0</a></div><div class="ttdeci">const KS_RF inv_invI0</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:112</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a82cf97823a7c838642029fdf29e9d76e"><div class="ttname"><a href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a></div><div class="ttdeci">void ksinv_init_sequence(KSINV_SEQUENCE *ksinv)</div><div class="ttdoc">Resets the KSINV_SEQUENCE struct (arg 1) to KSINV_INIT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:213</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea8f15ebeedb91d9adff053a02f2f5f634">KSINV_RF_CUSTOM</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">KSINV_PARAMS::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSInversion.e:76</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_aab92ee6c85dc28e0e1dd202fe27066c8"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#aab92ee6c85dc28e0e1dd202fe27066c8">adinv_shNvrg5b</a></div><div class="ttdeci">const KS_RF adinv_shNvrg5b</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:106</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">KSINV_PARAMS::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:75</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa6771fa061704040bf95cd4daf9f5e7f"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">KSINV_PARAMS::rftype</a></div><div class="ttdeci">int rftype</div><div class="ttdef"><b>Definition:</b> KSInversion.e:78</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67f02f9a7da4f096c07c202d43e3d8b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67f02f9a7da4f096c07c202d43e3d8b3">&#9670;&nbsp;</a></span>ksinv_eval_setupt2prep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_setupt2prep </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                     {</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  STATUS status;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    status = SUCCESS;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#af94140dc4d9b4928f1f37f55893de6ca">exc_ssfse90new</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ad54d5d49ec0d8e701496b7a6e98d7df1">flip_exc</a>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ae1d9bc5717ff9d6435e0854bc9b9929a">slthick_exc</a>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;ksinv_T2prep_exc&quot;</span>);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#af94140dc4d9b4928f1f37f55893de6ca">exc_ssfse90new</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ae1d9bc5717ff9d6435e0854bc9b9929a">slthick_exc</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ad54d5d49ec0d8e701496b7a6e98d7df1">flip_exc</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>, <span class="stringliteral">&quot;ksinv_T2prep_flip&quot;</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">rftype</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="comment">/*adiabatic refoc and inversion pulses  */</span>      </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000){</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a6a716da5284dd78fb501f9d242fc44fc">adinv_sh3t2</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#aab92ee6c85dc28e0e1dd202fe27066c8">adinv_shNvrg5b</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#afcd1eb9dce88d3e9dabb9074281c1169">rftype_refoc</a> == <a class="code" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="comment">/*adiabatic refoc and inversion pulses  */</span>      </div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000){</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a6a716da5284dd78fb501f9d242fc44fc">adinv_sh3t2</a>; <span class="comment">/* KSFoundation_GERF.h */</span>  </div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#aab92ee6c85dc28e0e1dd202fe27066c8">adinv_shNvrg5b</a>; <span class="comment">/* KSFoundation_GERF.h */</span>         </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> =  <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd">KS_RF_ROLE_REF</a>;      </div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>, <span class="stringliteral">&quot;ksinv_T2prep_refoc&quot;</span>);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">role</a> =  <a class="code" href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedac6b698b041a6da12fb9194c4947ec6e8">KS_RF_ROLE_INV</a>;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, <span class="stringliteral">&quot;ksinv_T2prep_inv&quot;</span>);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">/* ksinv-&gt;selrfexc.pregrad is empty --&gt; no postgrad for selrfflip.postgrad*/</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;} <span class="comment">/* ksinv_eval_setupt2prep() */</span></div><div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="struct_k_s___r_f_html_aea7921a9aa2757a88e843476848ddd55"><div class="ttname"><a href="struct_k_s___r_f.html#aea7921a9aa2757a88e843476848ddd55">KS_RF::role</a></div><div class="ttdeci">int role</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:788</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad77a28d39f423bca930ee2f8f392de17"><div class="ttname"><a href="_k_s_foundation_8h.html#ad77a28d39f423bca930ee2f8f392de17">ks_eval_selrf</a></div><div class="ttdeci">STATUS ks_eval_selrf(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1767</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd"><div class="ttname"><a href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142beda8f1b938816b04ffdeb45de47204252fd">KS_RF_ROLE_REF</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1750</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa324c3517656b8ec032523397a142bedac6b698b041a6da12fb9194c4947ec6e8"><div class="ttname"><a href="_k_s_foundation_8h.html#aa324c3517656b8ec032523397a142bedac6b698b041a6da12fb9194c4947ec6e8">KS_RF_ROLE_INV</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1750</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ae1d9bc5717ff9d6435e0854bc9b9929a"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ae1d9bc5717ff9d6435e0854bc9b9929a">KSINV_PARAMS::slthick_exc</a></div><div class="ttdeci">float slthick_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:87</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a7f69114669ee63f8e3d2f37956cabd49"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a></div><div class="ttdeci">const KS_RF ref_se1b4</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:88</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a6a716da5284dd78fb501f9d242fc44fc"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a6a716da5284dd78fb501f9d242fc44fc">adinv_sh3t2</a></div><div class="ttdeci">const KS_RF adinv_sh3t2</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:109</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_af94140dc4d9b4928f1f37f55893de6ca"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#af94140dc4d9b4928f1f37f55893de6ca">exc_ssfse90new</a></div><div class="ttdeci">const KS_RF exc_ssfse90new</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:55</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a9b938b45a69cb4a8e451d8c365dff979"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">KSINV_SEQUENCE::selrfflip</a></div><div class="ttdeci">KS_SELRF selrfflip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:103</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_afcd1eb9dce88d3e9dabb9074281c1169"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#afcd1eb9dce88d3e9dabb9074281c1169">KSINV_PARAMS::rftype_refoc</a></div><div class="ttdeci">int rftype_refoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:90</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSINV_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:102</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed"><div class="ttname"><a href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:45</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ad54d5d49ec0d8e701496b7a6e98d7df1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ad54d5d49ec0d8e701496b7a6e98d7df1">KSINV_PARAMS::flip_exc</a></div><div class="ttdeci">float flip_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:86</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa89aa200e4334657ad976733bebcbc2a">KSINV_PARAMS::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSInversion.e:76</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a620f873c08811cb1b6eae1a50bc97029"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">KSINV_SEQUENCE::selrfrefoc</a></div><div class="ttdeci">KS_SELRF selrfrefoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:104</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_aab92ee6c85dc28e0e1dd202fe27066c8"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#aab92ee6c85dc28e0e1dd202fe27066c8">adinv_shNvrg5b</a></div><div class="ttdeci">const KS_RF adinv_shNvrg5b</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:106</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a7ab9fec3ad0848d2dff5db7279f1a806">KSINV_PARAMS::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:75</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_aa6771fa061704040bf95cd4daf9f5e7f"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#aa6771fa061704040bf95cd4daf9f5e7f">KSINV_PARAMS::rftype</a></div><div class="ttdeci">int rftype</div><div class="ttdef"><b>Definition:</b> KSInversion.e:78</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb942440dc967f835bdad59f07519e03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb942440dc967f835bdad59f07519e03">&#9670;&nbsp;</a></span>ksinv_eval_setupobjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_setupobjects </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>suffix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *&#160;</td>
          <td class="paramname"><em>custom_selrf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up the sequence objects for the inversion sequence module (<a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> ksinv)</h4>
</p>
<p><a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a> has two inversion sequence modules, <code>ksinv1</code> and <code>ksinv2</code>, the latter only active for dual-IR. These are both declared in <code>@ipgexport</code> in <a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a>.</p>
<p>This function takes one of these sequence modules as first input argument (called from <a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a>) and sets up the sequence objects in that <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a>, with <code>suffix</code> as the unique suffix name for the sequence module (currently "1" and "2" in <a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a>).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> sequence module to be set up </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">suffix</td><td>Suffix string to att to "ksinv" for the description of the sequence module </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">custom_selrf</td><td>Optional pointer to <a class="el" href="struct_k_s___s_e_l_r_f.html" title="Composite sequence object for slice-selective RF">KS_SELRF</a> for custom inversion RF pulse. Pass NULL to use default RF pulses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                                                                                                  {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  STATUS status;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">char</span> tmpstr[1000];</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">/* if irmode == KSINV_OFF, reset and return */</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a>(ksinv);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  }</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">/* t2prepped selective RF inversion */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a67f02f9a7da4f096c07c202d43e3d8b3">ksinv_eval_setupt2prep</a>(ksinv);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">/* Selective RF inversion */</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a34a46f11f109e568396afa27660f9425">ksinv_eval_setuprf</a>(ksinv, suffix, custom_selrf);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">/* set up spoiler */</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a26b4ce5286681394fce04d2803769a05">spoilerarea</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;ksinv_spoiler%s&quot;</span>, suffix);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">/* make a trap that has 3x lower slewrate than normal, since minimum IR seq duration is not time critical */</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a984e0201828c0e74696118ff6487a303">ks_eval_trap_constrained</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmpstr, <a class="code" href="_k_s_foundation_8h.html#a5c919c547ee396b18069ed505c695139">ks_syslimits_ampmax</a>(<a class="code" href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a>), <a class="code" href="_k_s_foundation_8h.html#a712d215e449900b4fc566fefff51b4e9">ks_syslimits_slewrate</a>(<a class="code" href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a>) / 3.0, 0);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">/* status = ks_eval_trap(&amp;ksinv-&gt;spoiler, tmpstr); */</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">/* Name seqmodule and setup seqctrl with desired SSI time and zero duration. .min_duration will be set in ksinv_pg() */</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;ksinv%s&quot;</span>, suffix);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  strcpy(ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, tmpstr);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;} <span class="comment">/* ksinv_eval_setupobjects() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a34a46f11f109e568396afa27660f9425"><div class="ttname"><a href="_k_s_inversion_8e.html#a34a46f11f109e568396afa27660f9425">ksinv_eval_setuprf</a></div><div class="ttdeci">STATUS ksinv_eval_setuprf(KSINV_SEQUENCE *ksinv, const char *suffix, KS_SELRF *custom_selrf)</div><div class="ttdoc">Sets up the RF sequence object for the inversion sequence module (KSINV_SEQUENCE ksinv)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:285</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5c919c547ee396b18069ed505c695139"><div class="ttname"><a href="_k_s_foundation_8h.html#a5c919c547ee396b18069ed505c695139">ks_syslimits_ampmax</a></div><div class="ttdeci">float ks_syslimits_ampmax(LOG_GRAD loggrd)</div><div class="ttdoc">Returns the maximum gradient amplitude that can be used on all gradient boards simultaneously</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:163</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a67f02f9a7da4f096c07c202d43e3d8b3"><div class="ttname"><a href="_k_s_inversion_8e.html#a67f02f9a7da4f096c07c202d43e3d8b3">ksinv_eval_setupt2prep</a></div><div class="ttdeci">STATUS ksinv_eval_setupt2prep(KSINV_SEQUENCE *ksinv)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:336</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a82cf97823a7c838642029fdf29e9d76e"><div class="ttname"><a href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a></div><div class="ttdeci">void ksinv_init_sequence(KSINV_SEQUENCE *ksinv)</div><div class="ttdoc">Resets the KSINV_SEQUENCE struct (arg 1) to KSINV_INIT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:213</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a4bd8f92bd97315429605430e234dceb4"><div class="ttname"><a href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a></div><div class="ttdeci">LOG_GRAD loggrd</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a984e0201828c0e74696118ff6487a303"><div class="ttname"><a href="_k_s_foundation_8h.html#a984e0201828c0e74696118ff6487a303">ks_eval_trap_constrained</a></div><div class="ttdeci">STATUS ks_eval_trap_constrained(KS_TRAP *trap, const char *const desc, float ampmax, float slewrate, int minduration) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with gradient constraints specified as input argu...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:276</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a26b4ce5286681394fce04d2803769a05"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a26b4ce5286681394fce04d2803769a05">KSINV_PARAMS::spoilerarea</a></div><div class="ttdeci">float spoilerarea</div><div class="ttdef"><b>Definition:</b> KSInversion.e:79</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a712d215e449900b4fc566fefff51b4e9"><div class="ttname"><a href="_k_s_foundation_8h.html#a712d215e449900b4fc566fefff51b4e9">ks_syslimits_slewrate</a></div><div class="ttdeci">float ks_syslimits_slewrate(LOG_GRAD loggrd)</div><div class="ttdoc">Returns the maximum slewrate that can be used on all gradient boards simultaneously</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:196</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSINV_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> KSInversion.e:101</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a06d9eb96605539fd74a90b3788f21998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06d9eb96605539fd74a90b3788f21998">&#9670;&nbsp;</a></span>ksinv_eval_nullti()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_eval_nullti </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T1value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seqdur</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates the TI value necessary to null the signal from a tissue with a given T1 value,</h4>
the TR of the sequence and the main sequence duration, all in [us] </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TR</td><td>Repetition time in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1value</td><td>The T1 value of the tissue to be nulled in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seqdur</td><td>The duration of the main sequence in [us] </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TItime</td><td>Inversion time in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                       {</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) ((double) T1value * ( log(2.0) - log(1.0 + exp(-((<span class="keywordtype">double</span>) TR - (<span class="keywordtype">double</span>) seqdur)/((<span class="keywordtype">double</span>) T1value))) ));</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;} <span class="comment">/* ksinv_eval_nullti() */</span></div></div><!-- fragment -->
</div>
</div>
<a id="a6a4d7e8d641045f0f72b824493bdcb88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4d7e8d641045f0f72b824493bdcb88">&#9670;&nbsp;</a></span>ksinv_eval_duration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_duration </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_momentstart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h4>Sets the sequence module duration of a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> module based on an inversion time (TI) and the delay time from the start of the main sequence to its excitation center</h4>
<p>For simple main sequences consisting of only one sequence module each time it is played out (i.e. without additional fatsat or spatial sat sequences attached before each main sequence), <code>coreslice_momentstart</code> is typically a small value of a few [ms] indicating the isocenter of the excitation pulse of the main sequence measured from the start of the main sequence. When e.g. a fatsat pulse sequence module is added before each main sequence module, this needs to be taken into account to get the correct inversion time. In these cases <code>coreslice_momentstart</code> should be larger (to also include any leading extra sequence module between the inversion module and the main sequence module, and consequently the duration of the inversion module becomes proportionally smaller. If <code>TI</code> is short in relation to <code>coreslice_momentstart</code> this function will return an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> sequence module </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TI</td><td>Desired inversion time in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_momentstart</td><td>The delay time from the end of the inversion module to the isocenter of the excitation pulse of the main sequence </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TItime</td><td>Inversion time in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                                                                     {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> &lt;= 0) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Moment start position of the inversion sequence (arg 1) must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordflow">if</span> (TI &lt;= 0) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TI must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">if</span> (coreslice_momentstart &lt;= 0) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: The core slice moment start position must be  &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ksinv.params.irmode must be KSINV_IR_SIMPLE for this function&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = 0;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> = 0;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(TI + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> - coreslice_momentstart);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> &gt; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Input args resulted in a a too short inv. seq. duration&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;} <span class="comment">/* ksinv_eval_duration() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a2bc8ea23c238a06473dc7e8a32def3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a2bc8ea23c238a06473dc7e8a32def3">&#9670;&nbsp;</a></span>ksinv_eval_duration_t1value()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_duration_t1value </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>TR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>TI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>approxti_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_momentstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mainseq_mindur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T1value_toNull</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the sequence module duration of a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> as well as TI and TR (slice-ahead IR)</h4>
</p>
<p>This function enables the <em>slice-ahead</em> inversion mode, where the duration of the sequence module is determined while iteratively finding TI and TR, based on the duration and momentstart of the core slice playout. One 'core slice' consists of the main sequence and all other sequence modules played out every time with the main sequence directly before or after, e.g. [FatSat]-[SpatialSat]-[Mainsequence].</p>
<p>Optionally, one can pass in an <code>approxti_flag</code>. If <code>FALSE (= 0)</code>, then the inversion module duration is set to meet exactly the TI that will null a tissue with a T1-value of <code>T1value_toNull</code>. As with any IR module, the minimum duration (<code>ksinv.seqctrl.min_duration) given by the RF pulse and spoiler is very short in comparison to the actual duration (</code>ksinv.seqctrl.duration) since TI &gt;&gt; min_duration.</p>
<p>This function reduces the duration significantly by playing the IR module several slices ahead of the main sequence slice. This reduces the ksinv sequence module duration by one or more whole units of <code>coreslice_duration</code>, while still magnetically maintaining the inversion time (TI). The number of slices that the inversion module should be played out ahead of the main sequence is stored in ksinv.params.nslicesahead. Now, if <code>approxti_flag = TRUE</code>, the duration of this ksinv sequence module will be set to its minimum (<code>ksinv.seqctrl.min_duration</code>), and TI will be approximated to a whole number of <code>coreslice_duration</code>. This works best for long <code>T1value_toNull</code> and reasonably short <code>coreslice_duration</code> as the percent error in TI will be low. With <code>approxti_flag = TRUE</code> the scan time will be significantly reduced in general.</p>
<p>As this function estimates the optimal TR and TI iteratively, AutoTR and AutoTI modes must be used when calling this function. Typically T1-FLAIR uses slice-ahead IR, but STIR should also be more efficient compared to a simple IR approach. See also <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> sequence module to set up </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TR</td><td>Pointer to the repetition time (TR) resulting from the interative search in [us] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TI</td><td>Pointer to the inversion time (TI) resulting from the interative search in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">approxti_flag</td><td>0: Make TI exact 1: Make TI approximate (shorter scan time in general) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_momentstart</td><td>Time between the end of the inversion module and the moment start of the main sequence. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_duration</td><td>Duration of the 'core slice' (main sequence + other attached sequence modules) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mainseq_mindur</td><td>Minimum duration of just the main sequence (used by <a class="el" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998" title="Calculates the TI value necessary to null the signal from a tissue with a given T1 value...">ksinv_eval_nullti()</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1value_toNull</td><td>T1 value to null in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play out in one pass (acquisition) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                                                                                                      {</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> &lt;= 0) {</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): Moment start position of the inversion sequence (arg 1) must be &gt; 0&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keywordflow">if</span> (TR == NULL) {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): TR pointer cannot be NULL&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (TI == NULL) {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): TI pointer cannot be NULL&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  }</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (coreslice_momentstart &lt;= 0) {</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): The core slice moment start position must be  &gt; 0&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">if</span> (coreslice_duration &lt;= 0) {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">/* core slice duration is the sequence time (incl. SSI time) for the main sequence and other sequence modules that</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">    are played just before each main sequence (e.g. ChemSat, GRx Sat, Simple IR etc.) */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): The core slice time (arg 4) [attached seq. modules+ main seq.] must be &gt; 0&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  }</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="keywordflow">if</span> (slperpass &lt; 1) {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): slperpass must be &gt; 0&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  }</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a> &amp;&amp; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): ksinv.params.irmode must be either KSINV_IR_SIMPLE or KSINV_IR_SLICEAHEAD for this function&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keywordtype">int</span> iter_max = 50;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <span class="keywordtype">int</span> TItol = 20; <span class="comment">/* TI error tolerance in [us] */</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordtype">int</span> tempTI;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordtype">int</span> hasconverged = FALSE;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">int</span> reduce_sliceahead = 0;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">int</span> minimumTR_forslices = slperpass * (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> + coreslice_duration);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  *TR = minimumTR_forslices;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  *TI = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(*TR, T1value_toNull, mainseq_mindur);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keywordflow">if</span> (approxti_flag == TRUE) {</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">/* Optimal TI is approximated using discrete number of slice-aheads with ksinv-&gt;seqctrl.duration = ksinv-&gt;seqctrl.min_duration */</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">/* set .duration = .min_duration (again to be safe) */</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">/* integer nslicesahead that comes closest to the desired TI */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = (int) (((<span class="keywordtype">float</span>) (*TI + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> - coreslice_momentstart)) / ((float) (coreslice_duration + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>)) + 0.5);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">/* adjust TI to reflect the approximation */</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    *TI = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> * (coreslice_duration + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>) - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> + coreslice_momentstart;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">while</span> (hasconverged == FALSE &amp;&amp; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> &gt;= 0) {</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">while</span> (hasconverged == FALSE &amp;&amp; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++ &lt; iter_max) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a> &amp;&amp; slperpass &gt; 1) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = (*TI + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> - coreslice_momentstart) / (coreslice_duration + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>) - reduce_sliceahead;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> &lt; 0) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;          ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = 0;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> &gt; (slperpass - 1)) {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;          ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = slperpass - 1;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = 0;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      <span class="comment">/* duration of inversion module */</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD((*TI + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> - coreslice_momentstart - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> * coreslice_duration) / (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> + 1));</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">/* prevent too small durations */</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> &gt; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="comment">/* Update TR and TI after IR duration update */</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      *TR = slperpass * (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_duration);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      tempTI = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(*TR, T1value_toNull, mainseq_mindur);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      hasconverged = abs(tempTI - *TI) &lt; TItol;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      *TI = tempTI;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    } <span class="comment">/* inner while */</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    reduce_sliceahead++;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  } <span class="comment">/* outer while */</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">/* watchdogs */</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &gt;= iter_max) {</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): No solution. Increase ETL or #slices&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="keywordflow">if</span> (*TI == 0) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): TI became zero&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span> (*TR &lt; minimumTR_forslices) {</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s (%s): TR became too short to fit the number of slices&quot;</span>, __FUNCTION__, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> &gt; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Input args resulted in a a too short inv. seq. duration&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;} <span class="comment">/* ksinv_eval_duration_t1value() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a06d9eb96605539fd74a90b3788f21998"><div class="ttname"><a href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a></div><div class="ttdeci">int ksinv_eval_nullti(int TR, int T1value, int seqdur)</div><div class="ttdoc">Calculates the TI value necessary to null the signal from a tissue with a given T1 value...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:462</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f2ff181a992b40e2a58afec637d14bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f2ff181a992b40e2a58afec637d14bf">&#9670;&nbsp;</a></span>ksinv_eval_duration_flairblock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_duration_flairblock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_momentstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the sequence module duration of a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> for a FLAIR block design</h4>
</p>
<p>This function sets the duration for an <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> module in a FLAIR block design, where <code>ksinv.params.nflairslices</code> number of inversion pulses are played first (at different slice locations) followed by equally many 'core slice' playouts (main sequence + optional other sequence modules attached to the main sequence).</p>
<p>The maximum number of FLAIR slices is capped by <code>slperpass</code>, which is the maximum number of slices to fit in one TR. As each inversion module must be as long as the <code>coreslice_duration</code> in a FLAIR block design, the integer number of flair slices (<code>ksinv.params.nflairslices</code>) rarely fit exactly in the desired TI time, why the duration of the inversion modules are increased to exactly fit this available time. This means that after calling this function, one must make sure that the duration of the main sequence is also increased accordingly. This is done in <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> sequence module to set up </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TI</td><td>The inversion time (TI) resulting from the interative search in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_momentstart</td><td>Time between the end of closest inversion module and the moment start of the main sequence. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_duration</td><td>Duration of the coreslice (main sequence + other attached sequence modules) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play out in one pass (acquisition) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                                                                                                                       {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordtype">int</span> avail_flairseqtime;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  <span class="keywordflow">if</span> (TI &lt;= 0) {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TI must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  <span class="keywordflow">if</span> (coreslice_momentstart &lt;= 0) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: The core slice moment start position must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordflow">if</span> (coreslice_duration &lt;= 0) {</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">/* core slice duration is the sequence time (incl. SSI time) for the main sequence and other sequence modules that</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">    are played just before each main sequence (e.g. ChemSat, GRx Sat, Simple IR etc.) */</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: The core slice time (arg 3) [attached seq. modules+ main seq.] must be &gt; 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  }</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> &gt; coreslice_duration) {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Minimum FLAIR slice duration must be less than the core slice time&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span> (TI &lt; ksinv-&gt;seqctrl.min_duration - ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + coreslice_momentstart) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TI too short to fit one inversion slice&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  }</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a> &amp;&amp; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ksinv.params.irmode must be KSINV_FLAIR_BLOCK or KSINV_FLAIR_T2PREP_BLOCK for this function&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (slperpass &lt; 1) {</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: #slices per pass (5th arg) must be at least 1&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  }</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = 0;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  avail_flairseqtime = TI - coreslice_momentstart + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">/* how many slices that can be fitted within &#39;opti&#39; */</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> = avail_flairseqtime / coreslice_duration;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> == 0) {</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">/* round-up (fall back to simple IR style). We have already checked that TI is long enough to fit one IR playout */</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> = 1;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  }</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="comment">/* don&#39;t exceed the total number of slices per pass */</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> &gt; slperpass) {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> = slperpass;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> -= ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> % ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a>;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">/* increase the duration to fill up to &#39;avail_flairseqtime&#39;</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">  N.B: The calling function must also increase the duration of its main sequence to fill up corresponding &#39;avail_flairseqtime&#39; in the core slice block */</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(avail_flairseqtime / ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &lt; coreslice_duration &amp;&amp; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> &gt; 1) {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: FLAIR slice duration became shorter than coreslice duration&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;} <span class="comment">/* ksinv_eval_duration_flairblock() */</span></div><div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aca53dcf7a61b8beba82e8f9a0c768cb5"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">KS_SELRF::sms_info</a></div><div class="ttdeci">KS_SMS_INFO sms_info</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1343</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a58c64aa08739814113f9cd8a01b7f2e6"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">KS_SMS_INFO::mb_factor</a></div><div class="ttdeci">int mb_factor</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1217</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a356bbeecc0c30e76a26bec0290a16945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a356bbeecc0c30e76a26bec0290a16945">&#9670;&nbsp;</a></span>ksinv_eval_setfilltr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_setfilltr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>filltr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>duration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the duration of a wait sequence (filltr) between FLAIR-blocks to meet manual TR</h4>
</p>
<p>In <a class="el" href="_k_s_inversion_8e.html#a3f2ff181a992b40e2a58afec637d14bf" title="Sets the sequence module duration of a KSINV_SEQUENCE for a FLAIR block design">ksinv_eval_duration_flairblock()</a>, <code>ksinv.params.nflairslices</code> number of inversion pulses are played out before equally many main sequence playouts. This time corresponds to: <code>2 * ksinv.params.nflairslices * coreslice_duration</code></p>
<p>If TR is set manually (AutoTR off), this filltr wait sequence module is set to fill up the time to the desired TR. When ksinv.params.nflairslices &lt;= number of slices per pass, two or more FLAIR-blocks will be played out in <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>, where each block will end with this wait sequence. Therefore, the duration of this wait sequence will be reduced in time if used more than once in each slice loop, to keep the same total wait duration given by: <code>filltr duration = TR - N * (2 * ksinv.params.nflairslices * coreslice_duration</code>, where N is an integer &gt;= 1.</p>
<p>If the duration is zero, the description will be ignored and set to "fillTR_disabled".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">filltr</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html" title="A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching">KS_SEQ_CONTROL</a> for the fillTR wait sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc</td><td>Description of the wait sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">duration</td><td>Duration of the wait sequence </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                                                           {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  strcpy(filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, desc);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">if</span> (duration &gt; 0) {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    strcpy(filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, desc);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> = RUP_GRD(<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(duration);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &lt; filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a> || filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &lt; filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>) {</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: filltr.duration must be &gt;= .min_duration and .ssi_time&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(filltr);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a>;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    strcpy(filltr-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, <span class="stringliteral">&quot;fillTR_disabled&quot;</span>);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;} <span class="comment">/* ksinv_eval_setfilltr() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3ec411ca45ee9d7fd1497ad6bdec3621"><div class="ttname"><a href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a></div><div class="ttdeci">int ksinv_filltr_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:156</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5737de577667231c42545c5b12afca2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5737de577667231c42545c5b12afca2c">&#9670;&nbsp;</a></span>ksinv_init_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_init_UI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initializes inversion related UI</h4>
</p>
<p>Pre-DV26:</p><ul>
<li>T2FLAIR set by: opflair == OPFLAIR_GROUP</li>
<li>T1FLAIR set by: opflair == OPFLAIR_INTERLEAVED</li>
</ul>
<p>DV26+: UI buttons have been moved from column 2 (under FastSpinEcho/SSFSE) to column 3 (imaging options)</p><ul>
<li>T2FLAIR set by: opt2flair == TRUE</li>
<li>T1FLAIR set by: opt1flair == TRUE</li>
</ul>
<p>To be compatible with previous releases, this function sets the legacy opflair CV to the correct value, so that (for now) sequences using <a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a> can continue to use opflair despite the DV26 UI change.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                       {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  set_incompatible(PSD_IOPT_T1FLAIR, PSD_IOPT_T2FLAIR); </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="keywordflow">if</span> (opt1flair == TRUE &amp;&amp; opt2flair == TRUE) {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Selection of T1FLAIR and T2FLAIR is not allowed&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opt1flair == TRUE &amp;&amp; opt2flair == FALSE) {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    cvoverride(opflair, OPFLAIR_INTERLEAVED, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opt2flair == TRUE &amp;&amp; opt1flair == FALSE) {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    cvoverride(opflair, OPFLAIR_GROUP, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    cvoverride(opflair, FALSE, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  }</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div><div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1faad3c6c3b83af20fc17d34db56c1ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1faad3c6c3b83af20fc17d34db56c1ed">&#9670;&nbsp;</a></span>ksinv_eval_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_UI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Gets the current UI and checks for valid inputs related to the inversion module(s)</h4>
</p>
<p>The inversion mode(s) is initially dependent on the UI selections: T2-FLAIR, T1-FLAIR, IR-prep. Only 2D+Fast-SpinEcho enables the T2-FLAIR and T1-FLAIR buttons, but 2D+EchoPlanar enables a FLAIR-EPI button, which is the same thing as T2-FLAIR.</p>
<p>If the T2-FLAIR button is selected, <code>opflair = OPFLAIR_GROUP</code>, resulting in a FLAIR-block design (<code>ksinv1.params.mode = KSINV_FLAIR_BLOCK</code>).</p>
<p>If the T1-FLAIR button is selected, <code>opflair = OPFLAIR_INTERLEAVED</code>, resulting in a slice-ahead inversion mode (<code>ksinv1.params.mode = KSINV_IR_SLICEAHEAD</code>).</p>
<p>In T2-FLAIR and T1-FLAIR modes, only the first of the four UserCVs reserved by <a class="el" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818" title="C-macro assigning four UserCV slots and then calling ksinv_eval()">KSINV_EVAL()</a> is shown.</p>
<p>For custom IR control, using simple IR or dual IR (in simple or sliceahead modes), opflair should be 0 and opirprep should be 1. For FSE (<a class="el" href="ksfse_8e.html" title="This file contains the overall structure for the ksfse psd. ">ksfse.e</a>), this advanced mode is set by selecting FSE-IR. For EPI (<a class="el" href="ksepi_8e.html" title="This file contains the overall structure for the ksepi psd. ">ksepi.e</a>), this mode is set by selecting SE-EPI, GE-EPI or DW-EPI and then selecting IRprep.</p>
<p>This function is used to set up inversion for 2D sequences and is not suited for future 3D psd support.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                       {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  cvmin(opti, 0);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  cvmax(opti, 20s);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  cvmax(optr, 240s); <span class="comment">/* 4 mins */</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (oppseq != PSD_IR <span class="comment">/* 3 */</span> &amp;&amp; opirprep == FALSE &amp;&amp; opflair == FALSE) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="comment">/* no IR selection, disable everything IR related */</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    piuset &amp;= ~(<a class="code" href="_k_s_inversion_8e.html#a326f5619a82910c975cbe0dfdb80792a">use_ir1_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a> + <a class="code" href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a>);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a> = 0; <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;existflag = TRUE; <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;fixedflag = TRUE;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a> = 0; <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;existflag = TRUE; <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;fixedflag = TRUE;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    pitinub = 0;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="comment">/* GE&#39;s ARC recon does not seem to like the combined use of</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">      a) inversion</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">      b) interleaved spacing (opileave)</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">      We can avoid this at the PSD selection stage by not allowing ARC</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">      at all (disable_ioption) with any kind of inversion. This prevents however also ARC inversion</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment">      w/o interleaved spacing. A second level of defense is to allow ARC for inversion, but to check</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">      whether interleaved spacing is on and if R &gt; 1 (opaccel_ph_stride), but also checking if autolock</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment">      is off. If autolock is on, one assumes that the user wants to reconstruct the data from Pfiles,</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">      which works without problems with ARC, inversion and interleaved spacing.</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">      First defense at PSD selection: Inversion is enabled =&gt; disable ARC option. Comment this out</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">      to allow ARC but instead be trapped by the second defense */</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    disable_ioption(PSD_IOPT_ARC);</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="comment">/* Second defense against ARC, interleaved spacing and inversion, if rawdata is not saved */</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">if</span> ((opileave == TRUE) &amp;&amp; (oparc == TRUE) &amp;&amp; (opaccel_ph_stride &gt; 1.0) &amp;&amp; (autolock == FALSE)) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Use ASSET for Inversion &amp; Intleave Spacing&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP || opflair == OPFLAIR_INTERLEAVED) {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">/* T2-FLAIR or T1-FLAIR */</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000) {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#a14920c5e204db4c6806708793acd04d6">T1_CSF_3T</a>;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#a2f426784f63708cad67ecccef32052be">T1_WM_3T</a>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#ae84b291225425cacf5586f8e96eceb45">T1_CSF_1_5T</a>;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#a42466f02f13cffb483cc1e8d9f922969">T1_WM_1_5T</a>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    }</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">/* maybe STIR */</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000) {</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#a06f5d44c9946155170eee07f10711b90">T1_FAT_3T</a>;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#a274b254ad1864dae61ca471400767801">T1_FAT_1_5T</a>;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;defval = 50; <span class="comment">/* ms */</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">/* presets for T1-FLAIR and T2-FLAIR */</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP) {</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">/* T2-FLAIR */</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    pitival2 = 3000ms;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    pitival3 = 0; <span class="comment">/* should never show */</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    pitival4 = 0;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    pitival5 = 0;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    pitival6 = 0;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">if</span> (_optr.defval &lt; <a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>) {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      _optr.defval = <a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a54b20d97b03afcad597c99a023359575">ksinv_t2prep</a> == 1) {</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (opflair == OPFLAIR_INTERLEAVED) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">/* T1-FLAIR (must use autoTI) */</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    pitival2 = 700ms;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    pitival3 = 0; <span class="comment">/* should never show */</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    pitival4 = 0;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    pitival5 = 0;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    pitival6 = 0;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    pitival2 = 150ms;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    pitival3 = 200ms;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    pitival4 = 250ms;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    pitival5 = 300ms;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    pitival6 = 350ms;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  <span class="comment">/*** begin: opusers ***/</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <span class="comment">/* [opuser] IR #1 mode */</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;minval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;maxval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a>(<a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>, <span class="stringliteral">&quot;IR1 [0:Off 1:IR 2:SA-IR 3:FLAIR]&quot;</span>);</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;existflag == FALSE) {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a> = <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;defval;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="comment">/* [opuser] IR #2 mode */</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;minval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;maxval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;defval = <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a>(<a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>, <span class="stringliteral">&quot;IR2 [0:Off 1:IR 2:SA-IR]&quot;</span>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;existflag == FALSE) {</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a> = <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;defval;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  }</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="comment">/* [opuser] IR #1. T1 value to NULL in [ms] (N.B.: not TI, but T1!) */</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;minval = 0;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;maxval = 10000;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  {</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">char</span> tmpstr[100];</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;    IR1 - T1 to null           [CSF:%d GM:%d WM:%d Fat:%d]&quot;</span>, <a class="code" href="_k_s_inversion_8e.html#a14920c5e204db4c6806708793acd04d6">T1_CSF_3T</a>, <a class="code" href="_k_s_inversion_8e.html#aea1ff6fab1e514587e7476608e5a6411">T1_GM_3T</a>, <a class="code" href="_k_s_inversion_8e.html#a2f426784f63708cad67ecccef32052be">T1_WM_3T</a>, <a class="code" href="_k_s_inversion_8e.html#a06f5d44c9946155170eee07f10711b90">T1_FAT_3T</a>);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 15000) {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;      sprintf(tmpstr, <span class="stringliteral">&quot;    IR1 - T1 to null           [CSF:%d GM:%d WM:%d Fat:%d]&quot;</span>, <a class="code" href="_k_s_inversion_8e.html#ae84b291225425cacf5586f8e96eceb45">T1_CSF_1_5T</a>, <a class="code" href="_k_s_inversion_8e.html#a320b11f98da39a21a7434c56a6114d34">T1_GM_1_5T</a>, <a class="code" href="_k_s_inversion_8e.html#a42466f02f13cffb483cc1e8d9f922969">T1_WM_1_5T</a>, <a class="code" href="_k_s_inversion_8e.html#a274b254ad1864dae61ca471400767801">T1_FAT_1_5T</a>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a>(<a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>, tmpstr);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;existflag == FALSE) {</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> = <a class="code" href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a>-&gt;defval;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  }</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <span class="comment">/* [opuser] IR #2. T1 value to NULL in [ms] (N.B.: not TI, but T1!) */</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;minval = 0;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;maxval = 10000;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a>(<a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>, <span class="stringliteral">&quot;IR2 - T1 to null&quot;</span>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;existflag == FALSE) {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a> = <a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>-&gt;defval;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  }</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">/* turn on all these opuser CVs */</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  piuset |= <a class="code" href="_k_s_inversion_8e.html#a326f5619a82910c975cbe0dfdb80792a">use_ir1_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a> + <a class="code" href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">/* if we are not doing inversion, hide the TI menu and other opusers and set opti = 0 */</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    piuset &amp;= ~(<a class="code" href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a> + <a class="code" href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a>);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = 0;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> = 0;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    pitinub = 0;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a>-&gt;existflag = FALSE;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;existflag = FALSE;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="comment">/* Default: allow AutoTI and 5+1 rows in TI menu */</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    piautoti = 1;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    pitinub = 6;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="comment">/* Set AutoTR and AutoTI */</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  opautotr = TRUE;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  opautoti = TRUE;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    pitrnub = 0; <span class="comment">/* &#39;2&#39;: only one menu choice (Minimum = AutoTR). &#39;0&#39;: shown but greyed out (if also opautotr = 1) */</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    pitinub = -1; <span class="comment">/* &#39;2&#39;: only one menu choice (AutoTI). &#39;-1&#39;: shown but greyed out */</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  }</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">if</span> (opflair == OPFLAIR_GROUP || opflair == OPFLAIR_INTERLEAVED) {</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">/* T2-FLAIR or T1-FLAIR. Branded options, narrow options down */</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">/* remove 0 mm gap from slice spacing menu */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    piisil = PSD_ON;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordtype">float</span> minspacing = exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>) / 2.0;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    piisnub = 5;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    piisval2 = minspacing;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    piisval3 = minspacing + 1;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    piisval4 = minspacing + 2;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    piisval5 = minspacing + 3;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    piisval6 = minspacing + 4;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    cvdef(opslspace, minspacing);</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    opslspace = _opslspace.defval;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span> (opflair == OPFLAIR_INTERLEAVED) {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      pitrnub = 0;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      pitinub = -1;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      cvoverride(opautotr, PSD_ON, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      pitrnub = 2; <span class="comment">/* &#39;2&#39;: only one menu choice (Minimum = AutoTR). &#39;0&#39;: shown but greyed out (if also opautotr = 1) */</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      pitinub = 2; <span class="comment">/* &#39;2&#39;: only one menu choice (AutoTI). &#39;-1&#39;: shown but greyed out */</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    }    </div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="comment">/* disable 2nd IR for T1/T2-FLAIR */</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a>-&gt;existflag = FALSE;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a> = 0;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> = 0;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    piuset &amp;= ~(<a class="code" href="_k_s_inversion_8e.html#a326f5619a82910c975cbe0dfdb80792a">use_ir1_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a> + <a class="code" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="comment">/* if not AutoTI, set internal TI variable to selected TI (opti) and hide T1value opuser */</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <span class="keywordflow">if</span> (opautoti == FALSE) {</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    piuset &amp;= ~<a class="code" href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a>;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = exist(opti);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  }</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    piuset &amp;= ~<a class="code" href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> = 0;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;} <span class="comment">/* ksinv_eval_UI() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a54b20d97b03afcad597c99a023359575"><div class="ttname"><a href="_k_s_inversion_8e.html#a54b20d97b03afcad597c99a023359575">ksinv_t2prep</a></div><div class="ttdeci">int ksinv_t2prep</div><div class="ttdef"><b>Definition:</b> KSInversion.e:172</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aea1ff6fab1e514587e7476608e5a6411"><div class="ttname"><a href="_k_s_inversion_8e.html#aea1ff6fab1e514587e7476608e5a6411">T1_GM_3T</a></div><div class="ttdeci">#define T1_GM_3T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:63</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a249adb4dd19303322658fb21bd50f0f6"><div class="ttname"><a href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a></div><div class="ttdeci">int ksinv1_ti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:129</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aedcaff264fe0d9a3f5f21f798294df71"><div class="ttname"><a href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a></div><div class="ttdeci">int ksinv_mintr_t2flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:157</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a326f5619a82910c975cbe0dfdb80792a"><div class="ttname"><a href="_k_s_inversion_8e.html#a326f5619a82910c975cbe0dfdb80792a">use_ir1_mode</a></div><div class="ttdeci">int use_ir1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:132</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ae84b291225425cacf5586f8e96eceb45"><div class="ttname"><a href="_k_s_inversion_8e.html#ae84b291225425cacf5586f8e96eceb45">T1_CSF_1_5T</a></div><div class="ttdeci">#define T1_CSF_1_5T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:62</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a81b4237583e689d003167994a8719a0f"><div class="ttname"><a href="_k_s_inversion_8e.html#a81b4237583e689d003167994a8719a0f">use_ir2_t1</a></div><div class="ttdeci">int use_ir2_t1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:135</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aefff0d8b1fa3576fd70d11c3c6531153"><div class="ttname"><a href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a></div><div class="ttdeci">_cvfloat * _ksinv2_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:145</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a06f5d44c9946155170eee07f10711b90"><div class="ttname"><a href="_k_s_inversion_8e.html#a06f5d44c9946155170eee07f10711b90">T1_FAT_3T</a></div><div class="ttdeci">#define T1_FAT_3T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:67</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aefdb8236f7b0142a72e065761f38d77a"><div class="ttname"><a href="_k_s_inversion_8e.html#aefdb8236f7b0142a72e065761f38d77a">_ksinv2_mode</a></div><div class="ttdeci">_cvfloat * _ksinv2_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:143</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6a4b2616ed775246a12caf9b951eef55"><div class="ttname"><a href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a></div><div class="ttdeci">float * ksinv1_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:140</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6579b086714c710ddbc06234b65778ef"><div class="ttname"><a href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a></div><div class="ttdeci">float * ksinv2_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:141</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a8dd63530f860d975a0f760ad700a0ffd"><div class="ttname"><a href="_k_s_inversion_8e.html#a8dd63530f860d975a0f760ad700a0ffd">_ksinv1_mode</a></div><div class="ttdeci">_cvfloat * _ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:142</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a2f426784f63708cad67ecccef32052be"><div class="ttname"><a href="_k_s_inversion_8e.html#a2f426784f63708cad67ecccef32052be">T1_WM_3T</a></div><div class="ttdeci">#define T1_WM_3T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:65</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_abfc292edee1b0d4a4bb8dc26a5aaafb0"><div class="ttname"><a href="_k_s_inversion_8e.html#abfc292edee1b0d4a4bb8dc26a5aaafb0">_ksinv1_t1value</a></div><div class="ttdeci">_cvfloat * _ksinv1_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:144</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a595dd888c8c07d45eedcc25c826309f9"><div class="ttname"><a href="_k_s_inversion_8e.html#a595dd888c8c07d45eedcc25c826309f9">use_ir1_t1</a></div><div class="ttdeci">int use_ir1_t1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:133</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a42466f02f13cffb483cc1e8d9f922969"><div class="ttname"><a href="_k_s_inversion_8e.html#a42466f02f13cffb483cc1e8d9f922969">T1_WM_1_5T</a></div><div class="ttdeci">#define T1_WM_1_5T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:66</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a274b254ad1864dae61ca471400767801"><div class="ttname"><a href="_k_s_inversion_8e.html#a274b254ad1864dae61ca471400767801">T1_FAT_1_5T</a></div><div class="ttdeci">#define T1_FAT_1_5T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:68</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a320b11f98da39a21a7434c56a6114d34"><div class="ttname"><a href="_k_s_inversion_8e.html#a320b11f98da39a21a7434c56a6114d34">T1_GM_1_5T</a></div><div class="ttdeci">#define T1_GM_1_5T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:64</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ad16abf0f4ed621197332669743d97511"><div class="ttname"><a href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a></div><div class="ttdeci">int ksinv2_ti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:130</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a8a71ab613a50aa4cb90eb4146fb06ca7"><div class="ttname"><a href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a></div><div class="ttdeci">float * ksinv2_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:139</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a95165792103811810e882d2be1381f54"><div class="ttname"><a href="_k_s_inversion_8e.html#a95165792103811810e882d2be1381f54">use_ir2_mode</a></div><div class="ttdeci">int use_ir2_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:134</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a14920c5e204db4c6806708793acd04d6"><div class="ttname"><a href="_k_s_inversion_8e.html#a14920c5e204db4c6806708793acd04d6">T1_CSF_3T</a></div><div class="ttdeci">#define T1_CSF_3T</div><div class="ttdef"><b>Definition:</b> KSInversion.e:61</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_abd2839fe562821c8a76cc9c65d4dfae4"><div class="ttname"><a href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a></div><div class="ttdeci">#define _cvdesc(cv, string)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:63</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a70fccdbea3feb9556b6d52ea9aaaed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a70fccdbea3feb9556b6d52ea9aaaed">&#9670;&nbsp;</a></span>ksinv_eval()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *&#160;</td>
          <td class="paramname"><em>custom_selrf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h4>Gets the IR-related UI parameters, creates sequence objects and min_duration for the inversion module(s), and adds these modules to <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a>. </h4>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">custom_selrf</td><td>Optional pointer to <a class="el" href="struct_k_s___s_e_l_r_f.html" title="Composite sequence object for slice-selective RF">KS_SELRF</a> for custom inversion RF pulse. Pass NULL to use default RF pulses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                                                            {</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  STATUS status;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>);<span class="comment">/* 1st IR */</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>);<span class="comment">/* 2nd IR */</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>); <span class="comment">/* init fillTR for FLAIR-block */</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a1faad3c6c3b83af20fc17d34db56c1ed">ksinv_eval_UI</a>();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="comment">/* If no IR1 flag on, return quietly */</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="comment">/* Set inversion slice thickness. N.B.: &#39;avmaxacqs&#39; = number of acqs shown in the UI (a.k.a. acqs = npasses) */</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="keywordflow">if</span> (existcv(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>) &amp;&amp; (<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> &gt; 0)) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">int</span> intleavefact = IMax(2, 1, avmaxacqs);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordtype">float</span> slthickfact = intleavefact * (<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> + opslspace) / <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a> = (slthickfact &lt;= <a class="code" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>) ? slthickfact : <a class="code" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a859527bdf4dc460bdf84895ad48fad8e">ksinv_slthickfact_exc</a> = <a class="code" href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a>;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; existcv(opslquant) &amp;&amp; existcv(opslspace) &amp;&amp; opflair &amp;&amp; (avmaxacqs &lt;= 1) &amp;&amp; (opssfse == FALSE) &amp;&amp; (opslspace &lt;= 0) &amp;&amp; (opileave == 0)) {</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">/* for single acquisition T1-FLAIR or T2-FLAIR, prevent too little spacing between slices it not interleaved</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="comment">    spacing, but only once the user has set number of slices, TR, and slice gap (so we don&#39;t complain too early) */</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Use slice gap or Intleave&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="comment">/* single or 1st IR */</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#aa6d57cd163e2af9351a9535c2f32fdbc">ksinv_eval_copycvs</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>, (<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#abb942440dc967f835bdad59f07519e03">ksinv_eval_setupobjects</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <span class="stringliteral">&quot;1&quot;</span>, custom_selrf);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>);</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a9c627057bb753177d7b74e5cd9ba1a46">ks_eval_addtoseqcollection</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">/* FillTR sequence for KSINV_FLAIR_BLOCK. This is added after all slices have been played out each TR instead</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">  of increasing the duration of the main pulse sequence to fullfill TR */</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a356bbeecc0c30e76a26bec0290a16945">ksinv_eval_setfilltr</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, <span class="stringliteral">&quot;fillTR&quot;</span>, 0); <span class="comment">/* initialize to zero */</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a>) != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#aa6d57cd163e2af9351a9535c2f32fdbc">ksinv_eval_copycvs</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>, (<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a>);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#abb942440dc967f835bdad59f07519e03">ksinv_eval_setupobjects</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <span class="stringliteral">&quot;2&quot;</span>, custom_selrf);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#a9c627057bb753177d7b74e5cd9ba1a46">ks_eval_addtoseqcollection</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  }</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;  <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;} <span class="comment">/* ksinv_eval() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a356bbeecc0c30e76a26bec0290a16945"><div class="ttname"><a href="_k_s_inversion_8e.html#a356bbeecc0c30e76a26bec0290a16945">ksinv_eval_setfilltr</a></div><div class="ttdeci">STATUS ksinv_eval_setfilltr(KS_SEQ_CONTROL *filltr, const char *const desc, int duration)</div><div class="ttdoc">Sets the duration of a wait sequence (filltr) between FLAIR-blocks to meet manual TR...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:791</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a407623c8b83da7fb46f7c2fb693f58e1"><div class="ttname"><a href="_k_s_inversion_8e.html#a407623c8b83da7fb46f7c2fb693f58e1">ksinv_slthickfact</a></div><div class="ttdeci">float ksinv_slthickfact</div><div class="ttdef"><b>Definition:</b> KSInversion.e:165</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9c627057bb753177d7b74e5cd9ba1a46"><div class="ttname"><a href="_k_s_foundation_8h.html#a9c627057bb753177d7b74e5cd9ba1a46">ks_eval_addtoseqcollection</a></div><div class="ttdeci">STATUS ks_eval_addtoseqcollection(KS_SEQ_COLLECTION *seqcollection, KS_SEQ_CONTROL *seqctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Adds a sequence module (KS_SEQ_CONTROL) to the KS_SEQ_COLLECTION struct for later RF scaling and SAR ...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:130</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_afc869a70acec39e5abf83e4ff3f2282c"><div class="ttname"><a href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a></div><div class="ttdeci">#define KSINV_MAXTHICKFACT</div><div class="ttdef"><b>Definition:</b> KSInversion.e:58</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5d73f67e51b69dac2f331c220e8c7106"><div class="ttname"><a href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a></div><div class="ttdeci">int ksinv_pg(KSINV_SEQUENCE *)</div><div class="ttdoc">Generation of the waveforms for the sequence objects in a KSINV_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1930</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_abb942440dc967f835bdad59f07519e03"><div class="ttname"><a href="_k_s_inversion_8e.html#abb942440dc967f835bdad59f07519e03">ksinv_eval_setupobjects</a></div><div class="ttdeci">STATUS ksinv_eval_setupobjects(KSINV_SEQUENCE *ksinv, const char *suffix, KS_SELRF *custom_selrf)</div><div class="ttdoc">Sets up the sequence objects for the inversion sequence module (KSINV_SEQUENCE ksinv)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:411</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aa6d57cd163e2af9351a9535c2f32fdbc"><div class="ttname"><a href="_k_s_inversion_8e.html#aa6d57cd163e2af9351a9535c2f32fdbc">ksinv_eval_copycvs</a></div><div class="ttdeci">void ksinv_eval_copycvs(KSINV_PARAMS *params, int mode)</div><div class="ttdoc">Copy CVs into a common params struct (KSINV_PARAMS) used to steer this sequence module</div><div class="ttdef"><b>Definition:</b> KSInversion.e:231</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a82cf97823a7c838642029fdf29e9d76e"><div class="ttname"><a href="_k_s_inversion_8e.html#a82cf97823a7c838642029fdf29e9d76e">ksinv_init_sequence</a></div><div class="ttdeci">void ksinv_init_sequence(KSINV_SEQUENCE *ksinv)</div><div class="ttdoc">Resets the KSINV_SEQUENCE struct (arg 1) to KSINV_INIT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:213</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a1faad3c6c3b83af20fc17d34db56c1ed"><div class="ttname"><a href="_k_s_inversion_8e.html#a1faad3c6c3b83af20fc17d34db56c1ed">ksinv_eval_UI</a></div><div class="ttdeci">STATUS ksinv_eval_UI()</div><div class="ttdoc">Gets the current UI and checks for valid inputs related to the inversion module(s)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:883</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a8a71ab613a50aa4cb90eb4146fb06ca7"><div class="ttname"><a href="_k_s_inversion_8e.html#a8a71ab613a50aa4cb90eb4146fb06ca7">ksinv2_mode</a></div><div class="ttdeci">float * ksinv2_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:139</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a859527bdf4dc460bdf84895ad48fad8e"><div class="ttname"><a href="_k_s_inversion_8e.html#a859527bdf4dc460bdf84895ad48fad8e">ksinv_slthickfact_exc</a></div><div class="ttdeci">float ksinv_slthickfact_exc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:177</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="addad288b52ddf945f6740ac6241b4a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addad288b52ddf945f6740ac6241b4a39">&#9670;&nbsp;</a></span>ksinv_eval_mintr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_eval_mintr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *&#160;</td>
          <td class="paramname"><em>slice_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>gheatfact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>ksinv_filltr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const SCAN_INFO *, int, int, void **)&#160;</td>
          <td class="paramname"><em>play_coreslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core_nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>core_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates the minimum TR allowed for the <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a></h4>
</p>
<p>Given the current durations of the sequence modules involved in the <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>, this function calculates the minimum TR, accounting also for SAR and hardware limits.</p>
<p>This function expects a pointer to a scan function playing out one <code>coreslice</code>. The <code>coreslice</code> should play out the main sequence once (i.e. one slice), but the coreslice function may also play optional other sequence modules that should always be played together with the main sequence (e.g. fatsat).</p>
<p>As the number of arguments to the sequence's coreslice is psd-dependent, the function pointer <code>play_coreslice</code> must be a wrapper function to the coreslice function taking standardized input arguments <code>(int) core_nargs</code> and <code>(void **) core_args</code>. This coreslice wrapper function must be on the form: <code>int coreslice_nargs(SCAN_INFO *, int storeslice, int core_nargs, void **core_args);</code> If the coreslice function does not need any additional input arguments, <code>core_nargs = 0</code>, and <code>core_args = NULL</code>.</p>
<p>With this function pointer, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> can replace the sequence (non-inversion) sliceloop function, and play out the inversion module(s) and the sequence module(s) in the coreslice function.</p>
<p>After resetting the <code>seqctrl.nseqinstances</code> for all sequence modules in the sequence collection, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is called once to increment <code>seqctrl.nseqinstances</code> by 1 for every time each sequence modules is played out. With this updated information, <code>seqcollection</code> is passed to <a class="el" href="_k_s_foundation_8h.html#ab4c6e9f82b55a3db56765fc22f21b7b5" title="Returns the time required to play out a certain number of sequence modules over some interval...">ks_eval_gradrflimits()</a>, which will calculate the total duration and add additional time for SAR/hardware limits. This time is the return value of <a class="el" href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39" title="Calculates the minimum TR allowed for the ksinv_scan_sliceloop()">ksinv_eval_mintr()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_plan</td><td>Pointer to the <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html" title="Struct holding all information about slice locations and aquisition order">KS_SLICE_PLAN</a> struct holding the slice order information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gheatfact</td><td>Value in range [0,1] denoting how much the gradient heating limits should be honored (0:none, 1:full) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv1</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to the 1st (or only) inversion. Cannot be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv2</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to an optional 2nd inversion. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv_filltr</td><td>Pointer to <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html" title="A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching">KS_SEQ_CONTROL</a> for fillTR sequence for FLAIR block modes. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">play_coreslice</td><td>Function pointer to (the wrapper function to) the coreslice function of the sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_nargs</td><td>Number of extra input arguments to the coreslice wrapper function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_args</td><td>Void pointer array pointing to the variables containing the actual values needed for the sequence's coreslice function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">minTR</td><td>Minimum TR for <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> honoring SAR and hardware limits </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                                                                                                    {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">/* must be run before each call to function pointer `play_coreslice()` to set all `seqctrl.nseqinstances` to 0 */</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#acb34cd9d6c99193829696596b4d0271f">ks_eval_seqcollection_resetninst</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>);</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(slice_plan, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, 0, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, FALSE, play_coreslice, core_nargs, core_args); <span class="comment">/* get sequence instance counts */</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab4c6e9f82b55a3db56765fc22f21b7b5">ks_eval_gradrflimits</a>(NULL, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, gheatfact); <span class="comment">/* minTR within limits given the number of sequence instances, durations and RF/grad content */</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;} <span class="comment">/* ksinv_eval_mintr() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ab4c6e9f82b55a3db56765fc22f21b7b5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab4c6e9f82b55a3db56765fc22f21b7b5">ks_eval_gradrflimits</a></div><div class="ttdeci">int ks_eval_gradrflimits(KS_SAR *sar, KS_SEQ_COLLECTION *seqcollection, float gheatfact)</div><div class="ttdoc">Returns the time required to play out a certain number of sequence modules over some interval...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3014</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_acb34cd9d6c99193829696596b4d0271f"><div class="ttname"><a href="_k_s_foundation_8h.html#acb34cd9d6c99193829696596b4d0271f">ks_eval_seqcollection_resetninst</a></div><div class="ttdeci">void ks_eval_seqcollection_resetninst(KS_SEQ_COLLECTION *seqcollection)</div><div class="ttdoc">Set the .nseqinstances field of each sequence module (KS_SEQ_CONTROL) equal to 0</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3235</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0d4a045ba5f33c135f38227fe6326b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0d4a045ba5f33c135f38227fe6326b1">&#9670;&nbsp;</a></span>ksinv_eval_maxslicespertr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_eval_maxslicespertr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>TR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a>&#160;</td>
          <td class="paramname"><em>temp_slice_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>gheatfact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>ksinv_filltr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const SCAN_INFO *, int, int, void **)&#160;</td>
          <td class="paramname"><em>play_coreslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core_nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>core_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates the maximum slices per TR using <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a></h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TR</td><td>Repetition time in [us] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">temp_slice_plan</td><td>Pointer to the <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html" title="Struct holding all information about slice locations and aquisition order">KS_SLICE_PLAN</a> struct holding the slice order information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gheatfact</td><td>Value in range [0,1] denoting how much the gradient heating limits should be honored (0:none, 1:full) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv1</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to the 1st (or only) inversion. Cannot be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv2</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> corresponding to an optional 2nd inversion. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv_filltr</td><td>Pointer to <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html" title="A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching">KS_SEQ_CONTROL</a> for fillTR sequence for FLAIR block modes. May be NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">play_coreslice</td><td>Function pointer to (the wrapper function to) the coreslice function of the sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_nargs</td><td>Number of extra input arguments to the coreslice wrapper function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_args</td><td>Void pointer array pointing to the variables containing the actual values needed for the sequence's coreslice function </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MaxSlicesPerTR</td><td>Maximum slices that can fit in the specified TR, honoring SAR and hardware limits </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                                                                                                             {</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keywordtype">int</span> max_slquant1 = 0;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>, invslicelooptime;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 1; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 1024; <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    temp_slice_plan.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> = <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>; <span class="comment">/* hack the slice plan with &#39;i&#39; #slices to see when invslicelooptime becomes larger than TR */</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    invslicelooptime = <a class="code" href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a>(&amp;temp_slice_plan, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, gheatfact, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="keywordflow">if</span> (invslicelooptime == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) {</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    }</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordflow">if</span> (invslicelooptime &gt; TR) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      <span class="keywordflow">return</span> max_slquant1;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    max_slquant1 = <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>;</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  }</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">return</span> max_slquant1;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;} <span class="comment">/* ksinv_eval_maxslicespertr() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_addad288b52ddf945f6740ac6241b4a39"><div class="ttname"><a href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a></div><div class="ttdeci">int ksinv_eval_mintr(const KS_SLICE_PLAN *slice_plan, KS_SEQ_COLLECTION *seqcollection, float gheatfact, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Calculates the minimum TR allowed for the ksinv_scan_sliceloop()</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1272</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af56977a078ab040bd50c4b8b7fba9337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af56977a078ab040bd50c4b8b7fba9337">&#9670;&nbsp;</a></span>ksinv_eval_flairblock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_flairblock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>filltr_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>repetition_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>inversion_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>autotr_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T1tonull</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_momentstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>FLAIR block calculations</h4>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a>. ksinv.params.irmode must be KSINV_FLAIR_BLOCK and ksinv.seqctrl.min_duration and ksinv.seqctrl.momentstart both &gt; 0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">filltr_time</td><td>The time that needs to be added after all slices played out to fill up to the manual TR </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">repetition_time</td><td>Pointer to the repetition time [us]. If autotr_flag = TRUE, this value will be set and returned as TR to the calling function. If autotr_flag = FALSE, 'repetition_time' will be used as TR here </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">inversion_time</td><td>Pointer to the inversion time [us]. If 'T1tonull' &gt; 0, this value will be set and returned as TI to the calling function. If 'T1tonull' = 0, 'inversion_time' will be used as TI here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">autotr_flag</td><td>TRUE/FALSE flag for autoTR. If TRUE, 'repetition_time' will be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1tonull</td><td>T1-value to null. 0: Off (value of 'inversion_time' is used. &gt;0: Use this T1-value to calculate the TI value and update and return 'inversion_time' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_momentstart</td><td>Time between the end of closest inversion module and the moment start of the main sequence. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coreslice_duration</td><td>Duration of the coreslice (main sequence + other attached sequence modules) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play out in one pass (acquisition)</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                                                                                                                                                                                                  {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordtype">int</span> iter_max = 20;</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordtype">int</span> TRtol = 20; <span class="comment">/* TR error tolerance in [us] */</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordtype">int</span> hasconverged = FALSE;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordtype">int</span> cap_nflairslices = FALSE;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordtype">int</span> lowest_nflairslices = slperpass;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  <span class="keywordtype">int</span> minTR, TR, TI;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="keywordtype">int</span> nflairblocks;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordtype">int</span> lastTR = 0;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="keywordtype">int</span> flair_duration;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  <span class="keywordtype">int</span> timetoadd_perTR;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  STATUS status;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordflow">if</span> (filltr_time == NULL || repetition_time == NULL || inversion_time == NULL) {</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 2nd-4th args must be non-NULL int pointers&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keywordflow">if</span> (autotr_flag != 0 &amp;&amp; autotr_flag != 1) {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: autotr flag must be 0 (false) or 1 (true)&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keywordflow">if</span> (autotr_flag) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">/* AutoTR */</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    TR = 20s; <span class="comment">/* starting guess */</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    TR = *repetition_time;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  }</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  <span class="keywordflow">do</span> {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span> (T1tonull &gt; 0) {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="comment">/* AutoTI: set TI based on T1tonull and current TR (AutoTR) or fixed TR */</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      TI = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(TR, T1tonull, coreslice_duration);</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      TI = *inversion_time;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    }</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">/* duration of each inversion module in the FLAIR block. This function sets the field ksinv.params.nflairslices */</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a3f2ff181a992b40e2a58afec637d14bf">ksinv_eval_duration_flairblock</a>(ksinv, TI, coreslice_momentstart, coreslice_duration, (cap_nflairslices == TRUE) ? lowest_nflairslices : slperpass);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="comment">/* minimum TR (ignoring grad/RF heating and SAR) */</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    nflairblocks = CEIL_DIV(slperpass, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>); <span class="comment">/* number of FLAIR blocks */</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    flair_duration = (nflairblocks * ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> + slperpass) * ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="comment">/* keep minTR above ksinv_mintr_t2flair */</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    minTR = IMax(2, flair_duration, <a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>);</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordflow">if</span> (autotr_flag == TRUE) {</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      TR = minTR;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="comment">/* wait sequence after each set (group) of FLAIR + core slices to fill up TR. C.f. ksinv_scan_sliceloop() */</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    timetoadd_perTR = IMax(2, TR, <a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>) - flair_duration;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    *filltr_time = RUP_GRD(timetoadd_perTR / nflairblocks);</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">if</span> (autotr_flag == TRUE) {</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="comment">/* converge check and lastTR update */</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      hasconverged = abs(lastTR - minTR) &lt; TRtol;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      lastTR = minTR;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a> &lt; lowest_nflairslices &amp;&amp; cap_nflairslices == FALSE) {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        <span class="comment">/* In the event that the number of FLAIR slices toggles between two (or more) values, this iteration process may not converge.</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment">           We monitor the lowest nflairslices that occur during the first iteration round (lowest_nflairslices). If we reach iter_max, use lowest_nflairslices</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">           instead of slperass as last arg to ksinv_eval_duration_flairblock() to force nflairslices to this value, and re-iterate.</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="comment">           If still no convergence, lowest_nflairslices is reduced by 1 */</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        lowest_nflairslices = ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      }</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">if</span> (++<a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> == iter_max) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="comment">/* Things to do when we have reached #iterations */</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">if</span> (lowest_nflairslices &gt; 1) {</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <span class="comment">/* reset iteration counter */</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;          <span class="keywordflow">if</span> (cap_nflairslices == FALSE) {</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <span class="comment">/* try iterating a second time, now with the lowest number of nflairslices used in the iterations (lowest_nflairslices) */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            cap_nflairslices = TRUE;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;          } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;            <span class="comment">/* try iterating again after the second time, now with lowest_nflairslices reduced by 1 */</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            lowest_nflairslices--;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;          }</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: FLAIR-block - Combination of TI &amp; TR not found after %d iterations&quot;</span>, __FUNCTION__, iter_max);</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    } <span class="comment">/* autotr_flag */</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  } <span class="keywordflow">while</span> ((autotr_flag == TRUE) &amp;&amp; (hasconverged == FALSE)); <span class="comment">/* only iterate for AutoTR */</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <span class="keywordflow">if</span> (TR &lt; <a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>) {</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;     <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TR must be increased to %d ms&quot;</span>, __FUNCTION__, CEIL_DIV(<a class="code" href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a>, 1000));</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  *inversion_time = TI;</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  *repetition_time = TR;</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;}</div><div class="ttc" id="_k_s_inversion_8e_html_aedcaff264fe0d9a3f5f21f798294df71"><div class="ttname"><a href="_k_s_inversion_8e.html#aedcaff264fe0d9a3f5f21f798294df71">ksinv_mintr_t2flair</a></div><div class="ttdeci">int ksinv_mintr_t2flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:157</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a06d9eb96605539fd74a90b3788f21998"><div class="ttname"><a href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a></div><div class="ttdeci">int ksinv_eval_nullti(int TR, int T1value, int seqdur)</div><div class="ttdoc">Calculates the TI value necessary to null the signal from a tissue with a given T1 value...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:462</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3f2ff181a992b40e2a58afec637d14bf"><div class="ttname"><a href="_k_s_inversion_8e.html#a3f2ff181a992b40e2a58afec637d14bf">ksinv_eval_duration_flairblock</a></div><div class="ttdeci">STATUS ksinv_eval_duration_flairblock(KSINV_SEQUENCE *ksinv, int TI, int coreslice_momentstart, int coreslice_duration, int slperpass)</div><div class="ttdoc">Sets the sequence module duration of a KSINV_SEQUENCE for a FLAIR block design</div><div class="ttdef"><b>Definition:</b> KSInversion.e:706</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b1b8efc850e9c75308857736fd847ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b1b8efc850e9c75308857736fd847ec">&#9670;&nbsp;</a></span>ksinv_eval_flairblock_withmainupdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_flairblock_withmainupdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>ksinv_filltr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>mainseqctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>repetition_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>inversion_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>autotr_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>T1tonull</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_momentstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>coreslice_duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                                                                                                                                                                                                                                                                          {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  STATUS status;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keywordtype">int</span> filltr_duration;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a>(ksinv, &amp;filltr_duration, repetition_time, inversion_time, autotr_flag, T1tonull, coreslice_momentstart, coreslice_duration, slperpass);</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <span class="comment">/* set up fill TR sequence (to be played out CEIL_DIV(slperpass, ksinv-&gt;params.nflairslices) times per TR) unless filltr_duration &lt; ssi_time */</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a356bbeecc0c30e76a26bec0290a16945">ksinv_eval_setfilltr</a>(<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, <span class="stringliteral">&quot;fillTR&quot;</span>, (filltr_duration &gt; <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a>) * filltr_duration);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="comment">/* We must have the same seq duration for ksinv-&gt;seqctrl.duration and the coreslice duration, add round-up time due to nflairslices divisibility to the duration of the main sequence. */</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; coreslice_duration) {</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> += RUP_GRD(ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - coreslice_duration);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  }</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;}</div><div class="ttc" id="_k_s_inversion_8e_html_a356bbeecc0c30e76a26bec0290a16945"><div class="ttname"><a href="_k_s_inversion_8e.html#a356bbeecc0c30e76a26bec0290a16945">ksinv_eval_setfilltr</a></div><div class="ttdeci">STATUS ksinv_eval_setfilltr(KS_SEQ_CONTROL *filltr, const char *const desc, int duration)</div><div class="ttdoc">Sets the duration of a wait sequence (filltr) between FLAIR-blocks to meet manual TR...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:791</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af56977a078ab040bd50c4b8b7fba9337"><div class="ttname"><a href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a></div><div class="ttdeci">STATUS ksinv_eval_flairblock(KSINV_SEQUENCE *ksinv, int *filltr_time, int *repetition_time, int *inversion_time, int autotr_flag, int T1tonull, int coreslice_momentstart, int coreslice_duration, int slperpass)</div><div class="ttdoc">FLAIR block calculations</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1347</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3ec411ca45ee9d7fd1497ad6bdec3621"><div class="ttname"><a href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a></div><div class="ttdeci">int ksinv_filltr_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:156</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a4ae2b692531f3c649a5035992425c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a4ae2b692531f3c649a5035992425c1">&#9670;&nbsp;</a></span>ksinv_eval_multislice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_eval_multislice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> *&#160;</td>
          <td class="paramname"><em>slice_plan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(const SCAN_INFO *, int, int, void **)&#160;</td>
          <td class="paramname"><em>play_coreslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>core_nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>core_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *&#160;</td>
          <td class="paramname"><em>mainseqctrl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Calculates the duration of inversion module(s) for various inversion modes</h4>
</p>
<p>This function is to be used by a 2D psd to set the inversion duration(s) for <code>ksinv1</code> and possibly <code>ksinv2</code> (dual IR). Before calling this function, the <code>ksinv-&gt;params.irmode</code> (and <code>ksinv2.params.irmode</code>) must be set to steer which type of inversion that should be performed. Here follows the inversion modes supported by this function:</p>
<p>Single inversion (<code>ksinv2.params.irmode = KSINV_OFF</code>):</p><ol type="1">
<li><code>ksinv1.params.irmode = KSINV_FLAIR_BLOCK</code>:<ul>
<li>Heat handling: None, but will be caught in final SAR check at the end. Unlikely to happen for T2-FLAIR</li>
</ul>
</li>
<li><code>ksinv1.params.irmode = KSINV_IR_SIMPLE</code> and manual TR (<code>opautotr = FALSE</code>):<ul>
<li>Heat handling: Increase mainseqctrl-&gt;duration based on timetoadd_perTR</li>
</ul>
</li>
<li><code>ksinv1.params.irmode = KSINV_IR_SLICEAHEAD</code> <em>or</em> <code>ksinv1.params.irmode = KSINV_IR_SIMPLE</code> and (<code>opautotr = TRUE</code>)<ul>
<li>Heat handling: C.f. "Early grad/RF heat calculations" that increases mainseqctrl-&gt;duration <em>before</em> IR/TR timing calculations</li>
</ul>
</li>
</ol>
<p>Dual inversion:</p><ol type="1">
<li><code>ksinv1.params.irmode = KSINV_IR_SIMPLE</code> and <code>ksinv2.params.irmode = KSINV_IR_SIMPLE</code></li>
<li><code>ksinv1.params.irmode = KSINV_IR_SLICEAHEAD</code> and <code>ksinv2.params.irmode = KSINV_IR_SIMPLE</code></li>
<li><code>ksinv1.params.irmode = KSINV_FLAIR_BLOCK</code> and <code>ksinv2.params.irmode = KSINV_IR_SIMPLE</code></li>
<li><code>ksinv1.params.irmode = KSINV_IR_SLICEAHEAD</code> and <code>ksinv2.params.irmode = KSINV_IR_SLICEAHEAD</code>. TI1 (opti) will be approximated</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_plan</td><td>Pointer to the <a class="el" href="struct_k_s___s_l_i_c_e___p_l_a_n.html" title="Struct holding all information about slice locations and aquisition order">KS_SLICE_PLAN</a> struct holding the slice order information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">play_coreslice</td><td>Function pointer to (the wrapper function to) the coreslice function of the sequence </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_nargs</td><td>Number of extra input arguments to the coreslice wrapper function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">core_args</td><td>Void pointer array pointing to the variables containing the actual values needed for the sequence's coreslice function </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mainseqctrl</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html" title="A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching">KS_SEQ_CONTROL</a> struct for the main sequence</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">MaxSlicesPerTR</td><td>Maximum slices that can fit in the specified TR, honoring SAR and hardware limits </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                                                                                                                                                                                                                      {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  STATUS status;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="keywordtype">int</span> coreslice_momentstart;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="keywordtype">int</span> coreslice_duration;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordtype">int</span> minTR = 0;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordtype">int</span> timetoadd_perTR;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  SCAN_INFO dummy_slice_pos = <a class="code" href="_g_e_required_8e.html#a4c590873e5778394b3d52c4225250863">DEFAULT_AXIAL_SCAN_INFO</a>; <span class="comment">/* dummy slice info for coreslice */</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">/* return early if we don&#39;t have at least one inversion */</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  }</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="comment">/* return early if #slices/TR = 0 */</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keywordflow">if</span> (slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> == 0) {</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  }</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: DualIR: If 2nd IR is on, so must the 1st IR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) {</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: DualIR: If 2nd IR is sliceahead, so must the 1st IR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a> || <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: DualIR: 2nd IR cannot be a FLAIR block&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a> == TRUE) {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st IR (ksinv1): approximate TI only applicable to sliceahead IR mode&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  }</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a> == TRUE) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 2nd IR (ksinv2): approximate TI only applicable to sliceahead IR mode&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  }</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  <span class="comment">/* ks_eval_seqcollection_durations_atleastminimum() makes sure seqctrl.duration is at least seqctrl.min_duration for all sequence modules */</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  status = <a class="code" href="_k_s_foundation_8h.html#a3de8410411e4caddbabb57b40fc3abe1">ks_eval_seqcollection_durations_atleastminimum</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">if</span> ( (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) || ((<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>) &amp;&amp; (opautoti == TRUE) &amp;&amp; (opautotr == TRUE)) ) {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">     * Early grad/RF heat calculations</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">     *******************************************************************************************************/</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="comment">/* For KSINV_IR_SLICEAHEAD mode, we need to check for grad/RF heating *first* in a worst case scenario where all sequence</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">       modules have .duration = .min_duration. The penalty time is added the main sequence duration to be within the limits.</span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">       After this, we can start calculating the IR time(s). This is due to that the KSINV_IR_SLICEAHEAD mode in part uses inversion</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">       pulses from the previous TR to invert slices in the current TR, why the TR cannot be changed (increased) after these</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">       calculations due to later heating issues. The same applies to simple IR mode with both AutoTR and AutoTI.</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">       For these two cases, both TR and TI are consequences of the chosen T1 null value */</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;    <span class="comment">/* at this point, the IR module(s), main sequence, and other sequence modules should have .duration = .min_duration. Check worst case (minimum duration modules) */</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    minTR = <a class="code" href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a>(slice_plan, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="_g_e_required_8e.html#a7ca8f149618c5cab125f422cd627c433">ks_gheatfact</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, NULL, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">if</span> (minTR == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    </div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">/* how much TR needs to increase if we have only minimum duration modules */</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    timetoadd_perTR = minTR - <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(slice_plan, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, 0, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, NULL, FALSE, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="comment">/* we spread the available timetoadd_perTR evenly, by increasing .duration of each slice by timetoadd_perTR/slice_plan-&gt;nslices_per_pass */</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> += RUP_GRD(CEIL_DIV(timetoadd_perTR, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>));</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  }</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <span class="comment">/* get coreslice time, i.e. time for one slice. Note that this must come after early grad/RF heat calculation to reflect the increased mainseq duration */</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  coreslice_duration = play_coreslice(&amp;dummy_slice_pos, 0, core_nargs, core_args);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="comment">/* momentstart will be = mainseqctrl-&gt;momentstart if there is no other sequence module in play_coreslice(). However if the coreslice function contains</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="comment">  other sequence module they are required to be placed before the main sequence module to assure the inversion time is correctly calculated */</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  coreslice_momentstart = coreslice_duration - mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a>;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) {</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">     * First and second IR when both are in mode KSINV_IR_SLICEAHEAD</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">     *******************************************************************************************************/</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="comment">/* mainseqctrl-&gt;duration already prolonged to meed grad/RF limits if necessary (see above).</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment">       If both inversion pulses modes are KSINV_IR_SLICEAHEAD, the first IR has to get an approximate TI time using an</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">       (integer) ksinv1.params.nslicesahead and ksinv1.seqctrl.duration = ksinv1.seqctrl.min_duration. When calculating</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">       the sequence duration for ksinv2, we need to reserve this minimum time (ksinv1.seqctrl.min_duration) between the</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">       main sequence and ksinv2. Both IR pulses in KSINV_IR_SLICEAHEAD mode is faster, but the TI time for the first one</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">       will not be exact. For an FSE train of 200 ms, the TI will be rounded off by 200/2 ms at most, but since the 1st</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">       TI is usually 2500 ms when two IRs are used it may be ok */</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="keywordflow">if</span> (opautotr == FALSE || opautoti == FALSE) {</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: sliceahead mode requires AutoTI and AutoTR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">/* 1st IR duration fixed to minimum */</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">/* 2nd IR: get sequence module duration, TR and TI based on T1 null value and coreslice duration (iterative). Approximate TI if ksinv2.approxti = TRUE */</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a9a2bc8ea23c238a06473dc7e8a32def3">ksinv_eval_duration_t1value</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, &amp;minTR, &amp;<a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a>, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a>, coreslice_momentstart, coreslice_duration + <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>, (<span class="keywordtype">int</span>) (*<a class="code" href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a> * 1000.0) <span class="comment">/* [ms]-&gt;[us] */</span>, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">/* 1st IR (TI based on T1 to null) */</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(minTR, (<span class="keywordtype">int</span>) (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0) <span class="comment">/* [ms]-&gt;[us] */</span>, mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="comment">/* 1st IR (always approximate TI, using .duration = .min_duration) */</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> = (<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> + <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> - coreslice_momentstart - <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>) / (coreslice_duration + <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>);</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">nslicesahead</a> * (coreslice_duration + <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>) - <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + coreslice_momentstart;</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>) {</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">     * Second IR in mode KSINV_IR_SIMPLE</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="comment">     *******************************************************************************************************/</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;     <span class="comment">/* N.B: The TR we pass in to ksinv_eval_nullti() will be from last UI evaluation.</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="comment">       This may change when opautotr = TRUE, and a new TI2 will cause a new TR due to TI1 calcs below,</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">       which in turn will cause a new TI2 etc. Can this be made non-iteratitve ? */</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(exist(optr), (<span class="keywordtype">int</span>) (*<a class="code" href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a> * 1000.0) <span class="comment">/* [ms]-&gt;[us] */</span>, mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a6a4d7e8d641045f0f72b824493bdcb88">ksinv_eval_duration</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a>, coreslice_momentstart);</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  }</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a> || <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">     * First IR in mode KSINV_FLAIR_BLOCK or KSINV_FLAIR_T2PREP_BLOCK (T2-FLAIR)</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">     *******************************************************************************************************/</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordtype">int</span> TR;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">if</span> (opautotr == FALSE) { <span class="comment">/* Manual TR */</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordtype">int</span> filltr_duration;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      <span class="comment">/* minTR: Call ksinv_eval_flairblock() first in AutoTR mode to get the minimum TR to report back to the UI, then proceed with the actual TR (optr)</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">      using ksinv_eval_flairblock_withmainupdate(), where we also update the main sequence duration */</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      status = <a class="code" href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;filltr_duration, &amp;minTR, &amp;<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, TRUE, (opautoti) * (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0),</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                                   <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_momentstart, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_duration, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      TR = exist(optr);</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      </div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;      <span class="comment">/* Maximum slices that would fit the chosen manual TR */</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="keywordflow">while</span> (1) {</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        <span class="comment">/* N.B. arg 3 (TR) not modified in ksinv_eval_flairblock() when arg 5 (opautotr) = FALSE */</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        status = <a class="code" href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;filltr_duration, &amp;TR, &amp;<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, FALSE, (opautoti) * (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0),</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                                     <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_momentstart, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_duration, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> + <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">if</span> (filltr_duration &lt;= 0) {</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;          avmaxslquant = slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> + <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a> - 1; <span class="keywordflow">break</span>;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;          <a class="code" href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">i</a>++;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        }</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;      }</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    } <span class="comment">/* Manual TR */</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a5b1b8efc850e9c75308857736fd847ec">ksinv_eval_flairblock_withmainupdate</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, mainseqctrl, (opautotr) ? (&amp;minTR) : (&amp;TR), </div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                                                  &amp;<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, opautotr, (opautoti) * (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0),</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                                                  <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_momentstart, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + coreslice_duration, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>);</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">if</span> (opautotr) {</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="comment">/* show the optimal # slices to avoid inversion dummy inversion slices so the user can see what is the most time</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="comment">         efficient number of slices (i.e. when scantime/slice is the lowest) */</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      avmaxslquant = CEIL_DIV(slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>) * <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existcv(optr)) {</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <span class="comment">/* watch out for very narrow band of manual TR values between minTR and [minTR + nflairblocks*ksinv_filltr.ssi_time] where</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">      the sequence modules do not sum up to the intended optr since we have not been able to use the filltr sequence with this </span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">      short duration. Increase the minTR to trigger an error */</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      <span class="keywordtype">int</span> nflairblocks = CEIL_DIV(slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">nflairslices</a>); <span class="comment">/* number of FLAIR blocks */</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">if</span> (TR &gt; minTR) {</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        minTR = CEIL_DIV(minTR + nflairblocks * <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>, 1000) * 1000;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    }</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="comment">/* add the fillTR sequence module to the sequence collection (ignored if ksinv_filltr.duration = 0) */</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    status = <a class="code" href="_k_s_foundation_8h.html#a9c627057bb753177d7b74e5cd9ba1a46">ks_eval_addtoseqcollection</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;   </div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a> &amp;&amp; (opautotr == FALSE || opautoti == FALSE)) {</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">    * First IR in mode KSINV_IR_SIMPLE and not both AutoTI and AutoTR</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">if</span> (opautoti) {</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      <span class="comment">/* AutoTI: set TI based on ksinv1_t1value and current (manual) TR */</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> = <a class="code" href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a>(exist(optr), (<span class="keywordtype">int</span>) (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0) <span class="comment">/* [ms]-&gt;[us] */</span>, mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    }</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">/* set the sequence module duration */</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a6a4d7e8d641045f0f72b824493bdcb88">ksinv_eval_duration</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, coreslice_momentstart);</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="comment">/* calculate min TR given the ksinv_scan_sliceloop() duration and addition heating penalties */</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    minTR = <a class="code" href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a>(slice_plan, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="_g_e_required_8e.html#a7ca8f149618c5cab125f422cd627c433">ks_gheatfact</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, NULL, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">if</span> (minTR == <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">/* how much time to add due to long manual TR (opautotr = FALSE) or due to heating (opautotr = TRUE) */</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <span class="keywordflow">if</span> (opautotr == FALSE) {</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      timetoadd_perTR = exist(optr) - <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(slice_plan, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, 0, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, NULL, FALSE, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      timetoadd_perTR = minTR - <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(slice_plan, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, 0, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, NULL, FALSE, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    }</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="comment">/* we spread the available timetoadd_perTR evenly, by increasing .duration of each slice by timetoadd_perTR/slice_plan-&gt;nslices_per_pass */</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> += RUP_GRD(CEIL_DIV(timetoadd_perTR, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>));</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ((<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>) &amp;&amp; (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a>)) || ((<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a>) &amp;&amp; (opautoti == TRUE) &amp;&amp; (opautotr == TRUE)) ) {</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="comment">     * First IR, in mode</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="comment">     * - KSINV_IR_SIMPLE with AutoTI and AutoTR</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="comment">     * - KSINV_IR_SLICEAHEAD, when second IR was not KSINV_IR_SLICEAHEAD</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="comment">     * For both cases, early heating control has been done</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="comment">     *******************************************************************************************************/</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;     <span class="keywordflow">if</span> (opautotr == FALSE || opautoti == FALSE) {</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: sliceahead mode requires both AutoTI and AutoTR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="comment">/* get sequence module duration, TR and TI based on T1 null value and coreslice duration */</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a9a2bc8ea23c238a06473dc7e8a32def3">ksinv_eval_duration_t1value</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;minTR, &amp;<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">approxti</a>, coreslice_momentstart, coreslice_duration, mainseqctrl-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>, (<span class="keywordtype">int</span>) (*<a class="code" href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a> * 1000.0) <span class="comment">/* [ms]-&gt;[us] */</span>, slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">  * update UI and GE globals</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">/* for AutoTI, update TI menu (first row) with the value in ksinv1_ti as well as opti */</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="keywordflow">if</span> (opautoti == TRUE) {</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    pitival2 = <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    cvoverride(opti, <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) { <span class="comment">/* update opuser for IR2 T1-value with TI information */</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordtype">char</span> tmpstr[200];</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    sprintf(tmpstr, <span class="stringliteral">&quot;IR2 - T1 to null (TI=%d ms)&quot;</span>, <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a> / 1000);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a>(<a class="code" href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a>, tmpstr);</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a> - <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>) &lt; <a class="code" href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a>) {</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: IR2 must be shorter than IR1&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    }</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  }</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="comment">/* set npasses in slice plan to be consistent with nslices and nslices_per_pass */</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  avmaxacqs = slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>; <span class="comment">/* UI value (&quot;# of Acqs:&quot;) */</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="comment">/* update min TR advisory */</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  avmintr = minTR;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  avmaxtr = 100s;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">/* make sure TR in UI (optr) is long enough */</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="keywordflow">if</span> (opautotr == TRUE) {</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    avmaxtr = minTR;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    cvoverride(optr, minTR, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a> &amp;&amp; <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      avmaxslquant = slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; (optr &lt; minTR)) {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: increase TR to %.1f ms (seq./heating limit)&quot;</span>, __FUNCTION__, minTR / 1000.0);</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span> (avmaxslquant &lt; slice_plan-&gt;nslices_per_pass) {</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="comment">/* avoid the max slices value in the UI to show up smaller than the prescribed slices/pass now that all is good */</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      avmaxslquant = slice_plan-&gt;<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    }</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  }</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <span class="comment">/* prevent further addition of other sequence modules. Inversion must be last one added to the</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="comment">    sequence collection to keep inversion timing correct */</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">mode</a> = <a class="code" href="_k_s_foundation_8h.html#a99fb83031ce9923c84392b4e92f956b5af64c78cedb5f88bb17738bcf993a7755">KS_SEQ_COLLECTION_LOCKED</a>;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;  <span class="comment">/* synonyms for optr: avail_image_time and act_tr */</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  <a class="code" href="_g_e_required_8e.html#aab3baee33eebda2bcf24b20846ce32a9">avail_image_time</a> = RDN_GRD(exist(optr));</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <a class="code" href="_g_e_required_8e.html#a16ede8dd5ed24fd803dc270aa22e57c5">act_tr</a> = <a class="code" href="_g_e_required_8e.html#aab3baee33eebda2bcf24b20846ce32a9">avail_image_time</a>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  ihtr = <a class="code" href="_g_e_required_8e.html#a16ede8dd5ed24fd803dc270aa22e57c5">act_tr</a>; <span class="comment">/* image header TR */</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  avminslquant = 1;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="comment">  * Final SAR check</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="comment">/* assure that we have taken care of TR timing and grad/RF heating issues so that we don&#39;t call GEReq_eval_TR() again</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">     This also prevents further addition of other sequence modules */</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">evaltrdone</a> = TRUE;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="comment">/* Check TR timing and SAR limits */</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, slice_plan, play_coreslice, core_nargs, core_args);</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;<span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;} <span class="comment">/* ksinv_eval_multislice() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_aa08a7ecfbf13a621a577fa984bda2b5a"><div class="ttname"><a href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS ksinv_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Runs the inversion slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1846</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a249adb4dd19303322658fb21bd50f0f6"><div class="ttname"><a href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a></div><div class="ttdeci">int ksinv1_ti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:129</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cafc5578d0d2ba8fcaf7152291a23396d3">KSINV_FLAIR_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca9441a60b84ee1b973ae480da747dfd64">KSINV_IR_SIMPLE</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af56977a078ab040bd50c4b8b7fba9337"><div class="ttname"><a href="_k_s_inversion_8e.html#af56977a078ab040bd50c4b8b7fba9337">ksinv_eval_flairblock</a></div><div class="ttdeci">STATUS ksinv_eval_flairblock(KSINV_SEQUENCE *ksinv, int *filltr_time, int *repetition_time, int *inversion_time, int autotr_flag, int T1tonull, int coreslice_momentstart, int coreslice_duration, int slperpass)</div><div class="ttdoc">FLAIR block calculations</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1347</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6a4d7e8d641045f0f72b824493bdcb88"><div class="ttname"><a href="_k_s_inversion_8e.html#a6a4d7e8d641045f0f72b824493bdcb88">ksinv_eval_duration</a></div><div class="ttdeci">STATUS ksinv_eval_duration(KSINV_SEQUENCE *ksinv, int TI, int coreslice_momentstart)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:492</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_aefff0d8b1fa3576fd70d11c3c6531153"><div class="ttname"><a href="_k_s_inversion_8e.html#aefff0d8b1fa3576fd70d11c3c6531153">_ksinv2_t1value</a></div><div class="ttdeci">_cvfloat * _ksinv2_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:145</div></div>
<div class="ttc" id="union_indices_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="union_indices.html#ad9484f5522d0e5f033037c369365ec61">Indices::i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1302</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b1b8efc850e9c75308857736fd847ec"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b1b8efc850e9c75308857736fd847ec">ksinv_eval_flairblock_withmainupdate</a></div><div class="ttdeci">STATUS ksinv_eval_flairblock_withmainupdate(KSINV_SEQUENCE *ksinv, KS_SEQ_CONTROL *ksinv_filltr, KS_SEQ_CONTROL *mainseqctrl, int *repetition_time, int *inversion_time, int autotr_flag, int T1tonull, int coreslice_momentstart, int coreslice_duration, int slperpass)</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1452</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n_html_a1ea5d0cb93f22f7d0fdf804bd68c3326"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#a1ea5d0cb93f22f7d0fdf804bd68c3326">KS_SEQ_COLLECTION::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1150</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9c627057bb753177d7b74e5cd9ba1a46"><div class="ttname"><a href="_k_s_foundation_8h.html#a9c627057bb753177d7b74e5cd9ba1a46">ks_eval_addtoseqcollection</a></div><div class="ttdeci">STATUS ks_eval_addtoseqcollection(KS_SEQ_COLLECTION *seqcollection, KS_SEQ_CONTROL *seqctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Adds a sequence module (KS_SEQ_CONTROL) to the KS_SEQ_COLLECTION struct for later RF scaling and SAR ...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:130</div></div>
<div class="ttc" id="_g_e_required_8e_html_a16ede8dd5ed24fd803dc270aa22e57c5"><div class="ttname"><a href="_g_e_required_8e.html#a16ede8dd5ed24fd803dc270aa22e57c5">act_tr</a></div><div class="ttdeci">int act_tr</div><div class="ttdef"><b>Definition:</b> GERequired.e:208</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6a4b2616ed775246a12caf9b951eef55"><div class="ttname"><a href="_k_s_inversion_8e.html#a6a4b2616ed775246a12caf9b951eef55">ksinv1_t1value</a></div><div class="ttdeci">float * ksinv1_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:140</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6579b086714c710ddbc06234b65778ef"><div class="ttname"><a href="_k_s_inversion_8e.html#a6579b086714c710ddbc06234b65778ef">ksinv2_t1value</a></div><div class="ttdeci">float * ksinv2_t1value</div><div class="ttdef"><b>Definition:</b> KSInversion.e:141</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_ac40805e95e77104a3bc7e489a46c68bb"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#ac40805e95e77104a3bc7e489a46c68bb">KSINV_PARAMS::nslicesahead</a></div><div class="ttdeci">int nslicesahead</div><div class="ttdef"><b>Definition:</b> KSInversion.e:82</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3de8410411e4caddbabb57b40fc3abe1"><div class="ttname"><a href="_k_s_foundation_8h.html#a3de8410411e4caddbabb57b40fc3abe1">ks_eval_seqcollection_durations_atleastminimum</a></div><div class="ttdeci">STATUS ks_eval_seqcollection_durations_atleastminimum(KS_SEQ_COLLECTION *seqcollection) WARN_UNUSED_RESULT</div><div class="ttdoc">Assures the .duration fields of all sequence modules being part of the sequence collection (KS_SEQ_CO...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2992</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_addad288b52ddf945f6740ac6241b4a39"><div class="ttname"><a href="_k_s_inversion_8e.html#addad288b52ddf945f6740ac6241b4a39">ksinv_eval_mintr</a></div><div class="ttdeci">int ksinv_eval_mintr(const KS_SLICE_PLAN *slice_plan, KS_SEQ_COLLECTION *seqcollection, float gheatfact, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Calculates the minimum TR allowed for the ksinv_scan_sliceloop()</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1272</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a9cd9ebd93187231e5c4109d14c0dd69c"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">KS_SLICE_PLAN::npasses</a></div><div class="ttdeci">int npasses</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1201</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a06d9eb96605539fd74a90b3788f21998"><div class="ttname"><a href="_k_s_inversion_8e.html#a06d9eb96605539fd74a90b3788f21998">ksinv_eval_nullti</a></div><div class="ttdeci">int ksinv_eval_nullti(int TR, int T1value, int seqdur)</div><div class="ttdoc">Calculates the TI value necessary to null the signal from a tissue with a given T1 value...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:462</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ad16abf0f4ed621197332669743d97511"><div class="ttname"><a href="_k_s_inversion_8e.html#ad16abf0f4ed621197332669743d97511">ksinv2_ti</a></div><div class="ttdeci">int ksinv2_ti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:130</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a76c00ca60cd966806ee442a002e24cd1"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a76c00ca60cd966806ee442a002e24cd1">KSINV_PARAMS::nflairslices</a></div><div class="ttdeci">int nflairslices</div><div class="ttdef"><b>Definition:</b> KSInversion.e:83</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a9a2bc8ea23c238a06473dc7e8a32def3"><div class="ttname"><a href="_k_s_inversion_8e.html#a9a2bc8ea23c238a06473dc7e8a32def3">ksinv_eval_duration_t1value</a></div><div class="ttdeci">STATUS ksinv_eval_duration_t1value(KSINV_SEQUENCE *ksinv, int *TR, int *TI, int approxti_flag, int coreslice_momentstart, int coreslice_duration, int mainseq_mindur, int T1value_toNull, int slperpass)</div><div class="ttdoc">Sets the sequence module duration of a KSINV_SEQUENCE as well as TI and TR (slice-ahead IR)...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:563</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n_html_aaa31b32f56e7b425f15f4191ef1f92be"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">KS_SEQ_COLLECTION::evaltrdone</a></div><div class="ttdeci">int evaltrdone</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1152</div></div>
<div class="ttc" id="_g_e_required_8e_html_a7ca8f149618c5cab125f422cd627c433"><div class="ttname"><a href="_g_e_required_8e.html#a7ca8f149618c5cab125f422cd627c433">ks_gheatfact</a></div><div class="ttdeci">float ks_gheatfact</div><div class="ttdef"><b>Definition:</b> GERequired.e:241</div></div>
<div class="ttc" id="_g_e_required_8e_html_aab3baee33eebda2bcf24b20846ce32a9"><div class="ttname"><a href="_g_e_required_8e.html#aab3baee33eebda2bcf24b20846ce32a9">avail_image_time</a></div><div class="ttdeci">int avail_image_time</div><div class="ttdef"><b>Definition:</b> GERequired.e:207</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca3825efb9b2e90db494eb68203cd0fc1b">KSINV_IR_SLICEAHEAD</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_g_e_required_8e_html_a4c590873e5778394b3d52c4225250863"><div class="ttname"><a href="_g_e_required_8e.html#a4c590873e5778394b3d52c4225250863">DEFAULT_AXIAL_SCAN_INFO</a></div><div class="ttdeci">#define DEFAULT_AXIAL_SCAN_INFO</div><div class="ttdef"><b>Definition:</b> GERequired.e:152</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99fb83031ce9923c84392b4e92f956b5af64c78cedb5f88bb17738bcf993a7755"><div class="ttname"><a href="_k_s_foundation_8h.html#a99fb83031ce9923c84392b4e92f956b5af64c78cedb5f88bb17738bcf993a7755">KS_SEQ_COLLECTION_LOCKED</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1771</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_a70de662739aecac63e1b0a999ea4d23d"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#a70de662739aecac63e1b0a999ea4d23d">KSINV_PARAMS::approxti</a></div><div class="ttdeci">int approxti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:80</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_abd2839fe562821c8a76cc9c65d4dfae4"><div class="ttname"><a href="_k_s_foundation_8h.html#abd2839fe562821c8a76cc9c65d4dfae4">_cvdesc</a></div><div class="ttdeci">#define _cvdesc(cv, string)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:63</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a44a7199cbc45d139870616b7ec288cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a7199cbc45d139870616b7ec288cb7">&#9670;&nbsp;</a></span>ksinv_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Checks related to inversion</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;                     {</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; (opflair == OPFLAIR_INTERLEAVED) &amp;&amp; (optr &lt; <a class="code" href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a>)) {</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TR should be &gt;= %d ms for T1FLAIR&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a>/1000);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  }</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;}</div><div class="ttc" id="_k_s_inversion_8e_html_a674357090f00fc5dcfb92e6b734b3ba4"><div class="ttname"><a href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a></div><div class="ttdeci">#define KSINV_MINTR_T1FLAIR</div><div class="ttdef"><b>Definition:</b> KSInversion.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad58f67c4aa2bc4815d7ea1298753e069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad58f67c4aa2bc4815d7ea1298753e069">&#9670;&nbsp;</a></span>ksinv_predownload_setrecon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_predownload_setrecon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets IR-related recon variables in predownload</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;                                    {</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    cvoverride(ihti, <a class="code" href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a>, PSD_FIX_ON, PSD_EXIST_ON); <span class="comment">/* same as opti */</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  }</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;} <span class="comment">/* ksinv_predownload_setrecon() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a249adb4dd19303322658fb21bd50f0f6"><div class="ttname"><a href="_k_s_inversion_8e.html#a249adb4dd19303322658fb21bd50f0f6">ksinv1_ti</a></div><div class="ttdeci">int ksinv1_ti</div><div class="ttdef"><b>Definition:</b> KSInversion.e:129</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adecabb815648ab0473dade37919a7e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adecabb815648ab0473dade37919a7e0b">&#9670;&nbsp;</a></span>ksinv_pulsegen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksinv_pulsegen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Generation of all inversion-related sequence modules</h4>
</p>
<p>This function should be called directly from the <code><a class="el" href="ksepi_8e.html#a9229731c099971b90dbf7721bad586a9">pulsegen()</a></code> function in a psd to create up to three sequence modules that can be used during scan.</p>
<p>N.B.: If ksinvX.seqctrl.duration = 0, both <a class="el" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106" title="Generation of the waveforms for the sequence objects in a KSINV_SEQUENCE">ksinv_pg()</a> and <a class="el" href="_g_e_required_8e.html#ab1fe30ecb27b541de01992692c1e9a47" title="Creates a hardware sequence for the current sequence module">KS_SEQLENGTH()</a> will return early avoiding this sequence module to be created. Similarly for the seqInvFillTR wait sequence.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                      {</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;  <span class="comment">/* First (only) Inversion sequence module */</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>);</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;  <a class="code" href="_g_e_required_8e.html#ab1fe30ecb27b541de01992692c1e9a47">KS_SEQLENGTH</a>(seqInv1, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>); <span class="comment">/* does nothing if ksinv1.seqctrl.duration = 0 */</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="comment">/* 2nd Inversion sequence module */</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a>(&amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;  <a class="code" href="_g_e_required_8e.html#ab1fe30ecb27b541de01992692c1e9a47">KS_SEQLENGTH</a>(seqInv2, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>); <span class="comment">/* does nothing if ksinv2.seqctrl.duration = 0 */</span></div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;  <span class="comment">/* FillTR sequence for some inversion cases */</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <a class="code" href="_g_e_required_8e.html#ab1fe30ecb27b541de01992692c1e9a47">KS_SEQLENGTH</a>(seqInvFillTR, <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>); <span class="comment">/* does nothing if ksinv_filltr.duration = 0 */</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;} <span class="comment">/* ksinv_pulsegen() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="_g_e_required_8e_html_ab1fe30ecb27b541de01992692c1e9a47"><div class="ttname"><a href="_g_e_required_8e.html#ab1fe30ecb27b541de01992692c1e9a47">KS_SEQLENGTH</a></div><div class="ttdeci">KS_SEQLENGTH(seq_name, seq_struct)</div><div class="ttdoc">Creates a hardware sequence for the current sequence module</div><div class="ttdef"><b>Definition:</b> GERequired.e:66</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5d73f67e51b69dac2f331c220e8c7106"><div class="ttname"><a href="_k_s_inversion_8e.html#a5d73f67e51b69dac2f331c220e8c7106">ksinv_pg</a></div><div class="ttdeci">int ksinv_pg(KSINV_SEQUENCE *)</div><div class="ttdoc">Generation of the waveforms for the sequence objects in a KSINV_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1930</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7243c21c92994e98b1baf972465bde4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7243c21c92994e98b1baf972465bde4">&#9670;&nbsp;</a></span>ksinv_scan_seqstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksinv_scan_seqstate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the current state of a <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> during scanning</h4>
</p>
<p>This function sets the current state of all <code>ksinv</code> sequence objects being part of <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a>, specifically slice-dependent RF freq/phases changes.</p>
<p>The idea of having a 'seqstate' function is to be able to come back to a certain sequence state at any time and possibly play it out once more. This could for example be useful when certain lines or slices need to be rescanned due to image artifacts detected during scanning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_info</td><td>Pointer to position of the slice to be played out (one element in the <code>ks_scan_info[]</code> array) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                                                                               {</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a> || ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> == 0)</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="keywordflow">if</span> (slice_info != NULL) {</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a>(*slice_info);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a>) {</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, INSTRALL, *slice_info, 0);</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">selrfrefoc</a>, INSTRALL, *slice_info, 90);</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, INSTRALL, *slice_info, 0);</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">selrfflip</a>, INSTRALL, *slice_info, 0);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    } <span class="keywordflow">else</span> {  </div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, 0);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a177e78699b1c480f77893fa200380d84">pulse_type</a> == <a class="code" href="_k_s_foundation_8h.html#af968d7d6e4fa1359fba5550fc39ae172a27d5a473a532b02775bf36bd99857980">KS_SELRF_SMS_PINS_DANTE</a>) {</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#adb1b77a3c2cb4a699081c3ba79ba428c">ks_scan_selrf_setfreqphase_pins</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, 0, *slice_info,</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                                        ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a>, ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a1b26a538ab6e22362275d427f991a3e1">slice_gap</a>, 0.0);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>, 0, *slice_info, 0);</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      }</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    }</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, 0);</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  }</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;} <span class="comment">/* ksinv_scan_seqstate() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6d1910f42394dc7fb363d85bd6e9c5"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a></div><div class="ttdeci">void ks_scan_rf_on(KS_RF *rf, int instanceno)</div><div class="ttdoc">Resets the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:421</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06ca84d0a6fd0b878eee622df6121bea8eb2">KSINV_FLAIR_T2PREP_BLOCK</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aca53dcf7a61b8beba82e8f9a0c768cb5"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">KS_SELRF::sms_info</a></div><div class="ttdeci">KS_SMS_INFO sms_info</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1343</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a1b26a538ab6e22362275d427f991a3e1"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a1b26a538ab6e22362275d427f991a3e1">KS_SMS_INFO::slice_gap</a></div><div class="ttdeci">float slice_gap</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1218</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af968d7d6e4fa1359fba5550fc39ae172a27d5a473a532b02775bf36bd99857980"><div class="ttname"><a href="_k_s_foundation_8h.html#af968d7d6e4fa1359fba5550fc39ae172a27d5a473a532b02775bf36bd99857980">KS_SELRF_SMS_PINS_DANTE</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1760</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a9b938b45a69cb4a8e451d8c365dff979"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a9b938b45a69cb4a8e451d8c365dff979">KSINV_SEQUENCE::selrfflip</a></div><div class="ttdeci">KS_SELRF selrfflip</div><div class="ttdef"><b>Definition:</b> KSInversion.e:103</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae8766ce800f95dd75ca2eece6638326c"><div class="ttname"><a href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, float rfphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:532</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSINV_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:102</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_adb1b77a3c2cb4a699081c3ba79ba428c"><div class="ttname"><a href="_k_s_foundation_8h.html#adb1b77a3c2cb4a699081c3ba79ba428c">ks_scan_selrf_setfreqphase_pins</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase_pins(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, int sms_multiband_factor, float sms_slice_gap, float rfphase)</div><div class="ttdoc">Updates the off-center phase-modulation of one or all instances of a PINS RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:455</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2fdfe2e655a76c4cd4fb1dac16d1834b"><div class="ttname"><a href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a></div><div class="ttdeci">void ks_scan_rotate(SCAN_INFO slice_info)</div><div class="ttdoc">Performs a rotation of the logical system on hardware (WARP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:988</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a58c64aa08739814113f9cd8a01b7f2e6"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">KS_SMS_INFO::mb_factor</a></div><div class="ttdeci">int mb_factor</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1217</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a177e78699b1c480f77893fa200380d84"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a177e78699b1c480f77893fa200380d84">KS_SMS_INFO::pulse_type</a></div><div class="ttdeci">int pulse_type</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1219</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_a620f873c08811cb1b6eae1a50bc97029"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#a620f873c08811cb1b6eae1a50bc97029">KSINV_SEQUENCE::selrfrefoc</a></div><div class="ttdeci">KS_SELRF selrfrefoc</div><div class="ttdef"><b>Definition:</b> KSInversion.e:104</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc6e42d3cc89e0469897a74a66ffcc19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6e42d3cc89e0469897a74a66ffcc19">&#9670;&nbsp;</a></span>ksinv_scan_irslice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_scan_irslice </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *&#160;</td>
          <td class="paramname"><em>ksinv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out one inversion slice in real time during scanning</h4>
</p>
<p>On TGT on the MR system (PSD_HW), this function sets up (<a class="el" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498" title="Sets the current state of all ksepi sequence objects being part of KSEPI_SEQUENCE">ksepi_scan_seqstate()</a>) and plays out one <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a>. The low-level function call <code><a class="el" href="_k_s_foundation__tgt_8c.html#a7a93838e7d53ff7ec9fbe98843181d03">startseq()</a></code>, which actually starts the realtime sequence playout is called from within <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, which in addition also returns the time to play out that sequence module (see time += ...).</p>
<p>On HOST (in <a class="el" href="ksepi__implementation_8e.html#a10f68a0b1180fea87e5a74f8346d3633" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksepi_eval_tr()</a>) we call <a class="el" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e" title="Wrapper function to ksepi_scan_sliceloop() with standardized input arguments">ksepi_scan_sliceloop_nargs()</a>, which in turn calls this function that returns the total time in [us] taken to play out this core slice. These times are increasing in each parent function until ultimately ksepi_scan_scantime(), which returns the total time of the entire scan.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ksinv</td><td>Pointer to <a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html" title="typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms">KSINV_SEQUENCE</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Pointer to position of the slice to be played out (one element in the <code>ks_scan_info[]</code> array) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">irtime</td><td>Time taken in [us] to play out one inversion slice </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                                                                          {</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  SCAN_INFO slice_pos_updated;</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <span class="keywordtype">float</span> tloc = 0.0;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="keywordflow">if</span> (ksinv == NULL) {</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  }</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;  <span class="keywordflow">if</span> (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a> &amp;&amp; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> &gt; 0) {</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="keywordflow">if</span> (slice_pos != NULL) {</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="comment">/* N.B.: Mphysical_inversion is an ipgexport KS_MAT4x4 variable that e.g. the main sequence can update in real time */</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a1a51b640b1005f02c4475a1c5f673adb">ks_scan_update_slice_location</a>(&amp;slice_pos_updated, *slice_pos, <a class="code" href="_k_s_inversion_8e.html#a22f26aad1c923f8730b833487f07f6cb">Mphysical_inversion</a>, NULL);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;      tloc = slice_pos_updated.optloc;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#ac7243c21c92994e98b1baf972465bde4">ksinv_scan_seqstate</a>(ksinv, &amp;slice_pos_updated);</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;      <a class="code" href="_k_s_inversion_8e.html#ac7243c21c92994e98b1baf972465bde4">ksinv_scan_seqstate</a>(ksinv, slice_pos);</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    }</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="comment">/* SMS offset */</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordtype">float</span> offset = (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a1b26a538ab6e22362275d427f991a3e1">slice_gap</a> / 2) * (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a> - 1);</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keywordtype">float</span> sms_slice_positions[ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a>];</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordtype">int</span> slice = 0;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keywordflow">for</span> (slice = 0; slice &lt; ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a>; ++slice) {</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;      <span class="keywordflow">if</span> (slice_pos != NULL)</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        sms_slice_positions[slice] = tloc + ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a1b26a538ab6e22362275d427f991a3e1">slice_gap</a> * (0.5 + slice - (ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a> / 2.0)) + offset;</div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        sms_slice_positions[slice] = 0;</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    }</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>,</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                      ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">sms_info</a>.<a class="code" href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">mb_factor</a>,</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                      sms_slice_positions,</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                      ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">selrfinv</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>,</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                      slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>);</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;ksinv-&gt;<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  }</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">return</span> time;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;} <span class="comment">/* ksinv_scan_irslice() */</span></div><div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acfeb30fb10069a6976a4111a03db0ce4"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acfeb30fb10069a6976a4111a03db0ce4">KSINV_SEQUENCE::selrfinv</a></div><div class="ttdeci">KS_SELRF selrfinv</div><div class="ttdef"><b>Definition:</b> KSInversion.e:100</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aca53dcf7a61b8beba82e8f9a0c768cb5"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aca53dcf7a61b8beba82e8f9a0c768cb5">KS_SELRF::sms_info</a></div><div class="ttdeci">KS_SMS_INFO sms_info</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1343</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSINV_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSInversion.e:98</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a1b26a538ab6e22362275d427f991a3e1"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a1b26a538ab6e22362275d427f991a3e1">KS_SMS_INFO::slice_gap</a></div><div class="ttdeci">float slice_gap</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1218</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a22f26aad1c923f8730b833487f07f6cb"><div class="ttname"><a href="_k_s_inversion_8e.html#a22f26aad1c923f8730b833487f07f6cb">Mphysical_inversion</a></div><div class="ttdeci">KS_MAT4x4 Mphysical_inversion</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1915</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ac7243c21c92994e98b1baf972465bde4"><div class="ttname"><a href="_k_s_inversion_8e.html#ac7243c21c92994e98b1baf972465bde4">ksinv_scan_seqstate</a></div><div class="ttdeci">STATUS ksinv_scan_seqstate(KSINV_SEQUENCE *ksinv, const SCAN_INFO *slice_info)</div><div class="ttdoc">Sets the current state of a KSINV_SEQUENCE during scanning</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2103</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:194</div></div>
<div class="ttc" id="struct_k_s___s_m_s___i_n_f_o_html_a58c64aa08739814113f9cd8a01b7f2e6"><div class="ttname"><a href="struct_k_s___s_m_s___i_n_f_o.html#a58c64aa08739814113f9cd8a01b7f2e6">KS_SMS_INFO::mb_factor</a></div><div class="ttdeci">int mb_factor</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1217</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1a51b640b1005f02c4475a1c5f673adb"><div class="ttname"><a href="_k_s_foundation_8h.html#a1a51b640b1005f02c4475a1c5f673adb">ks_scan_update_slice_location</a></div><div class="ttdeci">void ks_scan_update_slice_location(SCAN_INFO *new_loc, const SCAN_INFO orig_loc, const KS_MAT4x4 M_physical, const KS_MAT4x4 M_logical)</div><div class="ttdoc">Updates a SCAN_INFO struct using physical and logical 4x4 transformation matrices</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:927</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4b638972c4a790586ed8031327e85d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b638972c4a790586ed8031327e85d9">&#9670;&nbsp;</a></span>ksinv_scan_sliceloop_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_scan_sliceloop_nargs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                                                                      {</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a> slice_plan = <a class="code" href="_k_s_foundation_8h.html#a46bcd22394cbabe45e76cc0d4af01aa9">KS_INIT_SLICEPLAN</a>;</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  slice_plan.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a> = slperpass;</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  SCAN_INFO *slice_positions = NULL;</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0;</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a> = NULL;</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a> = NULL;</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a> = NULL;</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a> ksinv_loop_mode = <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>;</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  int (*play_coreslice)(<span class="keyword">const</span> SCAN_INFO *, int, int, <span class="keywordtype">void</span> **) = 0;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="keywordtype">int</span> core_nargs = 0;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordtype">void</span> **core_args = NULL;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 3) {</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) must contain 7 or 9 elements: slice_positions, passindx, &amp;ksinv1, &amp;ksinv2, &amp;ksinv_filltr, play_as_dummy, play_coreslice [, core_nargs, core_args]&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) cannot be NULL if nargs (2nd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;  }</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    slice_positions = (SCAN_INFO *) args[0];</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  }</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  }</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 3 &amp;&amp; args[2] != NULL) {</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a> = (<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *) args[2];</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  }</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 4 &amp;&amp; args[3] != NULL) {</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a> = (<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> *) args[3];</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  }</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 5 &amp;&amp; args[4] != NULL) {</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a> = (<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> *) args[4];</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  }</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 6 &amp;&amp; args[5] != NULL) {</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    ksinv_loop_mode = *((<a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a> *) args[5]);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 7 &amp;&amp; args[6] != NULL) {</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    play_coreslice = (int (*)(<span class="keyword">const</span> SCAN_INFO *, int, int, <span class="keywordtype">void</span> **)) args[6];</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;  }</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 8 &amp;&amp; args[7] != NULL) {</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;    core_nargs = *((<span class="keywordtype">int</span> *) args[7]);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  }</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 9 &amp;&amp; args[8] != NULL) {</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;    core_args = (<span class="keywordtype">void</span> **) args[8];</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  }</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(&amp;slice_plan, slice_positions, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, <a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, <a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, <a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>, ksinv_loop_mode, play_coreslice, core_nargs, core_args); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;} <span class="comment">/* ksfse_scan_sliceloop_nargs() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a46bcd22394cbabe45e76cc0d4af01aa9"><div class="ttname"><a href="_k_s_foundation_8h.html#a46bcd22394cbabe45e76cc0d4af01aa9">KS_INIT_SLICEPLAN</a></div><div class="ttdeci">#define KS_INIT_SLICEPLAN</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:166</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html">KS_SLICE_PLAN</a></div><div class="ttdoc">Struct holding all information about slice locations and aquisition order</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1199</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a></div><div class="ttdoc">typedef struct holding all information about the KSInversion sequence module incl. all gradients and waveforms</div><div class="ttdef"><b>Definition:</b> KSInversion.e:96</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a></div><div class="ttdoc">A multi-purpose controller struct for each sequence module to facilitate RF scaling, SAR calculations, sequence duration and sequence switching</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:980</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112">KSINV_LOOP_MODE</a></div><div class="ttdeci">KSINV_LOOP_MODE</div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab1a16f7634c6afebc34abe7a8942709f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1a16f7634c6afebc34abe7a8942709f">&#9670;&nbsp;</a></span>ksinv1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> ksinv1 = <a class="el" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5b459c9789d0941c6a2e6262e59579aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b459c9789d0941c6a2e6262e59579aa">&#9670;&nbsp;</a></span>ksinv2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html">KSINV_SEQUENCE</a> ksinv2 = <a class="el" href="_k_s_inversion_8e.html#a4be1d3680000349036dcb110c7ff1a6f">KSINV_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a43cba2a0a2557026231e05da863c15c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43cba2a0a2557026231e05da863c15c3">&#9670;&nbsp;</a></span>ksinv_filltr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html">KS_SEQ_CONTROL</a> ksinv_filltr = <a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a249adb4dd19303322658fb21bd50f0f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249adb4dd19303322658fb21bd50f0f6">&#9670;&nbsp;</a></span>ksinv1_ti</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv1_ti = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad16abf0f4ed621197332669743d97511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad16abf0f4ed621197332669743d97511">&#9670;&nbsp;</a></span>ksinv2_ti</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv2_ti = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a326f5619a82910c975cbe0dfdb80792a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326f5619a82910c975cbe0dfdb80792a">&#9670;&nbsp;</a></span>use_ir1_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int use_ir1_mode = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a595dd888c8c07d45eedcc25c826309f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595dd888c8c07d45eedcc25c826309f9">&#9670;&nbsp;</a></span>use_ir1_t1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int use_ir1_t1 = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a95165792103811810e882d2be1381f54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95165792103811810e882d2be1381f54">&#9670;&nbsp;</a></span>use_ir2_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int use_ir2_mode = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a81b4237583e689d003167994a8719a0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81b4237583e689d003167994a8719a0f">&#9670;&nbsp;</a></span>use_ir2_t1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int use_ir2_t1 = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6b12154153490ce7139f74b5ac1d9199"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b12154153490ce7139f74b5ac1d9199">&#9670;&nbsp;</a></span>ksinv1_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ksinv1_mode = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a71ab613a50aa4cb90eb4146fb06ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a71ab613a50aa4cb90eb4146fb06ca7">&#9670;&nbsp;</a></span>ksinv2_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ksinv2_mode = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a4b2616ed775246a12caf9b951eef55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4b2616ed775246a12caf9b951eef55">&#9670;&nbsp;</a></span>ksinv1_t1value</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ksinv1_t1value = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6579b086714c710ddbc06234b65778ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6579b086714c710ddbc06234b65778ef">&#9670;&nbsp;</a></span>ksinv2_t1value</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float* ksinv2_t1value = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8dd63530f860d975a0f760ad700a0ffd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dd63530f860d975a0f760ad700a0ffd">&#9670;&nbsp;</a></span>_ksinv1_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_cvfloat* _ksinv1_mode = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aefdb8236f7b0142a72e065761f38d77a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefdb8236f7b0142a72e065761f38d77a">&#9670;&nbsp;</a></span>_ksinv2_mode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_cvfloat* _ksinv2_mode = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abfc292edee1b0d4a4bb8dc26a5aaafb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfc292edee1b0d4a4bb8dc26a5aaafb0">&#9670;&nbsp;</a></span>_ksinv1_t1value</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_cvfloat* _ksinv1_t1value = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aefff0d8b1fa3576fd70d11c3c6531153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefff0d8b1fa3576fd70d11c3c6531153">&#9670;&nbsp;</a></span>_ksinv2_t1value</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_cvfloat* _ksinv2_t1value = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3b9ea6f30b5b38c45e32c084a7bac3c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b9ea6f30b5b38c45e32c084a7bac3c7">&#9670;&nbsp;</a></span>ksinv_ssi_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_ssi_time = <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a> with {10, 20000, <a class="el" href="_k_s_inversion_8e.html#a868e7ea1239820edb6d7279f65e384a6">KSINV_DEFAULT_SSITIME</a>, VIS, &quot;Time from eos to ssi in intern trig&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3ec411ca45ee9d7fd1497ad6bdec3621"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec411ca45ee9d7fd1497ad6bdec3621">&#9670;&nbsp;</a></span>ksinv_filltr_ssi_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_filltr_ssi_time = <a class="el" href="_k_s_inversion_8e.html#a6d747180202840f5e601225a98ef8e06">KSINV_FILLTR_SSITIME</a> with {10, 20000, <a class="el" href="_k_s_inversion_8e.html#a6d747180202840f5e601225a98ef8e06">KSINV_FILLTR_SSITIME</a>, VIS, &quot;Time from eos to ssi in intern trig&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aedcaff264fe0d9a3f5f21f798294df71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedcaff264fe0d9a3f5f21f798294df71">&#9670;&nbsp;</a></span>ksinv_mintr_t2flair</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_mintr_t2flair = <a class="el" href="_k_s_inversion_8e.html#af0c4be32a3787391c3c1239ae744a496">KSINV_MINTR_T2FLAIR</a> with {0, 30s, KSINV_MINTR_T2FLAIR, VIS, &quot;Min TR for T2-FLAIR&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acc139f545253464349e788315546ee0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc139f545253464349e788315546ee0a">&#9670;&nbsp;</a></span>ksinv_mintr_t1flair</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_mintr_t1flair = <a class="el" href="_k_s_inversion_8e.html#a674357090f00fc5dcfb92e6b734b3ba4">KSINV_MINTR_T1FLAIR</a> with {0, 30s, KSINV_MINTR_T1FLAIR, VIS, &quot;Min TR for T1-FLAIR&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab3fa4125b24bcc3e5d7f0ffacc32d86b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3fa4125b24bcc3e5d7f0ffacc32d86b">&#9670;&nbsp;</a></span>ksinv_maxtr_t1flair</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_maxtr_t1flair = <a class="el" href="_k_s_inversion_8e.html#a2968a3f8855256ed2cebfa2236f048af">KSINV_MAXTR_T1FLAIR</a> with {0, 30s, KSINV_MAXTR_T1FLAIR, VIS, &quot;Max TR for T1-FLAIR&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa7d86b129051574ab247567e218f4b62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d86b129051574ab247567e218f4b62">&#9670;&nbsp;</a></span>ksinv_slicecheck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_slicecheck = 0 with {0.0, 1.0, 0.0, VIS, &quot;move slice sel to x axis for slice thickness test&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a093e98e842e1dbeff8b101ba74e70162"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a093e98e842e1dbeff8b101ba74e70162">&#9670;&nbsp;</a></span>ksinv_approxti</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_approxti = 1 with {0, 1, 1, VIS, &quot;allow approx. TI for sliceahead IR mode&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a782452f0d134270a074410f806be776f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a782452f0d134270a074410f806be776f">&#9670;&nbsp;</a></span>ksinv_flip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksinv_flip = <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a> with {0, 360, <a class="el" href="_k_s_inversion_8e.html#a11b34b780eeeb61d87bf58432fe16c8d">KSINV_DEFAULT_FLIP</a>, VIS, &quot;RF flip angle [deg]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a407623c8b83da7fb46f7c2fb693f58e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407623c8b83da7fb46f7c2fb693f58e1">&#9670;&nbsp;</a></span>ksinv_slthickfact</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksinv_slthickfact = 1.0 with {0, <a class="el" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>, 1.0, VIS, &quot;Inversion sl.thick / <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> factor&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a09100e3070e07bd6ee68aeecffe09997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09100e3070e07bd6ee68aeecffe09997">&#9670;&nbsp;</a></span>ksinv_rfoffset</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_rfoffset = 0 with { -10000, 10000, 0, VIS, &quot;RF <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> freq offset [Hz]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad4386f491cf706c7d23222d2fc840e20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4386f491cf706c7d23222d2fc840e20">&#9670;&nbsp;</a></span>ksinv_rftype</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_rftype = <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a> with {<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, VIS, &quot;RF type (0:Std 1:Adiabatic)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8bf554ec251f326d2cf7e544803cac5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf554ec251f326d2cf7e544803cac5e">&#9670;&nbsp;</a></span>ksinv_spoilerarea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksinv_spoilerarea = <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a> with {0, 100000, <a class="el" href="_k_s_inversion_8e.html#ad2772d646804abafb1606b361f08b717">KSINV_DEFAULT_SPOILERAREA</a>, VIS, &quot;Spoiler area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a97d3d685e189f82e1e1b536694d64933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d3d685e189f82e1e1b536694d64933">&#9670;&nbsp;</a></span>ksinv_startpos</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_startpos = <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a> with {16, 10000, <a class="el" href="_k_s_inversion_8e.html#a53fdc2a27e8d7a5b81219a20f51e8a29">KSINV_DEFAULT_STARTPOS</a>, VIS, &quot;Start time of the first grad/RF inversion pulse in sequence module&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a54b20d97b03afcad597c99a023359575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54b20d97b03afcad597c99a023359575">&#9670;&nbsp;</a></span>ksinv_t2prep</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_t2prep = 0 with {0, 1, 0, VIS, &quot;Use T2 preperation instead of conventional Inversion&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a795a20d46908cabfe8bafd734cf6d749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795a20d46908cabfe8bafd734cf6d749">&#9670;&nbsp;</a></span>ksinv_t2prep_exc_flip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_t2prep_exc_flip = 90 with {0, 180, 90, VIS, &quot;Flip angle of the <a class="el" href="_g_e_required_8e.html#ad96345992234a045c9b3cdff8432f94c">excitation</a> pulse and the flip down/up pulse for T2 prep&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e43e12d3223d1ba27eaccc3657cb824"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e43e12d3223d1ba27eaccc3657cb824">&#9670;&nbsp;</a></span>ksinv_t2prep_N_Refoc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_t2prep_N_Refoc = 1 with {1, 16, 1, VIS, &quot;Number of refocusing pulses in the T2 inversion preperation&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0892225b7196bf0d726691746f6af87f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0892225b7196bf0d726691746f6af87f">&#9670;&nbsp;</a></span>ksinv_t2prep_TE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_t2prep_TE = 100ms with {30ms, 300ms, 100ms, VIS, &quot;TE for T2 inv preperation&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6a73ff5d0928aab9fa04bd8a8bac689c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a73ff5d0928aab9fa04bd8a8bac689c">&#9670;&nbsp;</a></span>ksinv_t2prep_rftype_refoc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksinv_t2prep_rftype_refoc = <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a> with {<a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea6dc95f89034a609f6b09631ab1a46eed">KSINV_RF_ADIABATIC</a>, <a class="el" href="_k_s_inversion_8e.html#a61dadd085c1777f559549e05962b2c9ea9adb681df1fc8010a362349f8476ae06">KSINV_RF_STD</a>, VIS, &quot;RF type (0:Std 1:Adiabatic)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a859527bdf4dc460bdf84895ad48fad8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a859527bdf4dc460bdf84895ad48fad8e">&#9670;&nbsp;</a></span>ksinv_slthickfact_exc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksinv_slthickfact_exc = 1.0 with {0, <a class="el" href="_k_s_inversion_8e.html#afc869a70acec39e5abf83e4ff3f2282c">KSINV_MAXTHICKFACT</a>, 1.0, VIS, &quot;Inversion sl.thick / <a class="el" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> factor&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a22f26aad1c923f8730b833487f07f6cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f26aad1c923f8730b833487f07f6cb">&#9670;&nbsp;</a></span>Mphysical_inversion</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_k_s_foundation_8h.html#a7b8e8b52358de55dd1fb64ef924b2f48">KS_MAT4x4</a> Mphysical_inversion = <a class="el" href="_k_s_foundation_8h.html#afdbaf673741ec0d6d5ebb7ab5974338e">KS_MAT4x4_IDENTITY</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_edd0b46848e1966a9ba471eaad9abcfd.html">tmpfiles</a></li><li class="navelem"><a class="el" href="_k_s_inversion_8e.html">KSInversion.e</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
