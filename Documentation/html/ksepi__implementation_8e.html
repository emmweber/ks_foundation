<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KSFoundation: ksepi_implementation.e File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="KarolinskaLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KSFoundation
   &#160;<span id="projectnumber">[Feb-2019]</span>
   </div>
   <div id="projectbrief">A platform for simpler EPIC programming on GE MR systems</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ksepi__implementation_8e.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ksepi_implementation.e File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;KSFoundation_KSRF.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html">KSEPI_SEQUENCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html">KSEPI_FLEET_SEQUENCE</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2c37888e07c63cfcb9d517e6591ad515"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a2c37888e07c63cfcb9d517e6591ad515">KSEPI_MINHNOVER</a>&#160;&#160;&#160;8 /* N.B. overscans below about 16-24 should be avoided for long TE */</td></tr>
<tr class="separator:a2c37888e07c63cfcb9d517e6591ad515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a391cb70899387075c448742de89ca842"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a391cb70899387075c448742de89ca842">KSEPI_MAXRBW_NORAMPSAMPLING</a>&#160;&#160;&#160;125.0</td></tr>
<tr class="separator:a391cb70899387075c448742de89ca842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca08017f8b225d0dd7ee962fb98a28c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aca08017f8b225d0dd7ee962fb98a28c6">KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:aca08017f8b225d0dd7ee962fb98a28c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19bef9c315a497fdd3f4d20169c61e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a>&#160;&#160;&#160;1500</td></tr>
<tr class="separator:af19bef9c315a497fdd3f4d20169c61e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578eb447ff3690e43479e538a846f917"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a578eb447ff3690e43479e538a846f917">MAXVAL_KSEPI_ONLINERECON</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a578eb447ff3690e43479e538a846f917"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ea596623c76f2ca9894fed2294c9e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a16ea596623c76f2ca9894fed2294c9e6">KSEPI_INIT_SEQUENCE1</a>&#160;&#160;&#160;<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a></td></tr>
<tr class="separator:a16ea596623c76f2ca9894fed2294c9e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d2af96eb8eb1b21f36191c8005e29bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a7d2af96eb8eb1b21f36191c8005e29bc">KSEPI_INIT_SEQUENCE2</a>&#160;&#160;&#160;<a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, NULL</td></tr>
<tr class="separator:a7d2af96eb8eb1b21f36191c8005e29bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe40fdda4cc00e3922639c5f3d1b467f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#abe40fdda4cc00e3922639c5f3d1b467f">KSEPI_INIT_SEQUENCE</a>&#160;&#160;&#160;{<a class="el" href="ksepi__implementation_8e.html#a16ea596623c76f2ca9894fed2294c9e6">KSEPI_INIT_SEQUENCE1</a>, <a class="el" href="ksepi__implementation_8e.html#a7d2af96eb8eb1b21f36191c8005e29bc">KSEPI_INIT_SEQUENCE2</a>};</td></tr>
<tr class="separator:abe40fdda4cc00e3922639c5f3d1b467f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a40d0f726eb492ddb3da875c838833e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a8a40d0f726eb492ddb3da875c838833e">KSEPI_FLEET_INIT_SEQUENCE</a>&#160;&#160;&#160;{<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>};</td></tr>
<tr class="separator:a8a40d0f726eb492ddb3da875c838833e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a87038548a580745904ee788ce7c61678"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678">KSEPI_MULTISHOT_MODE</a> { <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a>, 
<a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17">KSEPI_MULTISHOT_ALLVOLS</a>, 
<a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06">KSEPI_MULTISHOT_1STVOL</a>, 
<a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>
 }</td></tr>
<tr class="separator:a87038548a580745904ee788ce7c61678"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abf1aa3de0cb369aec3558b083a3f47d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#abf1aa3de0cb369aec3558b083a3f47d7">abstract</a> (&quot;EPI [KSFoundation]&quot;)</td></tr>
<tr class="separator:abf1aa3de0cb369aec3558b083a3f47d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a87c20cf9628122364241c6c1f8f87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a83a87c20cf9628122364241c6c1f8f87">psdname</a> (&quot;ksepi&quot;)</td></tr>
<tr class="separator:a83a87c20cf9628122364241c6c1f8f87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a205256f70ffcd95c6248717004c24ce1"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a205256f70ffcd95c6248717004c24ce1">ksepi_eval_flowcomp_phase</a> (<a class="el" href="struct_k_s___t_r_a_p.html">KS_TRAP</a> *fcphase, const <a class="el" href="struct_k_s___e_p_i.html">KS_EPI</a> *epi, <a class="el" href="_k_s_foundation_8h.html#a06d5868fa630d1c05faea3350dbf045c">KS_DESCRIPTION</a> desc)</td></tr>
<tr class="separator:a205256f70ffcd95c6248717004c24ce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba344d89a93331600d92e4a2de6de5b"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#adba344d89a93331600d92e4a2de6de5b">ksepi_pg</a> (int start_time)</td></tr>
<tr class="separator:adba344d89a93331600d92e4a2de6de5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc40649251f5ba32ef7a0bfb326ccbe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe">ksepi_scan_coreslice</a> (const SCAN_INFO *slice_pos, int dabslice, int shot)</td></tr>
<tr class="separator:afdc40649251f5ba32ef7a0bfb326ccbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf598c5557e77ede0f012ec0ca884b05"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a> (const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</td></tr>
<tr class="separator:aaf598c5557e77ede0f012ec0ca884b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7d23c7f6bba668c5b103a75d6072ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae">ksepi_scan_sliceloop</a> (int slperpass, int <a class="el" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, int shot)</td></tr>
<tr class="separator:a3b7d23c7f6bba668c5b103a75d6072ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a381d3301de972d4eeaba60451b1b179e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e">ksepi_scan_sliceloop_nargs</a> (int slperpass, int nargs, void **args)</td></tr>
<tr class="separator:a381d3301de972d4eeaba60451b1b179e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ace969d9c0db0a396cdb9c7478d498"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a> (SCAN_INFO slice_info, int shot)</td></tr>
<tr class="separator:a46ace969d9c0db0a396cdb9c7478d498"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24677d9b979b2618fe48a802a1a03e4d"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a24677d9b979b2618fe48a802a1a03e4d">ksepi_scan_acqloop</a> (int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, int <a class="el" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, int multishotflag)</td></tr>
<tr class="separator:a24677d9b979b2618fe48a802a1a03e4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a455eb376ed04673e40382a6ba8503888"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888">ksepi_scan_scanloop</a> ()</td></tr>
<tr class="separator:a455eb376ed04673e40382a6ba8503888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a194b50baa60802751c7deb22e966d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a0a194b50baa60802751c7deb22e966d8">ksepi_init_imagingoptions</a> (void)</td></tr>
<tr class="separator:a0a194b50baa60802751c7deb22e966d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66351df684e62e29938634fa21c75518"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a66351df684e62e29938634fa21c75518">ksepi_init_UI</a> (void)</td></tr>
<tr class="separator:a66351df684e62e29938634fa21c75518"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3924b871f6b8dc8eb70a6512c62e6946"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a3924b871f6b8dc8eb70a6512c62e6946">ksepi_eval_UI</a> ()</td></tr>
<tr class="separator:a3924b871f6b8dc8eb70a6512c62e6946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215d0bcbe326951a1ff9415e34bb6916"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a215d0bcbe326951a1ff9415e34bb6916">ksepi_eval_setuprf_3dexc</a> (<a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *selrfexc, int rf3Dopt)</td></tr>
<tr class="separator:a215d0bcbe326951a1ff9415e34bb6916"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56cdd966749fa80f8042934a7e7d4565"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a56cdd966749fa80f8042934a7e7d4565">ksepi_eval_setuprf</a> ()</td></tr>
<tr class="separator:a56cdd966749fa80f8042934a7e7d4565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ceed1499e08a606d3908355149c669c"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a3ceed1499e08a606d3908355149c669c">ksepi_eval_setupfleet</a> ()</td></tr>
<tr class="separator:a3ceed1499e08a606d3908355149c669c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d92158be6188de2ff69e0b7e933dc8d"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a0d92158be6188de2ff69e0b7e933dc8d">ksepi_eval_setupobjects</a> ()</td></tr>
<tr class="separator:a0d92158be6188de2ff69e0b7e933dc8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c4213d8911196f066f554bb7c056aa"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a98c4213d8911196f066f554bb7c056aa">ksepi_eval_TErange</a> ()</td></tr>
<tr class="separator:a98c4213d8911196f066f554bb7c056aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8296cd3d369a69713aca8c6a44a5c56"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ae8296cd3d369a69713aca8c6a44a5c56">ksepi_eval_inversion</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:ae8296cd3d369a69713aca8c6a44a5c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f68a0b1180fea87e5a74f8346d3633"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a10f68a0b1180fea87e5a74f8346d3633">ksepi_eval_tr</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a10f68a0b1180fea87e5a74f8346d3633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a431814566b7bf9aac5283fb6ca957618"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a431814566b7bf9aac5283fb6ca957618">ksepi_eval_ssitime</a> ()</td></tr>
<tr class="separator:a431814566b7bf9aac5283fb6ca957618"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6520db5905a45ee8b364f42bdae29439"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6520db5905a45ee8b364f42bdae29439">ksepi_eval_scantime</a> ()</td></tr>
<tr class="separator:a6520db5905a45ee8b364f42bdae29439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04763ba80917b87378fdc6477d17ad88"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a04763ba80917b87378fdc6477d17ad88">ksepi_check</a> ()</td></tr>
<tr class="separator:a04763ba80917b87378fdc6477d17ad88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450b724c17eac1a3eebb6419e2cdb373"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a450b724c17eac1a3eebb6419e2cdb373">ksepi_predownload_plot</a> (<a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *<a class="el" href="ksgre_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>)</td></tr>
<tr class="separator:a450b724c17eac1a3eebb6419e2cdb373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd5d2e01eb4dbfcd069e263311293ab"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6cd5d2e01eb4dbfcd069e263311293ab">ksepi_predownload_setrecon</a> ()</td></tr>
<tr class="separator:a6cd5d2e01eb4dbfcd069e263311293ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3ec3aeb88356adf77fa9a923db2a7d0"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ae3ec3aeb88356adf77fa9a923db2a7d0">ksepi_pg_fleet</a> (int start_time)</td></tr>
<tr class="separator:ae3ec3aeb88356adf77fa9a923db2a7d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab51b9deb2b1220a3d694ee476e98d0ca"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ab51b9deb2b1220a3d694ee476e98d0ca">ksepi_fleet_scan_seqstate</a> (const SCAN_INFO *slice_info, int shot)</td></tr>
<tr class="separator:ab51b9deb2b1220a3d694ee476e98d0ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa71cd6d202e8a45bfbd6234906521dba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aa71cd6d202e8a45bfbd6234906521dba">ksepi_scan_rf_off</a> ()</td></tr>
<tr class="separator:aa71cd6d202e8a45bfbd6234906521dba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc002fd30d20e3a0c9a81b2deea9793a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#acc002fd30d20e3a0c9a81b2deea9793a">ksepi_fleet_scan_coreslice</a> (const SCAN_INFO *slice_pos, int dabslice, int shot)</td></tr>
<tr class="separator:acc002fd30d20e3a0c9a81b2deea9793a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad200fa60ab5064ac49d0100071f3c285"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ad200fa60ab5064ac49d0100071f3c285">ksepi_fleet_scan_sliceloop</a> (int slperpass, int <a class="el" href="ksgre__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, int <a class="el" href="ksgre__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>)</td></tr>
<tr class="separator:ad200fa60ab5064ac49d0100071f3c285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d1beca6af57701b1bb8a9db9d575fc"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a26d1beca6af57701b1bb8a9db9d575fc">ksepi_scan_init</a> (void)</td></tr>
<tr class="separator:a26d1beca6af57701b1bb8a9db9d575fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf440ff4f370482c345bfb11d4af62c2"><td class="memItemLeft" align="right" valign="top">STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aaf440ff4f370482c345bfb11d4af62c2">ksepi_scan_prescanloop</a> (int nloops, int dda)</td></tr>
<tr class="separator:aaf440ff4f370482c345bfb11d4af62c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad59c67febb3e502669472ea5c7a0a9a2"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> = 0</td></tr>
<tr class="separator:ad59c67febb3e502669472ea5c7a0a9a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2153981cac63a088fccb065a037f4bf"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ac2153981cac63a088fccb065a037f4bf">ksepi_gscalerfexc</a> = 0.9 with {0.1, 3.0, 0.9, VIS, &quot;Excitation slice thk scaling (&lt; 1.0 thicker slice)&quot;,}</td></tr>
<tr class="separator:ac2153981cac63a088fccb065a037f4bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45df6340afc8c3cc4d6062f26acdcd32"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a> = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td></tr>
<tr class="separator:a45df6340afc8c3cc4d6062f26acdcd32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4c674d9d559aa8b6ed732fffddf4216"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ab4c674d9d559aa8b6ed732fffddf4216">ksepi_spoilerarea</a> = 3000.0 with {0.0, 10000.0, 3000.0, VIS, &quot;ksepi ksepi.spoiler gradient area&quot;,}</td></tr>
<tr class="separator:ab4c674d9d559aa8b6ed732fffddf4216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f9bbb676722cdb9706b2de6b28e24d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6f9bbb676722cdb9706b2de6b28e24d4">ksepi_rfspoiling</a> = 1 with {0, 1, 1, VIS, &quot;Enable RF spoiling 1:on 0:off&quot;,}</td></tr>
<tr class="separator:a6f9bbb676722cdb9706b2de6b28e24d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad2255b3c8f58fd69bb45e53ef978e0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#adad2255b3c8f58fd69bb45e53ef978e0">ksepi_fse90</a> = 0 with {0, 1, 0, VIS, &quot;Use FSE90 instead of SPSP for non-fatsat&quot;,}</td></tr>
<tr class="separator:adad2255b3c8f58fd69bb45e53ef978e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97c618e8b43b5e2bf69f22ec58808bea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a> = 0 with {0, 1, 0, VIS, &quot;Choose optimized SPSP pulse for 3D [0:OFF]&quot;,}</td></tr>
<tr class="separator:a97c618e8b43b5e2bf69f22ec58808bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7d0418e6cad024520674d7d4d0eb0ec"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aa7d0418e6cad024520674d7d4d0eb0ec">ksepi_kissoff_factor</a> = 0.04 with {0, 1, 0.04, VIS, &quot;Slice oversampling fraction on each side (3D)&quot;,}</td></tr>
<tr class="separator:aa7d0418e6cad024520674d7d4d0eb0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88b8a2d84931db5714dc80942c08842"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#af88b8a2d84931db5714dc80942c08842">ksepi_crusherscale</a> = 1.0 with { -20.0, 20.0, 1.0, VIS, &quot;scaling of crusher gradient area&quot;,}</td></tr>
<tr class="separator:af88b8a2d84931db5714dc80942c08842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8b8ac5372fc8e417349e8108d418a47"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aa8b8ac5372fc8e417349e8108d418a47">ksepi_gscalerfref</a> = 0.9 with {0.1, 3.0, 0.9, VIS, &quot;Refocusing slice thk scaling (&lt; 1.0 thicker slice)&quot;,}</td></tr>
<tr class="separator:aa8b8ac5372fc8e417349e8108d418a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa30bc912f81e467781febda7c6d3da03"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aa30bc912f81e467781febda7c6d3da03">ksepi_rampsampling</a> = 1 with {0, 1, 1, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:aa30bc912f81e467781febda7c6d3da03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ac65e8574291f8d9d274a7553bf15d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a17ac65e8574291f8d9d274a7553bf15d">ksepi_readlobegap</a> = 0 with {0, 10ms, 0, VIS, &quot;extra gap between readout lobes [us]&quot;,}</td></tr>
<tr class="separator:a17ac65e8574291f8d9d274a7553bf15d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28fc9daaf728790fd96bdabe1e81a077"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a28fc9daaf728790fd96bdabe1e81a077">ksepi_echogap</a> = 0 with {0, 100ms, 0, VIS, &quot;extra gap between EPI echoes [us]&quot;,}</td></tr>
<tr class="separator:a28fc9daaf728790fd96bdabe1e81a077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53d012b69c3259f46aed1ea3ea18fe71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a> = 1 with { -1.0, 1.0, 1.0, VIS, &quot;Readout polarity: +1/-1&quot;,}</td></tr>
<tr class="separator:a53d012b69c3259f46aed1ea3ea18fe71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a435623003ba36d56efab4de35e73b0fd"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a435623003ba36d56efab4de35e73b0fd">ksepi_readampmax</a> = 3.0 with {0.0, 5.0, 3.0, VIS, &quot;Max grad amp for EPI readout lobes&quot;,}</td></tr>
<tr class="separator:a435623003ba36d56efab4de35e73b0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1624564b9e609568cf9842fb02fe1e21"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a1624564b9e609568cf9842fb02fe1e21">ksepi_sr</a> = 0.01 with {0.0, , 0.01, VIS, &quot;EPI SR: amp/ramp [(G/cm) / us]&quot;,}</td></tr>
<tr class="separator:a1624564b9e609568cf9842fb02fe1e21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6489b25909a89dfeb427e0482429801"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ac6489b25909a89dfeb427e0482429801">ksepi_esp</a> = 0 with {0, 1000000, 0, VIS, &quot;View-only: Echo spacing in [us]&quot;,}</td></tr>
<tr class="separator:ac6489b25909a89dfeb427e0482429801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5c5180eb0689126316981a3ac4f6173"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a> = <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a> with {<a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a>, <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>, <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>, VIS, &quot;Blip polarity: +1/-1&quot;,}</td></tr>
<tr class="separator:af5c5180eb0689126316981a3ac4f6173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9039a6bee3815109e2532128e74fc201"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> = 1 with {0, 1, 1, VIS, &quot;Enable echo time shifting for multi shot&quot;,}</td></tr>
<tr class="separator:a9039a6bee3815109e2532128e74fc201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29bfef1205483936f24f54560f52b58b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a29bfef1205483936f24f54560f52b58b">ksepi_kynover</a> = 24 with {<a class="el" href="ksepi__implementation_8e.html#a2c37888e07c63cfcb9d517e6591ad515">KSEPI_MINHNOVER</a>, 512, 24, VIS, &quot;#extralines for MinTE&quot;,}</td></tr>
<tr class="separator:a29bfef1205483936f24f54560f52b58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258744bff37289b369a855aac21501fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a258744bff37289b369a855aac21501fc">ksepi_kznover</a> = 0 with {0, 512, 0, VIS, &quot;#extralines in kz&quot;,}</td></tr>
<tr class="separator:a258744bff37289b369a855aac21501fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab383faf358ba44a390fbe0b4c094a352"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a> = 1 with {1, 512, 1, VIS, &quot;Acceleration in ky&quot;,}</td></tr>
<tr class="separator:ab383faf358ba44a390fbe0b4c094a352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23e2186cee0d7569231661df9e65cf51"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a23e2186cee0d7569231661df9e65cf51">ksepi_kz_R</a> = 1 with {1, 512, 1, VIS, &quot;Acceleration in kz&quot;,}</td></tr>
<tr class="separator:a23e2186cee0d7569231661df9e65cf51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c46570eed7a4f4e2596939555729492"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a2c46570eed7a4f4e2596939555729492">ksepi_kz_nacslines</a> = 16 with {0, 512, 16, VIS, &quot;Number of acs lines in kz&quot;,}</td></tr>
<tr class="separator:a2c46570eed7a4f4e2596939555729492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af247a505cba1e5157a68ef7b1d69453c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a> = 0 with {0, 512, 0, VIS, &quot;CAIPIRINHA shift (affects 3D epi only. Set 0 for no CAIPI)&quot;,}</td></tr>
<tr class="separator:af247a505cba1e5157a68ef7b1d69453c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60d24c9932e42095ed00b0409d207f71"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a60d24c9932e42095ed00b0409d207f71">ksepi_fcy</a> = 1 with {0, 1, 0, VIS, &quot;Flowcomp Y when opfcomp&quot;}</td></tr>
<tr class="separator:a60d24c9932e42095ed00b0409d207f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa319748c312e4b8fad896f728e7e2b3f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aa319748c312e4b8fad896f728e7e2b3f">ksepi_fcz</a> = 1 with {0, 1, 0, VIS, &quot;Flowcomp Z when opfcomp&quot;}</td></tr>
<tr class="separator:aa319748c312e4b8fad896f728e7e2b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263548cf715f98526edee92b52818db2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> = 0 with {0, 1, 0, VIS, &quot;FLEET calibration volume [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a263548cf715f98526edee92b52818db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72e12979bfb35fc8b2f603dab67c6477"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a72e12979bfb35fc8b2f603dab67c6477">ksepi_fleet_flip</a> = 15.0 with {0.1, 90.0, 15.0, VIS, &quot;FLEET flip angle [deg]&quot;,}</td></tr>
<tr class="separator:a72e12979bfb35fc8b2f603dab67c6477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7881e8fdb59329abf98720583d8d10d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a7881e8fdb59329abf98720583d8d10d5">ksepi_fleet_dda</a> = 0 with {0, 200, 0, VIS, &quot;Dummies for FLEET module&quot;,}</td></tr>
<tr class="separator:a7881e8fdb59329abf98720583d8d10d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6482961dc4df2cb9fccfcdcc6fa122c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6482961dc4df2cb9fccfcdcc6fa122c8">ksepi_fleet_num_ky</a> = 36 with {1, 512, 36, VIS, &quot;Number of ky encodes for FLEET module&quot;,}</td></tr>
<tr class="separator:a6482961dc4df2cb9fccfcdcc6fa122c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4943b888caa1b27d937ce1a42a27fa2f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a4943b888caa1b27d937ce1a42a27fa2f">ksepi_fleet_num_kz</a> = 24 with {1, 512, 24, VIS, &quot;Number of kz encodes for FLEET module (3D only)&quot;,}</td></tr>
<tr class="separator:a4943b888caa1b27d937ce1a42a27fa2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06bff71c4e2fca6d2f5cbefe7c259b9a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> = 0 with {0, 96, 0, VIS, &quot;Number of phase reference lines per shot&quot;,}</td></tr>
<tr class="separator:a06bff71c4e2fca6d2f5cbefe7c259b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48246f40836694cfd04f40280dbe17f6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a48246f40836694cfd04f40280dbe17f6">ksepi_swi_returnmode</a> = 0 with {0, 7, 0, VIS, &quot;SWI recon 0:Off 1:Acq 2:SWI 4:SWIphase&quot;,}</td></tr>
<tr class="separator:a48246f40836694cfd04f40280dbe17f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3712faf06d98f7af864abc7bf75c2b92"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a3712faf06d98f7af864abc7bf75c2b92">ksepi_pos_start</a> = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, INVIS, &quot;us from start until the first waveform begins&quot;,}</td></tr>
<tr class="separator:a3712faf06d98f7af864abc7bf75c2b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b4f0e2685695c87449b232bdb4e8f28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a> = <a class="el" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a> with {32, , <a class="el" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td></tr>
<tr class="separator:a7b4f0e2685695c87449b232bdb4e8f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c440a9bfab319879423028559eef5b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> = 1 with {0, 200, 1, VIS, &quot;Number of dummy scans for steady state&quot;,}</td></tr>
<tr class="separator:a85c440a9bfab319879423028559eef5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf2f72331b4f7c43d173d0278eda229a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#acf2f72331b4f7c43d173d0278eda229a">ksepi_debug</a> = 1 with {0.0, 100, 1.0, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;}</td></tr>
<tr class="separator:acf2f72331b4f7c43d173d0278eda229a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ba61305798e6f6ba10cf186493afc2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a25ba61305798e6f6ba10cf186493afc2">ksepi_imsize</a> = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td></tr>
<tr class="separator:a25ba61305798e6f6ba10cf186493afc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebf2679820e5b9cfcdf0926db8188851"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aebf2679820e5b9cfcdf0926db8188851">ksepi_abort_on_kserror</a> = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:aebf2679820e5b9cfcdf0926db8188851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780ca0306bbc21c57cd8d676bd8bedab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> = 0 with {0, <a class="el" href="ksepi__implementation_8e.html#a578eb447ff3690e43479e538a846f917">MAXVAL_KSEPI_ONLINERECON</a>, 0, VIS, &quot;Online recon [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a780ca0306bbc21c57cd8d676bd8bedab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d0943acffeeec5fe3f57110b28f7ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a> = 1 with {0, 1, 1, VIS, &quot;Ghost correction [0:OFF 1:ON]&quot;,}</td></tr>
<tr class="separator:a92d0943acffeeec5fe3f57110b28f7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90b2e2cbe6240eaf74e184cb7fe1c9eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a90b2e2cbe6240eaf74e184cb7fe1c9eb">ksepi_ref_nsegments</a> = 1 with {1, 512, 1, VIS, &quot;Number of kz segments in reference volume&quot;,}</td></tr>
<tr class="separator:a90b2e2cbe6240eaf74e184cb7fe1c9eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea932f1fd0cfa98b2f37e829e67a8f8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a> = <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a> with {<a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a>, <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>, <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>, VIS, &quot;0:PI 1:All MulShot 2:1stMulShot 3:b0MulShot&quot;,}</td></tr>
<tr class="separator:a6ea932f1fd0cfa98b2f37e829e67a8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e29ab200ec2ec2c226ae859b2064ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a64e29ab200ec2ec2c226ae859b2064ec">ksepi_multivolpfile</a> = TRUE with {FALSE, TRUE, TRUE, VIS, &quot;Store all data in a single Pfile (pre DV26)&quot;,}</td></tr>
<tr class="separator:a64e29ab200ec2ec2c226ae859b2064ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db646d881a5c19c6d6cc7068cc947e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html">KSEPI_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a> = <a class="el" href="ksepi__implementation_8e.html#abe40fdda4cc00e3922639c5f3d1b467f">KSEPI_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a6db646d881a5c19c6d6cc7068cc947e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a749ea98d148d9e4eaa6275b321a9d39e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html">KSEPI_FLEET_SEQUENCE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a> = <a class="el" href="ksepi__implementation_8e.html#a8a40d0f726eb492ddb3da875c838833e">KSEPI_FLEET_INIT_SEQUENCE</a></td></tr>
<tr class="separator:a749ea98d148d9e4eaa6275b321a9d39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf3409789f0f63acd82728cba2387bb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a> = 0</td></tr>
<tr class="separator:a6cf3409789f0f63acd82728cba2387bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e661325433fb0f29283f44babb61221"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> = 0</td></tr>
<tr class="separator:a1e661325433fb0f29283f44babb61221"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca57a989e4881d731835c196cefcde7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> = 0</td></tr>
<tr class="separator:aca57a989e4881d731835c196cefcde7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f39fad60409167fe45164b72a131e0b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a> []</td></tr>
<tr class="separator:a8f39fad60409167fe45164b72a131e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7cdf91b5410cdc97ac4abd7fe17bb3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a> = 0</td></tr>
<tr class="separator:abd7cdf91b5410cdc97ac4abd7fe17bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains the implementation details for the <em>ksepi</em> psd. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2c37888e07c63cfcb9d517e6591ad515"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c37888e07c63cfcb9d517e6591ad515">&#9670;&nbsp;</a></span>KSEPI_MINHNOVER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_MINHNOVER&#160;&#160;&#160;8 /* N.B. overscans below about 16-24 should be avoided for long TE */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a391cb70899387075c448742de89ca842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a391cb70899387075c448742de89ca842">&#9670;&nbsp;</a></span>KSEPI_MAXRBW_NORAMPSAMPLING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_MAXRBW_NORAMPSAMPLING&#160;&#160;&#160;125.0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aca08017f8b225d0dd7ee962fb98a28c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca08017f8b225d0dd7ee962fb98a28c6">&#9670;&nbsp;</a></span>KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af19bef9c315a497fdd3f4d20169c61e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19bef9c315a497fdd3f4d20169c61e6">&#9670;&nbsp;</a></span>KSEPI_DEFAULT_SSI_TIME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_DEFAULT_SSI_TIME&#160;&#160;&#160;1500</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a578eb447ff3690e43479e538a846f917"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a578eb447ff3690e43479e538a846f917">&#9670;&nbsp;</a></span>MAXVAL_KSEPI_ONLINERECON</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXVAL_KSEPI_ONLINERECON&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16ea596623c76f2ca9894fed2294c9e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ea596623c76f2ca9894fed2294c9e6">&#9670;&nbsp;</a></span>KSEPI_INIT_SEQUENCE1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_INIT_SEQUENCE1&#160;&#160;&#160;<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7d2af96eb8eb1b21f36191c8005e29bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d2af96eb8eb1b21f36191c8005e29bc">&#9670;&nbsp;</a></span>KSEPI_INIT_SEQUENCE2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_INIT_SEQUENCE2&#160;&#160;&#160;<a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>, NULL</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abe40fdda4cc00e3922639c5f3d1b467f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe40fdda4cc00e3922639c5f3d1b467f">&#9670;&nbsp;</a></span>KSEPI_INIT_SEQUENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_INIT_SEQUENCE&#160;&#160;&#160;{<a class="el" href="ksepi__implementation_8e.html#a16ea596623c76f2ca9894fed2294c9e6">KSEPI_INIT_SEQUENCE1</a>, <a class="el" href="ksepi__implementation_8e.html#a7d2af96eb8eb1b21f36191c8005e29bc">KSEPI_INIT_SEQUENCE2</a>};</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a40d0f726eb492ddb3da875c838833e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a40d0f726eb492ddb3da875c838833e">&#9670;&nbsp;</a></span>KSEPI_FLEET_INIT_SEQUENCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define KSEPI_FLEET_INIT_SEQUENCE&#160;&#160;&#160;{<a class="el" href="_k_s_foundation_8h.html#a232cf810c71aebfeadc56a82f472a1ad">KS_INIT_SEQ_CONTROL</a>, <a class="el" href="_k_s_foundation_8h.html#a3e677786bcadd601f03988f59cc20549">KS_INIT_EPI</a>, <a class="el" href="_k_s_foundation_8h.html#a1ba17433713316fa65385237ebb0fb67">KS_INIT_TRAP</a>, <a class="el" href="_k_s_foundation_8h.html#a8d8030715d634067abc0732b5507ce14">KS_INIT_SELRF</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#aed050d8d7344db4d7ae33ba974855b8a">KS_INIT_WAIT</a>, <a class="el" href="_k_s_foundation_8h.html#a9cf630986b9344177e80b7d9644bfb81">KS_INIT_PHASEENCODING_PLAN</a>};</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a87038548a580745904ee788ce7c61678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87038548a580745904ee788ce7c61678">&#9670;&nbsp;</a></span>KSEPI_MULTISHOT_MODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678">KSEPI_MULTISHOT_MODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Enums to switch between multishot vs. parallel imaging modes</h4>
</p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd"></a>KSEPI_MULTISHOT_OFF&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17"></a>KSEPI_MULTISHOT_ALLVOLS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06"></a>KSEPI_MULTISHOT_1STVOL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e"></a>KSEPI_MULTISHOT_B0VOLS&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;             {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a>, <span class="comment">/* 0 */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17">KSEPI_MULTISHOT_ALLVOLS</a>, <span class="comment">/* 1 */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06">KSEPI_MULTISHOT_1STVOL</a>, <span class="comment">/* 2 */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>, <span class="comment">/* 3 */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;} <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678">KSEPI_MULTISHOT_MODE</a>;</div><div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17">KSEPI_MULTISHOT_ALLVOLS</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:95</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:97</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:94</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678">KSEPI_MULTISHOT_MODE</a></div><div class="ttdeci">KSEPI_MULTISHOT_MODE</div><div class="ttdoc">Enums to switch between multishot vs. parallel imaging modes</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:93</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06">KSEPI_MULTISHOT_1STVOL</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:96</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abf1aa3de0cb369aec3558b083a3f47d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf1aa3de0cb369aec3558b083a3f47d7">&#9670;&nbsp;</a></span>abstract()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">abstract </td>
          <td>(</td>
          <td class="paramtype">&quot;EPI &quot;&#160;</td>
          <td class="paramname">[KSFoundation]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a83a87c20cf9628122364241c6c1f8f87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a87c20cf9628122364241c6c1f8f87">&#9670;&nbsp;</a></span>psdname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">psdname </td>
          <td>(</td>
          <td class="paramtype">&quot;ksepi&quot;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a205256f70ffcd95c6248717004c24ce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a205256f70ffcd95c6248717004c24ce1">&#9670;&nbsp;</a></span>ksepi_eval_flowcomp_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_flowcomp_phase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___t_r_a_p.html">KS_TRAP</a> *&#160;</td>
          <td class="paramname"><em>fcphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_k_s___e_p_i.html">KS_EPI</a> *&#160;</td>
          <td class="paramname"><em>epi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_k_s_foundation_8h.html#a06d5868fa630d1c05faea3350dbf045c">KS_DESCRIPTION</a>&#160;</td>
          <td class="paramname"><em>desc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                                                                                           {</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="comment">/* set time origin at end of bipolar flow comp lobe/beginning of epi.blipphaser */</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordtype">float</span> dummy1 = 0.0;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="keywordtype">float</span> dummy2 = 0.0;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordtype">float</span> zeromomentsum = 0.0;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordtype">float</span> firstmomentsum = 0.0;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="keywordtype">int</span> pulsepos = 0;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  <span class="keywordtype">int</span> invertphase = 0;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordtype">int</span> pulsecnt;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="keywordtype">int</span> epiesp = 0;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  </div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  epiesp = (epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a035bb76f8cc944eff7afd9333c2688e3">read_spacing</a>);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">/* compute moments for blips */</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  pulsepos = epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + epiesp - epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> / 2;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  </div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <span class="keywordtype">int</span> blips2cent = ((epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> != 0) ? (epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> / epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>) : (epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> / 2)) - 1;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">for</span> (pulsecnt = 0; pulsecnt &lt; blips2cent; pulsecnt++) {</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="comment">/* N.B.: pulsepos is updated in rampmoments() */</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    rampmoments(0.0,           epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">amp</a>, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>,    invertphase, &amp;pulsepos, &amp;dummy1, &amp;dummy2, &amp;zeromomentsum, &amp;firstmomentsum);</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    rampmoments(epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">amp</a>, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">amp</a>, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">plateautime</a>, invertphase, &amp;pulsepos, &amp;dummy1, &amp;dummy2, &amp;zeromomentsum, &amp;firstmomentsum);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    rampmoments(epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">amp</a>, 0.0,           epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>,    invertphase, &amp;pulsepos, &amp;dummy1, &amp;dummy2, &amp;zeromomentsum, &amp;firstmomentsum);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    pulsepos += (epiesp - epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">blip</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(fcphase);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="keywordflow">if</span> (zeromomentsum != 0 &amp;&amp; firstmomentsum != 0) {</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="keywordtype">int</span> fcramp, fcplateau, dummy;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordtype">float</span> fcamp;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    amppwygmn(zeromomentsum, firstmomentsum, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">plateautime</a>, epi-&gt;<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>, </div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;              0.0, 0.0, (<span class="keywordtype">double</span>) <a class="code" href="_k_s_foundation_8h.html#a5c919c547ee396b18069ed505c695139">ks_syslimits_ampmax</a>(<a class="code" href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a>), (<span class="keywordtype">double</span>) <a class="code" href="_k_s_foundation_8h.html#a72446af13d4f4cd0dc9caf51bd58f88e">ks_syslimits_ramptimemax</a>(<a class="code" href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a>), 0, </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;              &amp;fcramp, &amp;fcplateau, &amp;dummy, &amp;fcamp);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">amp</a> = fcamp;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> = fcramp;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">plateautime</a> = fcplateau;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = 2 * fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">plateautime</a>;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> * ((float) fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">plateautime</a>);</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    sprintf(fcphase-&gt;<a class="code" href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, desc);</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;} <span class="comment">/* ksepi_eval_flowcomp() */</span></div><div class="ttc" id="struct_k_s___e_p_i_html_aaa0021ab8174eb7806de89d599769a9b"><div class="ttname"><a href="struct_k_s___e_p_i.html#aaa0021ab8174eb7806de89d599769a9b">KS_EPI::blip</a></div><div class="ttdeci">KS_TRAP blip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1687</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a878bb367b07dc7dfb5fef5728d2e5b1d"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a878bb367b07dc7dfb5fef5728d2e5b1d">KS_TRAP::plateautime</a></div><div class="ttdeci">int plateautime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:436</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5c919c547ee396b18069ed505c695139"><div class="ttname"><a href="_k_s_foundation_8h.html#a5c919c547ee396b18069ed505c695139">ks_syslimits_ampmax</a></div><div class="ttdeci">float ks_syslimits_ampmax(LOG_GRAD loggrd)</div><div class="ttdoc">Returns the maximum gradient amplitude that can be used on all gradient boards simultaneously</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:163</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a72446af13d4f4cd0dc9caf51bd58f88e"><div class="ttname"><a href="_k_s_foundation_8h.html#a72446af13d4f4cd0dc9caf51bd58f88e">ks_syslimits_ramptimemax</a></div><div class="ttdeci">int ks_syslimits_ramptimemax(LOG_GRAD loggrd)</div><div class="ttdoc">Returns the minimum ramp time to get from zero to full gradient scale</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:190</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_EPI::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1690</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a8efdbce2fbb4bf21a6fd8983fdd6d5c7"><div class="ttname"><a href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a></div><div class="ttdeci">void ks_init_trap(KS_TRAP *trap)</div><div class="ttdoc">Resets a KS_TRAP sequence object to its default value (KS_INIT_TRAP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:45</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a4bd8f92bd97315429605430e234dceb4"><div class="ttname"><a href="_k_s_foundation_8h.html#a4bd8f92bd97315429605430e234dceb4">loggrd</a></div><div class="ttdeci">LOG_GRAD loggrd</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">KS_EPI::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1685</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ab508ded41392ee86a2a619d3e93d2373"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ab508ded41392ee86a2a619d3e93d2373">KS_TRAP::amp</a></div><div class="ttdeci">float amp</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:433</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">KS_PHASER::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1528</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a1c544bec41003a594ba4ec7d43a3a470">KS_TRAP::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:432</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a035bb76f8cc944eff7afd9333c2688e3"><div class="ttname"><a href="struct_k_s___e_p_i.html#a035bb76f8cc944eff7afd9333c2688e3">KS_EPI::read_spacing</a></div><div class="ttdeci">int read_spacing</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1691</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adba344d89a93331600d92e4a2de6de5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adba344d89a93331600d92e4a2de6de5b">&#9670;&nbsp;</a></span>ksepi_pg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_pg </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The ksepi (main) pulse sequence</h4>
</p>
<p>This is the main pulse sequence in <a class="el" href="ksepi_8e.html" title="This file contains the overall structure for the ksepi psd. ">ksepi.e</a> using the sequence objects in <a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksepi sequence">KSEPI_SEQUENCE</a> with the sequence module name "ksepimain" (= ksepi.seqctrl.description)</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                                {</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <a class="code" href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a> tmploc = <a class="code" href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a>;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  <span class="keywordtype">int</span> epi_startpos = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;  <span class="keywordtype">int</span> fc_startpos = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;  <span class="keywordtype">int</span> fcz_endpos = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="keywordtype">int</span> echo, board;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="keywordflow">if</span> (start_time &lt; <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>) {</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st arg (pos start) must be at least %d us&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">if</span> (opte &lt; avminte) {</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">/* we cannot proceed until TE is in range.</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">       Return a long seq duration and pretend all is good */</span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1s);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  }</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(start_time + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="comment">/* N.B.: ks_pg_selrf()-&gt;ks_pg_rf() detects that ksepi.selrfexc is an excitation pulse</span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="comment">     (ksepi.selrfexc.rf.role = KS_RF_ROLE_EXC) and will also set ksepi.seqctrl.momentstart</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">     to the absolute position in [us] of the isocenter of the RF excitation pulse */</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="comment">/* forward to end of selrfexc.postgrad (works for when slice sel gradient is KS_TRAP or KS_WAVE as only</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment">     one of them can have non-zero duration at a given time) */</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>.<a class="code" href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  </div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;  <span class="comment">/* Second flow comp gradient slice for slice excitation */</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* N.B.: will return quietly if ksepi.fcompslice.duration = 0 (opfcomp = 0) */</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  fcz_endpos = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;<span class="comment">  *  EPI phase reference lines</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1">KS_FREQX_PHASEY</a>;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = <a class="code" href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a>;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a804f4f4b870338386e1dea3a877f5bd2">ks_pg_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment">  *  EPI trains: Begin   (&gt; 1 only supported with offline recon)</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment">  -------------------------------------------------------------------------------------------------------*/</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <span class="keywordflow">for</span> (echo = 0; echo &lt; opnecho; echo++) {</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">if</span> (acq_type == TYPSPIN) {</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;      <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; echo == 0) {</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation__diffusion_8e.html#a4820b77571218e7b1869d24ad491186a">ksepi_diffusion_pg</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>, opte) == FAILURE)</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <span class="keywordflow">if</span> (echo == 0) <span class="comment">/* RF refocusing pulse for 1st EPI train at TE/2 */</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;          tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + opte / 2 - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a> - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <span class="keywordflow">else</span> <span class="comment">/* RF refocusing pulse between two EPI trains (2nd-Nth EPI train are played out as tight as possible when ksepi_echogap = 0). Use epi_startpos from previous echo index (see below) */</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;          tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = epi_startpos + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> + <a class="code" href="ksepi__implementation_8e.html#a28fc9daaf728790fd96bdabe1e81a077">ksepi_echogap</a> / 2;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;          <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      }</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    } <span class="comment">/* acq_type == TYPSPIN */</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="comment">    *  EPI readout including de/rephasers on freq, phase and slice encoding axes (net zero moment on both axes)</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = (<a class="code" href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a>) ? <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93">KS_FREQZ_PHASEY</a> : <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1">KS_FREQX_PHASEY</a>;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    epi_startpos = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a> + opte - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> + (echo * <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a>);</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = epi_startpos;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = <a class="code" href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a>;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a804f4f4b870338386e1dea3a877f5bd2">ks_pg_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="comment">/* Two extra dephasers for flowcomp on phase */</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = epi_startpos + IMax(3, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">readphaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>); <span class="comment">/* after all dephasers */</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> -= <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + 2 * <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    fc_startpos = tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance #0. N.B.: will return quietly if ksepi.fcompphase.duration = 0 */</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = -1;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) <span class="comment">/* instance #1 */</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">    *  EPI echo time shifting</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">    *******************************************************************************************************/</span></div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE &amp;&amp; echo == 0) {</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      <span class="keywordflow">for</span> (board = XGRAD; board &lt;= SSP; board++) {</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = board;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;        <span class="keywordflow">if</span> (oppseq == PSD_SE) {</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;          <span class="comment">/* 2D: SE-EPI or DW-EPI */</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;           tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = epi_startpos - GRAD_UPDATE_TIME;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;          <span class="comment">/* 2D/3D: GE-EPI</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">           For XGRAD and YGRAD, place wait pulse just before dephasers (incl flowcomp if present), the smallest of epi_startpos and fc_startpos</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">           For the other boards, place wait pulse after last slice rephaser (incl slice flowcomp if present) */</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;           tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = (board &lt;= YGRAD) ? (IMin(2, epi_startpos, fc_startpos) - GRAD_UPDATE_TIME) : (fcz_endpos + GRAD_UPDATE_TIME + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a>);</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        }</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) != SUCCESS) {</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;          <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        }</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;      }</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    }</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  }</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="comment">/*------------------------------------------------------------------------------------------------------</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">   *  EPI trains: End</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">   *  Gradient spoilers on Y and Z (at the same time)</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = epi_startpos + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">  *  EPI echo time shifting (post EPI readouts)</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += GRAD_UPDATE_TIME;</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129">KS_ALL</a>;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) != SUCCESS) {</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    }</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += IMax(2, <a class="code" href="_k_s_foundation__common_8c.html#aa4225c3edfbcb8e85d91fc491a495058">psd_grd_wait</a>, <a class="code" href="_k_s_foundation__common_8c.html#a636634b6eb50758af3826332f9180e9b">psd_rf_wait</a>) + GRAD_UPDATE_TIME;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a>;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;  }</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;<span class="comment">   *  Set the minimal sequence duration (ksepi.seqctrl.min_duration) by calling</span></div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="comment">   *  ks_eval_seqctrl_setminduration()</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;  <span class="comment">/* make sure we are divisible by GRAD_UPDATE_TIME (4us) */</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="comment">/* On HOST only: Sequence duration (ksepi.seqctrl.ssi_time must be &gt; 0 and is added to ksepi.seqctrl.min_duration in ks_eval_seqctrl_setminduration() */</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="ksepi__implementation_8e.html#a431814566b7bf9aac5283fb6ca957618">ksepi_eval_ssitime</a>();</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>); <span class="comment">/* tmploc.pos now corresponds to the end of last gradient in the sequence */</span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;<span class="comment">   * Phase encoding table</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;<span class="comment">   * Need to call this in ksepi_pg() so it is run both on HOST and TGT. This, since the phase table</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">   * is dynamically allocated in ks_phaseencoding_generate_epi()-&gt;ks_phaseencoding_resize()</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">full_peplan</a>, <span class="stringliteral">&quot;Fully sampled EPI volume&quot;</span>,</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                                      &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, </div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a>, </div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>, </div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>, </div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a>) == FAILURE) {</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  }</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">ref_peplan</a>, <span class="stringliteral">&quot;EPI reference volume&quot;</span>,</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                                      &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, </div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a>, </div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>, </div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a90b2e2cbe6240eaf74e184cb7fe1c9eb">ksepi_ref_nsegments</a>,</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a>) == FAILURE) {</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  }</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, <span class="stringliteral">&quot;Accelerated EPI volume&quot;</span>,</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                                      &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>,</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a>, </div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> / <a class="code" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a>,</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>,</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                                      <a class="code" href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a>) == FAILURE) {</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;  }</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a> = &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">full_peplan</a>;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  <span class="comment">/* KS_NOTSET -&gt; turns off phase blips for phase reference lines */</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, 0, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, 0);</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  <span class="comment">/* set EPI dephasers and blips to the first shot so we get the correct plots in WTools */</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, 0, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">full_peplan</a>, 0, 0);</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;} <span class="comment">/* ksepi_pg() */</span></div><div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6915a63ab744ee4957ab235a2f214ca7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">KSEPI_SEQUENCE::ref_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN ref_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:68</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1">KS_FREQX_PHASEY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0d83cf730d82612a87abc0f024bea336"><div class="ttname"><a href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a></div><div class="ttdeci">void ks_scan_epi_shotcontrol(KS_EPI *epi, int echo, SCAN_INFO sliceinfo, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot, float rcvphase)</div><div class="ttdoc">Changes the gradient state of a KS_EPI object for the given slice information</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1088</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af63cac5b01cd2842a511f6e8e99472e9"><div class="ttname"><a href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a></div><div class="ttdeci">STATUS ks_phaseencoding_generate_epi(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, const char *const desc, KS_EPI *epitrain, int blipsign, int numkyshots, int numsegments, int caipi)</div><div class="ttdoc">EPI: Makes a KS_PHASEENCODING_PLAN suitable for 2D or 3D epi</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:771</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af5c5180eb0689126316981a3ac4f6173"><div class="ttname"><a href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a></div><div class="ttdeci">int ksepi_blipsign</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:140</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">KS_SEQLOC::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:242</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:69</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ac6c0c1a7ad7a6b0ab69d5aedc27c36c7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">KSEPI_SEQUENCE::fcompphase</a></div><div class="ttdeci">KS_TRAP fcompphase</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:65</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a09b1a7dc77a7cf8c4e8421a23608a42a"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">KS_PHASER::numlinestoacq</a></div><div class="ttdeci">int numlinestoacq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1532</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6e727c3449c63278cbfc2e35cfcfa9fa"><div class="ttname"><a href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a></div><div class="ttdeci">STATUS ks_pg_selrf(KS_SELRF *selrf, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_SELRF sequence object on a gradient (and RF) board at some position in the pulse sequence...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1954</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af03615e60a63da6332e04a37aa801984"><div class="ttname"><a href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a></div><div class="ttdeci">STATUS ks_pg_wait(KS_WAIT *wait, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_WAIT sequence object on all boards at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2038</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a2e3f5254967cadb9a41167c6fbf6743e"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">KS_SEQLOC::board</a></div><div class="ttdeci">int board</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:241</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ad76a5ac226f0d25f70349ef83b5bc38a"><div class="ttname"><a href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">KS_EPI::zphaser</a></div><div class="ttdeci">KS_PHASER zphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1689</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93">KS_FREQZ_PHASEY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a606fbf556e8a297aa1f68b098f6ac2a2"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">KS_SEQLOC::ampscale</a></div><div class="ttdeci">float ampscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:243</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129">KS_ALL</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_EPI::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1692</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_a4820b77571218e7b1869d24ad491186a"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#a4820b77571218e7b1869d24ad491186a">ksepi_diffusion_pg</a></div><div class="ttdeci">STATUS ksepi_diffusion_pg(KSEPI_SEQUENCE *ksepi, int TE)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:740</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aba7bb21f100b12eda8151516fcb12461"><div class="ttname"><a href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a></div><div class="ttdeci">#define KS_RFSSP_POSTTIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:85</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6cf3409789f0f63acd82728cba2387bb"><div class="ttname"><a href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a></div><div class="ttdeci">int ksepi_interechotime</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:210</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ab383faf358ba44a390fbe0b4c094a352"><div class="ttname"><a href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a></div><div class="ttdeci">int ksepi_ky_R</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:144</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSEPI_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:66</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a804f4f4b870338386e1dea3a877f5bd2"><div class="ttname"><a href="_k_s_foundation_8h.html#a804f4f4b870338386e1dea3a877f5bd2">ks_pg_epi</a></div><div class="ttdeci">STATUS ks_pg_epi(KS_EPI *epi, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places out a KS_EPI object (EPI train including dephaser and rephaser gradients)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2455</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a45df6340afc8c3cc4d6062f26acdcd32"><div class="ttname"><a href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a></div><div class="ttdeci">int ksepi_slicecheck</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:114</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a28fc9daaf728790fd96bdabe1e81a077"><div class="ttname"><a href="ksepi__implementation_8e.html#a28fc9daaf728790fd96bdabe1e81a077">ksepi_echogap</a></div><div class="ttdeci">int ksepi_echogap</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:131</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a431814566b7bf9aac5283fb6ca957618"><div class="ttname"><a href="ksepi__implementation_8e.html#a431814566b7bf9aac5283fb6ca957618">ksepi_eval_ssitime</a></div><div class="ttdeci">int ksepi_eval_ssitime()</div><div class="ttdoc">The SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:1646</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a61651c54c4dfd4388fc939d804a9964b"><div class="ttname"><a href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a></div><div class="ttdeci">STATUS ks_pg_trap(KS_TRAP *trap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_TRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1212</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a></div><div class="ttdoc">typedef struct used as argument to ks_pg_*** functions to control where and when to place a sequence ...</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:240</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a53d012b69c3259f46aed1ea3ea18fe71"><div class="ttname"><a href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a></div><div class="ttdeci">int ksepi_readsign</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:132</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a43822646b479e4668a9076be0bb0612d"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">KSEPI_SEQUENCE::full_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN full_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:67</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a75c403072633f5a42fe364af4454b245"><div class="ttname"><a href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a></div><div class="ttdeci">STATUS ks_eval_seqctrl_setminduration(KS_SEQ_CONTROL *seqctrl, int mindur)</div><div class="ttdoc">Sets the minimum duration and duration fields of a KS_SEQ_CONTROL struct based on some minimum time (...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2925</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:57</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_EPI::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1693</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a34cf340f218f2155b3a9d357d8eda31c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">KSEPI_SEQUENCE::current_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN * current_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:70</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_abc81c5867684b6e31b65459ec9431269"><div class="ttname"><a href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">KS_EPI::readphaser</a></div><div class="ttdeci">KS_TRAP readphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1686</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_aa4225c3edfbcb8e85d91fc491a495058"><div class="ttname"><a href="_k_s_foundation__common_8c.html#aa4225c3edfbcb8e85d91fc491a495058">psd_grd_wait</a></div><div class="ttdeci">int psd_grd_wait</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a90b2e2cbe6240eaf74e184cb7fe1c9eb"><div class="ttname"><a href="ksepi__implementation_8e.html#a90b2e2cbe6240eaf74e184cb7fe1c9eb">ksepi_ref_nsegments</a></div><div class="ttdeci">int ksepi_ref_nsegments</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:185</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af247a505cba1e5157a68ef7b1d69453c"><div class="ttname"><a href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a></div><div class="ttdeci">int ksepi_caipi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:147</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad01dd4f06fe226a502e872d4173ba7ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a></div><div class="ttdeci">#define KS_INIT_SEQLOC</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:128</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a636634b6eb50758af3826332f9180e9b"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a636634b6eb50758af3826332f9180e9b">psd_rf_wait</a></div><div class="ttdeci">int psd_rf_wait</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:63</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="struct_k_s___w_a_v_e_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___w_a_v_e.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_WAVE::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:518</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:64</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc40649251f5ba32ef7a0bfb326ccbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc40649251f5ba32ef7a0bfb326ccbe">&#9670;&nbsp;</a></span>ksepi_scan_coreslice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_scan_coreslice </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out one slice in real time during scanning together with other active sequence modules</h4>
</p>
<p>On TGT on the MR system (PSD_HW), this function sets up (<a class="el" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498" title="Sets the current state of all ksepi sequence objects being part of KSEPI_SEQUENCE">ksepi_scan_seqstate()</a>) and plays out the core ksepi sequence with optional sequence modules also called in this function. The low-level function call <code><a class="el" href="_k_s_foundation__tgt_8c.html#a7a93838e7d53ff7ec9fbe98843181d03">startseq()</a></code>, which actually starts the realtime sequence playout is called from within <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, which in addition also returns the time to play out that sequence module (see time += ...).</p>
<p>On HOST (in <a class="el" href="ksepi__implementation_8e.html#a10f68a0b1180fea87e5a74f8346d3633" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksepi_eval_tr()</a>) we call <a class="el" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e" title="Wrapper function to ksepi_scan_sliceloop() with standardized input arguments">ksepi_scan_sliceloop_nargs()</a>, which in turn calls this function that returns the total time in [us] taken to play out this core slice. These times are increasing in each parent function until ultimately ksepi_scan_scantime(), which returns the total time of the entire scan.</p>
<p>After each call to <a class="el" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence()</a>, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> is called to add slice-timing information on file for later PDF-generation of the sequence. As scanning is performed in real-time and may fail if interrupted, <a class="el" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime()</a> will return quietly if it detects both IPG (TGT) and PSD_HW (on the MR scanner). See <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> for the PNG/PDF generation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Position of the slice to be played out (one element in the global <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td>Linear ky kz <code>shot</code> index in range <code>[0, (ksepi.peplan.num_shots-1)]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                                                                               {</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordtype">int</span> echo;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keywordtype">float</span> tloc = 0.0;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  SCAN_INFO slice_pos_updated;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a7b8e8b52358de55dd1fb64ef924b2f48">KS_MAT4x4</a> Mphysical = <a class="code" href="_k_s_foundation_8h.html#afdbaf673741ec0d6d5ebb7ab5974338e">KS_MAT4x4_IDENTITY</a>;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  <span class="keyword">const</span> <a class="code" href="_k_s_foundation_8h.html#a7b8e8b52358de55dd1fb64ef924b2f48">KS_MAT4x4</a> Identity = <a class="code" href="_k_s_foundation_8h.html#afdbaf673741ec0d6d5ebb7ab5974338e">KS_MAT4x4_IDENTITY</a>;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL)</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    tloc = slice_pos-&gt;optloc;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="comment">  * Update slice info</span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL) {</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a1a51b640b1005f02c4475a1c5f673adb">ks_scan_update_slice_location</a>(&amp;slice_pos_updated, *slice_pos, Mphysical, Identity);</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  }</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">  * SpSat sequence module</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  time += <a class="code" href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a>(<a class="code" href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a>);</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">  * Chemsat sequence module</span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>);</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a>.<a class="code" href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>); <span class="comment">/* no slice location for fat sat */</span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">  * ksepi main sequence module</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL) {</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="comment">/* modify sequence for next playout. If not entry point scan (e.g. L_REF), use no ky phase encodes */</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a>(slice_pos_updated, (<a class="code" href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a> == L_SCAN) ? shot : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="comment">/* false slice, shut off RF */</span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#aa71cd6d202e8a45bfbd6234906521dba">ksepi_scan_rf_off</a>();</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;  }</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;  <span class="comment">/* data routing control */</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, 0, shot); <span class="comment">/* coord to first line of EPI train */</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[1].optloc &gt; <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0].optloc)</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      dabslice = (opslquant * opvquant - 1) - coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;      dabslice = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  }</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;  <span class="keywordflow">for</span> (echo = 0; echo &lt; opnecho; echo++) {</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, echo, echo, dabslice, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, shot);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  }</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; 0) {</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="comment">/* store phase reference lines as opnecho:th echo */</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, 0, opnecho, dabslice, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, shot);</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  }</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, &amp;tloc, <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>);</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;} <span class="comment">/* ksepi_scan_coreslice() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_g_e_required_8e_html_aece7287cee904292d20da04682670ccc"><div class="ttname"><a href="_g_e_required_8e.html#aece7287cee904292d20da04682670ccc">ks_perform_slicetimeplot</a></div><div class="ttdeci">int ks_perform_slicetimeplot</div><div class="ttdef"><b>Definition:</b> GERequired.e:219</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a7b8e8b52358de55dd1fb64ef924b2f48"><div class="ttname"><a href="_k_s_foundation_8h.html#a7b8e8b52358de55dd1fb64ef924b2f48">KS_MAT4x4</a></div><div class="ttdeci">double KS_MAT4x4[16]</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:182</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a27b64905234db826096802c5a1f5bd6e"><div class="ttname"><a href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a></div><div class="ttdeci">void ks_scan_epi_loadecho(KS_EPI *epi, int echo, int storeecho, int slice, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot)</div><div class="ttdoc">Loads the data storage information to hardware for the acquisition windows in a KS_EPI sequence objec...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1148</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a46ace969d9c0db0a396cdb9c7478d498"><div class="ttname"><a href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a></div><div class="ttdeci">STATUS ksepi_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksepi sequence objects being part of KSEPI_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2287</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afdbaf673741ec0d6d5ebb7ab5974338e"><div class="ttname"><a href="_k_s_foundation_8h.html#afdbaf673741ec0d6d5ebb7ab5974338e">KS_MAT4x4_IDENTITY</a></div><div class="ttdeci">#define KS_MAT4x4_IDENTITY</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:173</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="_k_s_sp_sat_8e_html_abfffc166a1d95ac817d1dc894fd2a416"><div class="ttname"><a href="_k_s_sp_sat_8e.html#abfffc166a1d95ac817d1dc894fd2a416">ksspsat_scan_playsequences</a></div><div class="ttdeci">int ksspsat_scan_playsequences(int perform_slicetimeplot)</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:816</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a31e708efa36d49cc75d7dc46b58d17b9"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a31e708efa36d49cc75d7dc46b58d17b9">kschemsat_scan_seqstate</a></div><div class="ttdeci">void kschemsat_scan_seqstate(KSCHEMSAT_SEQUENCE *kschemsat)</div><div class="ttdoc">Sets the current state of all kschemsat sequence objects being part of KSCHEMSAT_SEQUENCE</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:387</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:194</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa71cd6d202e8a45bfbd6234906521dba"><div class="ttname"><a href="ksepi__implementation_8e.html#aa71cd6d202e8a45bfbd6234906521dba">ksepi_scan_rf_off</a></div><div class="ttdeci">void ksepi_scan_rf_off()</div><div class="ttdoc">Sets all RF pulse amplitudes to zero</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2354</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_a37673579414f16215fe19214f23a1116"><div class="ttname"><a href="_k_s_chem_sat_8e.html#a37673579414f16215fe19214f23a1116">kschemsat</a></div><div class="ttdeci">KSCHEMSAT_SEQUENCE kschemsat</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:88</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a34cf340f218f2155b3a9d357d8eda31c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">KSEPI_SEQUENCE::current_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN * current_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:70</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1a51b640b1005f02c4475a1c5f673adb"><div class="ttname"><a href="_k_s_foundation_8h.html#a1a51b640b1005f02c4475a1c5f673adb">ks_scan_update_slice_location</a></div><div class="ttdeci">void ks_scan_update_slice_location(SCAN_INFO *new_loc, const SCAN_INFO orig_loc, const KS_MAT4x4 M_physical, const KS_MAT4x4 M_logical)</div><div class="ttdoc">Updates a SCAN_INFO struct using physical and logical 4x4 transformation matrices</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:927</div></div>
<div class="ttc" id="_g_e_required_8e_html_adbed7cbe302ef957a49dead6990d286f"><div class="ttname"><a href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a></div><div class="ttdeci">int rspent</div><div class="ttdef"><b>Definition:</b> GERequired.e:2614</div></div>
<div class="ttc" id="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_c_h_e_m_s_a_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSCHEMSAT_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:70</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf598c5557e77ede0f012ec0ca884b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf598c5557e77ede0f012ec0ca884b05">&#9670;&nbsp;</a></span>ksepi_scan_coreslice_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_scan_coreslice_nargs </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a> with standardized input arguments</h4>
</p>
<p><a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a> has functions (<a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>, <a class="el" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a" title="Runs the inversion slice loop and validates TR and SAR/hardware limits">ksinv_eval_checkTR_SAR()</a> and <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>) that expect a standardized function pointer to the coreslice function of a main sequence. When inversion mode is enabled for the sequence, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is used instead of <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a> in <a class="el" href="ksepi__implementation_8e.html#a24677d9b979b2618fe48a802a1a03e4d" title="Plays out all phase encodes for all slices belonging to one pass">ksepi_scan_acqloop()</a>, and the generic <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> function need a handle to the coreslice function of the main sequence.</p>
<p>In order for these <code>ksinv_***</code> functions to work for any pulse sequence they need a standardized function pointer with a fixed set of input arguments. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05" title="Wrapper function to ksepi_scan_coreslice() with standardized input arguments">ksepi_scan_coreslice_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a>.</p>
<p>The function pointer must have SCAN_INFO and slice storage index (dabslice) as the first two input args, while remaining input arguments (to <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_pos</td><td>Pointer to the SCAN_INFO struct corresponding to the current slice to be played out </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dabslice</td><td>0-based slice index for data storage </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a> in range [0,2] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">coreslicetime</td><td>Time taken in [us] to play out one slice with potentially other sequence modules </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                                                                                                 {</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="keywordtype">int</span> shot = 0;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 1) {</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) must contain 0-1 elements (shot), not %d&quot;</span>, __FUNCTION__, nargs);</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 4th arg (void **) cannot be NULL if nargs (3rd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;  }</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  }</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe">ksepi_scan_coreslice</a>(slice_pos, dabslice, shot); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;} <span class="comment">/* ksepi_scan_coreslice_args() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_afdc40649251f5ba32ef7a0bfb326ccbe"><div class="ttname"><a href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe">ksepi_scan_coreslice</a></div><div class="ttdeci">int ksepi_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2392</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b7d23c7f6bba668c5b103a75d6072ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7d23c7f6bba668c5b103a75d6072ae">&#9670;&nbsp;</a></span>ksepi_scan_sliceloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_scan_sliceloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>volindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out <code>slperpass</code> slices corresponding to one TR</h4>
</p>
<p>This function gets a spatial slice location index based on the pass index and temporal position within current pass. It then calls <a class="el" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe" title="Plays out one slice in real time during scanning together with other active sequence modules...">ksepi_scan_coreslice()</a> to play out one coreslice (i.e. the main ksepi main sequence + optional sequence modules, excluding inversion modules).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">volindx</td><td>Volume index in range <code>[0, opfphases - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>Pass index in range <code>[0, ks_slice_plan.npasses - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td>Linear ky kz <code>shot</code> index in range <code>[0, (ksepi.peplan.num_shots-1)]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                                                                             {</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="keywordtype">int</span> slloc, sltimeinpass;</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  SCAN_INFO centerposition = <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0]; <span class="comment">/* first slice chosen here, need only rotation stuff */</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  (void) <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <span class="keywordtype">int</span> centerslice = opslquant/2;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <span class="comment">/* for future 3D multislab support, let passindx update centerposition */</span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    centerposition.optloc = (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice-1].optloc + <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice].optloc)/2.0;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  }</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; slperpass; sltimeinpass++) {</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    SCAN_INFO *current_slice = &amp;centerposition;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      current_slice = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc] : NULL;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;    }</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;    time += <a class="code" href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe">ksepi_scan_coreslice</a>(current_slice, sltimeinpass, shot);</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  }</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;} <span class="comment">/* ksepi_scan_sliceloop() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_afdc40649251f5ba32ef7a0bfb326ccbe"><div class="ttname"><a href="ksepi__implementation_8e.html#afdc40649251f5ba32ef7a0bfb326ccbe">ksepi_scan_coreslice</a></div><div class="ttdeci">int ksepi_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot)</div><div class="ttdoc">Plays out one slice in real time during scanning together with other active sequence modules...</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2392</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a381d3301de972d4eeaba60451b1b179e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a381d3301de972d4eeaba60451b1b179e">&#9670;&nbsp;</a></span>ksepi_scan_sliceloop_nargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_scan_sliceloop_nargs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a> with standardized input arguments</h4>
</p>
<p>For TR timing heat/SAR calculations of regular 2D multislice sequences, <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, <a class="el" href="_k_s_foundation_8h.html#af38e51235c90bff510cae4ee1955dd95" title="Returns the minimum TR based on the content of a slice loop, adding additional time due to SAR and ha...">ks_eval_mintr()</a> and <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a> use a standardized function pointer with a fixed set of input arguments to call the sliceloop of the main sequence with different number of slices to check current slice loop duration. As different pulse sequences may need different number of input arguments (with different meaning) this <a class="el" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e" title="Wrapper function to ksepi_scan_sliceloop() with standardized input arguments">ksepi_scan_sliceloop_nargs()</a> wrapper function provides the argument translation for <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a>.</p>
<p>The function pointer must have an integer corresponding to the number of slices to use as its first argument while the remaining input arguments (to <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a>) are stored in the generic void pointer array with <code>nargs</code> elements, which is then unpacked before calling <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slperpass</td><td>Number of slices to play in the slice loop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nargs</td><td>Number of extra input arguments to <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a> in range [0,3] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>Void pointer array pointing to the variables containing the actual values needed for <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">slicelooptime</td><td>Time taken in [us] to play out <code>slperpass</code> slices </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                                                                      {</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> = 0;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0;</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="keywordtype">int</span> shot = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>; <span class="comment">/* off */</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="keywordflow">if</span> (nargs &lt; 0 || nargs &gt; 3) {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) must contain up to 3 elements: volindx, passindx, shot. Not %d&quot;</span>, __FUNCTION__, nargs);</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nargs &gt; 0 &amp;&amp; args == NULL) {</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 3rd arg (void **) cannot be NULL if nargs (2nd arg) != 0&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  }</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 1 &amp;&amp; args[0] != NULL) {</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> = *((<span class="keywordtype">int</span> *) args[0]);</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  }</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 2 &amp;&amp; args[1] != NULL) {</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = *((<span class="keywordtype">int</span> *) args[1]);</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  }</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  <span class="keywordflow">if</span> (nargs &gt;= 3 &amp;&amp; args[2] != NULL) {</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    shot = *((<span class="keywordtype">int</span> *) args[2]);</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  }</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae">ksepi_scan_sliceloop</a>(slperpass, <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot); <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;} <span class="comment">/* ksepi_scan_sliceloop_nargs() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a3b7d23c7f6bba668c5b103a75d6072ae"><div class="ttname"><a href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae">ksepi_scan_sliceloop</a></div><div class="ttdeci">int ksepi_scan_sliceloop(int slperpass, int volindx, int passindx, int shot)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2550</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46ace969d9c0db0a396cdb9c7478d498"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46ace969d9c0db0a396cdb9c7478d498">&#9670;&nbsp;</a></span>ksepi_scan_seqstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_scan_seqstate </td>
          <td>(</td>
          <td class="paramtype">SCAN_INFO&#160;</td>
          <td class="paramname"><em>slice_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the current state of all ksepi sequence objects being part of <a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksepi sequence">KSEPI_SEQUENCE</a></h4>
</p>
<p>This function sets the current state of all ksepi sequence objects being part of <a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksepi sequence">KSEPI_SEQUENCE</a>, incl. gradient amplitude changes, RF freq/phases and receive freq/phase based on current slice position and phase encoding indices.</p>
<p>The idea of having a 'seqstate' function is to be able to come back to a certain sequence state at any time and possibly play it out once more. This could for example be useful when certain lines or slices need to be rescanned due to image artifacts detected during scanning.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slice_info</td><td>Position of the slice to be played out (one element in the <code>ks_scan_info[]</code> array) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">shot</td><td>Linear ky kz <code>shot</code> index in range <code>[0, (ksepi.peplan.num_shots-1)]</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                                           {</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="keywordtype">int</span> echo;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <span class="keywordtype">int</span> exc_rfphase;</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  <span class="comment">/* RF frequency &amp; phase */</span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6f9bbb676722cdb9706b2de6b28e24d4">ksepi_rfspoiling</a>) {</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    exc_rfphase = <a class="code" href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a>(<a class="code" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a>);</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a>++;</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    exc_rfphase = 0;</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  }</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a>(slice_info);</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, 0,        slice_info, exc_rfphase);</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, INSTRALL, slice_info, exc_rfphase+90);</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; opdualspinecho) {</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, 0);</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>, 0, slice_info, exc_rfphase+90);</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  }</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="comment">/* EPI echoes (i.e. EPI trains) */</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keywordflow">for</span> (echo = 0; echo &lt; opnecho; echo++) {</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, echo, slice_info, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, shot, exc_rfphase);</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  } <span class="comment">/* opnecho */</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, 0, slice_info, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, exc_rfphase);</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;} <span class="comment">/* ksepi_scan_seqstate() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6d1910f42394dc7fb363d85bd6e9c5"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a></div><div class="ttdeci">void ks_scan_rf_on(KS_RF *rf, int instanceno)</div><div class="ttdoc">Resets the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:421</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0d83cf730d82612a87abc0f024bea336"><div class="ttname"><a href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a></div><div class="ttdeci">void ks_scan_epi_shotcontrol(KS_EPI *epi, int echo, SCAN_INFO sliceinfo, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot, float rcvphase)</div><div class="ttdoc">Changes the gradient state of a KS_EPI object for the given slice information</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1088</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a48609b98dac5c8f7619bc0521f58d6e3"><div class="ttname"><a href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a></div><div class="ttdeci">float ks_scan_rf_phase_spoiling(int counter)</div><div class="ttdoc">Returns spoiling phase for a given RF counter</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3547</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_abd7cdf91b5410cdc97ac4abd7fe17bb3"><div class="ttname"><a href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a></div><div class="ttdeci">int rfspoiling_phase_counter</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2851</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6f9bbb676722cdb9706b2de6b28e24d4"><div class="ttname"><a href="ksepi__implementation_8e.html#a6f9bbb676722cdb9706b2de6b28e24d4">ksepi_rfspoiling</a></div><div class="ttdeci">int ksepi_rfspoiling</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:116</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae8766ce800f95dd75ca2eece6638326c"><div class="ttname"><a href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, float rfphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:532</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2fdfe2e655a76c4cd4fb1dac16d1834b"><div class="ttname"><a href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a></div><div class="ttdeci">void ks_scan_rotate(SCAN_INFO slice_info)</div><div class="ttdoc">Performs a rotation of the logical system on hardware (WARP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:988</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a34cf340f218f2155b3a9d357d8eda31c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">KSEPI_SEQUENCE::current_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN * current_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:70</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_abed769d29c48283fc675de705f3c9e71"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">KSEPI_SEQUENCE::selrfref2</a></div><div class="ttdeci">KS_SELRF selrfref2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:60</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a24677d9b979b2618fe48a802a1a03e4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24677d9b979b2618fe48a802a1a03e4d">&#9670;&nbsp;</a></span>ksepi_scan_acqloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_scan_acqloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>volindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>multishotflag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all phase encodes for all slices belonging to one pass</h4>
</p>
<p>This function traverses through all shots (<code>ksepi_numshots</code>) to be played out and runs the <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a> for each set of shots and excitation. If ksepi_dda &gt; 0, dummy scans will be played out before the phase encoding begins.</p>
<p>In the case of inversion, <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a> is called instead of <a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a>, where the former takes a function pointer to <a class="el" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05" title="Wrapper function to ksepi_scan_coreslice() with standardized input arguments">ksepi_scan_coreslice_nargs()</a> in order to be able to play out the coreslice in a timing scheme set by <a class="el" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4" title="Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...">ksinv_scan_sliceloop()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">passindx</td><td>0-based pass index in range <code>[0, ks_slice_plan.npasses - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">volindx</td><td>0-based image volume index in range <code>[0, opfphases - 1]</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">multishotflag</td><td>ksepi.epitrain.blipphaser.R is used as... 0: Parallel imaging factor 1: Multi-shot (all volumes, KSEPI_MULTISHOT_ON) 2: Multi-shot (multishot vol 1 (volindx=0), PI for vols 2-N, KSEPI_MULTISHOT_ON_VOL1) 3: Multi-shot (multishot for b0 volumes), PI for diffusion volumes (only when opdiffuse &gt; 0) </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">passlooptime</td><td>Time taken in [us] to play out all phase encodes and excitations for <code>slperpass</code> slices. Note that the value is a <code>float</code> instead of <code>int</code> to avoid int overrange at 38 mins of scanning </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                                                                       {</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <span class="keywordtype">int</span> shot, kyshot;</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord;</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  <span class="keywordtype">int</span> ndummies = 0;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;  <span class="keywordtype">int</span> is_multishot = (multishotflag == <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17">KSEPI_MULTISHOT_ALLVOLS</a>) || \</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                     (multishotflag == <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06">KSEPI_MULTISHOT_1STVOL</a> &amp;&amp; (<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> == 0)) || \</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                     (multishotflag == <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a> &amp;&amp; opdiffuse &amp;&amp; (<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; opdifnumt2));</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;</div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a> &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> == -1) { <span class="comment">/* reference volume */</span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a> = &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">ref_peplan</a>;</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_multishot) { <span class="comment">/* multishot volume */</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a> = &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">full_peplan</a>;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* accelerated volume */</span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a> = &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  }</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> == -<a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> - <a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a>) { <span class="comment">/* FLEET volume */</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    time += (float) <a class="code" href="ksepi__implementation_8e.html#ad200fa60ab5064ac49d0100071f3c285">ksepi_fleet_scan_sliceloop</a>(<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>);</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  }</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;  <span class="keywordflow">else</span> { <span class="comment">/* non-FLEET volumes */</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> == 0)</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;      ndummies = <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a>;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;      ndummies = 0;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    <span class="keywordflow">for</span> (shot = -ndummies; shot &lt; <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">num_shots</a>; shot++) {</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <span class="keywordflow">if</span> (shot == 0 &amp;&amp; ndummies &gt; 0) {</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a>);</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;      }</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, 0, shot); <span class="comment">/* coord to first line of EPI train */</span></div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        kyshot = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> % <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">phaser</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811">ks_enum_epiblipsign</a> blipsign = <a class="code" href="_k_s_foundation_8h.html#a27071ced949f926058771246110c119c">ks_scan_epi_verify_phaseenc_plan</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>, shot);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="keywordtype">int</span> post_delay = 0;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;        <span class="keywordflow">if</span> (blipsign == <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>) {</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;         post_delay = (kyshot &lt;= 0) ? GRAD_UPDATE_TIME : RUP_GRD((<span class="keywordtype">int</span>) (<a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> * kyshot));</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blipsign == <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a>) {</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;         post_delay = (kyshot &lt;= 0) ? GRAD_UPDATE_TIME : RUP_GRD((<span class="keywordtype">int</span>) (<a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> * (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">current_peplan</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">phaser</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>-1-kyshot)));</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        }</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>, <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> - post_delay);</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>, post_delay);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      }</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>.<a class="code" href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">params</a>.<a class="code" href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">irmode</a> != <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <span class="keywordtype">void</span> *args[] = {(<span class="keywordtype">void</span> *) &amp;shot}; <span class="comment">/* pass on args via ksinv_scan_sliceloop() to ksepi_scan_coreslice() */</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="keywordtype">int</span> nargs = <span class="keyword">sizeof</span>(args) / <span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *);</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        time += (float) <a class="code" href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a>, &amp;<a class="code" href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a>,</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                                              (shot &lt; 0) ? <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a> : <a class="code" href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a>, <a class="code" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a>, nargs, args);</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        time += (float) <a class="code" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae">ksepi_scan_sliceloop</a>(<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, shot);</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;      }</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a>(<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; 0 ? <span class="stringliteral">&quot;ksepi ghostcorr&quot;</span> : <span class="stringliteral">&quot;ksepi shots&quot;</span>);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <span class="comment">/* save a frame of the main sequence */</span></div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <span class="keywordflow">if</span> (shot &gt;= 0) {</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      }</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    } <span class="comment">/* for shot */</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; 0 ? <a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e">KS_PLOT_PASS_WAS_CALIBRATION</a> : <a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a>);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;  }</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;} <span class="comment">/* ksepi_scan_acqloop() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112ac8854c1057dc9a7f362ea5f8a0edd40e">KSINV_LOOP_NORMAL</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6915a63ab744ee4957ab235a2f214ca7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">KSEPI_SEQUENCE::ref_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN ref_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:68</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_aa2f98be84137da8386df3fc88763823c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">KS_PHASEENCODING_PLAN::num_shots</a></div><div class="ttdeci">int num_shots</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1587</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a1e661325433fb0f29283f44babb61221"><div class="ttname"><a href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a></div><div class="ttdeci">float ksepi_echotime_shifting_shotdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:213</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a85c440a9bfab319879423028559eef5b"><div class="ttname"><a href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a></div><div class="ttdeci">int ksepi_dda</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:179</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a43cba2a0a2557026231e05da863c15c3"><div class="ttname"><a href="_k_s_inversion_8e.html#a43cba2a0a2557026231e05da863c15c3">ksinv_filltr</a></div><div class="ttdeci">KS_SEQ_CONTROL ksinv_filltr</div><div class="ttdef"><b>Definition:</b> KSInversion.e:126</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a426a4d6dc160c5294ae7a1881199fc17">KSEPI_MULTISHOT_ALLVOLS</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:95</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a92d0943acffeeec5fe3f57110b28f7ac"><div class="ttname"><a href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a></div><div class="ttdeci">int ksepi_ghostcorr</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:184</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:69</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa4d70e1b753a44f18ce002ecb84cd16e"><div class="ttname"><a href="_k_s_foundation_8h.html#aa4d70e1b753a44f18ce002ecb84cd16e">ks_plot_tgt_addframe</a></div><div class="ttdeci">void ks_plot_tgt_addframe(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3151</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:97</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a263548cf715f98526edee92b52818db2"><div class="ttname"><a href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a></div><div class="ttdeci">int ksepi_fleet</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:158</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aaf598c5557e77ede0f012ec0ca884b05"><div class="ttname"><a href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a></div><div class="ttdeci">int ksepi_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksepi_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2485</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aadb6109f3b3f75f81b46e153f9eb11f0"><div class="ttname"><a href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a></div><div class="ttdeci">void ks_plot_slicetime_endofslicegroup(const char *desc)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3091</div></div>
<div class="ttc" id="struct_k_s_i_n_v___p_a_r_a_m_s_html_af099e402667813c2feafd4ec28debdb5"><div class="ttname"><a href="struct_k_s_i_n_v___p_a_r_a_m_s.html#af099e402667813c2feafd4ec28debdb5">KSINV_PARAMS::irmode</a></div><div class="ttdeci">int irmode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:74</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a27071ced949f926058771246110c119c"><div class="ttname"><a href="_k_s_foundation_8h.html#a27071ced949f926058771246110c119c">ks_scan_epi_verify_phaseenc_plan</a></div><div class="ttdeci">ks_enum_epiblipsign ks_scan_epi_verify_phaseenc_plan(KS_EPI *epi, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1049</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a676278a26cf0540ba967faa440461dc4">KS_PLOT_PASS_WAS_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:198</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ad200fa60ab5064ac49d0100071f3c285"><div class="ttname"><a href="ksepi__implementation_8e.html#ad200fa60ab5064ac49d0100071f3c285">ksepi_fleet_scan_sliceloop</a></div><div class="ttdeci">int ksepi_fleet_scan_sliceloop(int slperpass, int volindx, int passindx)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2582</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab1a16f7634c6afebc34abe7a8942709f"><div class="ttname"><a href="_k_s_inversion_8e.html#ab1a16f7634c6afebc34abe7a8942709f">ksinv1</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv1</div><div class="ttdef"><b>Definition:</b> KSInversion.e:124</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_af0adb26c729e5b3bd252f5e1918869c4"><div class="ttname"><a href="_k_s_inversion_8e.html#af0adb26c729e5b3bd252f5e1918869c4">ksinv_scan_sliceloop</a></div><div class="ttdeci">int ksinv_scan_sliceloop(const KS_SLICE_PLAN *slice_plan, const SCAN_INFO *slice_positions, int passindx, KSINV_SEQUENCE *ksinv1, KSINV_SEQUENCE *ksinv2, KS_SEQ_CONTROL *ksinv_filltr, KSINV_LOOP_MODE ksinv_loop_mode, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Plays out slice_plan.nslices_per_pass slices corresponding to one TR for inversion psds...</div><div class="ttdef"><b>Definition:</b> KSInversion.e:2246</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a196a10609c8f75d0ff6d7a520d0b7c27"><div class="ttname"><a href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a></div><div class="ttdeci">void ks_scan_wait(KS_WAIT *wait, int waitperiod)</div><div class="ttdoc">Updates the wait period of all instances of a KS_WAIT sequence object. The value of waitperiod must n...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:134</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a5b459c9789d0941c6a2e6262e59579aa"><div class="ttname"><a href="_k_s_inversion_8e.html#a5b459c9789d0941c6a2e6262e59579aa">ksinv2</a></div><div class="ttdeci">KSINV_SEQUENCE ksinv2</div><div class="ttdef"><b>Definition:</b> KSInversion.e:125</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a43822646b479e4668a9076be0bb0612d"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">KSEPI_SEQUENCE::full_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN full_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:67</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811">ks_enum_epiblipsign</a></div><div class="ttdeci">ks_enum_epiblipsign</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a34cf340f218f2155b3a9d357d8eda31c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a34cf340f218f2155b3a9d357d8eda31c">KSEPI_SEQUENCE::current_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN * current_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:70</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd"><div class="ttname"><a href="_k_s_inversion_8e.html#acda2604f80fde12fdea9080776fff112a6e85e8c8695e05028311131f451154dd">KSINV_LOOP_DUMMY</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:46</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a70bad3baa21b1c50c67859559c38ad06">KSEPI_MULTISHOT_1STVOL</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:96</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a1850e2f2b51731a0e043855f5991dda2">KS_PLOT_PASS_WAS_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:200</div></div>
<div class="ttc" id="struct_k_s_i_n_v___s_e_q_u_e_n_c_e_html_ae3f2882565f570c1f5122884187d435f"><div class="ttname"><a href="struct_k_s_i_n_v___s_e_q_u_e_n_c_e.html#ae3f2882565f570c1f5122884187d435f">KSINV_SEQUENCE::params</a></div><div class="ttdeci">KSINV_PARAMS params</div><div class="ttdef"><b>Definition:</b> KSInversion.e:99</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab8c26ea9ee8534faf737bbc61223253e"><div class="ttname"><a href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a></div><div class="ttdeci">void ks_plot_slicetime_endofpass()</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a3b7d23c7f6bba668c5b103a75d6072ae"><div class="ttname"><a href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae">ksepi_scan_sliceloop</a></div><div class="ttdeci">int ksepi_scan_sliceloop(int slperpass, int volindx, int passindx, int shot)</div><div class="ttdoc">Plays out slperpass slices corresponding to one TR</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2550</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:63</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e">KS_PLOT_PASS_WAS_CALIBRATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:199</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:64</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_a706b4cec8ea7b1363975e556d74de924"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">KS_PHASEENCODING_PLAN::phaser</a></div><div class="ttdeci">KS_PHASER * phaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1591</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a455eb376ed04673e40382a6ba8503888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a455eb376ed04673e40382a6ba8503888">&#9670;&nbsp;</a></span>ksepi_scan_scanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_scan_scanloop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plays out all volumes and passes of a single or multi-pass scan</h4>
</p>
<p>This function performs the entire scan and traverses through passes and volumes. For each <code>passindx</code> (in range <code>[0, ks_slice_plan.npasses-1]</code>), and <code>volindx</code>, <a class="el" href="ksepi__implementation_8e.html#a24677d9b979b2618fe48a802a1a03e4d" title="Plays out all phase encodes for all slices belonging to one pass">ksepi_scan_acqloop()</a> will be called to acquire all data for the current set of slices belong to the current pass (acquisition). At the end of each pass, <a class="el" href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5" title="Sets SSP word in sequence off_GEpass() to trigger data (Pfile) writing and reconstruction">GEReq_endofpass()</a> is called to trigger GE's recon and to dump Pfiles (if <code>autolock = 1</code>). <code>volindx</code> will start at -1 if <code>ksepi_ghostcorr = 1</code>, in which case a leading extra image volume will be played out without phase encoding blips. This data is used by GE's integrated refscan (rhref=5) to ghost correct the remaining volumes. This process requires single-shot (ksepi.epitrain.phaseenc.R = 1) and single-echo (opnecho = 1). However, for offline reconstruction, it is possible to still use this extra volume for ghost correction even though ksepi.epitrain.phaseenc.R &gt; 1 and/or opnecho &gt; 1.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">scantime</td><td>Total scan time in [us] (<code>float</code> to avoid int overrange after 38 mins) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;                            {</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;  <span class="keywordtype">float</span> time = 0.0;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>;</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> = -<a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> - <a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a>; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> &lt; opfphases; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>++) { <span class="comment">/* opfphases = # volumes */</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a> &amp;&amp; <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> == -1) <span class="comment">/* if ghostcorr is used it will be volume -1 */</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <a class="code" href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a> = <a class="code" href="_k_s_foundation_8h.html#a631e009fae4e6280b5fade1634356188">L_REF</a>; <span class="comment">/* will make zero phase encodes in ksepi_scan_coreslice() */</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;      <a class="code" href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a> = L_SCAN;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <a class="code" href="ksepi__implementation__diffusion_8e.html#aa8399e1e8cdc9a4d23089becce463be6">ksepi_diffusion_scan_diffamp</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>, <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>);</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;    }</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> = 0; <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>; <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>++) {</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      time += <a class="code" href="ksepi__implementation_8e.html#a24677d9b979b2618fe48a802a1a03e4d">ksepi_scan_acqloop</a>(<a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>, <a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>);</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="preprocessor">#ifdef IPG</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;      <span class="keywordflow">if</span> ( !((<a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a> + 1 == opfphases) &amp;&amp; (<a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a> + 1 == <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>)) ) {</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        <a class="code" href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a>(); <span class="comment">/* don&#39;t play last time, we rely now on  GEReq_endofpassandscan() in ksepi.e:scan() */</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;      }</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    } <span class="comment">/* end: acqs (pass) loop */</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  } <span class="comment">/* end: volume loop */</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;} <span class="comment">/* ksepi_scan_scanloop() */</span></div><div class="ttc" id="_g_e_required_8e_html_a7d88db21119d2904e811676cff0a49a5"><div class="ttname"><a href="_g_e_required_8e.html#a7d88db21119d2904e811676cff0a49a5">GEReq_endofpass</a></div><div class="ttdeci">void GEReq_endofpass()</div><div class="ttdoc">Sets SSP word in sequence off_GEpass() to trigger data (Pfile) writing and reconstruction</div><div class="ttdef"><b>Definition:</b> GERequired.e:2565</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a92d0943acffeeec5fe3f57110b28f7ac"><div class="ttname"><a href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a></div><div class="ttdeci">int ksepi_ghostcorr</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:184</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6ea932f1fd0cfa98b2f37e829e67a8f8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a></div><div class="ttdeci">int ksepi_multishot_control</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:186</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a263548cf715f98526edee92b52818db2"><div class="ttname"><a href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a></div><div class="ttdeci">int ksepi_fleet</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:158</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a631e009fae4e6280b5fade1634356188"><div class="ttname"><a href="_k_s_foundation_8h.html#a631e009fae4e6280b5fade1634356188">L_REF</a></div><div class="ttdeci">#define L_REF</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:91</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a9cd9ebd93187231e5c4109d14c0dd69c"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">KS_SLICE_PLAN::npasses</a></div><div class="ttdeci">int npasses</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1201</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_aa8399e1e8cdc9a4d23089becce463be6"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#aa8399e1e8cdc9a4d23089becce463be6">ksepi_diffusion_scan_diffamp</a></div><div class="ttdeci">void ksepi_diffusion_scan_diffamp(KSEPI_SEQUENCE *ksepi, int volindx)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:824</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a24677d9b979b2618fe48a802a1a03e4d"><div class="ttname"><a href="ksepi__implementation_8e.html#a24677d9b979b2618fe48a802a1a03e4d">ksepi_scan_acqloop</a></div><div class="ttdeci">float ksepi_scan_acqloop(int, int, int)</div><div class="ttdoc">Plays out all phase encodes for all slices belonging to one pass</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2711</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_g_e_required_8e_html_adbed7cbe302ef957a49dead6990d286f"><div class="ttname"><a href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a></div><div class="ttdeci">int rspent</div><div class="ttdef"><b>Definition:</b> GERequired.e:2614</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a194b50baa60802751c7deb22e966d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a194b50baa60802751c7deb22e966d8">&#9670;&nbsp;</a></span>ksepi_init_imagingoptions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksepi_init_imagingoptions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial handling of imaging options buttons and top-level CVs at the PSD type-in page</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                     {</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordtype">int</span> numopts = <span class="keyword">sizeof</span>(<a class="code" href="ksepi__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>) / <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  psd_init_iopt_activity();</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  activate_iopt_list(numopts, <a class="code" href="ksepi__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  enable_iopt_list(numopts, <a class="code" href="ksepi__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">/* Imaging option control functions (using PSD_IOPT_ZIP_512 as example):</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    - Make an option unchecked and not selectable: disable_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    - Make an option checked and not selectable:   set_required_disabled_option(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    - Remove the imaging option:                   deactivate_ioption(PSD_IOPT_ZIP_512)</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">/* Do not allow 3D multislab to be selected until supported by the PSD */</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  cvmax(opimode, PSD_3D);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">/* Button accept control */</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  cvmax(opflair, OPFLAIR_GROUP); <span class="comment">/* allow T2-FLAIR */</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  cvmax(opepi, 1);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  cvdef(opepi, 1);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  cvmax(opmph, 1);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    deactivate_ioption(PSD_IOPT_IR_PREP);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    deactivate_ioption(PSD_IOPT_ARC); <span class="comment">/* No arc for 2D */</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">/* flow comp only for GE-EPI */</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">if</span> (exist(oppseq) == PSD_SE) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    deactivate_ioption(PSD_IOPT_FLOW_COMP);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">if</span> (opflair) {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    deactivate_ioption(PSD_IOPT_IR_PREP);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    deactivate_ioption(PSD_IOPT_MPH);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">/* Allow diffusion, but also diffusion recon pipeline for non-diffusion EPI to</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">  allow for integrated refscan (rhref = 5) to remove Nyquist ghosting for all EPI variants.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">  If the user selects DW-EPI in the UI, opdiffuse is set to 1 by the host interface.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">  The integrated refscan in GE&#39;s online recon requires opdiffuse &gt; 0, but not necessarily 1.</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">  The following enum is declared in KSFoundation.h:</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">  {KS_EPI_DIFFUSION_OFF = 0, KS_EPI_DIFFUSION_ON = 1, KS_EPI_DIFFUSION_PRETEND_FOR_RECON = 2}</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">  So, to let this psd to know if diffusion is really wanted, we check whether opdiffuse is exactly</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">  1, like if (opdiffuse == KS_EPI_DIFFUSION_ON) in ksepi_implementation.e and ksepi_implementation_diffusion.e.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">  I.e. it is important not to check just for &quot;if (opdiffuse)&quot;.</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">  In GERequired()-&gt;GEReq_predownload_setrecon_epi(), we check whether opdiffuse = KS_EPI_DIFFUSION_ON,</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">  and if not, we set opdiffuse = KS_EPI_DIFFUSION_PRETEND_FOR_RECON. Copy and pasting the non-diffusion-scan</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">  will therefore not enable the diffusion gradients either.  */</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  cvmax(opdiffuse, <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4aa4576cd2d3b8dc8631cc85b1c4a7edaf">KS_EPI_DIFFUSION_PRETEND_FOR_RECON</a>); <span class="comment">/* = 2 */</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  cvdesc(opdiffuse, <span class="stringliteral">&quot;0: Off 1: On 2: pretend for recon&quot;</span>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">#ifdef SIM</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  opepi = !<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  setexist(opepi, PSD_ON);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  opirmode = PSD_OFF; <span class="comment">/* default interleaved slices */</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  setexist(opirmode, PSD_ON);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">/* GERequired.e:GEReq_cvinit() sets ks_qfact (acoustic reduction) when</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">     ART (opsilent) has been selected. For medium/high ART, ks_qfact is set to 8/20.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">     However, for EPI, the geometric distortions becomes too severe so need to</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">     reduce ks_qfact for EPI (and hence the amount of acoustic reduction).</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">     In ksepi.e:cvinit() GEReq_cvinit() is called before ksepi_init_imagingoptions(),</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">     so this code will override the ks_qfact values set in GEReq_cvinit() */</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span> (opsilent) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    _ks_qfact.existflag = TRUE;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span> (opsilentlevel == 1) {</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">/* moderate ART (small acoustic reduction) */</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a> = 4;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="ksepi__implementation__diffusion_8e.html#afaad49378fc39c10e2325f6c57be68a2">ksepi_diffusion_ramptime</a> = 1500;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">/* high ART (moderate acoustic reduction) */</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a> = 8;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      <a class="code" href="ksepi__implementation__diffusion_8e.html#afaad49378fc39c10e2325f6c57be68a2">ksepi_diffusion_ramptime</a> = 2500;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a> = 1;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="ksepi__implementation__diffusion_8e.html#afaad49378fc39c10e2325f6c57be68a2">ksepi_diffusion_ramptime</a> = 1500; <span class="comment">/* we don&#39;t reduce too much to avoid bed vibrations */</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  pipure = PSD_PURE_COMPATIBLE_2; <span class="comment">/* or maybe PSD_PURE_COMPATIBLE_1 ? */</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;} <span class="comment">/* ksepi_init_imagingoptions() */</span></div><div class="ttc" id="ksepi__implementation__diffusion_8e_html_afaad49378fc39c10e2325f6c57be68a2"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#afaad49378fc39c10e2325f6c57be68a2">ksepi_diffusion_ramptime</a></div><div class="ttdeci">int ksepi_diffusion_ramptime</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_a7506e6224f5036fb1941843536b6f4a6"><div class="ttname"><a href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a></div><div class="ttdeci">float ks_qfact</div><div class="ttdef"><b>Definition:</b> GERequired.e:240</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a8f39fad60409167fe45164b72a131e0b"><div class="ttname"><a href="ksepi__implementation_8e.html#a8f39fad60409167fe45164b72a131e0b">sequence_iopts</a></div><div class="ttdeci">int sequence_iopts[]</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:274</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4aa4576cd2d3b8dc8631cc85b1c4a7edaf"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4aa4576cd2d3b8dc8631cc85b1c4a7edaf">KS_EPI_DIFFUSION_PRETEND_FOR_RECON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66351df684e62e29938634fa21c75518"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66351df684e62e29938634fa21c75518">&#9670;&nbsp;</a></span>ksepi_init_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_init_UI </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Initial setup of user interface (UI) with default values for menus and fields</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                           {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  STATUS status;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="comment">/* Slice oversampling for 3D to avoid aliasing */</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    pislblank = <a class="code" href="ksepi__implementation_8e.html#aa7d0418e6cad024520674d7d4d0eb0ec">ksepi_kissoff_factor</a> * exist(opslquant);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="comment">/* Spin or Gradient Echo EPI */</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span> (exist(oppseq) == PSD_SE || exist(oppseq) == PSD_IR) {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    acq_type = TYPSPIN; <span class="comment">/* SE, FLAIR, or Diffusion EPI */</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    acq_type = TYPGRAD; <span class="comment">/* GRE-EPI */</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="comment">/* force flow comp off for non-GE-EPI */</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (acq_type != TYPGRAD) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    cvoverride(opfcomp, FALSE, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">/* rBW */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  pircbnub = 5; <span class="comment">/* number of variable bandwidth */</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  pircb2nub = 0; <span class="comment">/* no second bandwidth option */</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  cvmin(oprbw, 15.625);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#aa30bc912f81e467781febda7c6d3da03">ksepi_rampsampling</a>) {</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    cvmax(oprbw, 250);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    cvdef(oprbw, 250);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    pircbval2 = 31.25;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    pircbval3 = 62.50;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    pircbval4 = 125.0;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    pircbval5 = 250.0;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    cvmax(oprbw, <a class="code" href="ksepi__implementation_8e.html#a391cb70899387075c448742de89ca842">KSEPI_MAXRBW_NORAMPSAMPLING</a>);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    cvdef(oprbw, 62.5);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    pircbval2 = 31.25;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    pircbval3 = 62.50;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    pircbval4 = 83.33;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    pircbval5 = <a class="code" href="ksepi__implementation_8e.html#a391cb70899387075c448742de89ca842">KSEPI_MAXRBW_NORAMPSAMPLING</a>;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (oprbw &gt; _oprbw.maxval) {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">/* this avoid minFOV errors for rBW = 250 when FOV &lt; 35 cm */</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    cvoverride(oprbw, <a class="code" href="ksepi__implementation_8e.html#a391cb70899387075c448742de89ca842">KSEPI_MAXRBW_NORAMPSAMPLING</a>, _oprbw.fixedflag, _oprbw.existflag);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  }</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  oprbw = _oprbw.defval;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  pidefrbw = _oprbw.defval;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">/* NEX - never show. Partial Fourier in ky is done with opte = MINTE, not with NEX &lt; 1 */</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  cvdef(opnex, 1);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  opnex = _opnex.defval;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  cvmin(opnex, 1);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  cvmax(opnex, 1);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  pinexnub = 0;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  pinexval2 = 1;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  pinexval3 = 1;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  pinexval4 = 1;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  pinexval5 = 1;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  pinexval6 = 1;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">/* FOV */</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> = 240;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  pifovnub = 5;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  pifovval2 = 200;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  pifovval3 = 220;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  pifovval4 = 240;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  pifovval5 = 260;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  pifovval6 = 280;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">/* phase FOV fraction */</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  opphasefov = 1;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  piphasfovnub2 = 63;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  piphasfovval2 = 1.0;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  piphasfovval3 = 0.9;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  piphasfovval4 = 0.8;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  piphasfovval5 = 0.7;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  piphasfovval6 = 0.6;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">/* freq (x) resolution */</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 16);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">/* phase (y) resolution */</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  cvmin(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 16);</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">/* assuming many shots for 3D */</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 320);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      pixresnub = 63;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      pixresval2 = 192;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      pixresval3 = 256;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      pixresval4 = 288;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      pixresval5 = 320;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      pixresval6 = 384;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 320);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      piyresnub = 63;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      piyresval2 = 192;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      piyresval3 = 256;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      piyresval4 = 288;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      piyresval5 = 320;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      piyresval6 = 384;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 64);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a>, 64);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      pixresnub = 63;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      pixresval2 = 96;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      pixresval3 = 128;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      pixresval4 = 160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      pixresval5 = 192;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      pixresval6 = 224;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      piyresnub = 63;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      piyresval2 = 96;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      piyresval3 = 128;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      piyresval4 = 160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;      piyresval5 = 192;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      piyresval6 = 224;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      pixresnub = 63;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      pixresval2 = 32;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      pixresval3 = 64;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      pixresval4 = 96;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      pixresval5 = 128;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      pixresval6 = 160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      piyresnub = 63;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      piyresval2 = 32;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      piyresval3 = 64;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      piyresval4 = 96;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      piyresval5 = 128;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      piyresval6 = 160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  }</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a> = _opxres.defval;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> = _opyres.defval;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">/* Num echoes */</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  piechnub = 63;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  cvdef(opnecho, 1);</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  cvmax(opnecho, 8);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  opnecho = _opnecho.defval;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  piechdefval = _opnecho.defval;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  piechval2 = 1;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  piechval3 = 2;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  piechval4 = 4;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  piechval5 = 6;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  piechval6 = 8;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">/* ETL */</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  cvmax(opetl, 1024);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  pietlnub = 0;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">/* TE */</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  avmaxte = 1s;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  avminte = 0;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  avminte2 = 0;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  pitetype = PSD_LABEL_TE_EFF; <span class="comment">/* alt. PSD_LABEL_TE_EFF */</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  cvdef(opte, 200ms);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  opte = _opte.defval;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  pite1nub = 63;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  pite1val2 = PSD_MINIMUMTE;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  pite1val3 = PSD_MINFULLTE;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  pite1val4 = 30ms;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  pite1val5 = 50ms;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  pite1val6 = 70ms;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">/* TE2 */</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">/* pite2nub = 0; */</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  <span class="comment">/* TR */</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  cvdef(optr, 2s);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  optr = _optr.defval;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordflow">if</span> (opfast == TRUE) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    pitrnub = 0; <span class="comment">/* &#39;0&#39;: shown but greyed out (but only if opautotr = 1, otherwise TR menu is hidden) */</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    cvoverride(opautotr, PSD_ON, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    pitrnub = 6; <span class="comment">/* &#39;2&#39;: only one menu choice (Minimum = AutoTR) */</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  pitrval2 = PSD_MINIMUMTR;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  pitrval3 = 1000ms;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  pitrval4 = 2000ms;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  pitrval5 = 3000ms;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  pitrval6 = 4000ms;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="comment">/* FA */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keywordflow">if</span> (acq_type == TYPSPIN) {</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    cvdef(opflip, 180); <span class="comment">/* refocusing RF: initialize with low FA to avoid gradrf complaints on load */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 24</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    pifanub = 0; <span class="comment">/* can also be e.g. 2 to allow modification of refocusing flip angle */</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    pifamode = PSD_FLIP_ANGLE_MODE_REFOCUS;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    pifaval2 = 180;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    pifanub = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    pifanub = 6;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 24</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    pifamode = PSD_FLIP_ANGLE_MODE_EXCITE;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    cvdef(opflip, 10);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    pifaval2 = 10;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    pifaval3 = 15;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    pifaval4 = 20;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    pifaval5 = 30;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    pifaval6 = 90;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  opflip = _opflip.defval;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">/* slice thickness */</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  pistnub = 5;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 4);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    pistval2 = 3;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    pistval3 = 4;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    pistval4 = 5;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    pistval5 = 6;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    pistval6 = 10;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    cvdef(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>, 2);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    pistval2 = 1.50;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    pistval3 = 1.75;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    pistval4 = 2.00;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    pistval5 = 2.25;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    pistval6 = 2.50;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a> = _opslthick.defval;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">/* slice spacing */</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  cvdef(opslspace, 0);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  opslspace = _opslspace.defval;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  piisil = PSD_ON;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    piisnub = 4;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    piisval3 = 0.5;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    piisval4 = 1;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    piisval5 = 4;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    piisval6 = 20;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* change these to do overlaps */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    piisnub = 0;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    piisval2 = 0;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">/* default # of slices */</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  cvdef(opslquant, 30);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">/* 3D slice settings */</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {<span class="comment">/* PSD_3D (=2) or PSD_3DM (=6) */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">if</span> (opimode == PSD_3DM) {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ksepi: 3D multislab mode not supported&quot;</span>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">if</span> (acq_type == TYPSPIN) {</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;ksepi: 3D spin echo epi not supported&quot;</span>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    pimultislab = 0; <span class="comment">/* 0: forces only single slab, 1: allow multi-slab */</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    pilocnub = 4;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    pilocval2 = 32;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    pilocval3 = 64;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    pilocval4 = 128;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">/* opslquant = #slices in slab. opvquant = #slabs */</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    cvdef(opslquant, 32);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  }</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">/* Multi phase (i.e. multi volumes) */</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordflow">if</span> (opmph) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    pimphscrn = 1;   <span class="comment">/* display Multi-Phase Parameter screen */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    pifphasenub = 6;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    pifphaseval2 = 10;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    pifphaseval3 = 20;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    pifphaseval4 = 50;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    pifphaseval5 = 100;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    pifphaseval6 = 200;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    pisldelnub = 0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">    pisldelval3 = 1s;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">    pisldelval4 = 2s;</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">    pisldelval5 = 5s;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">    pisldelval6 = 10s;</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    piacqnub = 0;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    setexist(opacqo, 1);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    pihrepnub = 0;  <span class="comment">/* no XRR gating */</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span> (opdiffuse != <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      cvoverride(opfphases, 1, PSD_FIX_OFF, PSD_EXIST_OFF);</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    pimphscrn = 0;   <span class="comment">/* do not display the Multi-Phase Parameter screen */</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <span class="comment">/* Prescan buttons (autoshim). c.f. epic.h */</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  pipscoptnub = 1; <span class="comment">/* Bit map of number of Prescan option buttons. 0=none, 1=autoshim, 2=phase corr */</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="comment">/* opuser0: show GIT revision (GITSHA) using REV variable from the Imakefile */</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="preprocessor">#ifdef REV</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordtype">char</span> userstr[100];</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  sprintf(userstr, <span class="stringliteral">&quot;PSD version: %s&quot;</span>, REV);</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  cvmod(opuser0, 0, 0, 0, userstr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  piuset |= use0;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="comment">/* opuser1: Number of overscans (extra kylines) for partial Fourier */</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  cvmod(opuser1, _ksepi_kynover.minval, _ksepi_kynover.maxval, _ksepi_kynover.defval, _ksepi_kynover.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  opuser1 = _ksepi_kynover.defval;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  piuset |= use1;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  cvmod(opuser2, _ksepi_blipsign.minval, _ksepi_blipsign.maxval, _ksepi_blipsign.defval, _ksepi_blipsign.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  opuser2 = _ksepi_blipsign.defval;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  piuset |= use2;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  cvmod(opuser3, _ksepi_onlinerecon.minval, _ksepi_onlinerecon.maxval, _ksepi_onlinerecon.defval, _ksepi_onlinerecon.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  opuser3 = _ksepi_onlinerecon.defval;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &lt; 26</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;     piuset |= use3;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;     piuset &amp;= ~use3; <span class="comment">/* Hide this for DV26+ as EPI without HyperDABs is no longer supported. Custom recons are now necessary */</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">/* enum {KSEPI_MULTISHOT_OFF=0,KSEPI_MULTISHOT_ALLVOLS=1,KESPI_MULTISHOT_1STVOL=2, KSEPI_MULTISHOT_B0VOLS=3 */</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    piuset &amp;= ~use5;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    cvdef(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, 0);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    piuset |= use5;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      cvdef(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, 3);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      cvdesc(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, <span class="stringliteral">&quot;0:PI 1:All MulShot 2:1stMulShot 3:b0MulShot&quot;</span>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      cvdef(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, 2);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      cvdesc(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, <span class="stringliteral">&quot;0:PI 1:All MulShot 2:1stMulShot&quot;</span>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  cvmod(opuser5, _ksepi_multishot_control.minval, _ksepi_multishot_control.maxval, _ksepi_multishot_control.defval, _ksepi_multishot_control.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  opuser5 = (float) _ksepi_multishot_control.defval;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">/* OFFLINE_DIFFRETURN_ALL = 0, OFFLINE_DIFFRETURN_ACQUIRED = 1, OFFLINE_DIFFRETURN_B0 = 2, OFFLINE_DIFFRETURN_MEANDWI = 4, OFFLINE_DIFFRETURN_MEANADC = 8, OFFLINE_DIFFRETURN_EXPATT = 16, OFFLINE_DIFFRETURN_FA = 32, OFFLINE_DIFFRETURN_CFA = 64; */</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  cvmod(opuser6, _ksepi_diffusion_returnmode.minval, _ksepi_diffusion_returnmode.maxval, _ksepi_diffusion_returnmode.defval, _ksepi_diffusion_returnmode.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  opuser6 = (float) _ksepi_diffusion_returnmode.defval;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  if (opdiffuse) {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    piuset |= use6;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    piuset &amp;= ~use6;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  cvmod(opuser7, _ksepi_swi_returnmode.minval, _ksepi_swi_returnmode.maxval, _ksepi_swi_returnmode.defval, _ksepi_swi_returnmode.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  opuser7 = (float) _ksepi_swi_returnmode.defval;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  if (oppseq != PSD_SE) { <span class="comment">/* show for GE variants (PSD_GE, PSD_SPGR, ...) */</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   piuset |= use7;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   piuset &amp;= ~use7;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   cvoverride(<a class="code" href="ksepi__implementation_8e.html#a48246f40836694cfd04f40280dbe17f6">ksepi_swi_returnmode</a>, 0, PSD_FIX_OFF, PSD_EXIST_OFF);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="comment">/* make FLEET volume for GRAPPA calibration  */</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  _ksepi_fleet.defval = !<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>; <span class="comment">/* Default off for 3D */</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  cvmod(opuser8, _ksepi_fleet.minval, _ksepi_fleet.maxval, _ksepi_fleet.defval, _ksepi_fleet.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  opuser8 = (float) _ksepi_fleet.defval;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  if (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> || <a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> == TRUE)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    piuset &amp;= ~use8;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    piuset |= use8;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  <span class="comment">/* Number of phase reference lines for ghost correction per shot */</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  cvdef(<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a>, 0);</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> = _ksepi_reflines.defval;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  cvmod(opuser9, _ksepi_reflines.minval, _ksepi_reflines.maxval, _ksepi_reflines.defval, _ksepi_reflines.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  opuser9 = (float) _ksepi_reflines.defval;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  if (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> || <a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> == TRUE)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    piuset &amp;= ~use9;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    piuset |= use9;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    piuset |= use12;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    cvdef(<a class="code" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a>, 1);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    piuset &amp;= ~use12;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    cvdef(<a class="code" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a>, 0);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a> = _ksepi_rf3Dopt.defval;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  cvmod(opuser12, _ksepi_rf3Dopt.minval, _ksepi_rf3Dopt.maxval, _ksepi_rf3Dopt.defval, <span class="stringliteral">&quot;Choose 3D RF&quot;</span>, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  opuser12 = (float) _ksepi_rf3Dopt.defval;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  if (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    cvmod(opuser15, _ksepi_kz_nacslines.minval, _ksepi_kz_nacslines.maxval, _ksepi_kz_nacslines.defval, _ksepi_kz_nacslines.descr, 0, <span class="stringliteral">&quot; &quot;</span>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    opuser15 = (int) _ksepi_kz_nacslines.defval;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    piuset |= use15;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    piuset &amp;= ~use15;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  }</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">     Reserved opusers:</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">     ksepi_diffusion_predownload_setrecon(): opuser20-25 (needed by GE&#39;s recon)</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">     ksepi_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="comment">/* Acceleration menu (max accel = 4). But we don&#39;t show ARC for 2D */</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a>(<a class="code" href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a>, 4);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <span class="comment">/* multi-shot button (see also ksepi_eval_UI()) */</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  pishotnub = 63;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    pishotval2 = 8;</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    pishotval3 = 12;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    pishotval4 = 16;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    pishotval5 = 24;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    pishotval6 = 32;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    cvdef(opnshots, 16);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;} <span class="keywordflow">else</span> {</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    pishotval2 = 1;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    pishotval3 = 2;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    pishotval4 = 4;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    pishotval5 = 8;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    pishotval6 = 16;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    cvdef(opnshots, 1);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  cvmin(opnshots, 1);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  cvmax(opnshots, 512);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  opnshots = _opnshots.defval;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">/* Make R/L freq encoding attempts (a la epi2.e) */</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="keywordflow">if</span> ((TX_COIL_LOCAL == getTxCoilType() &amp;&amp; (exist(opplane) == PSD_AXIAL || exist(opplane)== PSD_COR) ) ||</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      (TX_COIL_LOCAL == getTxCoilType() &amp;&amp;  exist(opplane) == PSD_OBL &amp;&amp; existcv(opplane) &amp;&amp; (exist(opobplane) == PSD_AXIAL || exist(opobplane) == PSD_COR) )) {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      piswapfc = 1;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      piswapfc = 0;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">/* Diffusion init */</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  status = <a class="code" href="ksepi__implementation__diffusion_8e.html#a34732cddbd5e8a878cd9f00fd4c05ece">ksepi_diffusion_init_UI</a>();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;} <span class="comment">/* ksepi_init_UI() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6f4a9dd77c3d0d85845fbaceae04efa384a6dbf705a5fdf85efd0fb9fe33317">KS_ACCELMENU_INT</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1747</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a97c618e8b43b5e2bf69f22ec58808bea"><div class="ttname"><a href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a></div><div class="ttdeci">int ksepi_rf3Dopt</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:118</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa30bc912f81e467781febda7c6d3da03"><div class="ttname"><a href="ksepi__implementation_8e.html#aa30bc912f81e467781febda7c6d3da03">ksepi_rampsampling</a></div><div class="ttdeci">int ksepi_rampsampling</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:129</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6ea932f1fd0cfa98b2f37e829e67a8f8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a></div><div class="ttdeci">int ksepi_multishot_control</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:186</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_a34732cddbd5e8a878cd9f00fd4c05ece"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#a34732cddbd5e8a878cd9f00fd4c05ece">ksepi_diffusion_init_UI</a></div><div class="ttdeci">STATUS ksepi_diffusion_init_UI()</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:159</div></div>
<div class="ttc" id="_g_e_required_8e_html_a05e7d139f5f41deb6ed1c934ed6c6e64"><div class="ttname"><a href="_g_e_required_8e.html#a05e7d139f5f41deb6ed1c934ed6c6e64">GEReq_init_accelUI</a></div><div class="ttdeci">STATUS GEReq_init_accelUI(int integeraccel, int maxaccel)</div><div class="ttdoc">Sets up the menu for parallel imaging (ARC or ASSET) with max/min range</div><div class="ttdef"><b>Definition:</b> GERequired.e:427</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a48246f40836694cfd04f40280dbe17f6"><div class="ttname"><a href="ksepi__implementation_8e.html#a48246f40836694cfd04f40280dbe17f6">ksepi_swi_returnmode</a></div><div class="ttdeci">int ksepi_swi_returnmode</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:172</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a780ca0306bbc21c57cd8d676bd8bedab"><div class="ttname"><a href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a></div><div class="ttdeci">int ksepi_onlinerecon</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:183</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a391cb70899387075c448742de89ca842"><div class="ttname"><a href="ksepi__implementation_8e.html#a391cb70899387075c448742de89ca842">KSEPI_MAXRBW_NORAMPSAMPLING</a></div><div class="ttdeci">#define KSEPI_MAXRBW_NORAMPSAMPLING</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:35</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa7d0418e6cad024520674d7d4d0eb0ec"><div class="ttname"><a href="ksepi__implementation_8e.html#aa7d0418e6cad024520674d7d4d0eb0ec">ksepi_kissoff_factor</a></div><div class="ttdeci">float ksepi_kissoff_factor</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:119</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3924b871f6b8dc8eb70a6512c62e6946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3924b871f6b8dc8eb70a6512c62e6946">&#9670;&nbsp;</a></span>ksepi_eval_UI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_UI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Gets the current UI and checks for valid inputs</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                       {</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  STATUS status;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a66351df684e62e29938634fa21c75518">ksepi_init_UI</a>() == FAILURE)</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  <span class="comment">/*** Copy UserCVs to human readable CVs ***/</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  <span class="keywordflow">if</span> (existcv(opautote) &amp;&amp; opautote == PSD_MINTE) {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a29bfef1205483936f24f54560f52b58b">ksepi_kynover</a> = (int) opuser1;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> (ksepi_kynover &lt; _ksepi_kynover.minval || ksepi_kynover &gt; _ksepi_kynover.maxval)</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;&#39;#extralines for minTE&#39; is out of range&quot;</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a> = (int) opuser2;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a> != <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a> &amp;&amp; <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a> != <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a>) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;The EPI blip sign must be either +1 or -1&quot;</span>); <span class="comment">/* User error */</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  }</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> = (int) opuser3;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> != FALSE &amp;&amp; <a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> != TRUE) {</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;Recon flag must be 0 or 1&quot;</span>); <span class="comment">/* User error */</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  }</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;  <span class="comment">/* ksepi_ky_R = 1 means that k-space is fully sampled over opnshots TR</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">     ksepi_ky_R = opnshots means that k-space is sampled once with undersampling factor of opnshots</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">     See also ksepi_pg()-&gt;ks_phaseencoding_generate_epi() where multiple phase encoding plans are set up. */</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a> = opaccel_ph_stride;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a> = opnshots;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  <span class="keywordflow">if</span> (opnshots % <a class="code" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a> != 0) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;R must be an integer factor of opnshots&quot;</span>); <span class="comment">/* User error */</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <span class="comment">/* Reserved opusers:</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">     -----------------</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment">     ksepi_diffusion_predownload_setrecon(): opuser20-25 (needed by GE&#39;s recon)</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">     ksepi_eval_inversion(): opuser26-29</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">     GE reserves: opuser36-48 (epic.h)</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">/* Multi-shot (shown only if not online recon or ASSET. rhref = 5 cannot deal with multi-shot data) */</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> || (opasset == ASSET_SCAN)) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    pishotnub = 0; <span class="comment">/* hide multishot menu */</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    cvoverride(<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>, <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a>, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    piuset &amp;= ~use5;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    cvoverride(opnshots, 1, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    cvoverride(<a class="code" href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    piechnub = 0;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    autolock = 0; <span class="comment">/* don&#39;t save Pfiles by default if online recon. Can be manually overridden as any CV */</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a> = (int) (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? 0 : opuser5;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">if</span> (ksepi_multishot_control &lt; _ksepi_multishot_control.minval || ksepi_multishot_control &gt; _ksepi_multishot_control.maxval) {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;multishot control (CV5) must be in range [%d,%d]&quot;</span>, _ksepi_multishot_control.minval, _ksepi_multishot_control.maxval);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    cvoverride(opasset, FALSE, _opasset.fixedflag, _opasset.existflag); <span class="comment">/* force asset off, but keep exist/fixed status */</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    pishotnub = 63;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    piechnub = 63;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &lt; 26</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    autolock = 1; <span class="comment">/* save Pfiles by default if no online recon. Can be manually overridden as any CV */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    autolock = 0; <span class="comment">/* as of DV26+, we use Scan Archives instead of Pfiles for EPI */</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> == FALSE &amp;&amp; (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>)) {</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    piuset |= use6;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <a class="code" href="ksepi__implementation__diffusion_8e.html#a3647734e8ab891da7064804d9e0dc0ed">ksepi_diffusion_returnmode</a> = (int) opuser6;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    piuset &amp;= ~use6;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  }</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">/* Don&#39;t do the extra ghost correction volume (integrated refscan) if ETL = 1 */</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> == 1) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a> = FALSE;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a> = TRUE;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">/* Diffusion eval */</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  status = <a class="code" href="ksepi__implementation__diffusion_8e.html#a2706fa6ca011478e2252a6c77d67bb3f">ksepi_diffusion_eval_UI</a>();</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a48246f40836694cfd04f40280dbe17f6">ksepi_swi_returnmode</a> = (int) opuser7;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a> == FALSE) {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> = (int) opuser8;</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> = (int) opuser9;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    cvoverride(<a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a>, FALSE, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    cvoverride(<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a>, 0, PSD_FIX_OFF, PSD_EXIST_ON);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a> = (int) opuser12;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a2c46570eed7a4f4e2596939555729492">ksepi_kz_nacslines</a> = (int) opuser15;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;} <span class="comment">/* ksepi_eval_UI() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a29bfef1205483936f24f54560f52b58b"><div class="ttname"><a href="ksepi__implementation_8e.html#a29bfef1205483936f24f54560f52b58b">ksepi_kynover</a></div><div class="ttdeci">int ksepi_kynover</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:142</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af5c5180eb0689126316981a3ac4f6173"><div class="ttname"><a href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a></div><div class="ttdeci">int ksepi_blipsign</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:140</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_a2706fa6ca011478e2252a6c77d67bb3f"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#a2706fa6ca011478e2252a6c77d67bb3f">ksepi_diffusion_eval_UI</a></div><div class="ttdeci">STATUS ksepi_diffusion_eval_UI()</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:287</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a97c618e8b43b5e2bf69f22ec58808bea"><div class="ttname"><a href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a></div><div class="ttdeci">int ksepi_rf3Dopt</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:118</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a92d0943acffeeec5fe3f57110b28f7ac"><div class="ttname"><a href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a></div><div class="ttdeci">int ksepi_ghostcorr</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:184</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6ea932f1fd0cfa98b2f37e829e67a8f8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a></div><div class="ttdeci">int ksepi_multishot_control</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:186</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a2c46570eed7a4f4e2596939555729492"><div class="ttname"><a href="ksepi__implementation_8e.html#a2c46570eed7a4f4e2596939555729492">ksepi_kz_nacslines</a></div><div class="ttdeci">int ksepi_kz_nacslines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:146</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a263548cf715f98526edee92b52818db2"><div class="ttname"><a href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a></div><div class="ttdeci">int ksepi_fleet</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:158</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:94</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_EPI::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1690</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ab383faf358ba44a390fbe0b4c094a352"><div class="ttname"><a href="ksepi__implementation_8e.html#ab383faf358ba44a390fbe0b4c094a352">ksepi_ky_R</a></div><div class="ttdeci">int ksepi_ky_R</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:144</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_a3647734e8ab891da7064804d9e0dc0ed"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#a3647734e8ab891da7064804d9e0dc0ed">ksepi_diffusion_returnmode</a></div><div class="ttdeci">int ksepi_diffusion_returnmode</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:61</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a48246f40836694cfd04f40280dbe17f6"><div class="ttname"><a href="ksepi__implementation_8e.html#a48246f40836694cfd04f40280dbe17f6">ksepi_swi_returnmode</a></div><div class="ttdeci">int ksepi_swi_returnmode</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:172</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a66351df684e62e29938634fa21c75518"><div class="ttname"><a href="ksepi__implementation_8e.html#a66351df684e62e29938634fa21c75518">ksepi_init_UI</a></div><div class="ttdeci">STATUS ksepi_init_UI(void)</div><div class="ttdoc">Initial setup of user interface (UI) with default values for menus and fields</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:402</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a780ca0306bbc21c57cd8d676bd8bedab"><div class="ttname"><a href="ksepi__implementation_8e.html#a780ca0306bbc21c57cd8d676bd8bedab">ksepi_onlinerecon</a></div><div class="ttdeci">int ksepi_onlinerecon</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:183</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a215d0bcbe326951a1ff9415e34bb6916"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a215d0bcbe326951a1ff9415e34bb6916">&#9670;&nbsp;</a></span>ksepi_eval_setuprf_3dexc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_setuprf_3dexc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_l_r_f.html">KS_SELRF</a> *&#160;</td>
          <td class="paramname"><em>selrfexc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>rf3Dopt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                                                 {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    selrfexc-&gt;<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a8961bb2e53bc59067fd9ea04f974a42f">spsp_ss30260334</a>; <span class="comment">/* 3T SPSP */</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    selrfexc-&gt;<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#accc7d0e206068fe8e70dc3b2c4576e3c">spsp_ss30260334_gz</a>; <span class="comment">/* normalized to 1 G/cm */</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <span class="keywordflow">if</span> (rf3Dopt &gt; 0) {</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <span class="keywordflow">if</span> (exist(opslquant) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>) &gt;= 150) {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="comment">/* 150 mm pulses goes here */</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        selrfexc-&gt;<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>       = exc_SPSP3D_150mm_stbw10_etbw4_lin_lin; <span class="comment">/* 3T SPSP */</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        selrfexc-&gt;<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a> = exc_SPSP3D_150mm_stbw10_etbw4_lin_lin_gz; <span class="comment">/* normalized to 1 G/cm */</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    } <span class="comment">/* rf3Dopt &gt; 0 */</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordtype">char</span> tmpstr[<a class="code" href="_k_s_foundation_8h.html#aacb2fe1d83c45e8d0525f363bdd6b8a6">KS_DESCRIPTION_LENGTH</a>+20];</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    sprintf(tmpstr, <span class="stringliteral">&quot;Choose 3D RF [%s]&quot;</span>, selrfexc-&gt;<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7e99b5f31d2f7e896e6184a22d042e6f">designinfo</a>);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    cvdesc(opuser12, tmpstr);</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;}</div><div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a8961bb2e53bc59067fd9ea04f974a42f"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a8961bb2e53bc59067fd9ea04f974a42f">spsp_ss30260334</a></div><div class="ttdeci">const KS_RF spsp_ss30260334</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:120</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7e99b5f31d2f7e896e6184a22d042e6f"><div class="ttname"><a href="struct_k_s___r_f.html#a7e99b5f31d2f7e896e6184a22d042e6f">KS_RF::designinfo</a></div><div class="ttdeci">KS_DESCRIPTION designinfo</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:796</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aacb2fe1d83c45e8d0525f363bdd6b8a6"><div class="ttname"><a href="_k_s_foundation_8h.html#aacb2fe1d83c45e8d0525f363bdd6b8a6">KS_DESCRIPTION_LENGTH</a></div><div class="ttdeci">#define KS_DESCRIPTION_LENGTH</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:112</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_accc7d0e206068fe8e70dc3b2c4576e3c"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#accc7d0e206068fe8e70dc3b2c4576e3c">spsp_ss30260334_gz</a></div><div class="ttdeci">const KS_WAVE spsp_ss30260334_gz</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:122</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56cdd966749fa80f8042934a7e7d4565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56cdd966749fa80f8042934a7e7d4565">&#9670;&nbsp;</a></span>ksepi_eval_setuprf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_setuprf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            {</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">/* selective RF excitation */</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordflow">if</span> (opfat || <a class="code" href="ksepi__implementation_8e.html#adad2255b3c8f58fd69bb45e53ef978e0">ksepi_fse90</a> == TRUE) {</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a2c2f3ffff089ec8ea84810bdc2cba295">exc_fse90</a>; <span class="comment">/* KSFoundation_GERF.h */</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a>); <span class="comment">/* clear gradwave */</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a> == 30000) {</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a215d0bcbe326951a1ff9415e34bb6916">ksepi_eval_setuprf_3dexc</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <a class="code" href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a>) == FAILURE)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="comment">/* In 2D always use the standard GE pulse for now */</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a8961bb2e53bc59067fd9ea04f974a42f">spsp_ss30260334</a>; <span class="comment">/* 3T SPSP */</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#accc7d0e206068fe8e70dc3b2c4576e3c">spsp_ss30260334_gz</a>; <span class="comment">/* normalized to 1 G/cm */</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      }</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a79d3ba8100f3bbab8841bbb8873cd480">spsp_ss1528822</a>; <span class="comment">/* 1.5T SPSP */</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">gradwave</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#ac9a44282555274855bccdaec36b821d7">spsp_ss1528822_gz</a>; <span class="comment">/* normalized to 1 G/cm */</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    }</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  } <span class="comment">/* RF Excitation */</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  <span class="keywordflow">if</span> (acq_type == TYPSPIN)</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = 90.0; <span class="comment">/* always 90 FA for SE-EPI */</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip; <span class="comment">/* variable FA for GE-EPI */</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    cvoverride(opvthick, exist(opslquant) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>), _opslquant.fixedflag, existcv(opslquant));</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> = (exist(opslquant) - 2 * pislblank) * exist(<a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> = <a class="code" href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a>;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  }</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <span class="comment">/* Don&#39;t oversize slices for 3D */</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#ac2153981cac63a088fccb065a037f4bf">ksepi_gscalerfexc</a> = (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? 1.0 : 0.9;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#aa8b8ac5372fc8e417349e8108d418a47">ksepi_gscalerfref</a> = (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) ? 1.0 : 0.9;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> / <a class="code" href="ksepi__implementation_8e.html#ac2153981cac63a088fccb065a037f4bf">ksepi_gscalerfexc</a>;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;rfexc&quot;</span>) == FAILURE)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">/* selective RF refocusing */</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordflow">if</span> (acq_type == TYPSPIN) {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip; <span class="comment">/* since pifamode = PSD_FLIP_ANGLE_MODE_REFOCUS when TYPSPIN */</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> / <a class="code" href="ksepi__implementation_8e.html#aa8b8ac5372fc8e417349e8108d418a47">ksepi_gscalerfref</a>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="ksepi__implementation_8e.html#af88b8a2d84931db5714dc80942c08842">ksepi_crusherscale</a>;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, <span class="stringliteral">&quot;rfref&quot;</span>) == FAILURE)</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>); <span class="comment">/* GE-EPI: reset to default values (incl. zero .duration) */</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <span class="comment">/* selective RF refocusing with diffusion and opdualspinecho */</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">if</span> (acq_type == TYPSPIN &amp;&amp; opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; opdualspinecho) {</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a> = <a class="code" href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = opflip; <span class="comment">/* since pifamode = PSD_FLIP_ANGLE_MODE_REFOCUS when TYPSPIN */</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a> = <a class="code" href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a> / <a class="code" href="ksepi__implementation_8e.html#aa8b8ac5372fc8e417349e8108d418a47">ksepi_gscalerfref</a>;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">crusherscale</a> = <a class="code" href="ksepi__implementation_8e.html#af88b8a2d84931db5714dc80942c08842">ksepi_crusherscale</a> * <a class="code" href="ksepi__implementation__diffusion_8e.html#af7c42c64a5b033082b2070c63b90d2ce">ksepi_diffusion_2ndcrushfact</a>; <span class="comment">/* ksepi_diffusion_2ndcrushfact times bigger crushers to avoid stimulated echoes */</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>, <span class="stringliteral">&quot;rfref2&quot;</span>) == FAILURE)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>); <span class="comment">/* Not opdualspinecho diffusion: reset to default values (incl. zero .duration) */</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;} <span class="comment">/* ksepi_eval_setuprf() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_ad59c67febb3e502669472ea5c7a0a9a2"><div class="ttname"><a href="ksepi__implementation_8e.html#ad59c67febb3e502669472ea5c7a0a9a2">ksepi_excthickness</a></div><div class="ttdeci">float ksepi_excthickness</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:112</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a8961bb2e53bc59067fd9ea04f974a42f"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a8961bb2e53bc59067fd9ea04f974a42f">spsp_ss30260334</a></div><div class="ttdeci">const KS_RF spsp_ss30260334</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:120</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a86e5857ac625807c2dedd669cb11ede9"><div class="ttname"><a href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a></div><div class="ttdeci">STATUS ks_eval_selrf1(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1779</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a97c618e8b43b5e2bf69f22ec58808bea"><div class="ttname"><a href="ksepi__implementation_8e.html#a97c618e8b43b5e2bf69f22ec58808bea">ksepi_rf3Dopt</a></div><div class="ttdeci">int ksepi_rf3Dopt</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:118</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af88b8a2d84931db5714dc80942c08842"><div class="ttname"><a href="ksepi__implementation_8e.html#af88b8a2d84931db5714dc80942c08842">ksepi_crusherscale</a></div><div class="ttdeci">float ksepi_crusherscale</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:123</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a607347e9c1c7a9eef21fff556faccc3f"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a607347e9c1c7a9eef21fff556faccc3f">KS_SELRF::gradwave</a></div><div class="ttdeci">KS_WAVE gradwave</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1342</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a7f69114669ee63f8e3d2f37956cabd49"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a7f69114669ee63f8e3d2f37956cabd49">ref_se1b4</a></div><div class="ttdeci">const KS_RF ref_se1b4</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:88</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_af7c42c64a5b033082b2070c63b90d2ce"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#af7c42c64a5b033082b2070c63b90d2ce">ksepi_diffusion_2ndcrushfact</a></div><div class="ttdeci">float ksepi_diffusion_2ndcrushfact</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:60</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a79d3ba8100f3bbab8841bbb8873cd480"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a79d3ba8100f3bbab8841bbb8873cd480">spsp_ss1528822</a></div><div class="ttdeci">const KS_RF spsp_ss1528822</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:115</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_adad2255b3c8f58fd69bb45e53ef978e0"><div class="ttname"><a href="ksepi__implementation_8e.html#adad2255b3c8f58fd69bb45e53ef978e0">ksepi_fse90</a></div><div class="ttdeci">int ksepi_fse90</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:117</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ac2153981cac63a088fccb065a037f4bf"><div class="ttname"><a href="ksepi__implementation_8e.html#ac2153981cac63a088fccb065a037f4bf">ksepi_gscalerfexc</a></div><div class="ttdeci">float ksepi_gscalerfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:113</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa8b8ac5372fc8e417349e8108d418a47"><div class="ttname"><a href="ksepi__implementation_8e.html#aa8b8ac5372fc8e417349e8108d418a47">ksepi_gscalerfref</a></div><div class="ttdeci">float ksepi_gscalerfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:124</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a08b87aaf68a5eef056188032b386db46"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a08b87aaf68a5eef056188032b386db46">cffield</a></div><div class="ttdeci">float cffield</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3cb1d6e472e9061b0f4768d8985a442e"><div class="ttname"><a href="_k_s_foundation_8h.html#a3cb1d6e472e9061b0f4768d8985a442e">ks_init_selrf</a></div><div class="ttdeci">void ks_init_selrf(KS_SELRF *selrf)</div><div class="ttdoc">Resets a KS_SELRF sequence object to its default value (KS_INIT_SELRF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:65</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_ac9a44282555274855bccdaec36b821d7"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#ac9a44282555274855bccdaec36b821d7">spsp_ss1528822_gz</a></div><div class="ttdeci">const KS_WAVE spsp_ss1528822_gz</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:117</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_a2c2f3ffff089ec8ea84810bdc2cba295"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#a2c2f3ffff089ec8ea84810bdc2cba295">exc_fse90</a></div><div class="ttdeci">const KS_RF exc_fse90</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:46</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5e361f25d617a7522e7a14d0cba41c77"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5e361f25d617a7522e7a14d0cba41c77">KS_SELRF::crusherscale</a></div><div class="ttdeci">float crusherscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1337</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a215d0bcbe326951a1ff9415e34bb6916"><div class="ttname"><a href="ksepi__implementation_8e.html#a215d0bcbe326951a1ff9415e34bb6916">ksepi_eval_setuprf_3dexc</a></div><div class="ttdeci">STATUS ksepi_eval_setuprf_3dexc(KS_SELRF *selrfexc, int rf3Dopt)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:1027</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_abed769d29c48283fc675de705f3c9e71"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">KSEPI_SEQUENCE::selrfref2</a></div><div class="ttdeci">KS_SELRF selrfref2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:60</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a04f737cdd207318e145bbed14eb487ae"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a04f737cdd207318e145bbed14eb487ae">opslthick</a></div><div class="ttdeci">float opslthick</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa2b37fa5aa0bffff1de8ca29e7c19cc1"><div class="ttname"><a href="_k_s_foundation_8h.html#aa2b37fa5aa0bffff1de8ca29e7c19cc1">ks_init_wave</a></div><div class="ttdeci">void ks_init_wave(KS_WAVE *wave)</div><div class="ttdoc">Resets a KS_WAVE sequence object to its default value (KS_INIT_WAVE)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:53</div></div>
<div class="ttc" id="_k_s_foundation___g_e_r_f_8h_html_accc7d0e206068fe8e70dc3b2c4576e3c"><div class="ttname"><a href="_k_s_foundation___g_e_r_f_8h.html#accc7d0e206068fe8e70dc3b2c4576e3c">spsp_ss30260334_gz</a></div><div class="ttdeci">const KS_WAVE spsp_ss30260334_gz</div><div class="ttdef"><b>Definition:</b> KSFoundation_GERF.h:122</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ceed1499e08a606d3908355149c669c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ceed1499e08a606d3908355149c669c">&#9670;&nbsp;</a></span>ksepi_eval_setupfleet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_setupfleet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                               {</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">flip</a> = <a class="code" href="ksepi__implementation_8e.html#a72e12979bfb35fc8b2f603dab67c6477">ksepi_fleet_flip</a>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, <span class="stringliteral">&quot;fleetrfexc&quot;</span>) == FAILURE)</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <span class="comment">/* echo time shifting */</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <span class="comment">/*** Set up a pair of wait objects that are used to shift back the RF up to the echospacing ***/</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>,<span class="stringliteral">&quot;ksepi_fleet_wait_pre&quot;</span>, GRAD_UPDATE_TIME) == FAILURE) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>,<span class="stringliteral">&quot;ksepi_fleet_wait_post&quot;</span>, <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> - GRAD_UPDATE_TIME) == FAILURE) {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = IMin(2, </div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                                RUP_FACTOR((<span class="keywordtype">int</span>) <a class="code" href="ksepi__implementation_8e.html#a6482961dc4df2cb9fccfcdcc6fa122c8">ksepi_fleet_num_ky</a>, 2), <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                                (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> != 0) ? (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>/2 + abs(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a>)) : <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0; <span class="comment">/* no partial Fourier for FLEET */</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = IMax(2, 1, IMin(2, <a class="code" href="ksepi__implementation_8e.html#a4943b888caa1b27d937ce1a42a27fa2f">ksepi_fleet_num_kz</a>, opslquant));</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  </div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a77fb9dea403599e8fbbf1fed426ff66e">ks_eval_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, <span class="stringliteral">&quot;epifleet&quot;</span>, <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a>) == FAILURE)</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = <a class="code" href="ksepi__implementation_8e.html#ab4c674d9d559aa8b6ed732fffddf4216">ksepi_spoilerarea</a>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <span class="stringliteral">&quot;fleetspoiler&quot;</span>) == FAILURE)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  strcpy(<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, <span class="stringliteral">&quot;ksepifleet&quot;</span>);</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;}</div><div class="ttc" id="ksepi__implementation_8e_html_ab4c674d9d559aa8b6ed732fffddf4216"><div class="ttname"><a href="ksepi__implementation_8e.html#ab4c674d9d559aa8b6ed732fffddf4216">ksepi_spoilerarea</a></div><div class="ttdeci">float ksepi_spoilerarea</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:115</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a86e5857ac625807c2dedd669cb11ede9"><div class="ttname"><a href="_k_s_foundation_8h.html#a86e5857ac625807c2dedd669cb11ede9">ks_eval_selrf1</a></div><div class="ttdeci">STATUS ks_eval_selrf1(KS_SELRF *selrf, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_SELRF object for RF slice selection with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:1779</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_FLEET_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:81</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_FLEET_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:85</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ad76a5ac226f0d25f70349ef83b5bc38a"><div class="ttname"><a href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">KS_EPI::zphaser</a></div><div class="ttdeci">KS_PHASER zphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1689</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a72e12979bfb35fc8b2f603dab67c6477"><div class="ttname"><a href="ksepi__implementation_8e.html#a72e12979bfb35fc8b2f603dab67c6477">ksepi_fleet_flip</a></div><div class="ttdeci">float ksepi_fleet_flip</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:159</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6482961dc4df2cb9fccfcdcc6fa122c8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6482961dc4df2cb9fccfcdcc6fa122c8">ksepi_fleet_num_ky</a></div><div class="ttdeci">int ksepi_fleet_num_ky</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:161</div></div>
<div class="ttc" id="struct_k_s___r_f_html_a7ab9fec3ad0848d2dff5db7279f1a806"><div class="ttname"><a href="struct_k_s___r_f.html#a7ab9fec3ad0848d2dff5db7279f1a806">KS_RF::flip</a></div><div class="ttdeci">float flip</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:789</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_g_e_required_8e_html_a7506e6224f5036fb1941843536b6f4a6"><div class="ttname"><a href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a></div><div class="ttdeci">float ks_qfact</div><div class="ttdef"><b>Definition:</b> GERequired.e:240</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad0d05a33cfe5de925f28709883a37abc"><div class="ttname"><a href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a></div><div class="ttdeci">void ks_init_wait(KS_WAIT *wait)</div><div class="ttdoc">Resets a KS_WAIT sequence object to its default value (KS_INIT_WAIT)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:49</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_FLEET_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:83</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_FLEET_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:86</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aabacf1e670ae0faa4af8cd75d02778e7"><div class="ttname"><a href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a></div><div class="ttdeci">STATUS ks_eval_wait(KS_WAIT *wait, const char *const desc, int maxduration) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a wait pulse using a KS_WAIT sequence object</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:179</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">KS_PHASER::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1528</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_FLEET_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:84</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a77fb9dea403599e8fbbf1fed426ff66e"><div class="ttname"><a href="_k_s_foundation_8h.html#a77fb9dea403599e8fbbf1fed426ff66e">ks_eval_epi</a></div><div class="ttdeci">STATUS ks_eval_epi(KS_EPI *epi, const char *const desc, float quietnessfactor) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_EPI composite sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2867</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a4943b888caa1b27d937ce1a42a27fa2f"><div class="ttname"><a href="ksepi__implementation_8e.html#a4943b888caa1b27d937ce1a42a27fa2f">ksepi_fleet_num_kz</a></div><div class="ttdeci">int ksepi_fleet_num_kz</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:162</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_FLEET_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:82</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d92158be6188de2ff69e0b7e933dc8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d92158be6188de2ff69e0b7e933dc8d">&#9670;&nbsp;</a></span>ksepi_eval_setupobjects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_setupobjects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets up all sequence objects for the main sequence module (<a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksepi sequence">KSEPI_SEQUENCE</a> ksepi)</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                 {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">/* All RF related setup in separate function */</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a56cdd966749fa80f8042934a7e7d4565">ksepi_eval_setuprf</a>() == FAILURE)</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="comment">/* EPI readout */</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a035bb76f8cc944eff7afd9333c2688e3">read_spacing</a> = <a class="code" href="ksepi__implementation_8e.html#a17ac65e8574291f8d9d274a7553bf15d">ksepi_readlobegap</a>;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">acq</a>.<a class="code" href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">rbw</a> = oprbw;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a>;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR(<a class="code" href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a>, 2); <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">rampsampling</a> = <a class="code" href="ksepi__implementation_8e.html#aa30bc912f81e467781febda7c6d3da03">ksepi_rampsampling</a>;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0; <span class="comment">/* never partial Fourier in kx for EPI */</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> * opphasefov;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = RUP_FACTOR((<span class="keywordtype">int</span>) (<a class="code" href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a> * opphasefov), 2); <span class="comment">/* round up (RUP) to nearest multiple of 2 */</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">/* upsample to nearest power of 2 for res up to 256. For higher matrix sizes, use native res</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">     KSFoundation.h: {KS_IMSIZE_NATIVE, KS_IMSIZE_POW2, KS_IMSIZE_MIN256} */</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a> &lt; 256 &amp;&amp; <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> &lt; 256) {</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a25ba61305798e6f6ba10cf186493afc2">ksepi_imsize</a> = <a class="code" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a>;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a25ba61305798e6f6ba10cf186493afc2">ksepi_imsize</a> = <a class="code" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">if</span> (opautote == PSD_MINTE) <span class="comment">/* partial Fourier in ky */</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = <a class="code" href="ksepi__implementation_8e.html#a29bfef1205483936f24f54560f52b58b">ksepi_kynover</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="keywordflow">if</span> (opasset == ASSET_SCAN) {</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">/* ASSET acceleration, without acs lines (since 2nd arg = 0) */</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>, 0, opaccel_ph_stride) == FAILURE)</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">/* R is used as multishot if not ASSET has been selected */</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> = opnshots; <span class="comment">/* using multi-shot to accelerate EPI readout */</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">nacslines</a> = 0; <span class="comment">/* never have acs lines for EPI */</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  }</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="comment">/* z phase encoding gradient for the 3D case (one zphase enc. per TR, not real 3D EPI) */</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) { <span class="comment">/* PSD_3D or PSD_3DM */</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a23e2186cee0d7569231661df9e65cf51">ksepi_kz_R</a> = opaccel_sl_stride;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">fov</a> = opvthick;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = IMax(2, 1, opslquant);</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = IMin(2, <a class="code" href="ksepi__implementation_8e.html#a258744bff37289b369a855aac21501fc">ksepi_kznover</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>/2);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a> = <a class="code" href="ksepi__implementation_8e.html#a23e2186cee0d7569231661df9e65cf51">ksepi_kz_R</a>;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">nacslines</a> = <a class="code" href="ksepi__implementation_8e.html#a2c46570eed7a4f4e2596939555729492">ksepi_kz_nacslines</a>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>; <span class="comment">/* ks_eval_epi will clear zphaser if res &lt;= 1 */</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a77fb9dea403599e8fbbf1fed426ff66e">ks_eval_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, <span class="stringliteral">&quot;epi&quot;</span>, <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a>) == FAILURE) {</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  }</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  <span class="comment">/* echo time shifting */</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">/*** Set up a pair of wait objects that are used to shift back the RF up to the echospacing ***/</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>/<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> = RUP_GRD((<span class="keywordtype">int</span>) (<a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> * (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>-1))) + GRAD_UPDATE_TIME;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>,<span class="stringliteral">&quot;ksepi_wait_pre&quot;</span>, GRAD_UPDATE_TIME) == FAILURE) {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>,<span class="stringliteral">&quot;ksepi_wait_post&quot;</span>, <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> - GRAD_UPDATE_TIME) == FAILURE) {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    }</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; 0) {</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">nover</a> = 0;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a> = <a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> * <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a77fb9dea403599e8fbbf1fed426ff66e">ks_eval_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, <span class="stringliteral">&quot;epireflines&quot;</span>, <a class="code" href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a>) == FAILURE) {</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="keywordflow">else</span> {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ad06a3c6b22c54585d66b17eae440e6f7">ks_init_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>);</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  }</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">/* Flow comp */</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordflow">if</span> (opfcomp == TRUE) {</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a60d24c9932e42095ed00b0409d207f71">ksepi_fcy</a>) {</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="comment">/* Y: Need two extra phase gradients for flowcomp */</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a205256f70ffcd95c6248717004c24ce1">ksepi_eval_flowcomp_phase</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, <span class="stringliteral">&quot;fcompphase&quot;</span>) == FAILURE)</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#aa319748c312e4b8fad896f728e7e2b3f">ksepi_fcz</a>) {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="comment">/* Z: Add second z rephaser to complete 0th and 1st moment nulling of slice selection */</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = -<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a>;</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>, <span class="stringliteral">&quot;fcompslice2&quot;</span>) == FAILURE)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">return</span> FAILURE;   </div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="comment">/* Z: Now, make normal z rephaser twice as large */</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> *= 2;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>, <span class="stringliteral">&quot;rfexc.reph_fc1&quot;</span>) == FAILURE)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  } <span class="comment">/* opfcomp */</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">/* It is useful to be able to see the current echo spacing in DisplayCV to determine distortion levels etc */</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  cvoverride(<a class="code" href="ksepi__implementation_8e.html#ac6489b25909a89dfeb427e0482429801">ksepi_esp</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a035bb76f8cc944eff7afd9333c2688e3">read_spacing</a>, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">/* for consistency, set opetl to the actual one for the EPI train even though ETL menu should never be visible for EPI */</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  cvoverride(opetl, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a>, PSD_FIX_ON, PSD_EXIST_ON);</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="comment">/* protect against too long sequence. It appears that opnecho * ksepi.epitrain.etl cannot be &gt;= 1024 */</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a> * opnecho &gt;= 1024)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;# readouts &gt;= 1024. Please reduce echoes, phase res. or increase NumShots&quot;</span>);</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="comment">/* post-read ksepi.spoiler */</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">area</a> = <a class="code" href="ksepi__implementation_8e.html#ab4c674d9d559aa8b6ed732fffddf4216">ksepi_spoilerarea</a>;</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, <span class="stringliteral">&quot;spoiler&quot;</span>) == FAILURE)</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">/* diffusion weighting */</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="comment">/* set up the diffusion gradient objects in &#39;ksepi&#39;. If opdiffuse != KS_EPI_DIFFUSION_ON,</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">    this function will reset the diffusion objects */</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation__diffusion_8e.html#af4bfad35c1c019b945e472a3b596ecba">ksepi_diffusion_eval_gradients_TE</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>) == FAILURE)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">/* init seqctrl */</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  strcpy(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">description</a>, <span class="stringliteral">&quot;ksepimain&quot;</span>);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  <span class="comment">/* Setup FLEET sequence */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a3ceed1499e08a606d3908355149c669c">ksepi_eval_setupfleet</a>() == FAILURE)</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;} <span class="comment">/* ksepi_eval_setupobjects() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a17ac65e8574291f8d9d274a7553bf15d"><div class="ttname"><a href="ksepi__implementation_8e.html#a17ac65e8574291f8d9d274a7553bf15d">ksepi_readlobegap</a></div><div class="ttdeci">int ksepi_readlobegap</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:130</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ab4c674d9d559aa8b6ed732fffddf4216"><div class="ttname"><a href="ksepi__implementation_8e.html#ab4c674d9d559aa8b6ed732fffddf4216">ksepi_spoilerarea</a></div><div class="ttdeci">float ksepi_spoilerarea</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:115</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a23e2186cee0d7569231661df9e65cf51"><div class="ttname"><a href="ksepi__implementation_8e.html#a23e2186cee0d7569231661df9e65cf51">ksepi_kz_R</a></div><div class="ttdeci">int ksepi_kz_R</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:145</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a29bfef1205483936f24f54560f52b58b"><div class="ttname"><a href="ksepi__implementation_8e.html#a29bfef1205483936f24f54560f52b58b">ksepi_kynover</a></div><div class="ttdeci">int ksepi_kynover</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:142</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118"><div class="ttname"><a href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1745</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a66aaa6a3300240048d37097ded69ba53"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a66aaa6a3300240048d37097ded69ba53">opxres</a></div><div class="ttdeci">int opxres</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a4762b9a6307f0223b3d1dfde7e8ddce8"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a4762b9a6307f0223b3d1dfde7e8ddce8">KS_PHASER::nacslines</a></div><div class="ttdeci">int nacslines</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1530</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a62476b720a40200e94668beec660cac0"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a62476b720a40200e94668beec660cac0">opyres</a></div><div class="ttdeci">int opyres</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a1e661325433fb0f29283f44babb61221"><div class="ttname"><a href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a></div><div class="ttdeci">float ksepi_echotime_shifting_shotdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:213</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a3ceed1499e08a606d3908355149c669c"><div class="ttname"><a href="ksepi__implementation_8e.html#a3ceed1499e08a606d3908355149c669c">ksepi_eval_setupfleet</a></div><div class="ttdeci">STATUS ksepi_eval_setupfleet()</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:1128</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa319748c312e4b8fad896f728e7e2b3f"><div class="ttname"><a href="ksepi__implementation_8e.html#aa319748c312e4b8fad896f728e7e2b3f">ksepi_fcz</a></div><div class="ttdeci">int ksepi_fcz</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:153</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ac6489b25909a89dfeb427e0482429801"><div class="ttname"><a href="ksepi__implementation_8e.html#ac6489b25909a89dfeb427e0482429801">ksepi_esp</a></div><div class="ttdeci">int ksepi_esp</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:135</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aa30bc912f81e467781febda7c6d3da03"><div class="ttname"><a href="ksepi__implementation_8e.html#aa30bc912f81e467781febda7c6d3da03">ksepi_rampsampling</a></div><div class="ttdeci">int ksepi_rampsampling</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:129</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ac6c0c1a7ad7a6b0ab69d5aedc27c36c7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">KSEPI_SEQUENCE::fcompphase</a></div><div class="ttdeci">KS_TRAP fcompphase</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:65</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#abfd94a01fc71278021802ca0d1e25e16">KS_READTRAP::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1425</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a2c46570eed7a4f4e2596939555729492"><div class="ttname"><a href="ksepi__implementation_8e.html#a2c46570eed7a4f4e2596939555729492">ksepi_kz_nacslines</a></div><div class="ttdeci">int ksepi_kz_nacslines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:146</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a258744bff37289b369a855aac21501fc"><div class="ttname"><a href="ksepi__implementation_8e.html#a258744bff37289b369a855aac21501fc">ksepi_kznover</a></div><div class="ttdeci">int ksepi_kznover</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:143</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ad76a5ac226f0d25f70349ef83b5bc38a"><div class="ttname"><a href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">KS_EPI::zphaser</a></div><div class="ttdeci">KS_PHASER zphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1689</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_html_a544d58cc06d73e0f73e464114f6e5318"><div class="ttname"><a href="struct_k_s___r_e_a_d.html#a544d58cc06d73e0f73e464114f6e5318">KS_READ::rbw</a></div><div class="ttdeci">float rbw</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:584</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a13aea1e02502f8276373928c87d0da3f"><div class="ttname"><a href="_k_s_foundation_8h.html#a13aea1e02502f8276373928c87d0da3f">ks_eval_phaser_setaccel</a></div><div class="ttdeci">STATUS ks_eval_phaser_setaccel(KS_PHASER *phaser, int min_acslines, float R) WARN_UNUSED_RESULT</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:743</div></div>
<div class="ttc" id="_g_e_required_8e_html_a7506e6224f5036fb1941843536b6f4a6"><div class="ttname"><a href="_g_e_required_8e.html#a7506e6224f5036fb1941843536b6f4a6">ks_qfact</a></div><div class="ttdeci">float ks_qfact</div><div class="ttdef"><b>Definition:</b> GERequired.e:240</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad0d05a33cfe5de925f28709883a37abc"><div class="ttname"><a href="_k_s_foundation_8h.html#ad0d05a33cfe5de925f28709883a37abc">ks_init_wait</a></div><div class="ttdeci">void ks_init_wait(KS_WAIT *wait)</div><div class="ttdoc">Resets a KS_WAIT sequence object to its default value (KS_INIT_WAIT)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:49</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_EPI::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1690</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae789f20604371eec8036d0a63555d514"><div class="ttname"><a href="_k_s_foundation_8h.html#ae789f20604371eec8036d0a63555d514">ks_init_seqcontrol</a></div><div class="ttdeci">void ks_init_seqcontrol(KS_SEQ_CONTROL *seqcontrol)</div><div class="ttdoc">Resets KS_SEQ_CONTROL to its default value (KS_INIT_SEQ_CONTROL)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:93</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a8efdbce2fbb4bf21a6fd8983fdd6d5c7"><div class="ttname"><a href="_k_s_foundation_8h.html#a8efdbce2fbb4bf21a6fd8983fdd6d5c7">ks_init_trap</a></div><div class="ttdeci">void ks_init_trap(KS_TRAP *trap)</div><div class="ttdoc">Resets a KS_TRAP sequence object to its default value (KS_INIT_TRAP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:45</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSEPI_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:66</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_af4bfad35c1c019b945e472a3b596ecba"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#af4bfad35c1c019b945e472a3b596ecba">ksepi_diffusion_eval_gradients_TE</a></div><div class="ttdeci">STATUS ksepi_diffusion_eval_gradients_TE(KSEPI_SEQUENCE *ksepi)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:566</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">KS_EPI::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1685</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af40cc818066c7757959bf3712bfc5e6f"><div class="ttname"><a href="_k_s_foundation_8h.html#af40cc818066c7757959bf3712bfc5e6f">ks_eval_trap</a></div><div class="ttdeci">STATUS ks_eval_trap(KS_TRAP *trap, const char *const desc) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a trapezoid using a KS_TRAP sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:391</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_a97ab43f6fd28920a42d987c8fec4afec"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#a97ab43f6fd28920a42d987c8fec4afec">KS_TRAP::area</a></div><div class="ttdeci">float area</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:434</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aabacf1e670ae0faa4af8cd75d02778e7"><div class="ttname"><a href="_k_s_foundation_8h.html#aabacf1e670ae0faa4af8cd75d02778e7">ks_eval_wait</a></div><div class="ttdeci">STATUS ks_eval_wait(KS_WAIT *wait, const char *const desc, int maxduration) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a wait pulse using a KS_WAIT sequence object</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:179</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a29cf05caf131eb2c5915a41b18af16d0">KS_PHASER::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1528</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:57</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a205256f70ffcd95c6248717004c24ce1"><div class="ttname"><a href="ksepi__implementation_8e.html#a205256f70ffcd95c6248717004c24ce1">ksepi_eval_flowcomp_phase</a></div><div class="ttdeci">STATUS ksepi_eval_flowcomp_phase(KS_TRAP *fcphase, const KS_EPI *epi, KS_DESCRIPTION desc)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:977</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a25ba61305798e6f6ba10cf186493afc2"><div class="ttname"><a href="ksepi__implementation_8e.html#a25ba61305798e6f6ba10cf186493afc2">ksepi_imsize</a></div><div class="ttdeci">int ksepi_imsize</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:181</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a1c544bec41003a594ba4ec7d43a3a470"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a1c544bec41003a594ba4ec7d43a3a470">KS_SEQ_CONTROL::description</a></div><div class="ttdeci">KS_DESCRIPTION description</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:990</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a035bb76f8cc944eff7afd9333c2688e3"><div class="ttname"><a href="struct_k_s___e_p_i.html#a035bb76f8cc944eff7afd9333c2688e3">KS_EPI::read_spacing</a></div><div class="ttdeci">int read_spacing</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1691</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a29cf05caf131eb2c5915a41b18af16d0"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a29cf05caf131eb2c5915a41b18af16d0">KS_READTRAP::nover</a></div><div class="ttdeci">int nover</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1428</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a60d24c9932e42095ed00b0409d207f71"><div class="ttname"><a href="ksepi__implementation_8e.html#a60d24c9932e42095ed00b0409d207f71">ksepi_fcy</a></div><div class="ttdeci">int ksepi_fcy</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:152</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_a6a2cc013660b66a4c7793c6e55bfcaa8"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#a6a2cc013660b66a4c7793c6e55bfcaa8">KS_READTRAP::rampsampling</a></div><div class="ttdeci">int rampsampling</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1427</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_ac359c54a7c5f9e9a94105b3c0d0be9ea"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#ac359c54a7c5f9e9a94105b3c0d0be9ea">KS_READTRAP::acq</a></div><div class="ttdeci">KS_READ acq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1423</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a56cdd966749fa80f8042934a7e7d4565"><div class="ttname"><a href="ksepi__implementation_8e.html#a56cdd966749fa80f8042934a7e7d4565">ksepi_eval_setuprf</a></div><div class="ttdeci">STATUS ksepi_eval_setuprf()</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:1053</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad06a3c6b22c54585d66b17eae440e6f7"><div class="ttname"><a href="_k_s_foundation_8h.html#ad06a3c6b22c54585d66b17eae440e6f7">ks_init_epi</a></div><div class="ttdeci">void ks_init_epi(KS_EPI *epi)</div><div class="ttdoc">Resets a KS_EPI sequence object to its default value (KS_INIT_EPI)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:77</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4"><div class="ttname"><a href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1745</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a77fb9dea403599e8fbbf1fed426ff66e"><div class="ttname"><a href="_k_s_foundation_8h.html#a77fb9dea403599e8fbbf1fed426ff66e">ks_eval_epi</a></div><div class="ttdeci">STATUS ks_eval_epi(KS_EPI *epi, const char *const desc, float quietnessfactor) WARN_UNUSED_RESULT</div><div class="ttdoc">Sets up a KS_EPI composite sequence object with preset gradient constraints</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2867</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_abfd94a01fc71278021802ca0d1e25e16"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#abfd94a01fc71278021802ca0d1e25e16">KS_PHASER::fov</a></div><div class="ttdeci">float fov</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1526</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:63</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:64</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a98c4213d8911196f066f554bb7c056aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c4213d8911196f066f554bb7c056aa">&#9670;&nbsp;</a></span>ksepi_eval_TErange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_TErange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets the min/max TE based on the durations of the sequence objects in <a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html" title="typedef struct holding all all gradients and waveforms for the ksepi sequence">KSEPI_SEQUENCE</a> (ksepi)</h4>
</p>
<p>This function handles the TE range for SE-EPI, GE-EPI and DW-EPI (opdiffuse == KS_EPI_DIFFUSION_ON).</p>
<p>Multiple EPI trains (opnecho &gt; 1) are supported but will only work if ksepi_onlinerecon = FALSE, since GE's integrated refscan does not seem to work with multiple EPI trains (or multi-shot). Time between the EPI readouts is controlled using <code>ksepi_echogap</code>, yielding a <code>ksepi_interechotime</code> variable used in <a class="el" href="ksepi__implementation_8e.html#adba344d89a93331600d92e4a2de6de5b" title="The ksepi (main) pulse sequence">ksepi_pg()</a>.</p>
<p>N.B.: The minTE (avminte) and maxTE (avmaxte) ensures TE (opte) to be in the valid range for this pulse sequence to be set up in <a class="el" href="ksepi__implementation_8e.html#adba344d89a93331600d92e4a2de6de5b" title="The ksepi (main) pulse sequence">ksepi_pg()</a>. If the pulse sequence design changes in <a class="el" href="ksepi__implementation_8e.html#adba344d89a93331600d92e4a2de6de5b" title="The ksepi (main) pulse sequence">ksepi_pg()</a>, by adding/modifying/removing sequence objects in a way that affects the intended TE, this function needs to be updated too.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                            {</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordtype">int</span> min90_180, min180_echo;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordflow">if</span> (acq_type == TYPSPIN) {</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">/* minimum TE: Spin-Echo EPI case (also diffusion) */</span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">/*** minimum time needed between RF exc center to RF ref center ***/</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    min90_180 = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; 0) {</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      min90_180 += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    min90_180 += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac16f076ad3730bdc955ef91e0797a33f">diffgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    min90_180 += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="comment">/*** minimum time needed between RF ref center and echo center (using selrfref or selrfref2 (opdualspinecho) ***/</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    min180_echo = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac16f076ad3730bdc955ef91e0797a33f">diffgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* zero if not opdiffuse == KS_EPI_DIFFUSION_ON  */</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    min180_echo += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      min180_echo += GRAD_UPDATE_TIME;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; opdualspinecho) {</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      min180_echo += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      <span class="comment">/* minimum TE is 4x the biggest of the two */</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      avminte = IMax(2, min90_180, min180_echo) * 4;</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      <span class="comment">/* Also check that the middle two diffusion gradients (diffgrad2) fits.</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="comment">         There should be a time corresponding to TE/2 between the two 180 pulses for opdualspinecho, and within this time two instances</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="comment">         of ksepi.diffgrad2 must be possible to fit in (2nd and 3rd diffusion gradient) */</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      <span class="keywordtype">int</span> avail_time = (avminte/2);</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      avail_time -= <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* right crusher for 1st 180 */</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      avail_time -= <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">start2iso</a>; <span class="comment">/* left crusher for 2nd 180 */</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a78efc6810828c4f9c23cda4e7959a495">diffgrad2</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> * 2 &gt; avail_time) {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;       <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: DualSE diffusion - not enough space for &#39;diffgrad2&#39;&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      }</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      min180_echo += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="comment">/* minimum TE is 2x the biggest of the two */</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      avminte = IMax(2, min90_180, min180_echo) * 2;</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    }</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  } <span class="keywordflow">else</span> { <span class="comment">/* GE-EPI */</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="comment">/* RF center to rephaser end */</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    avminte = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a>;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a> == TRUE) {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      avminte += IMax(2,</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                      2 * <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <span class="comment">/* Y */</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> \</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                      + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">readphaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) <span class="comment">/* X + Z */</span>;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">/* Normal imaging case */</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      avminte += IMax(3,</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">readphaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <span class="comment">/* X */</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                      2 * <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">fcompphase</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <span class="comment">/* Y */</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                      <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">fcompslice</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>) <span class="comment">/* Z */</span>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; 0) {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      avminte += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="comment">/* EPI dephaser start to echo center (this includes ksepi.epitrain.readphaser.duration/ksepi.epitrain.blipphaser.grad.duration).</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="comment">      Since the dephasers have been added in the IMax(3, ...) above, we need to exclude this time to get TE down to minimum */</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    avminte += <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a> - IMax(3, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">readphaser</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>, <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>);</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      avminte += GRAD_UPDATE_TIME;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  }</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  avminte += GRAD_UPDATE_TIME * 2; <span class="comment">/* 8us extra margin */</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  avminte = RUP_FACTOR(avminte, 8); <span class="comment">/* round up to make time divisible by 8us */</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;  avmaxte = avminte; <span class="comment">/* initialization only to avoid avmaxte = 0 */</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;  <span class="comment">/* time offset between two EPI trains (up to 16 echoes = EPI trains) */</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a> = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a28fc9daaf728790fd96bdabe1e81a077">ksepi_echogap</a> + (acq_type == TYPSPIN) * (<a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">pregrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a>);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="comment">/* maximum TE */</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="keywordflow">if</span> (existcv(optr)) {</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">if</span> (opautotr) {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      <span class="comment">/* TR = minTR, i.e. the current TE is also the maximum TE */</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      <span class="keywordflow">if</span> (opautote)</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        avmaxte = avminte;</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existcv(opte))</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        avmaxte = opte;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        avmaxte = avminte;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="comment">/* maximum TE dependent on the chosen TR */</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      avmaxte = optr - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a>; <span class="comment">/* maximum sequence duration for this TR (implies one slice per TR) */</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      avmaxte -= <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* subtract ksepi.spoiler time */</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;      avmaxte -= <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> - <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">time2center</a>;</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      <span class="keywordflow">if</span> (opnecho &gt; 1) {</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        avmaxte -= (opnecho - 1) * <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a>; <span class="comment">/* for multi-echo */</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;      }</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    avmaxte = 1s;</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  }</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="keywordflow">if</span> (opnecho == 2) {</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">/* for opnecho == 2, the TE2 button appears although we have greyed it out (pite2nub = 0).</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="comment">       Make avminte2/opte2 contain the actual number */</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    avminte2 = avminte + <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a>;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    avmaxte2 = avmaxte + <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a>;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    opte2 = opte       + <a class="code" href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a>;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;  }</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  <span class="keywordflow">if</span> (opautote) {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    setpopup(opte, PSD_OFF);</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    cvoverride(opte, avminte, PSD_FIX_ON, PSD_EXIST_ON); <span class="comment">/* AutoTE: force TE to minimum */</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (existcv(opte)) {</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    setpopup(opte, PSD_ON);</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span> (opte &lt; avminte)</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;TE=%.1f too small. Please increase TE to %.1f&quot;</span>, opte / 1000.0, avminte / 1000.0);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (opte &gt; avmaxte)</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;TE=%.1f too large. Please decrease to %.1f&quot;</span>, opte / 1000.0, avmaxte / 1000.0);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  }</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;} <span class="comment">/* ksepi_TErange() */</span></div><div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___r_f_html_af9bc4afb4579b2bf18259e70175090a3"><div class="ttname"><a href="struct_k_s___r_f.html#af9bc4afb4579b2bf18259e70175090a3">KS_RF::start2iso</a></div><div class="ttdeci">int start2iso</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:793</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#af33317a98ade78e3ac252b33cbb794af">KS_PHASER::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1525</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ac6c0c1a7ad7a6b0ab69d5aedc27c36c7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac6c0c1a7ad7a6b0ab69d5aedc27c36c7">KSEPI_SEQUENCE::fcompphase</a></div><div class="ttdeci">KS_TRAP fcompphase</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:65</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ad76a5ac226f0d25f70349ef83b5bc38a"><div class="ttname"><a href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">KS_EPI::zphaser</a></div><div class="ttdeci">KS_PHASER zphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1689</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a35145c98c931f54a8bf2b97edfb3e4c6"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a35145c98c931f54a8bf2b97edfb3e4c6">KS_SELRF::pregrad</a></div><div class="ttdeci">KS_TRAP pregrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1339</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_EPI::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1692</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aba7bb21f100b12eda8151516fcb12461"><div class="ttname"><a href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a></div><div class="ttdeci">#define KS_RFSSP_POSTTIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:85</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6cf3409789f0f63acd82728cba2387bb"><div class="ttname"><a href="ksepi__implementation_8e.html#a6cf3409789f0f63acd82728cba2387bb">ksepi_interechotime</a></div><div class="ttdeci">int ksepi_interechotime</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:210</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ad6bc293fd2cfa9c687635660c6f0f878"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ad6bc293fd2cfa9c687635660c6f0f878">KSEPI_SEQUENCE::fcompslice</a></div><div class="ttdeci">KS_TRAP fcompslice</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:66</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a45df6340afc8c3cc4d6062f26acdcd32"><div class="ttname"><a href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a></div><div class="ttdeci">int ksepi_slicecheck</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:114</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a28fc9daaf728790fd96bdabe1e81a077"><div class="ttname"><a href="ksepi__implementation_8e.html#a28fc9daaf728790fd96bdabe1e81a077">ksepi_echogap</a></div><div class="ttdeci">int ksepi_echogap</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:131</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:57</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_aa29afe5800d6b5d4be29e1da24c63caf"><div class="ttname"><a href="struct_k_s___e_p_i.html#aa29afe5800d6b5d4be29e1da24c63caf">KS_EPI::time2center</a></div><div class="ttdeci">int time2center</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1693</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_abc81c5867684b6e31b65459ec9431269"><div class="ttname"><a href="struct_k_s___e_p_i.html#abc81c5867684b6e31b65459ec9431269">KS_EPI::readphaser</a></div><div class="ttdeci">KS_TRAP readphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1686</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ac16f076ad3730bdc955ef91e0797a33f"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac16f076ad3730bdc955ef91e0797a33f">KSEPI_SEQUENCE::diffgrad</a></div><div class="ttdeci">KS_TRAP diffgrad</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:61</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a78efc6810828c4f9c23cda4e7959a495"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a78efc6810828c4f9c23cda4e7959a495">KSEPI_SEQUENCE::diffgrad2</a></div><div class="ttdeci">KS_TRAP diffgrad2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:62</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_abed769d29c48283fc675de705f3c9e71"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">KSEPI_SEQUENCE::selrfref2</a></div><div class="ttdeci">KS_SELRF selrfref2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:60</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8296cd3d369a69713aca8c6a44a5c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8296cd3d369a69713aca8c6a44a5c56">&#9670;&nbsp;</a></span>ksepi_eval_inversion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_inversion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Wrapper function to KSInversion functions to add single and dual IR support to this sequence</h4>
</p>
<p>It is important that <a class="el" href="ksepi__implementation_8e.html#ae8296cd3d369a69713aca8c6a44a5c56" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksepi_eval_inversion()</a> is called after other sequence modules have been set up and added to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct in <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>. Otherwise the TI and TR timing will be wrong.</p>
<p>Whether IR is on or off is determined by ksinv1_mode, which is set up in <a class="el" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818" title="C-macro assigning four UserCV slots and then calling ksinv_eval()">KSINV_EVAL()</a>-&gt;<a class="el" href="_k_s_inversion_8e.html#a5a70fccdbea3feb9556b6d52ea9aaaed">ksinv_eval()</a>. If it is off, this function will return quietly.</p>
<p>This function calls <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> (<a class="el" href="_k_s_inversion_8e.html" title="This file contains an inversion preparation module that should be @inline&#39;d at the beginning of a KSF...">KSInversion.e</a>), which takes over the responsibility of TR timing that otherwise is determined in <a class="el" href="ksepi__implementation_8e.html#a10f68a0b1180fea87e5a74f8346d3633" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksepi_eval_tr()</a>. <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a> sets seqcollection.evaltrdone = TRUE, which indicates that TR timing has been done. <a class="el" href="ksepi__implementation_8e.html#a10f68a0b1180fea87e5a74f8346d3633" title="Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks">ksepi_eval_tr()</a> checks whether seqcollection.evaltrdone = TRUE to avoid that non-inversion TR timing overrides the TR timing set up in <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>.</p>
<p>At the end of this function, TR validation and heat/SAR checks are done.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                                                              {</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  STATUS status;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordtype">int</span> slperpass, npasses;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordtype">int</span> approved_TR = FALSE;</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, 26, 27, 28, 29); <span class="comment">/* args 2-6: integer X corresponds to opuserX CV */</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) *<a class="code" href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a>) == <a class="code" href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a>) {</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    <span class="comment">/* If no IR1 flag on, return */</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  }</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    npasses = 2;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    npasses = 1;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="keywordflow">while</span> (approved_TR == FALSE) {</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">/* Inversion (specific to 2D FSE/EPI type of PSDs). Must be done after all other sequence modules have been set up */</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    slperpass = CEIL_DIV((<span class="keywordtype">int</span>) exist(opslquant), npasses);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      status = <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opvquant), 1 <span class="comment">/* seq 3DMS */</span>);</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      status = <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    }</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="comment">/* ksinv_eval_multislice() sets seqcollection.evaltrdone = TRUE. This indicates that TR timing has been done.</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">       ksepi_eval_tr() check whether seqcollection.evaltrdone = TRUE to avoid that non-inversion TR timing overrides the</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">       intricate TR timing with inversion module(s). At the end of ksinv_eval_multislice(), TR validation and heat/SAR checks are done */</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    status = <a class="code" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a>, 0, NULL, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">if</span> (existcv(optr) &amp;&amp; opflair == OPFLAIR_INTERLEAVED &amp;&amp; optr &gt; <a class="code" href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a>) {</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <span class="comment">/* T1-FLAIR */</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="keywordflow">if</span> (npasses &gt; exist(opslquant)) {</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: T1-FLAIR: TR not met for single slice per TR&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      }</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      npasses++; <span class="comment">/* increase #passes and call ksinv_eval_multislice() again with a new ks_slice_plan */</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="comment">/* non-T1-FLAIR, or T1-FLAIR with approved TR value */</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      approved_TR = TRUE;</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    }</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  } <span class="comment">/* while (approved_TR == FALSE)  */</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="comment">/* Check TR timing and SAR limits */</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  status = <a class="code" href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, &amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a>, 0, NULL);</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;} <span class="comment">/* ksepi_eval_inversion() */</span></div><div class="ttc" id="_k_s_inversion_8e_html_aa08a7ecfbf13a621a577fa984bda2b5a"><div class="ttname"><a href="_k_s_inversion_8e.html#aa08a7ecfbf13a621a577fa984bda2b5a">ksinv_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS ksinv_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args)</div><div class="ttdoc">Runs the inversion slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1846</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a6b12154153490ce7139f74b5ac1d9199"><div class="ttname"><a href="_k_s_inversion_8e.html#a6b12154153490ce7139f74b5ac1d9199">ksinv1_mode</a></div><div class="ttdeci">float * ksinv1_mode</div><div class="ttdef"><b>Definition:</b> KSInversion.e:138</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aaf598c5557e77ede0f012ec0ca884b05"><div class="ttname"><a href="ksepi__implementation_8e.html#aaf598c5557e77ede0f012ec0ca884b05">ksepi_scan_coreslice_nargs</a></div><div class="ttdeci">int ksepi_scan_coreslice_nargs(const SCAN_INFO *slice_pos, int dabslice, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksepi_scan_coreslice() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2485</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22"><div class="ttname"><a href="_k_s_inversion_8e.html#adc29c2ff13d900c2f185ee95427fb06cac064495bd1949fdbad4fdaef8a93ad22">KSINV_OFF</a></div><div class="ttdef"><b>Definition:</b> KSInversion.e:44</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_ab3fa4125b24bcc3e5d7f0ffacc32d86b"><div class="ttname"><a href="_k_s_inversion_8e.html#ab3fa4125b24bcc3e5d7f0ffacc32d86b">ksinv_maxtr_t1flair</a></div><div class="ttdeci">int ksinv_maxtr_t1flair</div><div class="ttdef"><b>Definition:</b> KSInversion.e:159</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a2a4ae2b692531f3c649a5035992425c1"><div class="ttname"><a href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1">ksinv_eval_multislice</a></div><div class="ttdeci">STATUS ksinv_eval_multislice(KS_SEQ_COLLECTION *seqcollection, KS_SLICE_PLAN *slice_plan, int(*play_coreslice)(const SCAN_INFO *, int, int, void **), int core_nargs, void **core_args, KS_SEQ_CONTROL *mainseqctrl)</div><div class="ttdoc">Calculates the duration of inversion module(s) for various inversion modes</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1509</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b2d943c3862a3980c7291b8e3ac1818"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b2d943c3862a3980c7291b8e3ac1818">KSINV_EVAL</a></div><div class="ttdeci">#define KSINV_EVAL(sptr, o1, o2, o3, o4)</div><div class="ttdoc">C-macro assigning four UserCV slots and then calling ksinv_eval()</div><div class="ttdef"><b>Definition:</b> KSInversion.e:1132</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a10f68a0b1180fea87e5a74f8346d3633"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f68a0b1180fea87e5a74f8346d3633">&#9670;&nbsp;</a></span>ksepi_eval_tr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_tr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Evaluation of number of slices / TR, set up of slice plan, TR validation and SAR checks</h4>
</p>
<p>With the current sequence collection (see <a class="el" href="ksepi_8e.html#aa66251df1c4c64ce1a910d00ad7f1775">my_cveval()</a>), and a function pointer to an argument-standardized wrapper function (<a class="el" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e" title="Wrapper function to ksepi_scan_sliceloop() with standardized input arguments">ksepi_scan_sliceloop_nargs()</a>) to the slice loop function (<a class="el" href="ksepi__implementation_8e.html#a3b7d23c7f6bba668c5b103a75d6072ae" title="Plays out slperpass slices corresponding to one TR">ksepi_scan_sliceloop()</a>, this function calls <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>, where number of slices that can fit within one TR is determined by adding more slices as input argument to the slice loop function. For more details see <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>.</p>
<p>With the number of slices/TR now known, a standard 2D slice plan is set up using <a class="el" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb" title="Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...">ks_calc_sliceplan()</a> and the duration of the main sequence is increased based on timetoadd_perTR, which was returned by <a class="el" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR()</a>. timetoadd_perTR &gt; 0 when optr &gt; avmintr and when heat or SAR restrictions requires <code>avmintr</code> to be larger than the net sum of sequence modules in the slice loop.</p>
<p>This function first checks whether seqcollection.evaltrdone == TRUE. This is e.g. the case for inversion where the TR timing instead is controlled using <a class="el" href="ksepi__implementation_8e.html#ae8296cd3d369a69713aca8c6a44a5c56" title="Wrapper function to KSInversion functions to add single and dual IR support to this sequence...">ksepi_eval_inversion()</a> (calling <a class="el" href="_k_s_inversion_8e.html#a2a4ae2b692531f3c649a5035992425c1" title="Calculates the duration of inversion module(s) for various inversion modes">ksinv_eval_multislice()</a>).</p>
<p>At the end of this function, TR validation and heat/SAR checks are done using <a class="el" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473" title="Runs the slice loop and validates TR and SAR/hardware limits">GEReq_eval_checkTR_SAR()</a>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seqcollection</td><td>Pointer to the <a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html" title="Collection handle of all sequence modules involved in the pulse sequence, used for RF scaling...">KS_SEQ_COLLECTION</a> struct holding all sequence modules </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;                                                       {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordtype">int</span> timetoadd_perTR;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  STATUS status;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="keywordtype">int</span> slperpass, min_npasses;</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>-&gt;<a class="code" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">evaltrdone</a> == TRUE) {</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="comment">     We cannot call GEReq_eval_TR() or GEReq_eval_checkTR_SAR(..., ksepi_scan_sliceloop_nargs, ...) if e.g. the inversion sequence module is used. This is because</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">     ksinv_scan_sliceloop() is used instead of ksepi_scan_sliceloop(). When ksinv1.params.mode != 0 (i.e. inversion sequence module on), the TR timing and</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">     heat/SAR limits checks are done in ksinv_eval_multislice(), which is called from ksepi_eval_inversion().</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">     In the future, other sequence modules may want to take over the responsibility of TR calculations and SAR checks, in which case they need to end their corresponding function</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="comment">     by setting evaltrdone = TRUE to avoid double processing here */</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  }</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="comment">/* interleaved slices in slice gap menu, force 2+ acqs */</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  <span class="keywordflow">if</span> (opileave)</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    min_npasses = 2;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    min_npasses = 1;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="comment">/* Calculate # slices per TR, # acquisitions and how much spare time we have within the current TR by running the slice loop. */</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR</a>(&amp;slperpass, &amp;timetoadd_perTR, min_npasses, <a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e">ksepi_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  <span class="comment">/* Calculate the slice plan (ordering) and passes (acqs). ks_slice_plan is passed to GEReq_predownload_store_sliceplan() in predownload() */</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opvquant), 1 <span class="comment">/* seq 3DMS */</span>);</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, exist(opslquant), slperpass);</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  }</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  <span class="comment">/* We spread the available timetoadd_perTR evenly, by increasing the .duration of each slice by timetoadd_perTR/ksepi_slperpass */</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> = RUP_GRD(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> + CEIL_DIV(timetoadd_perTR, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>));</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="comment">/* Update SAR values in the UI (error will occur if the sum of sequence durations differs from optr) */</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  status = <a class="code" href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a>(<a class="code" href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a>, <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, <a class="code" href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e">ksepi_scan_sliceloop_nargs</a>, 0, NULL);</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordflow">if</span> (status != SUCCESS) <span class="keywordflow">return</span> status;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">/* Fill in the &#39;tmin&#39; and &#39;tmin_total&#39;. tmin_total is only like GEs use of the variable when TR = minTR */</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  tmin = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">min_duration</a>;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  tmin_total = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;} <span class="comment">/* ksepi_eval_tr() */</span></div><div class="ttc" id="_g_e_required_8e_html_a027161dabe834c55750bd1e7f2fa8473"><div class="ttname"><a href="_g_e_required_8e.html#a027161dabe834c55750bd1e7f2fa8473">GEReq_eval_checkTR_SAR</a></div><div class="ttdeci">STATUS GEReq_eval_checkTR_SAR(KS_SEQ_COLLECTION *seqcollection, int nslices, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdoc">Runs the slice loop and validates TR and SAR/hardware limits</div><div class="ttdef"><b>Definition:</b> GERequired.e:974</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a381d3301de972d4eeaba60451b1b179e"><div class="ttname"><a href="ksepi__implementation_8e.html#a381d3301de972d4eeaba60451b1b179e">ksepi_scan_sliceloop_nargs</a></div><div class="ttdeci">int ksepi_scan_sliceloop_nargs(int slperpass, int nargs, void **args)</div><div class="ttdoc">Wrapper function to ksepi_scan_sliceloop() with standardized input arguments</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2657</div></div>
<div class="ttc" id="_g_e_required_8e_html_a3bf65ebca3543f771e2d17799bbb0d3c"><div class="ttname"><a href="_g_e_required_8e.html#a3bf65ebca3543f771e2d17799bbb0d3c">GEReq_eval_TR</a></div><div class="ttdeci">STATUS GEReq_eval_TR(int *slperpass, int *timetoadd_perTR, int requested_minacqs, KS_SEQ_COLLECTION *seqcollection, int(*play_loop)(int, int, void **), int nargs, void **args)</div><div class="ttdef"><b>Definition:</b> GERequired.e:714</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi_8e_html_ab5adb9efc118dc1cc8a0dc3c32cb73bf"><div class="ttname"><a href="ksepi_8e.html#ab5adb9efc118dc1cc8a0dc3c32cb73bf">seqcollection</a></div><div class="ttdeci">KS_SEQ_COLLECTION seqcollection</div><div class="ttdef"><b>Definition:</b> ksepi.e:79</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_a901ce6fe6b2fa774dc95ea6bab219bd0"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#a901ce6fe6b2fa774dc95ea6bab219bd0">KS_SEQ_CONTROL::min_duration</a></div><div class="ttdeci">int min_duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:981</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n_html_aaa31b32f56e7b425f15f4191ef1f92be"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html#aaa31b32f56e7b425f15f4191ef1f92be">KS_SEQ_COLLECTION::evaltrdone</a></div><div class="ttdeci">int evaltrdone</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1152</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99557514f220cf0e97668286792e79cb"><div class="ttname"><a href="_k_s_foundation_8h.html#a99557514f220cf0e97668286792e79cb">ks_calc_sliceplan</a></div><div class="ttdeci">STATUS ks_calc_sliceplan(KS_SLICE_PLAN *slice_plan, int nslices, int slperpass)</div><div class="ttdoc">Calculates the data acquisition order for a standard interleaved 2D scans using one or more passes...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3429</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a431814566b7bf9aac5283fb6ca957618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a431814566b7bf9aac5283fb6ca957618">&#9670;&nbsp;</a></span>ksepi_eval_ssitime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_eval_ssitime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The SSI time for the sequence</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">int</td><td>SSI time in [us] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                         {</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="comment">/* SSI time CV:</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">     Empirical finding on how much SSI time we need to update.</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="comment">     But, use a longer SSI time when we write out data to file in scan() */</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a> = RUP_GRD(IMax(2, </div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                          <a class="code" href="_k_s_foundation_8h.html#a4fe0c2fc567d0a9be5ec8d7e55b21a42">ks_syslimits_hasICEhardware</a>() ? <a class="code" href="ksepi__implementation_8e.html#aca08017f8b225d0dd7ee962fb98a28c6">KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE</a> : <a class="code" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a>, </div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                          _ksepi_ssi_time.minval));</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">/* Copy SSI CV to seqctrl field used by setssitime() */</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = RUP_GRD(<a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = RUP_GRD(<a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;  <span class="comment">/* SSI time one-sequence-off workaround:</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">     We set the hardware ssitime in ks_scan_playsequence(), but it acts on the next sequence module, hence</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">     we aren&#39;t doing this correctly when using multiple sequence modules (as KSChemSat etc).</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment">     One option would be to add a short dummy sequence ks_scan_playsequence(), but need to investigate</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">     if there is a better way. For now, let&#39;s assume the the necessary update time is the longest for</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">     the main sequence (this function), and let the ssi time for all other sequence modules (KSChemSat etc)</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">     have the same ssi time as the main sequence. */</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <a class="code" href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a>    = <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <a class="code" href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a>      = <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a>        = <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>;</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <a class="code" href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a> = <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a>;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;} <span class="comment">/* ksepi_eval_ssitime() */</span></div><div class="ttc" id="_k_s_sp_sat_8e_html_ab39cbb31487a0719bb5d0af9a68f3ef2"><div class="ttname"><a href="_k_s_sp_sat_8e.html#ab39cbb31487a0719bb5d0af9a68f3ef2">ksspsat_ssi_time</a></div><div class="ttdeci">int ksspsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSSpSat.e:134</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_FLEET_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:81</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af19bef9c315a497fdd3f4d20169c61e6"><div class="ttname"><a href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a></div><div class="ttdeci">#define KSEPI_DEFAULT_SSI_TIME</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:38</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3ec411ca45ee9d7fd1497ad6bdec3621"><div class="ttname"><a href="_k_s_inversion_8e.html#a3ec411ca45ee9d7fd1497ad6bdec3621">ksinv_filltr_ssi_time</a></div><div class="ttdeci">int ksinv_filltr_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:156</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a7b4f0e2685695c87449b232bdb4e8f28"><div class="ttname"><a href="ksepi__implementation_8e.html#a7b4f0e2685695c87449b232bdb4e8f28">ksepi_ssi_time</a></div><div class="ttdeci">int ksepi_ssi_time</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:178</div></div>
<div class="ttc" id="_k_s_chem_sat_8e_html_ae39a435e62e3e6d2470d70d5dbf1833e"><div class="ttname"><a href="_k_s_chem_sat_8e.html#ae39a435e62e3e6d2470d70d5dbf1833e">kschemsat_ssi_time</a></div><div class="ttdeci">int kschemsat_ssi_time</div><div class="ttdef"><b>Definition:</b> KSChemSat.e:105</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a4fe0c2fc567d0a9be5ec8d7e55b21a42"><div class="ttname"><a href="_k_s_foundation_8h.html#a4fe0c2fc567d0a9be5ec8d7e55b21a42">ks_syslimits_hasICEhardware</a></div><div class="ttdeci">STATUS STATUS int ks_syslimits_hasICEhardware()</div><div class="ttdoc">Check for ICE Hardware (e.g. RX27+ on SIGNA Premier)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:152</div></div>
<div class="ttc" id="_k_s_inversion_8e_html_a3b9ea6f30b5b38c45e32c084a7bac3c7"><div class="ttname"><a href="_k_s_inversion_8e.html#a3b9ea6f30b5b38c45e32c084a7bac3c7">ksinv_ssi_time</a></div><div class="ttdeci">int ksinv_ssi_time</div><div class="ttdef"><b>Definition:</b> KSInversion.e:155</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca08017f8b225d0dd7ee962fb98a28c6"><div class="ttname"><a href="ksepi__implementation_8e.html#aca08017f8b225d0dd7ee962fb98a28c6">KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE</a></div><div class="ttdeci">#define KSEPI_DEFAULT_SSI_TIME_ICEHARDWARE</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6520db5905a45ee8b364f42bdae29439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6520db5905a45ee8b364f42bdae29439">&#9670;&nbsp;</a></span>ksepi_eval_scantime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_eval_scantime </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Set the number of dummy scans for the sequence and calls <a class="el" href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888" title="Plays out all volumes and passes of a single or multi-pass scan">ksepi_scan_scanloop()</a> to determine</h4>
the length of the scan </p>
<p>After setting the number of dummy scans based on the current TR, the <a class="el" href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888" title="Plays out all volumes and passes of a single or multi-pass scan">ksepi_scan_scanloop()</a> is called to get the scan time. <code>pitscan</code> is the UI variable for the scan clock shown in the top right corner on the MR scanner.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                             {</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  <span class="keywordflow">if</span> (optr &gt; 6s)</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> = 0;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (optr &gt;= 1s)</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> = 1;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (optr &gt; 350ms)</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> = 2;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> = 4;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> &gt; 0)</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a> -= <a class="code" href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a>; <span class="comment">/* remove one dummy TR as the ghost corr TR is also acting as one */</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;  pitscan = <a class="code" href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888">ksepi_scan_scanloop</a>();</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;} <span class="comment">/* ksepi_eval_scantime() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a85c440a9bfab319879423028559eef5b"><div class="ttname"><a href="ksepi__implementation_8e.html#a85c440a9bfab319879423028559eef5b">ksepi_dda</a></div><div class="ttdeci">int ksepi_dda</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:179</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a92d0943acffeeec5fe3f57110b28f7ac"><div class="ttname"><a href="ksepi__implementation_8e.html#a92d0943acffeeec5fe3f57110b28f7ac">ksepi_ghostcorr</a></div><div class="ttdeci">int ksepi_ghostcorr</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:184</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a455eb376ed04673e40382a6ba8503888"><div class="ttname"><a href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888">ksepi_scan_scanloop</a></div><div class="ttdeci">float ksepi_scan_scanloop()</div><div class="ttdoc">Plays out all volumes and passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2804</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04763ba80917b87378fdc6477d17ad88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04763ba80917b87378fdc6477d17ad88">&#9670;&nbsp;</a></span>ksepi_check()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_check </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Returns error of various parameter combinations that are not allowed for ksepi</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                     {</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="comment">/* Force the user to select the Echo Planar Imaging button. This error needs to be in cvcheck(), not in</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">     cvinit()/cveval() to avoid it to trigger also when Echo Planar Imaging has been selected.</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">     Without opepi = 1, the images won&#39;t show up correctly in the GE DB after the 1st volume */</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a> &amp;&amp; opepi == PSD_OFF) {</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Please first select the &#39;Echo Planar Imaging&#39; button&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  }</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (existcv(opte) &amp;&amp; existcv(opnex) &amp;&amp; opautote == PSD_MINTE &amp;&amp; opnex &lt; 1.0) {</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: TE = MinTE and NEX &lt; 1 is not allowed&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">etl</a>) {</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ksepi_reflines cannot be larger than echo train length &quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  }</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="keywordflow">if</span> (existcv(opnshots) &amp;&amp; (opasset == ASSET_SCAN) &amp;&amp; (opnshots &gt; 1)) {</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ASSET not compatible with multishot&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  }</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keywordflow">if</span> (existcv(opnshots) &amp;&amp; existcv(opslquant) &amp;&amp; existcv(optr) &amp;&amp; (opdiffuse != <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) &amp;&amp; (<a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a> == <a class="code" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>)) {</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Multishot control can only be 3 for DW-EPI&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  }</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="keywordflow">if</span> (opasset != 0 &amp;&amp; opasset != ASSET_SCAN) {</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: ASSET flag must be either 0 (OFF) or 2 (ON)&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  }</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; oppseq == 2) {</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: Select SpinEcho for Diffusion&quot;</span>, __FUNCTION__);</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &gt;= 26</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">/* Pixel size in UI */</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  piinplaneres = 1;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  ihinplanexres = <a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> / <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;  ihinplaneyres = (<a class="code" href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a> * opphasefov) / <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">res</a>;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">/* show echo spacing in UI */</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  piesp = 1;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  ihesp = <a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">read</a>.<a class="code" href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> / 1000.0;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;#endif</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;} <span class="comment">/* ksepi_check() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#aac31eb68bff694554a182bd796b2f1c5">KS_PHASER::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1527</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6ea932f1fd0cfa98b2f37e829e67a8f8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a></div><div class="ttdeci">int ksepi_multishot_control</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:186</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e"><div class="ttname"><a href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a></div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:97</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#af33317a98ade78e3ac252b33cbb794af">KS_READTRAP::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1435</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a7582325a159d8ec89a4a4ba0fb89e9a9"><div class="ttname"><a href="struct_k_s___e_p_i.html#a7582325a159d8ec89a4a4ba0fb89e9a9">KS_EPI::etl</a></div><div class="ttdeci">int etl</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1690</div></div>
<div class="ttc" id="struct_k_s___r_e_a_d_t_r_a_p_html_aac31eb68bff694554a182bd796b2f1c5"><div class="ttname"><a href="struct_k_s___r_e_a_d_t_r_a_p.html#aac31eb68bff694554a182bd796b2f1c5">KS_READTRAP::res</a></div><div class="ttdeci">int res</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1426</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a03d42c44e323f3203fe5beabcefa47a5"><div class="ttname"><a href="struct_k_s___e_p_i.html#a03d42c44e323f3203fe5beabcefa47a5">KS_EPI::read</a></div><div class="ttdeci">KS_READTRAP read</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1685</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_ad3c11a6737769e103948d107c1263749"><div class="ttname"><a href="_k_s_foundation__common_8c.html#ad3c11a6737769e103948d107c1263749">opfov</a></div><div class="ttdeci">float opfov</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a450b724c17eac1a3eebb6419e2cdb373"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450b724c17eac1a3eebb6419e2cdb373">&#9670;&nbsp;</a></span>ksepi_predownload_plot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_predownload_plot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_k_s___s_e_q___c_o_l_l_e_c_t_i_o_n.html">KS_SEQ_COLLECTION</a> *&#160;</td>
          <td class="paramname"><em>seqcollection</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Plotting of sequence modules and slice timing to PNG/SVG/PDF files</h4>
</p>
<p>The ks_plot_*** functions used in here will save plots to disk depending on the value of the CV <code>ks_plot_filefmt</code> (see KS_PLOT_FILEFORMATS). E.g. if ks_plot_filefmt = KS_PLOT_OFF, nothing will be written to disk. On the MR scanner, the output will be located in /usr/g/mrraw/plot/&lt;ks_psdname&gt;. In simulation, it will be placed in the current directory (./plot/).</p>
<p>Please see the documentation on how to install the required python version and links. Specifically, there must be a link /usr/local/bin/apython pointing to the Anaconda 2 python binary (v. 2.7).</p>
<p>In addition, the following text files are printed out</p><ul>
<li>&lt;ks_psdname&gt;_objects.txt</li>
<li>&lt;ks_psdname&gt;_seqcollection.txt</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>STATUS <code>SUCCESS</code> or <code>FAILURE</code> </dd></dl>
<div class="fragment"><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                                                {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordtype">char</span> tmpstr[1000];</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="preprocessor">#ifdef PSD_HW</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;/usr/g/mrraw/%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  sprintf(tmpstr, <span class="stringliteral">&quot;./%s_objects.txt&quot;</span>, <a class="code" href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a>);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  FILE *fp  = fopen(tmpstr, <span class="stringliteral">&quot;w&quot;</span>);</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">/* Note: &#39;fp&#39; can be replaced with &#39;stdout&#39; or &#39;stderr&#39; to get these</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;<span class="comment">     values printed out in the WTools window in simulation. However,</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;<span class="comment">     heavy printing may result in that the WTools window closes,</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="comment">     why we here write to a file ksepi_objects.txt instead */</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, fp);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>, fp);</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>, fp); <span class="comment">/* opdualspinecho = 1, opdiffuse = 1 */</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac16f076ad3730bdc955ef91e0797a33f">diffgrad</a>, fp); <span class="comment">/* opdiffuse = 1 */</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a78efc6810828c4f9c23cda4e7959a495">diffgrad2</a>, fp); <span class="comment">/* opdualspinecho = 1, opdiffuse = 1 */</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a11d7a5bdd7f74891cb50bff1401a339a">ks_print_epi</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, fp);</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a11d7a5bdd7f74891cb50bff1401a339a">ks_print_epi</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, fp);</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, fp);</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  fclose(fp);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;  <span class="comment">/* ks_plot_host():</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">  Plot each sequence module as a separate file (PNG/SVG/PDF depending on ks_plot_filefmt (GERequired.e))</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">  See KS_PLOT_FILEFORMATS in KSFoundation.h for options.</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">  Note that the phase encoding amplitudes corresponds to the first shot, as set by the call to ksepi_scan_seqstate below */</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], 0);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *plans[] = {&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">full_peplan</a>, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">ref_peplan</a>, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>};</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <span class="keywordtype">int</span> num_plans = <span class="keyword">sizeof</span>(plans) / <span class="keyword">sizeof</span>(<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a> *);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ad673a4b23913c3c006b3b0052b98e0df">ks_plot_host_seqctrl_manyplans</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, plans, num_plans);</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a8f60bc64f5da613130a7b7bfec468476">ks_plot_host_seqctrl</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  <span class="comment">/* Sequence timing plot */</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a>();</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888">ksepi_scan_scanloop</a>();</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a>();</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="comment">/* ks_plot_tgt_reset():</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;<span class="comment">  Creates sub directories and clear old files for later use of ksepi_scan_acqloop()-&gt;ks_plot_tgt_addframe().</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">  ks_plot_tgt_addframe() will only write in MgdSim (WTools) to avoid timing issues on the MR scanner. Hence,</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment">  unlike ks_plot_host() and the sequence timing plot, one has to open MgdSim and press RunEntry (and also</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment">  press PlotPulse several times after pressing RunEntry).</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment">  ks_plot_tgt_reset() will create a &#39;makegif_***.sh&#39; file that should be run in a terminal afterwards</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">  to create the animiated GIF from the dat files */</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;}  <span class="comment">/* ksepi_predownload_plot() */</span></div><div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6915a63ab744ee4957ab235a2f214ca7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6915a63ab744ee4957ab235a2f214ca7">KSEPI_SEQUENCE::ref_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN ref_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:68</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_FLEET_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:81</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html">KS_PHASEENCODING_PLAN</a></div><div class="ttdoc">Phase encoding plan for the sequence (2D and 3D)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1586</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:69</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11d7a5bdd7f74891cb50bff1401a339a"><div class="ttname"><a href="_k_s_foundation_8h.html#a11d7a5bdd7f74891cb50bff1401a339a">ks_print_epi</a></div><div class="ttdeci">void ks_print_epi(KS_EPI epi, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_EPI sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3754</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a455eb376ed04673e40382a6ba8503888"><div class="ttname"><a href="ksepi__implementation_8e.html#a455eb376ed04673e40382a6ba8503888">ksepi_scan_scanloop</a></div><div class="ttdeci">float ksepi_scan_scanloop()</div><div class="ttdoc">Plays out all volumes and passes of a single or multi-pass scan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2804</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="_g_e_required_8e_html_af846b49be109f687e9863f2016029516"><div class="ttname"><a href="_g_e_required_8e.html#af846b49be109f687e9863f2016029516">ks_psdname</a></div><div class="ttdeci">char ks_psdname[256]</div><div class="ttdef"><b>Definition:</b> GERequired.e:218</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a46ace969d9c0db0a396cdb9c7478d498"><div class="ttname"><a href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a></div><div class="ttdeci">STATUS ksepi_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksepi sequence objects being part of KSEPI_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2287</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a8f60bc64f5da613130a7b7bfec468476"><div class="ttname"><a href="_k_s_foundation_8h.html#a8f60bc64f5da613130a7b7bfec468476">ks_plot_host_seqctrl</a></div><div class="ttdeci">void ks_plot_host_seqctrl(KS_SEQ_CONTROL *ctrl, KS_PHASEENCODING_PLAN *plan)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:4088</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae136d8a2e504e06e8592185e85fecfde"><div class="ttname"><a href="_k_s_foundation_8h.html#ae136d8a2e504e06e8592185e85fecfde">ks_plot_slicetime_begin</a></div><div class="ttdeci">void ks_plot_slicetime_begin()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3068</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad673a4b23913c3c006b3b0052b98e0df"><div class="ttname"><a href="_k_s_foundation_8h.html#ad673a4b23913c3c006b3b0052b98e0df">ks_plot_host_seqctrl_manyplans</a></div><div class="ttdeci">void ks_plot_host_seqctrl_manyplans(KS_SEQ_CONTROL *ctrl, KS_PHASEENCODING_PLAN **plan, const int num_plans)</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:4093</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6eab83ca87166f306eb449a94a354ec6"><div class="ttname"><a href="_k_s_foundation_8h.html#a6eab83ca87166f306eb449a94a354ec6">ks_plot_slicetime_end</a></div><div class="ttdeci">void ks_plot_slicetime_end()</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3100</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_FLEET_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:87</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a1abdbad21b51b6554580840ef8376e0d"><div class="ttname"><a href="_k_s_foundation_8h.html#a1abdbad21b51b6554580840ef8376e0d">ks_print_trap</a></div><div class="ttdeci">void ks_print_trap(KS_TRAP trap, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_TRAP sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3691</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a43822646b479e4668a9076be0bb0612d"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a43822646b479e4668a9076be0bb0612d">KSEPI_SEQUENCE::full_peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN full_peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:67</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:57</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_abb36a5018815d55e357775e8515f220d"><div class="ttname"><a href="_k_s_foundation_8h.html#abb36a5018815d55e357775e8515f220d">ks_plot_tgt_reset</a></div><div class="ttdeci">void ks_plot_tgt_reset(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3108</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_ac16f076ad3730bdc955ef91e0797a33f"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#ac16f076ad3730bdc955ef91e0797a33f">KSEPI_SEQUENCE::diffgrad</a></div><div class="ttdeci">KS_TRAP diffgrad</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:61</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a78efc6810828c4f9c23cda4e7959a495"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a78efc6810828c4f9c23cda4e7959a495">KSEPI_SEQUENCE::diffgrad2</a></div><div class="ttdeci">KS_TRAP diffgrad2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:62</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_abed769d29c48283fc675de705f3c9e71"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">KSEPI_SEQUENCE::selrfref2</a></div><div class="ttdeci">KS_SELRF selrfref2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:60</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a29a4c870ed4dcbee78d35bbbce9722b4"><div class="ttname"><a href="_k_s_foundation_8h.html#a29a4c870ed4dcbee78d35bbbce9722b4">ks_print_selrf</a></div><div class="ttdeci">void ks_print_selrf(KS_SELRF selrf, FILE *fp)</div><div class="ttdoc">Writes out the contents of a KS_SELRF sequence object for debugging</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:3839</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cd5d2e01eb4dbfcd069e263311293ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd5d2e01eb4dbfcd069e263311293ab">&#9670;&nbsp;</a></span>ksepi_predownload_setrecon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_predownload_setrecon </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Last-resort function to override certain recon variables not set up correctly already</h4>
</p>
<p>For most cases, the GEReq_predownload_*** functions in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> in <a class="el" href="ksepi_8e.html" title="This file contains the overall structure for the ksepi psd. ">ksepi.e</a> set up the necessary rh*** variables for the reconstruction to work properly. However, if this sequence is customized, certain rh*** variables may need to be changed. Doing this here instead of in <a class="el" href="ksepi_8e.html#a6dab68043b9947b6a659f72613c083ec">predownload()</a> directly separates these changes from the standard behavior.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;                                    {</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="comment">/* GERequired.e uses: rhuser32-25 (VRGF) and rhuser48 (scantime) */</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  rhuser29 = (float) <a class="code" href="ksepi__implementation_8e.html#a6482961dc4df2cb9fccfcdcc6fa122c8">ksepi_fleet_num_ky</a>; <span class="comment">/* store for custom recon to know */</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  rhuser30 = (float) <a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a>; <span class="comment">/* store for custom recon to know */</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;  rhuser31 = (float) <a class="code" href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a>; <span class="comment">/* store for custom recon to know */</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;  rhuser47 = (float) opfphases; <span class="comment">/* number of imaging volumes (may be less than rhnphases due to cal vols. opfphases does not show up in raw header) */</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  rhrecon = 961; <span class="comment">/* VRE recon using Matlab recon (recon_epi.m). See matlab/deploy/rpmbuild on how to make an RPM */</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="preprocessor">#if EPIC_RELEASE &lt; 26</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  <span class="comment">/* rhrawsize = slquant1 * opnecho * (2 * rhptsize) * rhdaxres * rhdayres; */</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a64e29ab200ec2ec2c226ae859b2064ec">ksepi_multivolpfile</a>) {</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    rhtype1 |= RHTYP1RCALLPASS;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    rhrawsize *= <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">npasses</a>;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    rhtype1 &amp;= ~RHTYP1RCALLPASS;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;} <span class="comment">/* ksepi_predownload_setrecon() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a6ea932f1fd0cfa98b2f37e829e67a8f8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6ea932f1fd0cfa98b2f37e829e67a8f8">ksepi_multishot_control</a></div><div class="ttdeci">int ksepi_multishot_control</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:186</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6482961dc4df2cb9fccfcdcc6fa122c8"><div class="ttname"><a href="ksepi__implementation_8e.html#a6482961dc4df2cb9fccfcdcc6fa122c8">ksepi_fleet_num_ky</a></div><div class="ttdeci">int ksepi_fleet_num_ky</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:161</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a9cd9ebd93187231e5c4109d14c0dd69c"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a9cd9ebd93187231e5c4109d14c0dd69c">KS_SLICE_PLAN::npasses</a></div><div class="ttdeci">int npasses</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1201</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a64e29ab200ec2ec2c226ae859b2064ec"><div class="ttname"><a href="ksepi__implementation_8e.html#a64e29ab200ec2ec2c226ae859b2064ec">ksepi_multivolpfile</a></div><div class="ttdeci">int ksepi_multivolpfile</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:187</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3ec3aeb88356adf77fa9a923db2a7d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3ec3aeb88356adf77fa9a923db2a7d0">&#9670;&nbsp;</a></span>ksepi_pg_fleet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_pg_fleet </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>start_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>The fleet pulse sequence for GRAPPA calibration</h4>
</p>
<p>This is the fleet pulse sequence in <a class="el" href="ksepi_8e.html" title="This file contains the overall structure for the ksepi psd. ">ksepi.e</a> using the sequence objects in <a class="el" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html" title="FLEET sequence module for GRAPPA calibration volume in the presence of motion">KSEPI_FLEET_SEQUENCE</a> with the sequence module name "ksepifleet" (= ksepi_fleet.seqctrl.description)</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                                      {</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;  <a class="code" href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a> tmploc = <a class="code" href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a>;</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a> == FALSE) {</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  }</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <span class="keywordflow">if</span> (start_time &lt; <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>) {</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a>(<span class="stringliteral">&quot;%s: 1st arg (pos start) must be at least %d us&quot;</span>, __FUNCTION__, <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  }</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="comment">   *  RF Excitation</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(start_time + <a class="code" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="comment">/* N.B.: ks_pg_selrf()-&gt;ks_pg_rf() detects that ksepi_fleetseq.selrfexc is an excitation pulse</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="comment">     (ksepi_fleetseq.selrfexc.rf.role = KS_RF_ROLE_EXC) and will also set ksepi_fleetseq.seqctrl.momentstart</span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">     to the absolute position in [us] of the isocenter of the RF excitation pulse */</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">momentstart</a>;</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a> + <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>.<a class="code" href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">iso2end</a> + <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">grad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">ramptime</a> + <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">postgrad</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">  *  EPI echo time shifting</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129">KS_ALL</a>;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) != SUCCESS) {</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    }</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += GRAD_UPDATE_TIME;</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  }</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">  *  EPI readout including de/rephasers on freq and phase encoding axes (net zero moment on both axes)</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a>)</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93">KS_FREQZ_PHASEY</a>;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1">KS_FREQX_PHASEY</a>;</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = <a class="code" href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a>;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a804f4f4b870338386e1dea3a877f5bd2">ks_pg_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE) {</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  }</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>; <span class="comment">/* end of EPI (incl. x/y rephasers, but not zphaser) */</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">   *  Gradient spoilers on Y and Z (at the same time)</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">ampscale</a> = 1.0;</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = YGRAD;</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = ZGRAD;</div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) == FAILURE)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">spoiler</a>.<a class="code" href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a>;</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="comment">  *  EPI echo time shifting</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="comment">  *******************************************************************************************************/</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += GRAD_UPDATE_TIME;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">board</a> = <a class="code" href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129">KS_ALL</a>;</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>, tmploc, &amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>) != SUCCESS) {</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;      <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    }</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += IMax(2, <a class="code" href="_k_s_foundation__common_8c.html#aa4225c3edfbcb8e85d91fc491a495058">psd_grd_wait</a>, <a class="code" href="_k_s_foundation__common_8c.html#a636634b6eb50758af3826332f9180e9b">psd_rf_wait</a>) + GRAD_UPDATE_TIME;</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> += <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a>;</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;  }</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="comment">   *  Set the minimal sequence duration (ksepi.seqctrl.min_duration) by calling</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="comment">   *  ks_eval_seqctrl_setminduration()</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">/* make sure we are divisible by GRAD_UPDATE_TIME (4us) */</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a> = RUP_GRD(tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>);</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="preprocessor">#ifdef HOST_TGT</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  <span class="comment">/* On HOST only: Sequence duration (ksepi_fleetseq.seqctrl.ssi_time must be &gt; 0 and is added to ksepi_fleetseq.seqctrl.min_duration in ks_eval_seqctrl_setminduration() */</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> = <a class="code" href="ksepi__implementation_8e.html#a431814566b7bf9aac5283fb6ca957618">ksepi_eval_ssitime</a>();</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, tmploc.<a class="code" href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">pos</a>); <span class="comment">/* tmploc.pos now corresponds to the end of last gradient in the sequence */</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">/*******************************************************************************************************</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">   * Phase encoding table</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">   * Need to call this in ksepi_pg_fleet() so it is run both on HOST and TGT. This, since the phase table</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">   * is dynamically allocated in ks_phaseencoding_generate_epi()-&gt;ks_phaseencoding_resize()</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">   *******************************************************************************************************/</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, <span class="stringliteral">&quot;Fully sampled EPI volume&quot;</span>,</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                                    &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>,</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                                    <a class="code" href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a>, </div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                                    <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">blipphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>, </div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                                    <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>.<a class="code" href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">zphaser</a>.<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">numlinestoacq</a>,</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                                    <a class="code" href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a>) == FAILURE) {</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;    <span class="keywordflow">return</span> FAILURE;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  }</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="comment">/* set EPI dephasers and blips to the first shot so we get the correct plots in WTools */</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, 0, <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0], &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, 0, 0);</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;} <span class="comment">/* ksepi_pg_fleet() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a6016c24e63f250c7e49d537c9b01dea1">KS_FREQX_PHASEY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_af33317a98ade78e3ac252b33cbb794af"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#af33317a98ade78e3ac252b33cbb794af">KS_SELRF::grad</a></div><div class="ttdeci">KS_TRAP grad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1340</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0d83cf730d82612a87abc0f024bea336"><div class="ttname"><a href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a></div><div class="ttdeci">void ks_scan_epi_shotcontrol(KS_EPI *epi, int echo, SCAN_INFO sliceinfo, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot, float rcvphase)</div><div class="ttdoc">Changes the gradient state of a KS_EPI object for the given slice information</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1088</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_FLEET_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:81</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af63cac5b01cd2842a511f6e8e99472e9"><div class="ttname"><a href="_k_s_foundation_8h.html#af63cac5b01cd2842a511f6e8e99472e9">ks_phaseencoding_generate_epi</a></div><div class="ttdeci">STATUS ks_phaseencoding_generate_epi(KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, const char *const desc, KS_EPI *epitrain, int blipsign, int numkyshots, int numsegments, int caipi)</div><div class="ttdoc">EPI: Makes a KS_PHASEENCODING_PLAN suitable for 2D or 3D epi</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:771</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af5c5180eb0689126316981a3ac4f6173"><div class="ttname"><a href="ksepi__implementation_8e.html#af5c5180eb0689126316981a3ac4f6173">ksepi_blipsign</a></div><div class="ttdeci">int ksepi_blipsign</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:140</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a1910d262855b71da353ed0d07a6c7823"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a1910d262855b71da353ed0d07a6c7823">KS_SEQLOC::pos</a></div><div class="ttdeci">int pos</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:242</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_FLEET_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:85</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab08efc665b1013671852ab756840e1a5"><div class="ttname"><a href="_k_s_foundation_8h.html#ab08efc665b1013671852ab756840e1a5">ks_error</a></div><div class="ttdeci">STATUS ks_error(const char *format,...) __attribute__((format(printf</div><div class="ttdoc">Common error message function for HOST and TGT</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_a22cd0313e5ffabe8393f77745dba8d52"><div class="ttname"><a href="struct_k_s___e_p_i.html#a22cd0313e5ffabe8393f77745dba8d52">KS_EPI::blipphaser</a></div><div class="ttdeci">KS_PHASER blipphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1688</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a09b1a7dc77a7cf8c4e8421a23608a42a"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a09b1a7dc77a7cf8c4e8421a23608a42a">KS_PHASER::numlinestoacq</a></div><div class="ttdeci">int numlinestoacq</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1532</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a6e727c3449c63278cbfc2e35cfcfa9fa"><div class="ttname"><a href="_k_s_foundation_8h.html#a6e727c3449c63278cbfc2e35cfcfa9fa">ks_pg_selrf</a></div><div class="ttdeci">STATUS ks_pg_selrf(KS_SELRF *selrf, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_SELRF sequence object on a gradient (and RF) board at some position in the pulse sequence...</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1954</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ab9bf2aebde69b811853b4febc57ff5f8"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ab9bf2aebde69b811853b4febc57ff5f8">KS_SEQ_CONTROL::momentstart</a></div><div class="ttdeci">int momentstart</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:985</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a263548cf715f98526edee92b52818db2"><div class="ttname"><a href="ksepi__implementation_8e.html#a263548cf715f98526edee92b52818db2">ksepi_fleet</a></div><div class="ttdeci">int ksepi_fleet</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:158</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_af03615e60a63da6332e04a37aa801984"><div class="ttname"><a href="_k_s_foundation_8h.html#af03615e60a63da6332e04a37aa801984">ks_pg_wait</a></div><div class="ttdeci">STATUS ks_pg_wait(KS_WAIT *wait, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_WAIT sequence object on all boards at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2038</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a2e3f5254967cadb9a41167c6fbf6743e"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a2e3f5254967cadb9a41167c6fbf6743e">KS_SEQLOC::board</a></div><div class="ttdeci">int board</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:241</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ad76a5ac226f0d25f70349ef83b5bc38a"><div class="ttname"><a href="struct_k_s___e_p_i.html#ad76a5ac226f0d25f70349ef83b5bc38a">KS_EPI::zphaser</a></div><div class="ttdeci">KS_PHASER zphaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1689</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8ad53040a098477496911fa2b1850a2d93">KS_FREQZ_PHASEY</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html_a606fbf556e8a297aa1f68b098f6ac2a2"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html#a606fbf556e8a297aa1f68b098f6ac2a2">KS_SEQLOC::ampscale</a></div><div class="ttdeci">float ampscale</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:243</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129"><div class="ttname"><a href="_k_s_foundation_8h.html#a5a6c30061dd7a6d943e51c3697727ba8a839a809fe0e8486a8cd3d41788349129">KS_ALL</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1738</div></div>
<div class="ttc" id="struct_k_s___e_p_i_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___e_p_i.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_EPI::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1692</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aba7bb21f100b12eda8151516fcb12461"><div class="ttname"><a href="_k_s_foundation_8h.html#aba7bb21f100b12eda8151516fcb12461">KS_RFSSP_POSTTIME</a></div><div class="ttdeci">#define KS_RFSSP_POSTTIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:85</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a51a584f46a7ad0f966d8667324a593c2"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a51a584f46a7ad0f966d8667324a593c2">KSEPI_FLEET_SEQUENCE::spoiler</a></div><div class="ttdeci">KS_TRAP spoiler</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:83</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a804f4f4b870338386e1dea3a877f5bd2"><div class="ttname"><a href="_k_s_foundation_8h.html#a804f4f4b870338386e1dea3a877f5bd2">ks_pg_epi</a></div><div class="ttdeci">STATUS ks_pg_epi(KS_EPI *epi, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places out a KS_EPI object (EPI train including dephaser and rephaser gradients)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:2455</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a45df6340afc8c3cc4d6062f26acdcd32"><div class="ttname"><a href="ksepi__implementation_8e.html#a45df6340afc8c3cc4d6062f26acdcd32">ksepi_slicecheck</a></div><div class="ttdeci">int ksepi_slicecheck</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:114</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a431814566b7bf9aac5283fb6ca957618"><div class="ttname"><a href="ksepi__implementation_8e.html#a431814566b7bf9aac5283fb6ca957618">ksepi_eval_ssitime</a></div><div class="ttdeci">int ksepi_eval_ssitime()</div><div class="ttdoc">The SSI time for the sequence</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:1646</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a61651c54c4dfd4388fc939d804a9964b"><div class="ttname"><a href="_k_s_foundation_8h.html#a61651c54c4dfd4388fc939d804a9964b">ks_pg_trap</a></div><div class="ttdeci">STATUS ks_pg_trap(KS_TRAP *trap, KS_SEQLOC loc, KS_SEQ_CONTROL *ctrl) WARN_UNUSED_RESULT</div><div class="ttdoc">Places a KS_TRAP sequence object on a board at some position in the pulse sequence</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:1212</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_FLEET_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:87</div></div>
<div class="ttc" id="struct_k_s___s_e_q_l_o_c_html"><div class="ttname"><a href="struct_k_s___s_e_q_l_o_c.html">KS_SEQLOC</a></div><div class="ttdoc">typedef struct used as argument to ks_pg_*** functions to control where and when to place a sequence ...</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:240</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a53d012b69c3259f46aed1ea3ea18fe71"><div class="ttname"><a href="ksepi__implementation_8e.html#a53d012b69c3259f46aed1ea3ea18fe71">ksepi_readsign</a></div><div class="ttdeci">int ksepi_readsign</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:132</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_FLEET_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:86</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_a5ac7ed86029ab647ba0c9a656ae9fb37"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#a5ac7ed86029ab647ba0c9a656ae9fb37">KS_SELRF::postgrad</a></div><div class="ttdeci">KS_TRAP postgrad</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1341</div></div>
<div class="ttc" id="struct_k_s___r_f_html_afa10c3dbec21b5cc34276e741deeb97e"><div class="ttname"><a href="struct_k_s___r_f.html#afa10c3dbec21b5cc34276e741deeb97e">KS_RF::iso2end</a></div><div class="ttdeci">int iso2end</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:794</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a75c403072633f5a42fe364af4454b245"><div class="ttname"><a href="_k_s_foundation_8h.html#a75c403072633f5a42fe364af4454b245">ks_eval_seqctrl_setminduration</a></div><div class="ttdeci">STATUS ks_eval_seqctrl_setminduration(KS_SEQ_CONTROL *seqctrl, int mindur)</div><div class="ttdoc">Sets the minimum duration and duration fields of a KS_SEQ_CONTROL struct based on some minimum time (...</div><div class="ttdef"><b>Definition:</b> KSFoundation_host.c:2925</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_aa4225c3edfbcb8e85d91fc491a495058"><div class="ttname"><a href="_k_s_foundation__common_8c.html#aa4225c3edfbcb8e85d91fc491a495058">psd_grd_wait</a></div><div class="ttdeci">int psd_grd_wait</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_af247a505cba1e5157a68ef7b1d69453c"><div class="ttname"><a href="ksepi__implementation_8e.html#af247a505cba1e5157a68ef7b1d69453c">ksepi_caipi</a></div><div class="ttdeci">int ksepi_caipi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:147</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ad01dd4f06fe226a502e872d4173ba7ae"><div class="ttname"><a href="_k_s_foundation_8h.html#ad01dd4f06fe226a502e872d4173ba7ae">KS_INIT_SEQLOC</a></div><div class="ttdeci">#define KS_INIT_SEQLOC</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:128</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_TRAP::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:437</div></div>
<div class="ttc" id="_k_s_foundation__common_8c_html_a636634b6eb50758af3826332f9180e9b"><div class="ttname"><a href="_k_s_foundation__common_8c.html#a636634b6eb50758af3826332f9180e9b">psd_rf_wait</a></div><div class="ttdeci">int psd_rf_wait</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_FLEET_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:84</div></div>
<div class="ttc" id="struct_k_s___t_r_a_p_html_acbc719dc4e48c2a2df0447875e4348ca"><div class="ttname"><a href="struct_k_s___t_r_a_p.html#acbc719dc4e48c2a2df0447875e4348ca">KS_TRAP::ramptime</a></div><div class="ttdeci">int ramptime</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:435</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_FLEET_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:82</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a3bb177070dbeb44d2386c268d781fe61"><div class="ttname"><a href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a></div><div class="ttdeci">#define KS_RFSSP_PRETIME</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:84</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab51b9deb2b1220a3d694ee476e98d0ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51b9deb2b1220a3d694ee476e98d0ca">&#9670;&nbsp;</a></span>ksepi_fleet_scan_seqstate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_fleet_scan_seqstate </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                                                                        {</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  <span class="keywordtype">int</span> exc_rfphase;</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="comment">/* RF frequency &amp; phase */</span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a6f9bbb676722cdb9706b2de6b28e24d4">ksepi_rfspoiling</a>) {</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    exc_rfphase = <a class="code" href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a>(<a class="code" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a>);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <a class="code" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a>++;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    exc_rfphase = 0;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  }</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="keywordflow">if</span> (slice_info != NULL) {</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a>(*slice_info);</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>, 0, *slice_info, exc_rfphase);</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, 0, *slice_info, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, shot, exc_rfphase);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  }</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;} <span class="comment">/* ksepi_fleet_scan_seqstate() */</span></div><div class="ttc" id="_k_s_foundation_8h_html_ada6d1910f42394dc7fb363d85bd6e9c5"><div class="ttname"><a href="_k_s_foundation_8h.html#ada6d1910f42394dc7fb363d85bd6e9c5">ks_scan_rf_on</a></div><div class="ttdeci">void ks_scan_rf_on(KS_RF *rf, int instanceno)</div><div class="ttdoc">Resets the amplitude of one or all instances of an RF pulse (KS_RF)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:421</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0d83cf730d82612a87abc0f024bea336"><div class="ttname"><a href="_k_s_foundation_8h.html#a0d83cf730d82612a87abc0f024bea336">ks_scan_epi_shotcontrol</a></div><div class="ttdeci">void ks_scan_epi_shotcontrol(KS_EPI *epi, int echo, SCAN_INFO sliceinfo, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot, float rcvphase)</div><div class="ttdoc">Changes the gradient state of a KS_EPI object for the given slice information</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1088</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a48609b98dac5c8f7619bc0521f58d6e3"><div class="ttname"><a href="_k_s_foundation_8h.html#a48609b98dac5c8f7619bc0521f58d6e3">ks_scan_rf_phase_spoiling</a></div><div class="ttdeci">float ks_scan_rf_phase_spoiling(int counter)</div><div class="ttdoc">Returns spoiling phase for a given RF counter</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3547</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_abd7cdf91b5410cdc97ac4abd7fe17bb3"><div class="ttname"><a href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a></div><div class="ttdeci">int rfspoiling_phase_counter</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2851</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6f9bbb676722cdb9706b2de6b28e24d4"><div class="ttname"><a href="ksepi__implementation_8e.html#a6f9bbb676722cdb9706b2de6b28e24d4">ksepi_rfspoiling</a></div><div class="ttdeci">int ksepi_rfspoiling</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:116</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae8766ce800f95dd75ca2eece6638326c"><div class="ttname"><a href="_k_s_foundation_8h.html#ae8766ce800f95dd75ca2eece6638326c">ks_scan_selrf_setfreqphase</a></div><div class="ttdeci">void ks_scan_selrf_setfreqphase(KS_SELRF *selrf, int instanceno, SCAN_INFO sliceinfo, float rfphase)</div><div class="ttdoc">Updates the frequency and phase of one or all instances of a slice selective RF pulse (KS_SELRF)...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:532</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_FLEET_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:87</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a2fdfe2e655a76c4cd4fb1dac16d1834b"><div class="ttname"><a href="_k_s_foundation_8h.html#a2fdfe2e655a76c4cd4fb1dac16d1834b">ks_scan_rotate</a></div><div class="ttdeci">void ks_scan_rotate(SCAN_INFO slice_info)</div><div class="ttdoc">Performs a rotation of the logical system on hardware (WARP)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:988</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_FLEET_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:84</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_FLEET_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:82</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa71cd6d202e8a45bfbd6234906521dba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa71cd6d202e8a45bfbd6234906521dba">&#9670;&nbsp;</a></span>ksepi_scan_rf_off()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ksepi_scan_rf_off </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Sets all RF pulse amplitudes to zero</h4>
</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<div class="fragment"><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                         {</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">selrfref</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a> &amp;&amp; opdualspinecho) {</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">selrfref2</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">rf</a>, INSTRALL);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  }</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;}</div><div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:58</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a99675ab672242a3f37444f01b1246bda"><div class="ttname"><a href="_k_s_foundation_8h.html#a99675ab672242a3f37444f01b1246bda">ks_scan_rf_off</a></div><div class="ttdeci">void ks_scan_rf_off(KS_RF *rf, int instanceno)</div><div class="ttdoc">Sets the amplitude of one or all instances of an RF pulse (KS_RF) to zero</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:448</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_adeab1cc34f1a7f20f41e8825d849981e"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#adeab1cc34f1a7f20f41e8825d849981e">KS_SELRF::rf</a></div><div class="ttdeci">KS_RF rf</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1334</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a22fe49e9c1d0c13ac981b0c4ba3e52f7"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a22fe49e9c1d0c13ac981b0c4ba3e52f7">KSEPI_SEQUENCE::selrfref</a></div><div class="ttdeci">KS_SELRF selrfref</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:59</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_abed769d29c48283fc675de705f3c9e71"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#abed769d29c48283fc675de705f3c9e71">KSEPI_SEQUENCE::selrfref2</a></div><div class="ttdeci">KS_SELRF selrfref2</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:60</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc002fd30d20e3a0c9a81b2deea9793a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc002fd30d20e3a0c9a81b2deea9793a">&#9670;&nbsp;</a></span>ksepi_fleet_scan_coreslice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet_scan_coreslice </td>
          <td>(</td>
          <td class="paramtype">const SCAN_INFO *&#160;</td>
          <td class="paramname"><em>slice_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dabslice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>shot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                                                                                   {</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordtype">float</span> tloc = 0.0;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">duration</a> == 0) {</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  }</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="keywordflow">if</span> (slice_pos != NULL)</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    tloc = slice_pos-&gt;optloc; <span class="comment">/* real slice */</span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    dabslice = <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>; <span class="comment">/* shut off data acq if false slice */</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#ab51b9deb2b1220a3d694ee476e98d0ca">ksepi_fleet_scan_seqstate</a>(slice_pos, (<a class="code" href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a> == L_SCAN) ? shot  : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;  <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, 0, shot); <span class="comment">/* coord to first line of EPI train */</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[1].optloc &gt; <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0].optloc)</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      dabslice = (opslquant * opvquant - 1) - coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      dabslice = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">kz</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  }</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, 0, 0, dabslice, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, shot);</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  time += <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>, 1, &amp;tloc, <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">selrfexc</a>.<a class="code" href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">slthick</a>,</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                    slice_pos == NULL ? <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a> : <a class="code" href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a>);</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;  <span class="keywordflow">return</span> time; <span class="comment">/* in [us] */</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;} <span class="comment">/* ksepi_fleet_scan_coreslice() */</span></div><div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_FLEET_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:81</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6e4b2a3cf932b33832d4e4e4e7cd0de"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6e4b2a3cf932b33832d4e4e4e7cd0de">KS_SEQ_CONTROL::duration</a></div><div class="ttdeci">int duration</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:984</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a27b64905234db826096802c5a1f5bd6e"><div class="ttname"><a href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a></div><div class="ttdeci">void ks_scan_epi_loadecho(KS_EPI *epi, int echo, int storeecho, int slice, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot)</div><div class="ttdoc">Loads the data storage information to hardware for the acquisition windows in a KS_EPI sequence objec...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1148</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_a7894f45c2928e5a523eeafc5ef4ae8b7"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#a7894f45c2928e5a523eeafc5ef4ae8b7">KS_PHASEENCODING_COORD::kz</a></div><div class="ttdeci">int kz</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1554</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9adbb6a4373075b4e441df71373a3d55ad">KS_PLOT_NO_EXCITATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:195</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_FLEET_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:87</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679"><div class="ttname"><a href="_k_s_foundation_8h.html#a0ba82984ac3a22ad68cab5bce5224cf9a31ef5b1dd7ca976daa060cd0bb7aa679">KS_PLOT_STANDARD</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:194</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ac0c669d4d641190116b6886e0976fd47"><div class="ttname"><a href="_k_s_foundation_8h.html#ac0c669d4d641190116b6886e0976fd47">ks_plot_slicetime</a></div><div class="ttdeci">void ks_plot_slicetime(KS_SEQ_CONTROL *ctrl, int nslices, float *slicepos_mm, float slthick_mm, KS_PLOT_EXCITATION_MODE exctype)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3076</div></div>
<div class="ttc" id="_g_e_required_8e_html_adbed7cbe302ef957a49dead6990d286f"><div class="ttname"><a href="_g_e_required_8e.html#adbed7cbe302ef957a49dead6990d286f">rspent</a></div><div class="ttdeci">int rspent</div><div class="ttdef"><b>Definition:</b> GERequired.e:2614</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_ab51b9deb2b1220a3d694ee476e98d0ca"><div class="ttname"><a href="ksepi__implementation_8e.html#ab51b9deb2b1220a3d694ee476e98d0ca">ksepi_fleet_scan_seqstate</a></div><div class="ttdeci">STATUS ksepi_fleet_scan_seqstate(const SCAN_INFO *slice_info, int shot)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2324</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_af990e245cc9c266a6813f8c2739426b6"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#af990e245cc9c266a6813f8c2739426b6">KSEPI_FLEET_SEQUENCE::selrfexc</a></div><div class="ttdeci">KS_SELRF selrfexc</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:84</div></div>
<div class="ttc" id="struct_k_s___s_e_l_r_f_html_aa89aa200e4334657ad976733bebcbc2a"><div class="ttname"><a href="struct_k_s___s_e_l_r_f.html#aa89aa200e4334657ad976733bebcbc2a">KS_SELRF::slthick</a></div><div class="ttdeci">float slthick</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1336</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_FLEET_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:82</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad200fa60ab5064ac49d0100071f3c285"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad200fa60ab5064ac49d0100071f3c285">&#9670;&nbsp;</a></span>ksepi_fleet_scan_sliceloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet_scan_sliceloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>slperpass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>volindx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>passindx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                                                                         {</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keywordtype">int</span> time = 0;</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;  <span class="keywordtype">int</span> slloc, sltimeinpass, shot;</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;  SCAN_INFO centerposition = <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[0]; <span class="comment">/* first slice chosen here, need only rotation stuff */</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;  (void) <a class="code" href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a>;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;    <span class="keywordtype">int</span> centerslice = opslquant/2;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    <span class="comment">/* for future 3D multislab support, let passindx update centerposition */</span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;    centerposition.optloc = (<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice-1].optloc + <a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[centerslice].optloc)/2.0;</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  }</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;  <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; slperpass; sltimeinpass++) {</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    SCAN_INFO *current_slice = &amp;centerposition;</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a>) {</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, <a class="code" href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a>, sltimeinpass);</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      current_slice = (slloc != <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>) ? &amp;<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc] : NULL;</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    }</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">for</span> (shot = -<a class="code" href="ksepi__implementation_8e.html#a7881e8fdb59329abf98720583d8d10d5">ksepi_fleet_dda</a>; shot &lt; <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">num_shots</a>; shot++) {</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a> == TRUE) {</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a> coord = <a class="code" href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, 0, shot); <span class="comment">/* coord to first line of EPI train */</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> kyshot = coord.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">ky</a> % <a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">phaser</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811">ks_enum_epiblipsign</a> blipsign = <a class="code" href="_k_s_foundation_8h.html#a27071ced949f926058771246110c119c">ks_scan_epi_verify_phaseenc_plan</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, &amp;<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>, shot);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="keywordtype">int</span> post_delay = 0;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <span class="keywordflow">if</span> (blipsign == <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>) {</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;         post_delay = (kyshot &lt;= 0) ? GRAD_UPDATE_TIME : RUP_GRD((<span class="keywordtype">int</span>) (<a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> * kyshot));</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blipsign == <a class="code" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a>) {</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;         post_delay = (kyshot &lt;= 0) ? GRAD_UPDATE_TIME : RUP_GRD((<span class="keywordtype">int</span>) (<a class="code" href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a> * (<a class="code" href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a>.<a class="code" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">peplan</a>.<a class="code" href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">phaser</a>-&gt;<a class="code" href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">R</a>-1-kyshot)));</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        }</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">pre_delay</a>, <a class="code" href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a> - post_delay);</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">post_delay</a>, post_delay);</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      }</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      time += <a class="code" href="ksepi__implementation_8e.html#acc002fd30d20e3a0c9a81b2deea9793a">ksepi_fleet_scan_coreslice</a>(current_slice, (shot &gt;= 0) ? sltimeinpass : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, (shot &gt;= 0) ? shot : <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    }</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a>(<a class="code" href="ksepi__implementation_8e.html#a7881e8fdb59329abf98720583d8d10d5">ksepi_fleet_dda</a> &gt; 0 ? <span class="stringliteral">&quot;FLEET shots (incl dummies)&quot;</span> : <span class="stringliteral">&quot;FLEET shots&quot;</span>);</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  }</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a>(<a class="code" href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e">KS_PLOT_PASS_WAS_CALIBRATION</a>);</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;  <span class="keywordflow">return</span> time;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;}</div><div class="ttc" id="struct_k_s___p_h_a_s_e_r_html_a3d90133d3051fbc4816d02efd9566d8e"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_r.html#a3d90133d3051fbc4816d02efd9566d8e">KS_PHASER::R</a></div><div class="ttdeci">int R</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1529</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_aa2f98be84137da8386df3fc88763823c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#aa2f98be84137da8386df3fc88763823c">KS_PHASEENCODING_PLAN::num_shots</a></div><div class="ttdeci">int num_shots</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1587</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a1e661325433fb0f29283f44babb61221"><div class="ttname"><a href="ksepi__implementation_8e.html#a1e661325433fb0f29283f44babb61221">ksepi_echotime_shifting_shotdelay</a></div><div class="ttdeci">float ksepi_echotime_shifting_shotdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:213</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_adffbee0f8231c5226387c8dd8f2dd482"><div class="ttname"><a href="ksfse__implementation_8e.html#adffbee0f8231c5226387c8dd8f2dd482">volindx</a></div><div class="ttdeci">int volindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksfse__implementation_8e_html_aae477e374b559bf16a475321797d62cb"><div class="ttname"><a href="ksfse__implementation_8e.html#aae477e374b559bf16a475321797d62cb">passindx</a></div><div class="ttdeci">int passindx</div><div class="ttdef"><b>Definition:</b> ksfse_implementation.e:2829</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a749ea98d148d9e4eaa6275b321a9d39e"><div class="ttname"><a href="ksepi__implementation_8e.html#a749ea98d148d9e4eaa6275b321a9d39e">ksepi_fleetseq</a></div><div class="ttdeci">KSEPI_FLEET_SEQUENCE ksepi_fleetseq</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:207</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a969816ef84367f11542f3473473260dc"><div class="ttname"><a href="_k_s_foundation_8h.html#a969816ef84367f11542f3473473260dc">KS_3D_SELECTED</a></div><div class="ttdeci">#define KS_3D_SELECTED</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:104</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html_ad097e95262501d52829d5cd9a827275c"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html#ad097e95262501d52829d5cd9a827275c">KS_PHASEENCODING_COORD::ky</a></div><div class="ttdeci">int ky</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1553</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aadb6109f3b3f75f81b46e153f9eb11f0"><div class="ttname"><a href="_k_s_foundation_8h.html#aadb6109f3b3f75f81b46e153f9eb11f0">ks_plot_slicetime_endofslicegroup</a></div><div class="ttdeci">void ks_plot_slicetime_endofslicegroup(const char *desc)</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:3091</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a27071ced949f926058771246110c119c"><div class="ttname"><a href="_k_s_foundation_8h.html#a27071ced949f926058771246110c119c">ks_scan_epi_verify_phaseenc_plan</a></div><div class="ttdeci">ks_enum_epiblipsign ks_scan_epi_verify_phaseenc_plan(KS_EPI *epi, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1049</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d_html"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___c_o_o_r_d.html">KS_PHASEENCODING_COORD</a></div><div class="ttdoc">Struct holding a 3D k-space phase encoding location (ky,kz)</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1552</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a9712828cb11bdaf20671ac4e43c80d3a"><div class="ttname"><a href="_k_s_foundation_8h.html#a9712828cb11bdaf20671ac4e43c80d3a">ks_phaseencoding_get</a></div><div class="ttdeci">KS_PHASEENCODING_COORD ks_phaseencoding_get(const KS_PHASEENCODING_PLAN *phaseenc_plan_ptr, int echo, int shot)</div><div class="ttdoc">Get [ky,kz] coordinate from KS_PHASEENCODING_PLAN for given echo and shot</div><div class="ttdef"><b>Definition:</b> KSFoundation_common.c:308</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_acc002fd30d20e3a0c9a81b2deea9793a"><div class="ttname"><a href="ksepi__implementation_8e.html#acc002fd30d20e3a0c9a81b2deea9793a">ksepi_fleet_scan_coreslice</a></div><div class="ttdeci">int ksepi_fleet_scan_coreslice(const SCAN_INFO *slice_pos, int dabslice, int shot)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2505</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_ae35400b9f2b1e7c9ddfb569496a6e73c"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#ae35400b9f2b1e7c9ddfb569496a6e73c">KSEPI_FLEET_SEQUENCE::peplan</a></div><div class="ttdeci">KS_PHASEENCODING_PLAN peplan</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:87</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a196a10609c8f75d0ff6d7a520d0b7c27"><div class="ttname"><a href="_k_s_foundation_8h.html#a196a10609c8f75d0ff6d7a520d0b7c27">ks_scan_wait</a></div><div class="ttdeci">void ks_scan_wait(KS_WAIT *wait, int waitperiod)</div><div class="ttdoc">Updates the wait period of all instances of a KS_WAIT sequence object. The value of waitperiod must n...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:134</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811">ks_enum_epiblipsign</a></div><div class="ttdeci">ks_enum_epiblipsign</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a9039a6bee3815109e2532128e74fc201"><div class="ttname"><a href="ksepi__implementation_8e.html#a9039a6bee3815109e2532128e74fc201">ksepi_echotime_shifting</a></div><div class="ttdeci">int ksepi_echotime_shifting</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:141</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a7881e8fdb59329abf98720583d8d10d5"><div class="ttname"><a href="ksepi__implementation_8e.html#a7881e8fdb59329abf98720583d8d10d5">ksepi_fleet_dda</a></div><div class="ttdeci">int ksepi_fleet_dda</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:160</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ab8c26ea9ee8534faf737bbc61223253e"><div class="ttname"><a href="_k_s_foundation_8h.html#ab8c26ea9ee8534faf737bbc61223253e">ks_plot_slicetime_endofpass</a></div><div class="ttdeci">void ks_plot_slicetime_endofpass()</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a7975371d96c005ce07af700aefd24d6a"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a7975371d96c005ce07af700aefd24d6a">KSEPI_SEQUENCE::pre_delay</a></div><div class="ttdeci">KS_WAIT pre_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:63</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4"><div class="ttname"><a href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1741</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e"><div class="ttname"><a href="_k_s_foundation_8h.html#a41f5719fe6c2d60e864572e00af44342a720101fc6fb1f89f445b01ac1083214e">KS_PLOT_PASS_WAS_CALIBRATION</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:199</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a760ccab2db5c38fe675480281e009fe4"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a760ccab2db5c38fe675480281e009fe4">KSEPI_SEQUENCE::post_delay</a></div><div class="ttdeci">KS_WAIT post_delay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:64</div></div>
<div class="ttc" id="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_FLEET_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:82</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_aca57a989e4881d731835c196cefcde7d"><div class="ttname"><a href="ksepi__implementation_8e.html#aca57a989e4881d731835c196cefcde7d">ksepi_echotime_shifting_sumdelay</a></div><div class="ttdeci">int ksepi_echotime_shifting_sumdelay</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:216</div></div>
<div class="ttc" id="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n_html_a706b4cec8ea7b1363975e556d74de924"><div class="ttname"><a href="struct_k_s___p_h_a_s_e_e_n_c_o_d_i_n_g___p_l_a_n.html#a706b4cec8ea7b1363975e556d74de924">KS_PHASEENCODING_PLAN::phaser</a></div><div class="ttdeci">KS_PHASER * phaser</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1591</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a26d1beca6af57701b1bb8a9db9d575fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26d1beca6af57701b1bb8a9db9d575fc">&#9670;&nbsp;</a></span>ksepi_scan_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_scan_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Common initialization for prescan entry points MPS2 and APS2 as well as the SCAN entry point</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;                             {</div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <a class="code" href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a>();</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="comment">/* Here goes code common for APS2, MPS2 and SCAN */</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <a class="code" href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);  <span class="comment">/* switch to main sequence */</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  scopeon(&amp;seqcore); <span class="comment">/* Activate scope for core */</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  syncon(&amp;seqcore);  <span class="comment">/* Activate sync for core */</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;  <a class="code" href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a>(<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>.<a class="code" href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">ssi_time</a> / HW_GRAD_UPDATE_TIME);</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;  <span class="comment">/* can we make these independent on global rsptrigger and rsprot in orderslice? */</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  settriggerarray( (<span class="keywordtype">short</span>) <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>, rsptrigger);</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  <a class="code" href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a> = 0;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;} <span class="comment">/* ksepi_scan_init() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a595f599c90a3cb1f300c3c83b5fa116d"><div class="ttname"><a href="_k_s_foundation_8h.html#a595f599c90a3cb1f300c3c83b5fa116d">ks_scan_switch_to_sequence</a></div><div class="ttdeci">void ks_scan_switch_to_sequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1269</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_abd7cdf91b5410cdc97ac4abd7fe17bb3"><div class="ttname"><a href="ksepi__implementation_8e.html#abd7cdf91b5410cdc97ac4abd7fe17bb3">rfspoiling_phase_counter</a></div><div class="ttdeci">int rfspoiling_phase_counter</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2851</div></div>
<div class="ttc" id="_k_s_foundation__tgt_8c_html_a70f8570a5d1cca01d8d49d9cd34bed79"><div class="ttname"><a href="_k_s_foundation__tgt_8c.html#a70f8570a5d1cca01d8d49d9cd34bed79">setssitime</a></div><div class="ttdeci">STATUS setssitime(long)</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="_g_e_required_8e_html_ad56ed68dab054734d4e258fc33a45b71"><div class="ttname"><a href="_g_e_required_8e.html#ad56ed68dab054734d4e258fc33a45b71">GEReq_initRSP</a></div><div class="ttdeci">void GEReq_initRSP(void)</div><div class="ttdoc">RSP Init. To be inserted in the psdinit() function (or scan()) in the main sequence</div><div class="ttdef"><b>Definition:</b> GERequired.e:2671</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s___s_e_q___c_o_n_t_r_o_l_html_ac6037d68ff7b6f66735a92611628df57"><div class="ttname"><a href="struct_k_s___s_e_q___c_o_n_t_r_o_l.html#ac6037d68ff7b6f66735a92611628df57">KS_SEQ_CONTROL::ssi_time</a></div><div class="ttdeci">int ssi_time</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:983</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf440ff4f370482c345bfb11d4af62c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf440ff4f370482c345bfb11d4af62c2">&#9670;&nbsp;</a></span>ksepi_scan_prescanloop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATUS ksepi_scan_prescanloop </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nloops</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dda</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><h4>Prescan loop called from both APS2 and MPS2 entry points</h4>
</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">STATUS</td><td><code>SUCCESS</code> or <code>FAILURE</code> </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                                   {</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keywordtype">int</span> i, echoindx, sliceindx, shotindx, sltimeinpass;</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <span class="keywordtype">int</span> slloc;</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="comment">/* turn off receivers for all echoes (thanks to slice = KS_NOTSET) */</span></div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <span class="keywordflow">for</span> (echoindx = 0; echoindx &lt; opnecho; echoindx++) {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, echoindx, echoindx, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;  }</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a> &gt; 0) {</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="comment">/* store phase reference echo as opnecho */</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">epireftrain</a>, 0, opnecho, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>, NULL, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  }</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;  <span class="comment">/* Diffusion gradients must be off during prescan to get the correct receiver gain */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;  <span class="keywordflow">if</span> (opdiffuse == <a class="code" href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a>) {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <a class="code" href="ksepi__implementation__diffusion_8e.html#aa8399e1e8cdc9a4d23089becce463be6">ksepi_diffusion_scan_diffamp</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>, <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>); <span class="comment">/* KS_NOTSET zeroes all diffusion gradient amplitudes */</span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;  }</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="comment">/* play dummy scans to get into steady state */</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <span class="keywordflow">for</span> (i = -dda; i &lt; nloops; i++) {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;    <span class="comment">/* loop over slices */</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <span class="keywordflow">for</span> (sltimeinpass = 0; sltimeinpass &lt; <a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>.<a class="code" href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">nslices_per_pass</a>; sltimeinpass++) {</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      <span class="comment">/* slice location from slice plan */</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      slloc = <a class="code" href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a>(&amp;<a class="code" href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a>, 0, sltimeinpass);</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="comment">/* modify sequence for next playout */</span></div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;      <a class="code" href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a>(<a class="code" href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a>[slloc], <a class="code" href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a>);</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;      <span class="comment">/* data routing control */</span></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      echoindx = 0; <span class="comment">/* just to 1st echo for prescan */</span></div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;      sliceindx = 0;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      shotindx = 0;</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;      <span class="keywordflow">if</span> (i &gt;= 0) {</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <a class="code" href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">epitrain</a>, echoindx, echoindx, sliceindx, NULL, shotindx);</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;      }</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <a class="code" href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a>(&amp;<a class="code" href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a>.<a class="code" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">seqctrl</a>);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    } <span class="comment">/* for slices */</span></div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  } <span class="comment">/* for nloops */</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="keywordflow">return</span> SUCCESS;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;} <span class="comment">/* ksepi_scan_prescanloop() */</span></div><div class="ttc" id="ksepi__implementation_8e_html_a6db646d881a5c19c6d6cc7068cc947e5"><div class="ttname"><a href="ksepi__implementation_8e.html#a6db646d881a5c19c6d6cc7068cc947e5">ksepi</a></div><div class="ttdeci">KSEPI_SEQUENCE ksepi</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:204</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_afd953f31b866a09e0418967c2bf65a59"><div class="ttname"><a href="_k_s_foundation_8h.html#afd953f31b866a09e0418967c2bf65a59">KS_NOTSET</a></div><div class="ttdeci">#define KS_NOTSET</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:60</div></div>
<div class="ttc" id="_g_e_required_8e_html_aedd5d7c8a00be480230531f3ab5f8bdb"><div class="ttname"><a href="_g_e_required_8e.html#aedd5d7c8a00be480230531f3ab5f8bdb">ks_scan_info</a></div><div class="ttdeci">SCAN_INFO ks_scan_info[SLTAB_MAX]</div><div class="ttdef"><b>Definition:</b> GERequired.e:212</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a27b64905234db826096802c5a1f5bd6e"><div class="ttname"><a href="_k_s_foundation_8h.html#a27b64905234db826096802c5a1f5bd6e">ks_scan_epi_loadecho</a></div><div class="ttdeci">void ks_scan_epi_loadecho(KS_EPI *epi, int echo, int storeecho, int slice, KS_PHASEENCODING_PLAN *phaseenc_plan, int shot)</div><div class="ttdoc">Loads the data storage information to hardware for the acquisition windows in a KS_EPI sequence objec...</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1148</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_aa8bd52574e797bf5b3e6741004c34b46"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#aa8bd52574e797bf5b3e6741004c34b46">KSEPI_SEQUENCE::epitrain</a></div><div class="ttdeci">KS_EPI epitrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:55</div></div>
<div class="ttc" id="struct_k_s___s_l_i_c_e___p_l_a_n_html_a3c4ea64a2a861da12849cb565afab129"><div class="ttname"><a href="struct_k_s___s_l_i_c_e___p_l_a_n.html#a3c4ea64a2a861da12849cb565afab129">KS_SLICE_PLAN::nslices_per_pass</a></div><div class="ttdeci">int nslices_per_pass</div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1202</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a46ace969d9c0db0a396cdb9c7478d498"><div class="ttname"><a href="ksepi__implementation_8e.html#a46ace969d9c0db0a396cdb9c7478d498">ksepi_scan_seqstate</a></div><div class="ttdeci">STATUS ksepi_scan_seqstate(SCAN_INFO slice_info, int shot)</div><div class="ttdoc">Sets the current state of all ksepi sequence objects being part of KSEPI_SEQUENCE</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:2287</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_acd34da9660251c2abb551f0efdd20368"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#acd34da9660251c2abb551f0efdd20368">KSEPI_SEQUENCE::seqctrl</a></div><div class="ttdeci">KS_SEQ_CONTROL seqctrl</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:54</div></div>
<div class="ttc" id="struct_k_s_e_p_i___s_e_q_u_e_n_c_e_html_a6c7125457136724152d37c1e9ffd237c"><div class="ttname"><a href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html#a6c7125457136724152d37c1e9ffd237c">KSEPI_SEQUENCE::epireftrain</a></div><div class="ttdeci">KS_EPI epireftrain</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:56</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b"><div class="ttname"><a href="_k_s_foundation_8h.html#a11a05c3ea650ef64c6421ced6c56bff4a74ba4041bf3d1545f9bfdba233bddb7b">KS_EPI_DIFFUSION_ON</a></div><div class="ttdef"><b>Definition:</b> KSFoundation.h:1742</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_a02e188307a4bd9dfdb00d37688c0487e"><div class="ttname"><a href="_k_s_foundation_8h.html#a02e188307a4bd9dfdb00d37688c0487e">ks_scan_playsequence</a></div><div class="ttdeci">int ks_scan_playsequence(KS_SEQ_CONTROL *ctrl)</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1281</div></div>
<div class="ttc" id="ksepi__implementation__diffusion_8e_html_aa8399e1e8cdc9a4d23089becce463be6"><div class="ttname"><a href="ksepi__implementation__diffusion_8e.html#aa8399e1e8cdc9a4d23089becce463be6">ksepi_diffusion_scan_diffamp</a></div><div class="ttdeci">void ksepi_diffusion_scan_diffamp(KSEPI_SEQUENCE *ksepi, int volindx)</div><div class="ttdef"><b>Definition:</b> ksepi_implementation_diffusion.e:824</div></div>
<div class="ttc" id="ksepi__implementation_8e_html_a06bff71c4e2fca6d2f5cbefe7c259b9a"><div class="ttname"><a href="ksepi__implementation_8e.html#a06bff71c4e2fca6d2f5cbefe7c259b9a">ksepi_reflines</a></div><div class="ttdeci">int ksepi_reflines</div><div class="ttdef"><b>Definition:</b> ksepi_implementation.e:167</div></div>
<div class="ttc" id="_g_e_required_8e_html_ae6527c3b5637d870c648a7703c202985"><div class="ttname"><a href="_g_e_required_8e.html#ae6527c3b5637d870c648a7703c202985">ks_slice_plan</a></div><div class="ttdeci">KS_SLICE_PLAN ks_slice_plan</div><div class="ttdef"><b>Definition:</b> GERequired.e:214</div></div>
<div class="ttc" id="_k_s_foundation_8h_html_aa3ed2adea6f1023e3f926978e9a7b856"><div class="ttname"><a href="_k_s_foundation_8h.html#aa3ed2adea6f1023e3f926978e9a7b856">ks_scan_getsliceloc</a></div><div class="ttdeci">int ks_scan_getsliceloc(const KS_SLICE_PLAN *slice_plan, int passindx, int sltimeinpass)</div><div class="ttdoc">Returns the spatially sorted slice index from a DATA_ACQ_ORDER struct array</div><div class="ttdef"><b>Definition:</b> KSFoundation_tgt.c:1022</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad59c67febb3e502669472ea5c7a0a9a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59c67febb3e502669472ea5c7a0a9a2">&#9670;&nbsp;</a></span>ksepi_excthickness</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_excthickness = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2153981cac63a088fccb065a037f4bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2153981cac63a088fccb065a037f4bf">&#9670;&nbsp;</a></span>ksepi_gscalerfexc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_gscalerfexc = 0.9 with {0.1, 3.0, 0.9, VIS, &quot;Excitation slice thk scaling (&lt; 1.0 thicker slice)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a45df6340afc8c3cc4d6062f26acdcd32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45df6340afc8c3cc4d6062f26acdcd32">&#9670;&nbsp;</a></span>ksepi_slicecheck</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_slicecheck = 0 with {0.0, 1.0, 0.0, VIS, &quot;move readout to z axis for slice thickness test&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab4c674d9d559aa8b6ed732fffddf4216"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4c674d9d559aa8b6ed732fffddf4216">&#9670;&nbsp;</a></span>ksepi_spoilerarea</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_spoilerarea = 3000.0 with {0.0, 10000.0, 3000.0, VIS, &quot;ksepi ksepi.spoiler gradient area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6f9bbb676722cdb9706b2de6b28e24d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f9bbb676722cdb9706b2de6b28e24d4">&#9670;&nbsp;</a></span>ksepi_rfspoiling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_rfspoiling = 1 with {0, 1, 1, VIS, &quot;Enable RF spoiling 1:on 0:off&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adad2255b3c8f58fd69bb45e53ef978e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adad2255b3c8f58fd69bb45e53ef978e0">&#9670;&nbsp;</a></span>ksepi_fse90</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fse90 = 0 with {0, 1, 0, VIS, &quot;Use FSE90 instead of SPSP for non-fatsat&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a97c618e8b43b5e2bf69f22ec58808bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97c618e8b43b5e2bf69f22ec58808bea">&#9670;&nbsp;</a></span>ksepi_rf3Dopt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_rf3Dopt = 0 with {0, 1, 0, VIS, &quot;Choose optimized SPSP pulse for 3D [0:OFF]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa7d0418e6cad024520674d7d4d0eb0ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7d0418e6cad024520674d7d4d0eb0ec">&#9670;&nbsp;</a></span>ksepi_kissoff_factor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_kissoff_factor = 0.04 with {0, 1, 0.04, VIS, &quot;Slice oversampling fraction on each side (3D)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af88b8a2d84931db5714dc80942c08842"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af88b8a2d84931db5714dc80942c08842">&#9670;&nbsp;</a></span>ksepi_crusherscale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_crusherscale = 1.0 with { -20.0, 20.0, 1.0, VIS, &quot;scaling of crusher gradient area&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8b8ac5372fc8e417349e8108d418a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8b8ac5372fc8e417349e8108d418a47">&#9670;&nbsp;</a></span>ksepi_gscalerfref</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_gscalerfref = 0.9 with {0.1, 3.0, 0.9, VIS, &quot;Refocusing slice thk scaling (&lt; 1.0 thicker slice)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa30bc912f81e467781febda7c6d3da03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa30bc912f81e467781febda7c6d3da03">&#9670;&nbsp;</a></span>ksepi_rampsampling</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_rampsampling = 1 with {0, 1, 1, VIS, &quot;Rampsampling [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a17ac65e8574291f8d9d274a7553bf15d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17ac65e8574291f8d9d274a7553bf15d">&#9670;&nbsp;</a></span>ksepi_readlobegap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_readlobegap = 0 with {0, 10ms, 0, VIS, &quot;extra gap between readout lobes [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a28fc9daaf728790fd96bdabe1e81a077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28fc9daaf728790fd96bdabe1e81a077">&#9670;&nbsp;</a></span>ksepi_echogap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_echogap = 0 with {0, 100ms, 0, VIS, &quot;extra gap between EPI echoes [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53d012b69c3259f46aed1ea3ea18fe71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53d012b69c3259f46aed1ea3ea18fe71">&#9670;&nbsp;</a></span>ksepi_readsign</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_readsign = 1 with { -1.0, 1.0, 1.0, VIS, &quot;Readout polarity: +1/-1&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a435623003ba36d56efab4de35e73b0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a435623003ba36d56efab4de35e73b0fd">&#9670;&nbsp;</a></span>ksepi_readampmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_readampmax = 3.0 with {0.0, 5.0, 3.0, VIS, &quot;Max grad amp for EPI readout lobes&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1624564b9e609568cf9842fb02fe1e21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1624564b9e609568cf9842fb02fe1e21">&#9670;&nbsp;</a></span>ksepi_sr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_sr = 0.01 with {0.0, , 0.01, VIS, &quot;EPI SR: amp/ramp [(G/cm) / us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac6489b25909a89dfeb427e0482429801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6489b25909a89dfeb427e0482429801">&#9670;&nbsp;</a></span>ksepi_esp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_esp = 0 with {0, 1000000, 0, VIS, &quot;View-only: Echo spacing in [us]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af5c5180eb0689126316981a3ac4f6173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5c5180eb0689126316981a3ac4f6173">&#9670;&nbsp;</a></span>ksepi_blipsign</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_blipsign = <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a> with {<a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811a5b332d904cae8d59fc2f85b49ada0ae4">KS_EPI_NEGBLIPS</a>, <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>, <a class="el" href="_k_s_foundation_8h.html#ae3a267da7c3c7e4e6e523dafba9b7811ab36b1c8bcdbe924fc9d4a36cde9ba4dd">KS_EPI_POSBLIPS</a>, VIS, &quot;Blip polarity: +1/-1&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9039a6bee3815109e2532128e74fc201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9039a6bee3815109e2532128e74fc201">&#9670;&nbsp;</a></span>ksepi_echotime_shifting</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_echotime_shifting = 1 with {0, 1, 1, VIS, &quot;Enable echo time shifting for multi shot&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29bfef1205483936f24f54560f52b58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29bfef1205483936f24f54560f52b58b">&#9670;&nbsp;</a></span>ksepi_kynover</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_kynover = 24 with {<a class="el" href="ksepi__implementation_8e.html#a2c37888e07c63cfcb9d517e6591ad515">KSEPI_MINHNOVER</a>, 512, 24, VIS, &quot;#extralines for MinTE&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a258744bff37289b369a855aac21501fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a258744bff37289b369a855aac21501fc">&#9670;&nbsp;</a></span>ksepi_kznover</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_kznover = 0 with {0, 512, 0, VIS, &quot;#extralines in kz&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab383faf358ba44a390fbe0b4c094a352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab383faf358ba44a390fbe0b4c094a352">&#9670;&nbsp;</a></span>ksepi_ky_R</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_ky_R = 1 with {1, 512, 1, VIS, &quot;Acceleration in ky&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a23e2186cee0d7569231661df9e65cf51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23e2186cee0d7569231661df9e65cf51">&#9670;&nbsp;</a></span>ksepi_kz_R</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_kz_R = 1 with {1, 512, 1, VIS, &quot;Acceleration in kz&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2c46570eed7a4f4e2596939555729492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c46570eed7a4f4e2596939555729492">&#9670;&nbsp;</a></span>ksepi_kz_nacslines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_kz_nacslines = 16 with {0, 512, 16, VIS, &quot;Number of acs lines in kz&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af247a505cba1e5157a68ef7b1d69453c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af247a505cba1e5157a68ef7b1d69453c">&#9670;&nbsp;</a></span>ksepi_caipi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_caipi = 0 with {0, 512, 0, VIS, &quot;CAIPIRINHA shift (affects 3D epi only. Set 0 for no CAIPI)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a60d24c9932e42095ed00b0409d207f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d24c9932e42095ed00b0409d207f71">&#9670;&nbsp;</a></span>ksepi_fcy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fcy = 1 with {0, 1, 0, VIS, &quot;Flowcomp Y when opfcomp&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa319748c312e4b8fad896f728e7e2b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa319748c312e4b8fad896f728e7e2b3f">&#9670;&nbsp;</a></span>ksepi_fcz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fcz = 1 with {0, 1, 0, VIS, &quot;Flowcomp Z when opfcomp&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a263548cf715f98526edee92b52818db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a263548cf715f98526edee92b52818db2">&#9670;&nbsp;</a></span>ksepi_fleet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet = 0 with {0, 1, 0, VIS, &quot;FLEET calibration volume [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a72e12979bfb35fc8b2f603dab67c6477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72e12979bfb35fc8b2f603dab67c6477">&#9670;&nbsp;</a></span>ksepi_fleet_flip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_fleet_flip = 15.0 with {0.1, 90.0, 15.0, VIS, &quot;FLEET flip angle [deg]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7881e8fdb59329abf98720583d8d10d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7881e8fdb59329abf98720583d8d10d5">&#9670;&nbsp;</a></span>ksepi_fleet_dda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet_dda = 0 with {0, 200, 0, VIS, &quot;Dummies for FLEET module&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6482961dc4df2cb9fccfcdcc6fa122c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6482961dc4df2cb9fccfcdcc6fa122c8">&#9670;&nbsp;</a></span>ksepi_fleet_num_ky</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet_num_ky = 36 with {1, 512, 36, VIS, &quot;Number of ky encodes for FLEET module&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4943b888caa1b27d937ce1a42a27fa2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4943b888caa1b27d937ce1a42a27fa2f">&#9670;&nbsp;</a></span>ksepi_fleet_num_kz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_fleet_num_kz = 24 with {1, 512, 24, VIS, &quot;Number of kz encodes for FLEET module (3D only)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06bff71c4e2fca6d2f5cbefe7c259b9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06bff71c4e2fca6d2f5cbefe7c259b9a">&#9670;&nbsp;</a></span>ksepi_reflines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_reflines = 0 with {0, 96, 0, VIS, &quot;Number of phase reference lines per shot&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a48246f40836694cfd04f40280dbe17f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48246f40836694cfd04f40280dbe17f6">&#9670;&nbsp;</a></span>ksepi_swi_returnmode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_swi_returnmode = 0 with {0, 7, 0, VIS, &quot;SWI recon 0:Off 1:Acq 2:SWI 4:SWIphase&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3712faf06d98f7af864abc7bf75c2b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3712faf06d98f7af864abc7bf75c2b92">&#9670;&nbsp;</a></span>ksepi_pos_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_pos_start = <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a> with {0, , <a class="el" href="_k_s_foundation_8h.html#a3bb177070dbeb44d2386c268d781fe61">KS_RFSSP_PRETIME</a>, INVIS, &quot;us from start until the first waveform begins&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7b4f0e2685695c87449b232bdb4e8f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b4f0e2685695c87449b232bdb4e8f28">&#9670;&nbsp;</a></span>ksepi_ssi_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_ssi_time = <a class="el" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a> with {32, , <a class="el" href="ksepi__implementation_8e.html#af19bef9c315a497fdd3f4d20169c61e6">KSEPI_DEFAULT_SSI_TIME</a>, VIS, &quot;time from eos to ssi in intern trig&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a85c440a9bfab319879423028559eef5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c440a9bfab319879423028559eef5b">&#9670;&nbsp;</a></span>ksepi_dda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_dda = 1 with {0, 200, 1, VIS, &quot;Number of dummy scans for steady state&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acf2f72331b4f7c43d173d0278eda229a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf2f72331b4f7c43d173d0278eda229a">&#9670;&nbsp;</a></span>ksepi_debug</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_debug = 1 with {0.0, 100, 1.0, VIS, &quot;Write out e.g. plot files (unless <a class="el" href="ksgre_8e.html#a1669428052472d00b1c55a1291f8032f">scan</a> on HW)&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a25ba61305798e6f6ba10cf186493afc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25ba61305798e6f6ba10cf186493afc2">&#9670;&nbsp;</a></span>ksepi_imsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_imsize = <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a> with {<a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ae462c5cfa8631a66d48604d1c04a0af4">KS_IMSIZE_NATIVE</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699ad8ee9fcfbd4ce48b046b2c6bd8557bb0">KS_IMSIZE_MIN256</a>, <a class="el" href="_k_s_foundation_8h.html#ae418ab3d6fe87794cd978b12d10ed699a27dfe464db7e9579482065d43f0d9118">KS_IMSIZE_POW2</a>, VIS, &quot;img. upsamp. [0:native 1:pow2 2:min256]&quot;}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aebf2679820e5b9cfcdf0926db8188851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebf2679820e5b9cfcdf0926db8188851">&#9670;&nbsp;</a></span>ksepi_abort_on_kserror</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_abort_on_kserror = FALSE with {0, 1, 0, VIS, &quot;Hard program abort on <a class="el" href="_k_s_foundation__common_8c.html#abf203f668f25e2c05338fddeb1bb1434">ks_error</a> [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a780ca0306bbc21c57cd8d676bd8bedab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780ca0306bbc21c57cd8d676bd8bedab">&#9670;&nbsp;</a></span>ksepi_onlinerecon</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_onlinerecon = 0 with {0, <a class="el" href="ksepi__implementation_8e.html#a578eb447ff3690e43479e538a846f917">MAXVAL_KSEPI_ONLINERECON</a>, 0, VIS, &quot;Online recon [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a92d0943acffeeec5fe3f57110b28f7ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92d0943acffeeec5fe3f57110b28f7ac">&#9670;&nbsp;</a></span>ksepi_ghostcorr</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_ghostcorr = 1 with {0, 1, 1, VIS, &quot;Ghost correction [0:OFF 1:ON]&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a90b2e2cbe6240eaf74e184cb7fe1c9eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90b2e2cbe6240eaf74e184cb7fe1c9eb">&#9670;&nbsp;</a></span>ksepi_ref_nsegments</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_ref_nsegments = 1 with {1, 512, 1, VIS, &quot;Number of kz segments in reference volume&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6ea932f1fd0cfa98b2f37e829e67a8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ea932f1fd0cfa98b2f37e829e67a8f8">&#9670;&nbsp;</a></span>ksepi_multishot_control</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_multishot_control = <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a> with {<a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a6662a22f9085ddf85afc093d84822ecd">KSEPI_MULTISHOT_OFF</a>, <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>, <a class="el" href="ksepi__implementation_8e.html#a87038548a580745904ee788ce7c61678a3cba83b22834a2c8b35358ae35eed93e">KSEPI_MULTISHOT_B0VOLS</a>, VIS, &quot;0:PI 1:All MulShot 2:1stMulShot 3:b0MulShot&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a64e29ab200ec2ec2c226ae859b2064ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e29ab200ec2ec2c226ae859b2064ec">&#9670;&nbsp;</a></span>ksepi_multivolpfile</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_multivolpfile = TRUE with {FALSE, TRUE, TRUE, VIS, &quot;Store all data in a single Pfile (pre DV26)&quot;,}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6db646d881a5c19c6d6cc7068cc947e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db646d881a5c19c6d6cc7068cc947e5">&#9670;&nbsp;</a></span>ksepi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_e_p_i___s_e_q_u_e_n_c_e.html">KSEPI_SEQUENCE</a> ksepi = <a class="el" href="ksepi__implementation_8e.html#abe40fdda4cc00e3922639c5f3d1b467f">KSEPI_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a749ea98d148d9e4eaa6275b321a9d39e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a749ea98d148d9e4eaa6275b321a9d39e">&#9670;&nbsp;</a></span>ksepi_fleetseq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_k_s_e_p_i___f_l_e_e_t___s_e_q_u_e_n_c_e.html">KSEPI_FLEET_SEQUENCE</a> ksepi_fleetseq = <a class="el" href="ksepi__implementation_8e.html#a8a40d0f726eb492ddb3da875c838833e">KSEPI_FLEET_INIT_SEQUENCE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6cf3409789f0f63acd82728cba2387bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf3409789f0f63acd82728cba2387bb">&#9670;&nbsp;</a></span>ksepi_interechotime</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_interechotime = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1e661325433fb0f29283f44babb61221"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e661325433fb0f29283f44babb61221">&#9670;&nbsp;</a></span>ksepi_echotime_shifting_shotdelay</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float ksepi_echotime_shifting_shotdelay = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aca57a989e4881d731835c196cefcde7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca57a989e4881d731835c196cefcde7d">&#9670;&nbsp;</a></span>ksepi_echotime_shifting_sumdelay</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ksepi_echotime_shifting_sumdelay = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f39fad60409167fe45164b72a131e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f39fad60409167fe45164b72a131e0b">&#9670;&nbsp;</a></span>sequence_iopts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sequence_iopts[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line"></div><div class="line">  PSD_IOPT_ASSET, </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">  PSD_IOPT_MPH, </div><div class="line">  PSD_IOPT_EDR, </div><div class="line">  PSD_IOPT_ZIP_512, </div><div class="line">  PSD_IOPT_IR_PREP, </div><div class="line">  PSD_IOPT_MILDNOTE, </div><div class="line">  PSD_IOPT_FLOW_COMP, </div><div class="line">  PSD_IOPT_SEQUENTIAL, </div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">}</div></div><!-- fragment -->
</div>
</div>
<a id="abd7cdf91b5410cdc97ac4abd7fe17bb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd7cdf91b5410cdc97ac4abd7fe17bb3">&#9670;&nbsp;</a></span>rfspoiling_phase_counter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rfspoiling_phase_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_edd0b46848e1966a9ba471eaad9abcfd.html">tmpfiles</a></li><li class="navelem"><a class="el" href="ksepi__implementation_8e.html">ksepi_implementation.e</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
